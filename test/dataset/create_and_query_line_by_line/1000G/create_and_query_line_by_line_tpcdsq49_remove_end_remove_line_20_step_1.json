[
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0\n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by sts.ss_item_sk\n \t) in_store\n ) store\n where \n (\n store.return_rank <= 10\n or\n store.currency_rank <= 10\n )\n) /*CURSOR_IDENTIFIER*/ as final_selection",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"FINAL_SELECTION\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"FINAL_SELECTION\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_SELECTION\".\"ITEM\" AS \"ITEM\" , \"FINAL_SELECTION\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"FINAL_SELECTION\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"FINAL_SELECTION\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"FINAL_SELECTION\" AS \"FINAL_SELECTION\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080522,
                    "execution_time": 0.031513,
                    "compile_time": 0.000239,
                    "planning_time": 0.024808,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.149992,
                    "execution_time": 0.030764,
                    "compile_time": 0.000233,
                    "planning_time": 0.095086,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 GROUP BY \"WS\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.242804,
                    "execution_time": 0.145803,
                    "compile_time": 0.00039,
                    "planning_time": 0.044936,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.651616,
                    "execution_time": 5.30235,
                    "compile_time": 4.177078,
                    "planning_time": 0.11406,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"ITEM\" AS \"ITEM\" , \"SPEQLITE_TEMP_TABLE_2\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_2\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_2\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.092964,
                    "execution_time": 0.048658,
                    "compile_time": 0.000314,
                    "planning_time": 0.004098,
                    "create_size": 196
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.157619,
                    "execution_time": 0.049581,
                    "compile_time": 0.006605,
                    "planning_time": 0.060578,
                    "create_size": 196
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) AS FINAL_SELECTION LIMIT 21",
                "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web  169202     0.408602          399              2\n1      web  176977        0E-16            1            109\n2      web  238531        0E-16            1            152\n3      web  104182        0E-16            1            234\n4      web  143221        0E-16            1           1029\n5      web  188059        0E-16            1           1647\n6      web  106711        0E-16            1           2114\n7      web  223693        0E-16            1           2337\n8      web  114397        0E-16            1           2564\n9      web  221098        0E-16            1           2608\n10     web  260086        0E-16            1           2765\n11     web   54607        0E-16            1           2955\n12     web  287344        0E-16            1           3215\n13     web   86848        0E-16            1           3764\n14     web  132571        0E-16            1           4137\n15     web  203366        0E-16            1           4327\n16     web  266911        0E-16            1           4682\n17     web  199363        0E-16            1           5264\n18     web  168958        0E-16            1           6283\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 3.256968,
                    "execution_time": 3.073467,
                    "compile_time": 0.001095,
                    "planning_time": 0.136689
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 17.798413,
                    "execution_time": 4.915319,
                    "compile_time": 12.609311,
                    "planning_time": 0.225554
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web  169202     0.408602          399              2\n1      web  176977        0E-16            1            109\n2      web  238531        0E-16            1            152\n3      web  104182        0E-16            1            234\n4      web  143221        0E-16            1           1029\n5      web  188059        0E-16            1           1647\n6      web  106711        0E-16            1           2114\n7      web  223693        0E-16            1           2337\n8      web  114397        0E-16            1           2564\n9      web  221098        0E-16            1           2608\n10     web  260086        0E-16            1           2765\n11     web   54607        0E-16            1           2955\n12     web  287344        0E-16            1           3215\n13     web   86848        0E-16            1           3764\n14     web  132571        0E-16            1           4137\n15     web  203366        0E-16            1           4327\n16     web  266911        0E-16            1           4682\n17     web  199363        0E-16            1           5264\n18     web  168958        0E-16            1           6283\n...*/"
    },
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n(select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.WR_RETURN_QUANTITY,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.WR_RETURN_AMT,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.WR_ORDER_NUMBER and \n \t\t\tws.ws_item_sk = wr.WR_ITEM_SK)\n                 ,date_dim\n \t\twhere \n \t\t\twr.WR_RETURN_AMT > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.CR_RETURN_QUANTITY,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.CR_RETURN_AMOUNT,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.CR_ORDER_NUMBER and \n \t\t\tcs.cs_item_sk = cr.CR_ITEM_SK)\n                ,date_dim\n \t\twhere \n \t\t\tcr.CR_RETURN_AMOUNT > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.SR_RETURN_QUANTITY,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.SR_RETURN_AMT,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.SR_TICKET_NUMBER and sts.ss_item_sk = sr.SR_ITEM_SK)\n                ,date_dim\n \t\twhere \n \t\t\tsr.SR_RETURN_AMT > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0\n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by sts.ss_item_sk\n \t) in_store\n ) store\n where \n (\n store.return_rank <= 10\n or\n store.currency_rank <=10\n )\n) as final_result\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"FINAL_RESULT\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"FINAL_RESULT\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_RESULT\".\"ITEM\" AS \"ITEM\" , \"FINAL_RESULT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"FINAL_RESULT\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"FINAL_RESULT\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"FINAL_RESULT\" AS \"FINAL_RESULT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.24547,
                    "execution_time": 0.146495,
                    "compile_time": 0.000409,
                    "planning_time": 0.04432,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.549007,
                    "execution_time": 0.210032,
                    "compile_time": 4.161014,
                    "planning_time": 0.117274,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"ITEM\" AS \"ITEM\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096698,
                    "execution_time": 0.058873,
                    "compile_time": 0.000348,
                    "planning_time": 0.004298,
                    "create_size": 196
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177285,
                    "execution_time": 0.067272,
                    "compile_time": 0.00033,
                    "planning_time": 0.063502,
                    "create_size": 196
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) AS FINAL_RESULT LIMIT 21",
                "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web  145465        0E-16            1             76\n1      web   34801        0E-16            1            397\n2      web  147001        0E-16            1            515\n3      web  287720        0E-16            1            773\n4      web   63841        0E-16            1           1391\n5      web  255397        0E-16            1           1478\n6      web  273955        0E-16            1           1508\n7      web  295862        0E-16            1           1631\n8      web  105988        0E-16            1           1936\n9      web  114326        0E-16            1           2516\n10     web  235064        0E-16            1           3033\n11     web  138262        0E-16            1           4035\n12     web  251018        0E-16            1           4682\n13     web  239006        0E-16            1           5376\n14     web   14222        0E-16            1           5629\n15     web  296960        0E-16            1           7567\n16     web  241880        0E-16            1           8105\n17     web  146350        0E-16            1           8304\n18     web  278959        0E-16            1           8538\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.282905,
                    "execution_time": 2.107992,
                    "compile_time": 0.001125,
                    "planning_time": 0.127795
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.243771,
                    "execution_time": 1.967184,
                    "compile_time": 0.001136,
                    "planning_time": 0.229783
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web  145465        0E-16            1             76\n1      web   34801        0E-16            1            397\n2      web  147001        0E-16            1            515\n3      web  287720        0E-16            1            773\n4      web   63841        0E-16            1           1391\n5      web  255397        0E-16            1           1478\n6      web  273955        0E-16            1           1508\n7      web  295862        0E-16            1           1631\n8      web  105988        0E-16            1           1936\n9      web  114326        0E-16            1           2516\n10     web  235064        0E-16            1           3033\n11     web  138262        0E-16            1           4035\n12     web  251018        0E-16            1           4682\n13     web  239006        0E-16            1           5376\n14     web   14222        0E-16            1           5629\n15     web  296960        0E-16            1           7567\n16     web  241880        0E-16            1           8105\n17     web  146350        0E-16            1           8304\n18     web  278959        0E-16            1           8538\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws.ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs.cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and sts.ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n ) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"_Q_0\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ITEM\" AS \"ITEM\" , \"_Q_0\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"_Q_0\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"_Q_0\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"ITEM\" AS \"ITEM\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"SPEQLITE_TEMP_TABLE_4\".\"CURRENCY_RATIO\" AS \"CURRENCY_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.097645,
                    "execution_time": 0.047792,
                    "compile_time": 0.000259,
                    "planning_time": 0.003465,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.361286,
                    "execution_time": 0.053111,
                    "compile_time": 0.200401,
                    "planning_time": 0.059452,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM\" AS \"ITEM\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.094672,
                    "execution_time": 0.048813,
                    "compile_time": 0.000317,
                    "planning_time": 0.004227,
                    "create_size": 196
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.152734,
                    "execution_time": 0.050712,
                    "compile_time": 0.000318,
                    "planning_time": 0.060362,
                    "create_size": 196
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS.WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS.CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND STS.SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) LIMIT 21",
                "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web  232906      0.42268          409              4\n1      web  139622      0.43617          417             10\n2      web  295840        0E-16            1            175\n3      web  114217        0E-16            1            667\n4      web  232573        0E-16            1            861\n5      web    1342        0E-16            1           1742\n6      web  167101        0E-16            1           2147\n7      web  228739        0E-16            1           2280\n8      web   74824        0E-16            1           2444\n9      web  197335        0E-16            1           2794\n10     web  289039        0E-16            1           2913\n11     web  294424        0E-16            1           3437\n12     web  120136        0E-16            1           4014\n13     web    3098        0E-16            1           4233\n14     web   68714        0E-16            1           4541\n15     web   94724        0E-16            1           4575\n16     web  280592        0E-16            1           4595\n17     web  149137        0E-16            1           4697\n18     web  242258        0E-16            1           5228\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.828516,
                    "execution_time": 0.654425,
                    "compile_time": 0.001086,
                    "planning_time": 0.127636
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.248232,
                    "execution_time": 0.977637,
                    "compile_time": 0.001145,
                    "planning_time": 0.223389
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web  232906      0.42268          409              4\n1      web  139622      0.43617          417             10\n2      web  295840        0E-16            1            175\n3      web  114217        0E-16            1            667\n4      web  232573        0E-16            1            861\n5      web    1342        0E-16            1           1742\n6      web  167101        0E-16            1           2147\n7      web  228739        0E-16            1           2280\n8      web   74824        0E-16            1           2444\n9      web  197335        0E-16            1           2794\n10     web  289039        0E-16            1           2913\n11     web  294424        0E-16            1           3437\n12     web  120136        0E-16            1           4014\n13     web    3098        0E-16            1           4233\n14     web   68714        0E-16            1           4541\n15     web   94724        0E-16            1           4575\n16     web  280592        0E-16            1           4595\n17     web  149137        0E-16            1           4697\n18     web  242258        0E-16            1           5228\n...*/"
    },
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws.ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs.cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and sts.ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n) /* Added missing parenthesis here for the main query structure */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"_Q_0\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ITEM\" AS \"ITEM\" , \"_Q_0\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"_Q_0\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"_Q_0\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS.WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS.CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND STS.SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) LIMIT 21",
                "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web   86287        0E-16            1            227\n1      web  261248        0E-16            1            596\n2      web   23462        0E-16            1            821\n3      web  223696        0E-16            1           1033\n4      web  271495        0E-16            1           1806\n5      web   79801        0E-16            1           1806\n6      web   65422        0E-16            1           2086\n7      web  155402        0E-16            1           2428\n8      web  254635        0E-16            1           2602\n9      web  216638        0E-16            1           2913\n10     web   91885        0E-16            1           3227\n11     web  174712        0E-16            1           4004\n12     web  233191        0E-16            1           4233\n13     web  211004        0E-16            1           4275\n14     web  149722        0E-16            1           4863\n15     web  105934        0E-16            1           5068\n16     web  226375        0E-16            1           5485\n17     web  146800        0E-16            1           6321\n18     web  194170        0E-16            1           6442\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.851833,
                    "execution_time": 0.678074,
                    "compile_time": 0.001113,
                    "planning_time": 0.127032
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.835695,
                    "execution_time": 0.663394,
                    "compile_time": 0.001095,
                    "planning_time": 0.126123
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web   86287        0E-16            1            227\n1      web  261248        0E-16            1            596\n2      web   23462        0E-16            1            821\n3      web  223696        0E-16            1           1033\n4      web  271495        0E-16            1           1806\n5      web   79801        0E-16            1           1806\n6      web   65422        0E-16            1           2086\n7      web  155402        0E-16            1           2428\n8      web  254635        0E-16            1           2602\n9      web  216638        0E-16            1           2913\n10     web   91885        0E-16            1           3227\n11     web  174712        0E-16            1           4004\n12     web  233191        0E-16            1           4233\n13     web  211004        0E-16            1           4275\n14     web  149722        0E-16            1           4863\n15     web  105934        0E-16            1           5068\n16     web  226375        0E-16            1           5485\n17     web  146800        0E-16            1           6321\n18     web  194170        0E-16            1           6442\n...*/"
    },
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"_Q_0\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ITEM\" AS \"ITEM\" , \"_Q_0\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"_Q_0\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"_Q_0\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) LIMIT 21",
                "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web   62132     0.385417          391              1\n1      web  136645     0.414141          402              3\n2      web  129562     0.414141          402              9\n3      web  203978        0E-16            1            397\n4      web  248887        0E-16            1            632\n5      web  148078        0E-16            1           1036\n6      web  231907        0E-16            1           1214\n7      web  213998        0E-16            1           1278\n8      web  177988        0E-16            1           1593\n9      web  194845        0E-16            1           1665\n10     web   93382        0E-16            1           1678\n11     web   67447        0E-16            1           1806\n12     web  157604        0E-16            1           1949\n13     web   60583        0E-16            1           1958\n14     web   27577        0E-16            1           1996\n15     web   19888        0E-16            1           2564\n16     web  217654        0E-16            1           2807\n17     web    7952        0E-16            1           3042\n18     web  241618        0E-16            1           3248\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.829574,
                    "execution_time": 0.650621,
                    "compile_time": 0.001141,
                    "planning_time": 0.132597
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.930333,
                    "execution_time": 0.648027,
                    "compile_time": 0.001092,
                    "planning_time": 0.23539
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   channel    item return_ratio  return_rank  currency_rank\n0      web   62132     0.385417          391              1\n1      web  136645     0.414141          402              3\n2      web  129562     0.414141          402              9\n3      web  203978        0E-16            1            397\n4      web  248887        0E-16            1            632\n5      web  148078        0E-16            1           1036\n6      web  231907        0E-16            1           1214\n7      web  213998        0E-16            1           1278\n8      web  177988        0E-16            1           1593\n9      web  194845        0E-16            1           1665\n10     web   93382        0E-16            1           1678\n11     web   67447        0E-16            1           1806\n12     web  157604        0E-16            1           1949\n13     web   60583        0E-16            1           1958\n14     web   27577        0E-16            1           1996\n15     web   19888        0E-16            1           2564\n16     web  217654        0E-16            1           2807\n17     web    7952        0E-16            1           3042\n18     web  241618        0E-16            1           3248\n...*/"
    },
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"_Q_0\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ITEM\" AS \"ITEM\" , \"_Q_0\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"_Q_0\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"_Q_0\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"_Q_0\" AS \"_Q_0\" ORDER BY \"CHANNEL\" NULLS LAST , \"RETURN_RANK\" NULLS LAST , \"CURRENCY_RANK\" NULLS LAST , \"ITEM\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) ORDER BY 1 NULLS FIRST , 4 NULLS FIRST , 5 NULLS FIRST , 2 NULLS FIRST LIMIT 21",
                "preview": "\n/*    channel    item return_ratio  return_rank  currency_rank\n0   catalog  297421        0E-16            1              4\n1   catalog  220576        0E-16            1             99\n2   catalog  283364        0E-16            1            148\n3   catalog  127603        0E-16            1            198\n4   catalog  104572        0E-16            1            224\n5   catalog  128468        0E-16            1            328\n6   catalog  184012        0E-16            1            452\n7   catalog   47786        0E-16            1            518\n8   catalog  186205        0E-16            1            563\n9   catalog   29128        0E-16            1            624\n10  catalog   60559        0E-16            1            631\n11  catalog   75571        0E-16            1            699\n12  catalog  299752        0E-16            1            867\n13  catalog   64502        0E-16            1           1049\n14  catalog   84976        0E-16            1           1456\n15  catalog  134932        0E-16            1           1516\n16  catalog  106399        0E-16            1           1550\n17  catalog   72922        0E-16            1           1575\n18  catalog  226060        0E-16            1           1575\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.846776,
                    "execution_time": 0.664382,
                    "compile_time": 0.001292,
                    "planning_time": 0.131961
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.936147,
                    "execution_time": 0.655525,
                    "compile_time": 0.007459,
                    "planning_time": 0.228012
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    channel    item return_ratio  return_rank  currency_rank\n0   catalog  297421        0E-16            1              4\n1   catalog  220576        0E-16            1             99\n2   catalog  283364        0E-16            1            148\n3   catalog  127603        0E-16            1            198\n4   catalog  104572        0E-16            1            224\n5   catalog  128468        0E-16            1            328\n6   catalog  184012        0E-16            1            452\n7   catalog   47786        0E-16            1            518\n8   catalog  186205        0E-16            1            563\n9   catalog   29128        0E-16            1            624\n10  catalog   60559        0E-16            1            631\n11  catalog   75571        0E-16            1            699\n12  catalog  299752        0E-16            1            867\n13  catalog   64502        0E-16            1           1049\n14  catalog   84976        0E-16            1           1456\n15  catalog  134932        0E-16            1           1516\n16  catalog  106399        0E-16            1           1550\n17  catalog   72922        0E-16            1           1575\n18  catalog  226060        0E-16            1           1575\n...*/"
    },
    {
        "input": "-- start template query49.tpl query 48 in stream 0\nselect /* TPC-DS query49.tpl 0.48 */  channel, item, return_ratio, return_rank, currency_rank from\n (select\n 'web' as channel\n ,web.item\n ,web.return_ratio\n ,web.return_rank\n ,web.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect ws.ws_item_sk as item\n \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\t web_sales ws left outer join web_returns wr \n \t\t\ton (ws.ws_order_number = wr.wr_order_number and \n \t\t\tws.ws_item_sk = wr.wr_item_sk)\n                 ,date_dim\n \t\twhere \n \t\t\twr.wr_return_amt > 10000 \n \t\t\tand ws.ws_net_profit > 1\n                         and ws.ws_net_paid > 0\n                         and ws.ws_quantity > 0\n                         and ws_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by ws.ws_item_sk\n \t) in_web\n ) web\n where \n (\n web.return_rank <= 10\n or\n web.currency_rank <= 10\n )\n union\n select \n 'catalog' as channel\n ,catalog.item\n ,catalog.return_ratio\n ,catalog.return_rank\n ,catalog.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect \n \t\tcs.cs_item_sk as item\n \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\n \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tcatalog_sales cs left outer join catalog_returns cr\n \t\t\ton (cs.cs_order_number = cr.cr_order_number and \n \t\t\tcs.cs_item_sk = cr.cr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tcr.cr_return_amount > 10000 \n \t\t\tand cs.cs_net_profit > 1\n                         and cs.cs_net_paid > 0\n                         and cs.cs_quantity > 0\n                         and cs_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n                 group by cs.cs_item_sk\n \t) in_cat\n ) catalog\n where \n (\n catalog.return_rank <= 10\n or\n catalog.currency_rank <=10\n )\n union\n select \n 'store' as channel\n ,store.item\n ,store.return_ratio\n ,store.return_rank\n ,store.currency_rank\n from (\n \tselect \n \t item\n \t,return_ratio\n \t,currency_ratio\n \t,rank() over (order by return_ratio) as return_rank\n \t,rank() over (order by currency_ratio) as currency_rank\n \tfrom\n \t(\tselect sts.ss_item_sk as item\n \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\n \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\n \t\tfrom \n \t\tstore_sales sts left outer join store_returns sr\n \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\n                ,date_dim\n \t\twhere \n \t\t\tsr.sr_return_amt > 10000 \n \t\t\tand sts.ss_net_profit > 1\n                         and sts.ss_net_paid > 0 \n                         and sts.ss_quantity > 0\n                         and ss_sold_date_sk = d_date_sk\n                         and d_year = 1999\n                         and d_moy = 11\n \t\tgroup by sts.ss_item_sk\n \t) in_store\n ) store\n where  (\n store.return_rank <= 10\n or \n store.currency_rank <= 10\n )\n )\n order by 1,4,5,2\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 11 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"IN_WEB\" AS ( SELECT \"WS\".\"WS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"WR\".\"WR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"WS\".\"WS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"WS\".\"WS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" WHERE \"WR\".\"WR_RETURN_AMT\" > 10000 AND \"WS\".\"WS_NET_PAID\" > 0 AND \"WS\".\"WS_NET_PROFIT\" > 1 AND \"WS\".\"WS_QUANTITY\" > 0 GROUP BY \"WS\".\"WS_ITEM_SK\" ) , \"WEB\" AS ( SELECT \"IN_WEB\".\"ITEM\" AS \"ITEM\" , \"IN_WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_WEB\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_WEB\" AS \"IN_WEB\" ) , \"IN_CAT\" AS ( SELECT \"CS\".\"CS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"CR\".\"CR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"CS\".\"CS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) / SUM ( COALESCE ( \"CS\".\"CS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"CATALOG_SALES\" AS \"CS\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" WHERE \"CR\".\"CR_RETURN_AMOUNT\" > 10000 AND \"CS\".\"CS_NET_PAID\" > 0 AND \"CS\".\"CS_NET_PROFIT\" > 1 AND \"CS\".\"CS_QUANTITY\" > 0 GROUP BY \"CS\".\"CS_ITEM_SK\" ) , \"CATALOG\" AS ( SELECT \"IN_CAT\".\"ITEM\" AS \"ITEM\" , \"IN_CAT\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_CAT\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_CAT\" AS \"IN_CAT\" ) , \"IN_STORE\" AS ( SELECT \"STS\".\"SS_ITEM_SK\" AS \"ITEM\" , CAST ( SUM ( COALESCE ( \"SR\".\"SR_RETURN_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( \"STS\".\"SS_QUANTITY\" , 0 ) ) AS DECIMAL ( 15 , 4 ) ) AS \"RETURN_RATIO\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) / SUM ( COALESCE ( \"STS\".\"SS_NET_PAID\" , 0 ) ) AS \"CURRENCY_RATIO\" FROM \"STORE_SALES\" AS \"STS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STS\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"STS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"STS\".\"SS_TICKET_NUMBER\" WHERE \"SR\".\"SR_RETURN_AMT\" > 10000 AND \"STS\".\"SS_NET_PAID\" > 0 AND \"STS\".\"SS_NET_PROFIT\" > 1 AND \"STS\".\"SS_QUANTITY\" > 0 GROUP BY \"STS\".\"SS_ITEM_SK\" ) , \"STORE\" AS ( SELECT \"IN_STORE\".\"ITEM\" AS \"ITEM\" , \"IN_STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"RETURN_RATIO\" NULLS LAST ) AS \"RETURN_RANK\" , RANK ( ) OVER ( ORDER BY \"IN_STORE\".\"CURRENCY_RATIO\" NULLS LAST ) AS \"CURRENCY_RANK\" FROM \"IN_STORE\" AS \"IN_STORE\" ) , \"_Q_0\" AS ( SELECT 'web' AS \"CHANNEL\" , \"WEB\".\"ITEM\" AS \"ITEM\" , \"WEB\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"WEB\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"WEB\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"WEB\" AS \"WEB\" WHERE \"WEB\".\"CURRENCY_RANK\" <= 10 OR \"WEB\".\"RETURN_RANK\" <= 10 UNION SELECT 'catalog' AS \"CHANNEL\" , \"CATALOG\".\"ITEM\" AS \"ITEM\" , \"CATALOG\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"CATALOG\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"CATALOG\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"CATALOG\" AS \"CATALOG\" WHERE \"CATALOG\".\"CURRENCY_RANK\" <= 10 OR \"CATALOG\".\"RETURN_RANK\" <= 10 UNION SELECT 'store' AS \"CHANNEL\" , \"STORE\".\"ITEM\" AS \"ITEM\" , \"STORE\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"STORE\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"STORE\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"STORE\" AS \"STORE\" WHERE \"STORE\".\"CURRENCY_RANK\" <= 10 OR \"STORE\".\"RETURN_RANK\" <= 10 ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ITEM\" AS \"ITEM\" , \"_Q_0\".\"RETURN_RATIO\" AS \"RETURN_RATIO\" , \"_Q_0\".\"RETURN_RANK\" AS \"RETURN_RANK\" , \"_Q_0\".\"CURRENCY_RANK\" AS \"CURRENCY_RANK\" FROM \"_Q_0\" AS \"_Q_0\" ORDER BY \"CHANNEL\" NULLS LAST , \"RETURN_RANK\" NULLS LAST , \"CURRENCY_RANK\" NULLS LAST , \"ITEM\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CHANNEL , ITEM , RETURN_RATIO , RETURN_RANK , CURRENCY_RANK FROM ( SELECT 'web' AS CHANNEL , WEB.ITEM , WEB.RETURN_RATIO , WEB.RETURN_RANK , WEB.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT WS.WS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( WS.WS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER AND WS.WS_ITEM_SK = WR.WR_ITEM_SK ) , DATE_DIM WHERE WR.WR_RETURN_AMT > 10000 AND WS.WS_NET_PROFIT > 1 AND WS.WS_NET_PAID > 0 AND WS.WS_QUANTITY > 0 AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY WS.WS_ITEM_SK ) AS IN_WEB ) AS WEB WHERE ( WEB.RETURN_RANK <= 10 OR WEB.CURRENCY_RANK <= 10 ) UNION SELECT 'catalog' AS CHANNEL , CATALOG.ITEM , CATALOG.RETURN_RATIO , CATALOG.RETURN_RANK , CATALOG.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT CS.CS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( CS.CS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER AND CS.CS_ITEM_SK = CR.CR_ITEM_SK ) , DATE_DIM WHERE CR.CR_RETURN_AMOUNT > 10000 AND CS.CS_NET_PROFIT > 1 AND CS.CS_NET_PAID > 0 AND CS.CS_QUANTITY > 0 AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY CS.CS_ITEM_SK ) AS IN_CAT ) AS CATALOG WHERE ( CATALOG.RETURN_RANK <= 10 OR CATALOG.CURRENCY_RANK <= 10 ) UNION SELECT 'store' AS CHANNEL , STORE.ITEM , STORE.RETURN_RATIO , STORE.RETURN_RANK , STORE.CURRENCY_RANK FROM ( SELECT ITEM , RETURN_RATIO , CURRENCY_RATIO , RANK ( ) OVER ( ORDER BY RETURN_RATIO NULLS FIRST ) AS RETURN_RANK , RANK ( ) OVER ( ORDER BY CURRENCY_RATIO NULLS FIRST ) AS CURRENCY_RANK FROM ( SELECT STS.SS_ITEM_SK AS ITEM , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_QUANTITY , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS RETURN_RATIO , ( CAST ( SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS DECIMAL ( 15 , 4 ) ) / CAST ( SUM ( COALESCE ( STS.SS_NET_PAID , 0 ) ) AS DECIMAL ( 15 , 4 ) ) ) AS CURRENCY_RATIO FROM STORE_SALES AS STS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER AND STS.SS_ITEM_SK = SR.SR_ITEM_SK ) , DATE_DIM WHERE SR.SR_RETURN_AMT > 10000 AND STS.SS_NET_PROFIT > 1 AND STS.SS_NET_PAID > 0 AND STS.SS_QUANTITY > 0 AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_MOY = 11 GROUP BY STS.SS_ITEM_SK ) AS IN_STORE ) AS STORE WHERE ( STORE.RETURN_RANK <= 10 OR STORE.CURRENCY_RANK <= 10 ) ) ORDER BY 1 NULLS FIRST , 4 NULLS FIRST , 5 NULLS FIRST , 2 NULLS FIRST LIMIT 21",
                "preview": "\n/*    channel    item return_ratio  return_rank  currency_rank\n0   catalog  297421        0E-16            1              4\n1   catalog  220576        0E-16            1             99\n2   catalog  283364        0E-16            1            148\n3   catalog  127603        0E-16            1            198\n4   catalog  104572        0E-16            1            224\n5   catalog  128468        0E-16            1            328\n6   catalog  184012        0E-16            1            452\n7   catalog   47786        0E-16            1            518\n8   catalog  186205        0E-16            1            563\n9   catalog   29128        0E-16            1            624\n10  catalog   60559        0E-16            1            631\n11  catalog   75571        0E-16            1            699\n12  catalog  299752        0E-16            1            867\n13  catalog   64502        0E-16            1           1049\n14  catalog   84976        0E-16            1           1456\n15  catalog  134932        0E-16            1           1516\n16  catalog  106399        0E-16            1           1550\n17  catalog   72922        0E-16            1           1575\n18  catalog  226060        0E-16            1           1575\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.830127,
                    "execution_time": 0.652902,
                    "compile_time": 0.001278,
                    "planning_time": 0.127557
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.831633,
                    "execution_time": 0.654126,
                    "compile_time": 0.001191,
                    "planning_time": 0.128162
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    channel    item return_ratio  return_rank  currency_rank\n0   catalog  297421        0E-16            1              4\n1   catalog  220576        0E-16            1             99\n2   catalog  283364        0E-16            1            148\n3   catalog  127603        0E-16            1            198\n4   catalog  104572        0E-16            1            224\n5   catalog  128468        0E-16            1            328\n6   catalog  184012        0E-16            1            452\n7   catalog   47786        0E-16            1            518\n8   catalog  186205        0E-16            1            563\n9   catalog   29128        0E-16            1            624\n10  catalog   60559        0E-16            1            631\n11  catalog   75571        0E-16            1            699\n12  catalog  299752        0E-16            1            867\n13  catalog   64502        0E-16            1           1049\n14  catalog   84976        0E-16            1           1456\n15  catalog  134932        0E-16            1           1516\n16  catalog  106399        0E-16            1           1550\n17  catalog   72922        0E-16            1           1575\n18  catalog  226060        0E-16            1           1575\n...*/"
    }
]