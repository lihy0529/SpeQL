[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "SELECT ca_zip\nFROM (\n    SELECT Substring(ca_zip, 1, 5) as ca_zip\n    FROM customer_address\n    WHERE Substring(ca_zip, 1, 5) IN (\n        '67436', '26121', '38443', '63157', '68856', '19485', '86425', '26741',\n        '70991', '60899', '63573', '47556', '56193', '93314', '87827', '62017',\n        '85067', '95390', '48091', '10261', '41790', '81845', '42853', '24675',\n        '12840', '60065', '84430', '57451', '24021', '91735', '75335', '71935',\n        '34482', '56943', '70695', '52147', '56251', '28411', '86653', '23005',\n        '22478', '29031', '34398', '15365', '42460', '33337', '59433', '73943',\n        '72477', '74081', '74430', '64605', '39006', '11226', '49057', '97308',\n        '42663', '18187', '19768', '43454', '32147', '76637', '51975', '11181',\n        '45630', '33129', '45995', '64386', '55522', '26697', '20963', '35154',\n        '64587', '49752', '66386', '30586', '59286', '13177', '66646', '84195',\n        '74316', '36853', '32927', '12469', '11904', '36269', '17724', '55346',\n        '12595', '53988', '65439', '28015', '63268', '73590', '29216', '82575',\n        '69267', '13805', '91678', '79460', '94152', '14961', '15419', '48277',\n        '62588', '55493', '28360', '14152', '55225', '18007', '53705', '56573',\n        '80245', '71769', '57348', '36845', '13039', '17270', '22363', '83474',\n        '25294', '43269', '77666', '15488', '99146', '64441', '43338', '38736',\n        '62754', '48556', '86057', '23090', '38114', '66061', '18910', '84385',\n        '23600', '19975', '27883', '65719', '19933', '32085', '49731', '40473',\n        '27190', '46192', '23949', '44738', '12436', '64794', '68741', '15333',\n        '24282', '49085', '31844', '71156', '48441', '17100', '98207', '44982',\n        '20277', '71496', '96299', '37583', '22206', '89174', '30589', '61924',\n        '53079', '10976', '13104', '42794', '54772', '15809', '56434', '39975',\n        '13874', '30753', '77598', '78229', '59478', '12345', '55547', '57422',\n        '42600', '79444', '29074', '29752', '21676', '32096', '43044', '39383',\n        '37296', '36295', '63077', '16572', '31275', '18701', '40197', '48242',\n        '27219', '49865', '84175', '30446', '25165', '13807', '72142', '70499',\n        '70464', '71429', '18111', '70857', '29545', '36425', '52706', '36194',\n        '42963', '75068', '47921', '74763', '90990', '89456', '62073', '88397',\n        '73963', '75885', '62657', '12530', '81146', '57434', '25099', '41429',\n        '98441', '48713', '52552', '31667', '14072', '13903', '44709', '85429',\n        '58017', '38295', '44875', '73541', '30091', '12707', '23762', '62258',\n        '33247', '78722', '77431', '14510', '35656', '72428', '92082', '35267',\n        '43759', '24354', '90952', '11512', '21242', '22579', '56114', '32339',\n        '52282', '41791', '24484', '95020', '28408', '99710', '11899', '43344',\n        '72915', '27644', '62708', '74479', '17177', '32619', '12351', '91339',\n        '31169', '57081', '53522', '16712', '34419', '71779', '44187', '46206',\n        '96099', '61910', '53664', '12295', '31837', '33096', '10813', '63048',\n        '31732', '79118', '73084', '72783', '84952', '46965', '77956', '39815',\n        '32311', '75329', '48156', '30826', '49661', '13736', '92076', '74865',\n        '88149', '92397', '52777', '68453', '32012', '21222', '52721', '24626',\n        '18210', '42177', '91791', '75251', '82075', '44372', '45542', '20609',\n        '60115', '17362', '22750', '90434', '31852', '54071', '33762', '14705',\n        '40718', '56433', '30996', '40657', '49056', '23585', '66455', '41021',\n        '74736', '72151', '37007', '21729', '60177', '84558', '59027', '93855',\n        '60022', '86443', '19541', '86886', '30532', '39062', '48532', '34713',\n        '52077', '22564', '64638', '15273', '31677', '36138', '62367', '60261',\n        '80213', '42818', '25113', '72378', '69802', '69096', '55443', '28820',\n        '13848', '78258', '37490', '30556', '77380', '28447', '44550', '26791',\n        '70609', '82182', '33306', '43224', '22322', '86959', '68519', '14308',\n        '46501', '81131', '34056', '61991', '19896', '87804', '65774', '92564'\n    )\n) AS inner_query /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '67436' , '26121' , '38443' , '63157' , '68856' , '19485' , '86425' , '26741' , '70991' , '60899' , '63573' , '47556' , '56193' , '93314' , '87827' , '62017' , '85067' , '95390' , '48091' , '10261' , '41790' , '81845' , '42853' , '24675' , '12840' , '60065' , '84430' , '57451' , '24021' , '91735' , '75335' , '71935' , '34482' , '56943' , '70695' , '52147' , '56251' , '28411' , '86653' , '23005' , '22478' , '29031' , '34398' , '15365' , '42460' , '33337' , '59433' , '73943' , '72477' , '74081' , '74430' , '64605' , '39006' , '11226' , '49057' , '97308' , '42663' , '18187' , '19768' , '43454' , '32147' , '76637' , '51975' , '11181' , '45630' , '33129' , '45995' , '64386' , '55522' , '26697' , '20963' , '35154' , '64587' , '49752' , '66386' , '30586' , '59286' , '13177' , '66646' , '84195' , '74316' , '36853' , '32927' , '12469' , '11904' , '36269' , '17724' , '55346' , '12595' , '53988' , '65439' , '28015' , '63268' , '73590' , '29216' , '82575' , '69267' , '13805' , '91678' , '79460' , '94152' , '14961' , '15419' , '48277' , '62588' , '55493' , '28360' , '14152' , '55225' , '18007' , '53705' , '56573' , '80245' , '71769' , '57348' , '36845' , '13039' , '17270' , '22363' , '83474' , '25294' , '43269' , '77666' , '15488' , '99146' , '64441' , '43338' , '38736' , '62754' , '48556' , '86057' , '23090' , '38114' , '66061' , '18910' , '84385' , '23600' , '19975' , '27883' , '65719' , '19933' , '32085' , '49731' , '40473' , '27190' , '46192' , '23949' , '44738' , '12436' , '64794' , '68741' , '15333' , '24282' , '49085' , '31844' , '71156' , '48441' , '17100' , '98207' , '44982' , '20277' , '71496' , '96299' , '37583' , '22206' , '89174' , '30589' , '61924' , '53079' , '10976' , '13104' , '42794' , '54772' , '15809' , '56434' , '39975' , '13874' , '30753' , '77598' , '78229' , '59478' , '12345' , '55547' , '57422' , '42600' , '79444' , '29074' , '29752' , '21676' , '32096' , '43044' , '39383' , '37296' , '36295' , '63077' , '16572' , '31275' , '18701' , '40197' , '48242' , '27219' , '49865' , '84175' , '30446' , '25165' , '13807' , '72142' , '70499' , '70464' , '71429' , '18111' , '70857' , '29545' , '36425' , '52706' , '36194' , '42963' , '75068' , '47921' , '74763' , '90990' , '89456' , '62073' , '88397' , '73963' , '75885' , '62657' , '12530' , '81146' , '57434' , '25099' , '41429' , '98441' , '48713' , '52552' , '31667' , '14072' , '13903' , '44709' , '85429' , '58017' , '38295' , '44875' , '73541' , '30091' , '12707' , '23762' , '62258' , '33247' , '78722' , '77431' , '14510' , '35656' , '72428' , '92082' , '35267' , '43759' , '24354' , '90952' , '11512' , '21242' , '22579' , '56114' , '32339' , '52282' , '41791' , '24484' , '95020' , '28408' , '99710' , '11899' , '43344' , '72915' , '27644' , '62708' , '74479' , '17177' , '32619' , '12351' , '91339' , '31169' , '57081' , '53522' , '16712' , '34419' , '71779' , '44187' , '46206' , '96099' , '61910' , '53664' , '12295' , '31837' , '33096' , '10813' , '63048' , '31732' , '79118' , '73084' , '72783' , '84952' , '46965' , '77956' , '39815' , '32311' , '75329' , '48156' , '30826' , '49661' , '13736' , '92076' , '74865' , '88149' , '92397' , '52777' , '68453' , '32012' , '21222' , '52721' , '24626' , '18210' , '42177' , '91791' , '75251' , '82075' , '44372' , '45542' , '20609' , '60115' , '17362' , '22750' , '90434' , '31852' , '54071' , '33762' , '14705' , '40718' , '56433' , '30996' , '40657' , '49056' , '23585' , '66455' , '41021' , '74736' , '72151' , '37007' , '21729' , '60177' , '84558' , '59027' , '93855' , '60022' , '86443' , '19541' , '86886' , '30532' , '39062' , '48532' , '34713' , '52077' , '22564' , '64638' , '15273' , '31677' , '36138' , '62367' , '60261' , '80213' , '42818' , '25113' , '72378' , '69802' , '69096' , '55443' , '28820' , '13848' , '78258' , '37490' , '30556' , '77380' , '28447' , '44550' , '26791' , '70609' , '82182' , '33306' , '43224' , '22322' , '86959' , '68519' , '14308' , '46501' , '81131' , '34056' , '61991' , '19896' , '87804' , '65774' , '92564' )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '67436' , '26121' , '38443' , '63157' , '68856' , '19485' , '86425' , '26741' , '70991' , '60899' , '63573' , '47556' , '56193' , '93314' , '87827' , '62017' , '85067' , '95390' , '48091' , '10261' , '41790' , '81845' , '42853' , '24675' , '12840' , '60065' , '84430' , '57451' , '24021' , '91735' , '75335' , '71935' , '34482' , '56943' , '70695' , '52147' , '56251' , '28411' , '86653' , '23005' , '22478' , '29031' , '34398' , '15365' , '42460' , '33337' , '59433' , '73943' , '72477' , '74081' , '74430' , '64605' , '39006' , '11226' , '49057' , '97308' , '42663' , '18187' , '19768' , '43454' , '32147' , '76637' , '51975' , '11181' , '45630' , '33129' , '45995' , '64386' , '55522' , '26697' , '20963' , '35154' , '64587' , '49752' , '66386' , '30586' , '59286' , '13177' , '66646' , '84195' , '74316' , '36853' , '32927' , '12469' , '11904' , '36269' , '17724' , '55346' , '12595' , '53988' , '65439' , '28015' , '63268' , '73590' , '29216' , '82575' , '69267' , '13805' , '91678' , '79460' , '94152' , '14961' , '15419' , '48277' , '62588' , '55493' , '28360' , '14152' , '55225' , '18007' , '53705' , '56573' , '80245' , '71769' , '57348' , '36845' , '13039' , '17270' , '22363' , '83474' , '25294' , '43269' , '77666' , '15488' , '99146' , '64441' , '43338' , '38736' , '62754' , '48556' , '86057' , '23090' , '38114' , '66061' , '18910' , '84385' , '23600' , '19975' , '27883' , '65719' , '19933' , '32085' , '49731' , '40473' , '27190' , '46192' , '23949' , '44738' , '12436' , '64794' , '68741' , '15333' , '24282' , '49085' , '31844' , '71156' , '48441' , '17100' , '98207' , '44982' , '20277' , '71496' , '96299' , '37583' , '22206' , '89174' , '30589' , '61924' , '53079' , '10976' , '13104' , '42794' , '54772' , '15809' , '56434' , '39975' , '13874' , '30753' , '77598' , '78229' , '59478' , '12345' , '55547' , '57422' , '42600' , '79444' , '29074' , '29752' , '21676' , '32096' , '43044' , '39383' , '37296' , '36295' , '63077' , '16572' , '31275' , '18701' , '40197' , '48242' , '27219' , '49865' , '84175' , '30446' , '25165' , '13807' , '72142' , '70499' , '70464' , '71429' , '18111' , '70857' , '29545' , '36425' , '52706' , '36194' , '42963' , '75068' , '47921' , '74763' , '90990' , '89456' , '62073' , '88397' , '73963' , '75885' , '62657' , '12530' , '81146' , '57434' , '25099' , '41429' , '98441' , '48713' , '52552' , '31667' , '14072' , '13903' , '44709' , '85429' , '58017' , '38295' , '44875' , '73541' , '30091' , '12707' , '23762' , '62258' , '33247' , '78722' , '77431' , '14510' , '35656' , '72428' , '92082' , '35267' , '43759' , '24354' , '90952' , '11512' , '21242' , '22579' , '56114' , '32339' , '52282' , '41791' , '24484' , '95020' , '28408' , '99710' , '11899' , '43344' , '72915' , '27644' , '62708' , '74479' , '17177' , '32619' , '12351' , '91339' , '31169' , '57081' , '53522' , '16712' , '34419' , '71779' , '44187' , '46206' , '96099' , '61910' , '53664' , '12295' , '31837' , '33096' , '10813' , '63048' , '31732' , '79118' , '73084' , '72783' , '84952' , '46965' , '77956' , '39815' , '32311' , '75329' , '48156' , '30826' , '49661' , '13736' , '92076' , '74865' , '88149' , '92397' , '52777' , '68453' , '32012' , '21222' , '52721' , '24626' , '18210' , '42177' , '91791' , '75251' , '82075' , '44372' , '45542' , '20609' , '60115' , '17362' , '22750' , '90434' , '31852' , '54071' , '33762' , '14705' , '40718' , '56433' , '30996' , '40657' , '49056' , '23585' , '66455' , '41021' , '74736' , '72151' , '37007' , '21729' , '60177' , '84558' , '59027' , '93855' , '60022' , '86443' , '19541' , '86886' , '30532' , '39062' , '48532' , '34713' , '52077' , '22564' , '64638' , '15273' , '31677' , '36138' , '62367' , '60261' , '80213' , '42818' , '25113' , '72378' , '69802' , '69096' , '55443' , '28820' , '13848' , '78258' , '37490' , '30556' , '77380' , '28447' , '44550' , '26791' , '70609' , '82182' , '33306' , '43224' , '22322' , '86959' , '68519' , '14308' , '46501' , '81131' , '34056' , '61991' , '19896' , '87804' , '65774' , '92564' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.153929,
                    "execution_time": 0.07287,
                    "compile_time": 0.00028,
                    "planning_time": 0.046217,
                    "create_size": 160
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.796986,
                    "execution_time": 0.646889,
                    "compile_time": 0.003428,
                    "planning_time": 0.109459,
                    "create_size": 160
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   ca_zip\n0   46192\n1   70499\n2   46192\n3   60899\n4   46192\n5   72477\n6   31852\n7   46192\n8   72477\n9   46192\n10  72477\n11  46192\n12  31732\n13  26697\n14  72477\n15  72477\n16  46192\n17  72477\n18  72477\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015544,
                    "execution_time": 0.00701,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.002666
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.154734,
                    "execution_time": 0.007007,
                    "compile_time": 0.102684,
                    "planning_time": 0.038035
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('67436', '26121', '38443', '63157', '68856', '19485', '86425', '26741', '70991', '60899', '63573', '47556', '56193', '93314', '87827', '62017', '85067', '95390', '48091', '10261', '41790', '81845', '42853', '24675', '12840', '60065', '84430', '57451', '24021', '91735', '75335', '71935', '34482', '56943', '70695', '52147', '56251', '28411', '86653', '23005', '22478', '29031', '34398', '15365', '42460', '33337', '59433', '73943', '72477', '74081', '74430', '64605', '39006', '11226', '49057', '97308', '42663', '18187', '19768', '43454', '32147', '76637', '51975', '11181', '45630', '33129', '45995', '64386', '55522', '26697', '20963', '35154', '64587', '49752', '66386', '30586', '59286', '13177', '66646', '84195', '74316', '36853', '32927', '12469', '11904', '36269', '17724', '55346', '12595', '53988', '65439', '28015', '63268', '73590', '29216', '82575', '69267', '13805', '91678', '79460', '94152', '14961', '15419', '48277', '62588', '55493', '28360', '14152', '55225', '18007', '53705', '56573', '80245', '71769', '57348', '36845', '13039', '17270', '22363', '83474', '25294', '43269', '77666', '15488', '99146', '64441', '43338', '38736', '62754', '48556', '86057', '23090', '38114', '66061', '18910', '84385', '23600', '19975', '27883', '65719', '19933', '32085', '49731', '40473', '27190', '46192', '23949', '44738', '12436', '64794', '68741', '15333', '24282', '49085', '31844', '71156', '48441', '17100', '98207', '44982', '20277', '71496', '96299', '37583', '22206', '89174', '30589', '61924', '53079', '10976', '13104', '42794', '54772', '15809', '56434', '39975', '13874', '30753', '77598', '78229', '59478', '12345', '55547', '57422', '42600', '79444', '29074', '29752', '21676', '32096', '43044', '39383', '37296', '36295', '63077', '16572', '31275', '18701', '40197', '48242', '27219', '49865', '84175', '30446', '25165', '13807', '72142', '70499', '70464', '71429', '18111', '70857', '29545', '36425', '52706', '36194', '42963', '75068', '47921', '74763', '90990', '89456', '62073', '88397', '73963', '75885', '62657', '12530', '81146', '57434', '25099', '41429', '98441', '48713', '52552', '31667', '14072', '13903', '44709', '85429', '58017', '38295', '44875', '73541', '30091', '12707', '23762', '62258', '33247', '78722', '77431', '14510', '35656', '72428', '92082', '35267', '43759', '24354', '90952', '11512', '21242', '22579', '56114', '32339', '52282', '41791', '24484', '95020', '28408', '99710', '11899', '43344', '72915', '27644', '62708', '74479', '17177', '32619', '12351', '91339', '31169', '57081', '53522', '16712', '34419', '71779', '44187', '46206', '96099', '61910', '53664', '12295', '31837', '33096', '10813', '63048', '31732', '79118', '73084', '72783', '84952', '46965', '77956', '39815', '32311', '75329', '48156', '30826', '49661', '13736', '92076', '74865', '88149', '92397', '52777', '68453', '32012', '21222', '52721', '24626', '18210', '42177', '91791', '75251', '82075', '44372', '45542', '20609', '60115', '17362', '22750', '90434', '31852', '54071', '33762', '14705', '40718', '56433', '30996', '40657', '49056', '23585', '66455', '41021', '74736', '72151', '37007', '21729', '60177', '84558', '59027', '93855', '60022', '86443', '19541', '86886', '30532', '39062', '48532', '34713', '52077', '22564', '64638', '15273', '31677', '36138', '62367', '60261', '80213', '42818', '25113', '72378', '69802', '69096', '55443', '28820', '13848', '78258', '37490', '30556', '77380', '28447', '44550', '26791', '70609', '82182', '33306', '43224', '22322', '86959', '68519', '14308', '46501', '81131', '34056', '61991', '19896', '87804', '65774', '92564')",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   ca_zip\n0   46192\n1   70499\n2   46192\n3   60899\n4   46192\n5   72477\n6   31852\n7   46192\n8   72477\n9   46192\n10  72477\n11  46192\n12  31732\n13  26697\n14  72477\n15  72477\n16  46192\n17  72477\n18  72477\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "SELECT Substring(ca_zip, 1, 5) AS ca_zip, \n               Count(*) AS cnt \nFROM   customer_address \nWHERE  ca_address_sk IN (SELECT c_current_addr_sk \n                          FROM   customer \n                          WHERE  c_preferred_cust_flag = 'Y')\nGROUP BY Substring(ca_zip, 1, 5) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" AS \"C_CURRENT_ADDR_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' GROUP BY \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" ) SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" AS \"C_CURRENT_ADDR_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' GROUP BY \"CUSTOMER\".\"C_CURRENT_ADDR_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.395361,
                    "execution_time": 0.298573,
                    "compile_time": 0.00031,
                    "planning_time": 0.024243,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.659293,
                    "execution_time": 0.34576,
                    "compile_time": 0.152532,
                    "planning_time": 0.084772,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.203256,
                    "execution_time": 0.144197,
                    "compile_time": 0.000366,
                    "planning_time": 0.025762,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.481395,
                    "execution_time": 0.149774,
                    "compile_time": 0.207355,
                    "planning_time": 0.086591,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   ca_zip   cnt\n0   79391  4506\n1   91904  1575\n2   88222  2140\n3   53360   253\n4   33511  3868\n5   80587  2164\n6   10169  1290\n7   49193   209\n8   86115   110\n9   22324   176\n10  83683  2244\n11  31204   182\n12  74212   223\n13  80534  2225\n14  04627    41\n15  08809    48\n16  84092   109\n17  06166    46\n18  27317   182\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016746,
                    "execution_time": 0.007786,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.00312
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.144921,
                    "execution_time": 0.007735,
                    "compile_time": 0.091984,
                    "planning_time": 0.038016
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   ca_zip   cnt\n0   79391  4506\n1   91904  1575\n2   88222  2140\n3   53360   253\n4   33511  3868\n5   80587  2164\n6   10169  1290\n7   49193   209\n8   86115   110\n9   22324   176\n10  83683  2244\n11  31204   182\n12  74212   223\n13  80534  2225\n14  04627    41\n15  08809    48\n16  84092   109\n17  06166    46\n18  27317   182\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- query8.tpl \nSELECT s_store_name, \n               Sum(ss_net_profit) \nFROM   store_sales, \n       date_dim, \n       store, \n       (SELECT ca_zip \n        FROM   (SELECT Substring(ca_zip, 1, 5) ca_zip \n                FROM   customer_address \n                WHERE  Substring(ca_zip, 1, 5) IN ( '67436', '26121', '38443', \n                                                 '63157', \n                                                 '68856', '19485', '86425', \n                                                 '26741', \n                                                 '70991', '60899', '63573', \n                                                 '47556', \n                                                 '56193', '93314', '87827', \n                                                 '62017', \n                                                 '85067', '95390', '48091', \n                                                 '10261', \n                                                 '41790', '81845', '42853', \n                                                 '24675', \n                                                 '12840', '60065', '84430', \n                                                 '57451', \n                                                 '24021', '91735', '75335', \n                                                 '71935', \n                                                 '34482', '56943', '70695', \n                                                 '52147', \n                                                 '56251', '28411', '86653', \n                                                 '23005', \n                                                 '22478', '29031', '34398', \n                                                 '15365', \n                                                 '42460', '33337', '59433', \n                                                 '73943', \n                                                 '72477', '74081', '74430', \n                                                 '64605', \n                                                 '39006', '11226', '49057', \n                                                 '97308', \n                                                 '42663', '18187', '19768', \n                                                 '43454', \n                                                 '32147', '76637', '51975', \n                                                 '11181', \n                                                 '45630', '33129', '45995', \n                                                 '64386', \n                                                 '55522', '26697', '20963', \n                                                 '35154', \n                                                 '64587', '49752', '66386', \n                                                 '30586', \n                                                 '59286', '13177', '66646', \n                                                 '84195', \n                                                 '74316', '36853', '32927', \n                                                 '12469', \n                                                 '11904', '36269', '17724', \n                                                 '55346', \n                                                 '12595', '53988', '65439', \n                                                 '28015', \n                                                 '63268', '73590', '29216', \n                                                 '82575', \n                                                 '69267', '13805', '91678', \n                                                 '79460', \n                                                 '94152', '14961', '15419', \n                                                 '48277', \n                                                 '62588', '55493', '28360', \n                                                 '14152', \n                                                 '55225', '18007', '53705', \n                                                 '56573', \n                                                 '80245', '71769', '57348', \n                                                 '36845', \n                                                 '13039', '17270', '22363', \n                                                 '83474', \n                                                 '25294', '43269', '77666', \n                                                 '15488', \n                                                 '99146', '64441', '43338', \n                                                 '38736', \n                                                 '62754', '48556', '86057', \n                                                 '23090', \n                                                 '38114', '66061', '18910', \n                                                 '84385', \n                                                 '23600', '19975', '27883', \n                                                 '65719', \n                                                 '19933', '32085', '49731', \n                                                 '40473', \n                                                 '27190', '46192', '23949', \n                                                 '44738', \n                                                 '12436', '64794', '68741', \n                                                 '15333', \n                                                 '24282', '49085', '31844', \n                                                 '71156', \n                                                 '48441', '17100', '98207', \n                                                 '44982', \n                                                 '20277', '71496', '96299', \n                                                 '37583', \n                                                 '22206', '89174', '30589', \n                                                 '61924', \n                                                 '53079', '10976', '13104', \n                                                 '42794', \n                                                 '54772', '15809', '56434', \n                                                 '39975', \n                                                 '13874', '30753', '77598', \n                                                 '78229', \n                                                 '59478', '12345', '55547', \n                                                 '57422', \n                                                 '42600', '79444', '29074', \n                                                 '29752', \n                                                 '21676', '32096', '43044', \n                                                 '39383', \n                                                 '37296', '36295', '63077', \n                                                 '16572', \n                                                 '31275', '18701', '40197', \n                                                 '48242', \n                                                 '27219', '49865', '84175', \n                                                 '30446', \n                                                 '25165', '13807', '72142', \n                                                 '70499', \n                                                 '70464', '71429', '18111', \n                                                 '70857', \n                                                 '29545', '36425', '52706', \n                                                 '36194', \n                                                 '42963', '75068', '47921', \n                                                 '74763', \n                                                 '90990', '89456', '62073', \n                                                 '88397', \n                                                 '73963', '75885', '62657', \n                                                 '12530', \n                                                 '81146', '57434', '25099', \n                                                 '41429', \n                                                 '98441', '48713', '52552', \n                                                 '31667', \n                                                 '14072', '13903', '44709', \n                                                 '85429', \n                                                 '58017', '38295', '44875', \n                                                 '73541', \n                                                 '30091', '12707', '23762', \n                                                 '62258', \n                                                 '33247', '78722', '77431', \n                                                 '14510', \n                                                 '35656', '72428', '92082', \n                                                 '35267', \n                                                 '43759', '24354', '90952', \n                                                 '11512', \n                                                 '21242', '22579', '56114', \n                                                 '32339', \n                                                 '52282', '41791', '24484', \n                                                 '95020', \n                                                 '28408', '99710', '11899', \n                                                 '43344', \n                                                 '72915', '27644', '62708', \n                                                 '74479', \n                                                 '17177', '32619', '12351', \n                                                 '91339', \n                                                 '31169', '57081', '53522', \n                                                 '16712', \n                                                 '34419', '71779', '44187', \n                                                 '46206', \n                                                 '96099', '61910', '53664', \n                                                 '12295', \n                                                 '31837', '33096', '10813', \n                                                 '63048', \n                                                 '31732', '79118', '73084', \n                                                 '72783', \n                                                 '84952', '46965', '77956', \n                                                 '39815', \n                                                 '32311', '75329', '48156', \n                                                 '30826', \n                                                 '49661', '13736', '92076', \n                                                 '74865', \n                                                 '88149', '92397', '52777', \n                                                 '68453', \n                                                 '32012', '21222', '52721', \n                                                 '24626', \n                                                 '18210', '42177', '91791', \n                                                 '75251', \n                                                 '82075', '44372', '45542', \n                                                 '20609', \n                                                 '60115', '17362', '22750', \n                                                 '90434', \n                                                 '31852', '54071', '33762', \n                                                 '14705', \n                                                 '40718', '56433', '30996', \n                                                 '40657', \n                                                 '49056', '23585', '66455', \n                                                 '41021', \n                                                 '74736', '72151', '37007', \n                                                 '21729', \n                                                 '60177', '84558', '59027', \n                                                 '93855', \n                                                 '60022', '86443', '19541', \n                                                 '86886', \n                                                 '30532', '39062', '48532', \n                                                 '34713', \n                                                 '52077', '22564', '64638', \n                                                 '15273', \n                                                 '31677', '36138', '62367', \n                                                 '60261', \n                                                 '80213', '42818', '25113', \n                                                 '72378', \n                                                 '69802', '69096', '55443', \n                                                 '28820', \n                                                 '13848', '78258', '37490', \n                                                 '30556', \n                                                 '77380', '28447', '44550', \n                                                 '26791', \n                                                 '70609', '82182', '33306', \n                                                 '43224', \n                                                 '22322', '86959', '68519', \n                                                 '14308', \n                                                 '46501', '81131', '34056', \n                                                 '61991', \n                                                 '19896', '87804', '65774', \n                                                 '92564' ) \n                INTERSECT \n                SELECT ca_zip \n                FROM   (SELECT Substring(ca_zip, 1, 5) ca_zip, \n                               Count(*)             cnt \n                        FROM   customer_address, \n                               customer \n                        WHERE  ca_address_sk = c_current_addr_sk \n                               AND c_preferred_cust_flag = 'Y' \n                        GROUP  BY ca_zip \n                        HAVING Count(*) > 10)A1)A2) V1 \nWHERE  ss_store_sk = s_store_sk \n       AND ss_sold_date_sk = d_date_sk \n       AND d_qoy = 2 \n       AND d_year = 2000 \n       AND ( Substring(s_zip, 1, 2) = Substring(V1.ca_zip, 1, 2) ) \nGROUP  BY s_store_name \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"A1\" AS ( SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" HAVING COUNT ( * ) > 10 ) , \"A2\" AS ( SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '67436' , '26121' , '38443' , '63157' , '68856' , '19485' , '86425' , '26741' , '70991' , '60899' , '63573' , '47556' , '56193' , '93314' , '87827' , '62017' , '85067' , '95390' , '48091' , '10261' , '41790' , '81845' , '42853' , '24675' , '12840' , '60065' , '84430' , '57451' , '24021' , '91735' , '75335' , '71935' , '34482' , '56943' , '70695' , '52147' , '56251' , '28411' , '86653' , '23005' , '22478' , '29031' , '34398' , '15365' , '42460' , '33337' , '59433' , '73943' , '72477' , '74081' , '74430' , '64605' , '39006' , '11226' , '49057' , '97308' , '42663' , '18187' , '19768' , '43454' , '32147' , '76637' , '51975' , '11181' , '45630' , '33129' , '45995' , '64386' , '55522' , '26697' , '20963' , '35154' , '64587' , '49752' , '66386' , '30586' , '59286' , '13177' , '66646' , '84195' , '74316' , '36853' , '32927' , '12469' , '11904' , '36269' , '17724' , '55346' , '12595' , '53988' , '65439' , '28015' , '63268' , '73590' , '29216' , '82575' , '69267' , '13805' , '91678' , '79460' , '94152' , '14961' , '15419' , '48277' , '62588' , '55493' , '28360' , '14152' , '55225' , '18007' , '53705' , '56573' , '80245' , '71769' , '57348' , '36845' , '13039' , '17270' , '22363' , '83474' , '25294' , '43269' , '77666' , '15488' , '99146' , '64441' , '43338' , '38736' , '62754' , '48556' , '86057' , '23090' , '38114' , '66061' , '18910' , '84385' , '23600' , '19975' , '27883' , '65719' , '19933' , '32085' , '49731' , '40473' , '27190' , '46192' , '23949' , '44738' , '12436' , '64794' , '68741' , '15333' , '24282' , '49085' , '31844' , '71156' , '48441' , '17100' , '98207' , '44982' , '20277' , '71496' , '96299' , '37583' , '22206' , '89174' , '30589' , '61924' , '53079' , '10976' , '13104' , '42794' , '54772' , '15809' , '56434' , '39975' , '13874' , '30753' , '77598' , '78229' , '59478' , '12345' , '55547' , '57422' , '42600' , '79444' , '29074' , '29752' , '21676' , '32096' , '43044' , '39383' , '37296' , '36295' , '63077' , '16572' , '31275' , '18701' , '40197' , '48242' , '27219' , '49865' , '84175' , '30446' , '25165' , '13807' , '72142' , '70499' , '70464' , '71429' , '18111' , '70857' , '29545' , '36425' , '52706' , '36194' , '42963' , '75068' , '47921' , '74763' , '90990' , '89456' , '62073' , '88397' , '73963' , '75885' , '62657' , '12530' , '81146' , '57434' , '25099' , '41429' , '98441' , '48713' , '52552' , '31667' , '14072' , '13903' , '44709' , '85429' , '58017' , '38295' , '44875' , '73541' , '30091' , '12707' , '23762' , '62258' , '33247' , '78722' , '77431' , '14510' , '35656' , '72428' , '92082' , '35267' , '43759' , '24354' , '90952' , '11512' , '21242' , '22579' , '56114' , '32339' , '52282' , '41791' , '24484' , '95020' , '28408' , '99710' , '11899' , '43344' , '72915' , '27644' , '62708' , '74479' , '17177' , '32619' , '12351' , '91339' , '31169' , '57081' , '53522' , '16712' , '34419' , '71779' , '44187' , '46206' , '96099' , '61910' , '53664' , '12295' , '31837' , '33096' , '10813' , '63048' , '31732' , '79118' , '73084' , '72783' , '84952' , '46965' , '77956' , '39815' , '32311' , '75329' , '48156' , '30826' , '49661' , '13736' , '92076' , '74865' , '88149' , '92397' , '52777' , '68453' , '32012' , '21222' , '52721' , '24626' , '18210' , '42177' , '91791' , '75251' , '82075' , '44372' , '45542' , '20609' , '60115' , '17362' , '22750' , '90434' , '31852' , '54071' , '33762' , '14705' , '40718' , '56433' , '30996' , '40657' , '49056' , '23585' , '66455' , '41021' , '74736' , '72151' , '37007' , '21729' , '60177' , '84558' , '59027' , '93855' , '60022' , '86443' , '19541' , '86886' , '30532' , '39062' , '48532' , '34713' , '52077' , '22564' , '64638' , '15273' , '31677' , '36138' , '62367' , '60261' , '80213' , '42818' , '25113' , '72378' , '69802' , '69096' , '55443' , '28820' , '13848' , '78258' , '37490' , '30556' , '77380' , '28447' , '44550' , '26791' , '70609' , '82182' , '33306' , '43224' , '22322' , '86959' , '68519' , '14308' , '46501' , '81131' , '34056' , '61991' , '19896' , '87804' , '65774' , '92564' ) INTERSECT SELECT \"A1\".\"CA_ZIP\" AS \"CA_ZIP\" FROM \"A1\" AS \"A1\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"A2\" AS \"A2\" ON SUBSTRING ( \"A2\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" HAVING COUNT ( * ) > 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.245092,
                    "execution_time": 0.181516,
                    "compile_time": 0.000374,
                    "planning_time": 0.031795,
                    "create_size": 32
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.571323,
                    "execution_time": 0.187748,
                    "compile_time": 0.244701,
                    "planning_time": 0.104795,
                    "create_size": 32
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '67436' , '26121' , '38443' , '63157' , '68856' , '19485' , '86425' , '26741' , '70991' , '60899' , '63573' , '47556' , '56193' , '93314' , '87827' , '62017' , '85067' , '95390' , '48091' , '10261' , '41790' , '81845' , '42853' , '24675' , '12840' , '60065' , '84430' , '57451' , '24021' , '91735' , '75335' , '71935' , '34482' , '56943' , '70695' , '52147' , '56251' , '28411' , '86653' , '23005' , '22478' , '29031' , '34398' , '15365' , '42460' , '33337' , '59433' , '73943' , '72477' , '74081' , '74430' , '64605' , '39006' , '11226' , '49057' , '97308' , '42663' , '18187' , '19768' , '43454' , '32147' , '76637' , '51975' , '11181' , '45630' , '33129' , '45995' , '64386' , '55522' , '26697' , '20963' , '35154' , '64587' , '49752' , '66386' , '30586' , '59286' , '13177' , '66646' , '84195' , '74316' , '36853' , '32927' , '12469' , '11904' , '36269' , '17724' , '55346' , '12595' , '53988' , '65439' , '28015' , '63268' , '73590' , '29216' , '82575' , '69267' , '13805' , '91678' , '79460' , '94152' , '14961' , '15419' , '48277' , '62588' , '55493' , '28360' , '14152' , '55225' , '18007' , '53705' , '56573' , '80245' , '71769' , '57348' , '36845' , '13039' , '17270' , '22363' , '83474' , '25294' , '43269' , '77666' , '15488' , '99146' , '64441' , '43338' , '38736' , '62754' , '48556' , '86057' , '23090' , '38114' , '66061' , '18910' , '84385' , '23600' , '19975' , '27883' , '65719' , '19933' , '32085' , '49731' , '40473' , '27190' , '46192' , '23949' , '44738' , '12436' , '64794' , '68741' , '15333' , '24282' , '49085' , '31844' , '71156' , '48441' , '17100' , '98207' , '44982' , '20277' , '71496' , '96299' , '37583' , '22206' , '89174' , '30589' , '61924' , '53079' , '10976' , '13104' , '42794' , '54772' , '15809' , '56434' , '39975' , '13874' , '30753' , '77598' , '78229' , '59478' , '12345' , '55547' , '57422' , '42600' , '79444' , '29074' , '29752' , '21676' , '32096' , '43044' , '39383' , '37296' , '36295' , '63077' , '16572' , '31275' , '18701' , '40197' , '48242' , '27219' , '49865' , '84175' , '30446' , '25165' , '13807' , '72142' , '70499' , '70464' , '71429' , '18111' , '70857' , '29545' , '36425' , '52706' , '36194' , '42963' , '75068' , '47921' , '74763' , '90990' , '89456' , '62073' , '88397' , '73963' , '75885' , '62657' , '12530' , '81146' , '57434' , '25099' , '41429' , '98441' , '48713' , '52552' , '31667' , '14072' , '13903' , '44709' , '85429' , '58017' , '38295' , '44875' , '73541' , '30091' , '12707' , '23762' , '62258' , '33247' , '78722' , '77431' , '14510' , '35656' , '72428' , '92082' , '35267' , '43759' , '24354' , '90952' , '11512' , '21242' , '22579' , '56114' , '32339' , '52282' , '41791' , '24484' , '95020' , '28408' , '99710' , '11899' , '43344' , '72915' , '27644' , '62708' , '74479' , '17177' , '32619' , '12351' , '91339' , '31169' , '57081' , '53522' , '16712' , '34419' , '71779' , '44187' , '46206' , '96099' , '61910' , '53664' , '12295' , '31837' , '33096' , '10813' , '63048' , '31732' , '79118' , '73084' , '72783' , '84952' , '46965' , '77956' , '39815' , '32311' , '75329' , '48156' , '30826' , '49661' , '13736' , '92076' , '74865' , '88149' , '92397' , '52777' , '68453' , '32012' , '21222' , '52721' , '24626' , '18210' , '42177' , '91791' , '75251' , '82075' , '44372' , '45542' , '20609' , '60115' , '17362' , '22750' , '90434' , '31852' , '54071' , '33762' , '14705' , '40718' , '56433' , '30996' , '40657' , '49056' , '23585' , '66455' , '41021' , '74736' , '72151' , '37007' , '21729' , '60177' , '84558' , '59027' , '93855' , '60022' , '86443' , '19541' , '86886' , '30532' , '39062' , '48532' , '34713' , '52077' , '22564' , '64638' , '15273' , '31677' , '36138' , '62367' , '60261' , '80213' , '42818' , '25113' , '72378' , '69802' , '69096' , '55443' , '28820' , '13848' , '78258' , '37490' , '30556' , '77380' , '28447' , '44550' , '26791' , '70609' , '82182' , '33306' , '43224' , '22322' , '86959' , '68519' , '14308' , '46501' , '81131' , '34056' , '61991' , '19896' , '87804' , '65774' , '92564' ) INTERSECT SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.162557,
                    "execution_time": 0.081006,
                    "compile_time": 0.000392,
                    "planning_time": 0.047765,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.33947,
                    "execution_time": 0.080906,
                    "compile_time": 0.111753,
                    "planning_time": 0.113279,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.514498,
                    "execution_time": 0.437133,
                    "compile_time": 0.000435,
                    "planning_time": 0.044568,
                    "create_size": 50
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.050238,
                    "execution_time": 1.884731,
                    "compile_time": 0.007814,
                    "planning_time": 0.12308,
                    "create_size": 50
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   s_store_name        _col_1\n0           pri -6.316715e+08\n1           bar -1.908652e+09\n2         ought -3.793124e+08\n3               -1.275468e+08\n4          n st -1.129956e+09\n5          eing -1.265124e+09\n6          anti -7.594911e+08\n7         ation -1.008633e+09\n8           ese -1.512643e+09\n9         cally -2.021464e+09\n10         able -1.532325e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016303,
                    "execution_time": 0.007055,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003245
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053602,
                    "execution_time": 0.007245,
                    "compile_time": 0.001012,
                    "planning_time": 0.038179
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   s_store_name        _col_1\n0           pri -6.316715e+08\n1           bar -1.908652e+09\n2         ought -3.793124e+08\n3               -1.275468e+08\n4          n st -1.129956e+09\n5          eing -1.265124e+09\n6          anti -7.594911e+08\n7         ation -1.008633e+09\n8           ese -1.512643e+09\n9         cally -2.021464e+09\n10         able -1.532325e+09*/"
    },
    {
        "input": "-- query8.tpl \nSELECT s_store_name, \n               Sum(ss_net_profit) \nFROM   store_sales, \n       date_dim, \n       store, \n       (SELECT ca_zip \n        FROM   (SELECT Substring(ca_zip, 1, 5) ca_zip \n                FROM   customer_address \n                WHERE  Substring(ca_zip, 1, 5) IN ( '67436', '26121', '38443', \n                                                 '63157', \n                                                 '68856', '19485', '86425', \n                                                 '26741', \n                                                 '70991', '60899', '63573', \n                                                 '47556', \n                                                 '56193', '93314', '87827', \n                                                 '62017', \n                                                 '85067', '95390', '48091', \n                                                 '10261', \n                                                 '41790', '81845', '42853', \n                                                 '24675', \n                                                 '12840', '60065', '84430', \n                                                 '57451', \n                                                 '24021', '91735', '75335', \n                                                 '71935', \n                                                 '34482', '56943', '70695', \n                                                 '52147', \n                                                 '56251', '28411', '86653', \n                                                 '23005', \n                                                 '22478', '29031', '34398', \n                                                 '15365', \n                                                 '42460', '33337', '59433', \n                                                 '73943', \n                                                 '72477', '74081', '74430', \n                                                 '64605', \n                                                 '39006', '11226', '49057', \n                                                 '97308', \n                                                 '42663', '18187', '19768', \n                                                 '43454', \n                                                 '32147', '76637', '51975', \n                                                 '11181', \n                                                 '45630', '33129', '45995', \n                                                 '64386', \n                                                 '55522', '26697', '20963', \n                                                 '35154', \n                                                 '64587', '49752', '66386', \n                                                 '30586', \n                                                 '59286', '13177', '66646', \n                                                 '84195', \n                                                 '74316', '36853', '32927', \n                                                 '12469', \n                                                 '11904', '36269', '17724', \n                                                 '55346', \n                                                 '12595', '53988', '65439', \n                                                 '28015', \n                                                 '63268', '73590', '29216', \n                                                 '82575', \n                                                 '69267', '13805', '91678', \n                                                 '79460', \n                                                 '94152', '14961', '15419', \n                                                 '48277', \n                                                 '62588', '55493', '28360', \n                                                 '14152', \n                                                 '55225', '18007', '53705', \n                                                 '56573', \n                                                 '80245', '71769', '57348', \n                                                 '36845', \n                                                 '13039', '17270', '22363', \n                                                 '83474', \n                                                 '25294', '43269', '77666', \n                                                 '15488', \n                                                 '99146', '64441', '43338', \n                                                 '38736', \n                                                 '62754', '48556', '86057', \n                                                 '23090', \n                                                 '38114', '66061', '18910', \n                                                 '84385', \n                                                 '23600', '19975', '27883', \n                                                 '65719', \n                                                 '19933', '32085', '49731', \n                                                 '40473', \n                                                 '27190', '46192', '23949', \n                                                 '44738', \n                                                 '12436', '64794', '68741', \n                                                 '15333', \n                                                 '24282', '49085', '31844', \n                                                 '71156', \n                                                 '48441', '17100', '98207', \n                                                 '44982', \n                                                 '20277', '71496', '96299', \n                                                 '37583', \n                                                 '22206', '89174', '30589', \n                                                 '61924', \n                                                 '53079', '10976', '13104', \n                                                 '42794', \n                                                 '54772', '15809', '56434', \n                                                 '39975', \n                                                 '13874', '30753', '77598', \n                                                 '78229', \n                                                 '59478', '12345', '55547', \n                                                 '57422', \n                                                 '42600', '79444', '29074', \n                                                 '29752', \n                                                 '21676', '32096', '43044', \n                                                 '39383', \n                                                 '37296', '36295', '63077', \n                                                 '16572', \n                                                 '31275', '18701', '40197', \n                                                 '48242', \n                                                 '27219', '49865', '84175', \n                                                 '30446', \n                                                 '25165', '13807', '72142', \n                                                 '70499', \n                                                 '70464', '71429', '18111', \n                                                 '70857', \n                                                 '29545', '36425', '52706', \n                                                 '36194', \n                                                 '42963', '75068', '47921', \n                                                 '74763', \n                                                 '90990', '89456', '62073', \n                                                 '88397', \n                                                 '73963', '75885', '62657', \n                                                 '12530', \n                                                 '81146', '57434', '25099', \n                                                 '41429', \n                                                 '98441', '48713', '52552', \n                                                 '31667', \n                                                 '14072', '13903', '44709', \n                                                 '85429', \n                                                 '58017', '38295', '44875', \n                                                 '73541', \n                                                 '30091', '12707', '23762', \n                                                 '62258', \n                                                 '33247', '78722', '77431', \n                                                 '14510', \n                                                 '35656', '72428', '92082', \n                                                 '35267', \n                                                 '43759', '24354', '90952', \n                                                 '11512', \n                                                 '21242', '22579', '56114', \n                                                 '32339', \n                                                 '52282', '41791', '24484', \n                                                 '95020', \n                                                 '28408', '99710', '11899', \n                                                 '43344', \n                                                 '72915', '27644', '62708', \n                                                 '74479', \n                                                 '17177', '32619', '12351', \n                                                 '91339', \n                                                 '31169', '57081', '53522', \n                                                 '16712', \n                                                 '34419', '71779', '44187', \n                                                 '46206', \n                                                 '96099', '61910', '53664', \n                                                 '12295', \n                                                 '31837', '33096', '10813', \n                                                 '63048', \n                                                 '31732', '79118', '73084', \n                                                 '72783', \n                                                 '84952', '46965', '77956', \n                                                 '39815', \n                                                 '32311', '75329', '48156', \n                                                 '30826', \n                                                 '49661', '13736', '92076', \n                                                 '74865', \n                                                 '88149', '92397', '52777', \n                                                 '68453', \n                                                 '32012', '21222', '52721', \n                                                 '24626', \n                                                 '18210', '42177', '91791', \n                                                 '75251', \n                                                 '82075', '44372', '45542', \n                                                 '20609', \n                                                 '60115', '17362', '22750', \n                                                 '90434', \n                                                 '31852', '54071', '33762', \n                                                 '14705', \n                                                 '40718', '56433', '30996', \n                                                 '40657', \n                                                 '49056', '23585', '66455', \n                                                 '41021', \n                                                 '74736', '72151', '37007', \n                                                 '21729', \n                                                 '60177', '84558', '59027', \n                                                 '93855', \n                                                 '60022', '86443', '19541', \n                                                 '86886', \n                                                 '30532', '39062', '48532', \n                                                 '34713', \n                                                 '52077', '22564', '64638', \n                                                 '15273', \n                                                 '31677', '36138', '62367', \n                                                 '60261', \n                                                 '80213', '42818', '25113', \n                                                 '72378', \n                                                 '69802', '69096', '55443', \n                                                 '28820', \n                                                 '13848', '78258', '37490', \n                                                 '30556', \n                                                 '77380', '28447', '44550', \n                                                 '26791', \n                                                 '70609', '82182', '33306', \n                                                 '43224', \n                                                 '22322', '86959', '68519', \n                                                 '14308', \n                                                 '46501', '81131', '34056', \n                                                 '61991', \n                                                 '19896', '87804', '65774', \n                                                 '92564' ) \n                INTERSECT \n                SELECT ca_zip \n                FROM   (SELECT Substring(ca_zip, 1, 5) ca_zip, \n                               Count(*)             cnt \n                        FROM   customer_address, \n                               customer \n                        WHERE  ca_address_sk = c_current_addr_sk \n                               AND c_preferred_cust_flag = 'Y' \n                        GROUP  BY ca_zip \n                        HAVING Count(*) > 10)A1)A2) V1 \nWHERE  ss_store_sk = s_store_sk \n       AND ss_sold_date_sk = d_date_sk \n       AND d_qoy = 2 \n       AND d_year = 2000 \n       AND ( Substring(s_zip, 1, 2) = Substring(V1.ca_zip, 1, 2) ) \nGROUP  BY s_store_name \nORDER  BY s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"A1\" AS ( SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" HAVING COUNT ( * ) > 10 ) , \"A2\" AS ( SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '67436' , '26121' , '38443' , '63157' , '68856' , '19485' , '86425' , '26741' , '70991' , '60899' , '63573' , '47556' , '56193' , '93314' , '87827' , '62017' , '85067' , '95390' , '48091' , '10261' , '41790' , '81845' , '42853' , '24675' , '12840' , '60065' , '84430' , '57451' , '24021' , '91735' , '75335' , '71935' , '34482' , '56943' , '70695' , '52147' , '56251' , '28411' , '86653' , '23005' , '22478' , '29031' , '34398' , '15365' , '42460' , '33337' , '59433' , '73943' , '72477' , '74081' , '74430' , '64605' , '39006' , '11226' , '49057' , '97308' , '42663' , '18187' , '19768' , '43454' , '32147' , '76637' , '51975' , '11181' , '45630' , '33129' , '45995' , '64386' , '55522' , '26697' , '20963' , '35154' , '64587' , '49752' , '66386' , '30586' , '59286' , '13177' , '66646' , '84195' , '74316' , '36853' , '32927' , '12469' , '11904' , '36269' , '17724' , '55346' , '12595' , '53988' , '65439' , '28015' , '63268' , '73590' , '29216' , '82575' , '69267' , '13805' , '91678' , '79460' , '94152' , '14961' , '15419' , '48277' , '62588' , '55493' , '28360' , '14152' , '55225' , '18007' , '53705' , '56573' , '80245' , '71769' , '57348' , '36845' , '13039' , '17270' , '22363' , '83474' , '25294' , '43269' , '77666' , '15488' , '99146' , '64441' , '43338' , '38736' , '62754' , '48556' , '86057' , '23090' , '38114' , '66061' , '18910' , '84385' , '23600' , '19975' , '27883' , '65719' , '19933' , '32085' , '49731' , '40473' , '27190' , '46192' , '23949' , '44738' , '12436' , '64794' , '68741' , '15333' , '24282' , '49085' , '31844' , '71156' , '48441' , '17100' , '98207' , '44982' , '20277' , '71496' , '96299' , '37583' , '22206' , '89174' , '30589' , '61924' , '53079' , '10976' , '13104' , '42794' , '54772' , '15809' , '56434' , '39975' , '13874' , '30753' , '77598' , '78229' , '59478' , '12345' , '55547' , '57422' , '42600' , '79444' , '29074' , '29752' , '21676' , '32096' , '43044' , '39383' , '37296' , '36295' , '63077' , '16572' , '31275' , '18701' , '40197' , '48242' , '27219' , '49865' , '84175' , '30446' , '25165' , '13807' , '72142' , '70499' , '70464' , '71429' , '18111' , '70857' , '29545' , '36425' , '52706' , '36194' , '42963' , '75068' , '47921' , '74763' , '90990' , '89456' , '62073' , '88397' , '73963' , '75885' , '62657' , '12530' , '81146' , '57434' , '25099' , '41429' , '98441' , '48713' , '52552' , '31667' , '14072' , '13903' , '44709' , '85429' , '58017' , '38295' , '44875' , '73541' , '30091' , '12707' , '23762' , '62258' , '33247' , '78722' , '77431' , '14510' , '35656' , '72428' , '92082' , '35267' , '43759' , '24354' , '90952' , '11512' , '21242' , '22579' , '56114' , '32339' , '52282' , '41791' , '24484' , '95020' , '28408' , '99710' , '11899' , '43344' , '72915' , '27644' , '62708' , '74479' , '17177' , '32619' , '12351' , '91339' , '31169' , '57081' , '53522' , '16712' , '34419' , '71779' , '44187' , '46206' , '96099' , '61910' , '53664' , '12295' , '31837' , '33096' , '10813' , '63048' , '31732' , '79118' , '73084' , '72783' , '84952' , '46965' , '77956' , '39815' , '32311' , '75329' , '48156' , '30826' , '49661' , '13736' , '92076' , '74865' , '88149' , '92397' , '52777' , '68453' , '32012' , '21222' , '52721' , '24626' , '18210' , '42177' , '91791' , '75251' , '82075' , '44372' , '45542' , '20609' , '60115' , '17362' , '22750' , '90434' , '31852' , '54071' , '33762' , '14705' , '40718' , '56433' , '30996' , '40657' , '49056' , '23585' , '66455' , '41021' , '74736' , '72151' , '37007' , '21729' , '60177' , '84558' , '59027' , '93855' , '60022' , '86443' , '19541' , '86886' , '30532' , '39062' , '48532' , '34713' , '52077' , '22564' , '64638' , '15273' , '31677' , '36138' , '62367' , '60261' , '80213' , '42818' , '25113' , '72378' , '69802' , '69096' , '55443' , '28820' , '13848' , '78258' , '37490' , '30556' , '77380' , '28447' , '44550' , '26791' , '70609' , '82182' , '33306' , '43224' , '22322' , '86959' , '68519' , '14308' , '46501' , '81131' , '34056' , '61991' , '19896' , '87804' , '65774' , '92564' ) INTERSECT SELECT \"A1\".\"CA_ZIP\" AS \"CA_ZIP\" FROM \"A1\" AS \"A1\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"A2\" AS \"A2\" ON SUBSTRING ( \"A2\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name        _col_1\n0               -1.275468e+08\n1          able -1.532325e+09\n2          anti -7.594911e+08\n3         ation -1.008633e+09\n4           bar -1.908652e+09\n5         cally -2.021464e+09\n6          eing -1.265124e+09\n7           ese -1.512643e+09\n8          n st -1.129956e+09\n9         ought -3.793124e+08\n10          pri -6.316715e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01732,
                    "execution_time": 0.008002,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003375
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054917,
                    "execution_time": 0.008378,
                    "compile_time": 0.00191,
                    "planning_time": 0.038187
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\" ORDER BY \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name        _col_1\n0               -1.275468e+08\n1          able -1.532325e+09\n2          anti -7.594911e+08\n3         ation -1.008633e+09\n4           bar -1.908652e+09\n5         cally -2.021464e+09\n6          eing -1.265124e+09\n7           ese -1.512643e+09\n8          n st -1.129956e+09\n9         ought -3.793124e+08\n10          pri -6.316715e+08*/"
    },
    {
        "input": "-- query8.tpl \nSELECT s_store_name, \n               Sum(ss_net_profit) \nFROM   store_sales, \n       date_dim, \n       store, \n       (SELECT ca_zip \n        FROM   (SELECT Substring(ca_zip, 1, 5) ca_zip \n                FROM   customer_address \n                WHERE  Substring(ca_zip, 1, 5) IN ( '67436', '26121', '38443', \n                                                 '63157', \n                                                 '68856', '19485', '86425', \n                                                 '26741', \n                                                 '70991', '60899', '63573', \n                                                 '47556', \n                                                 '56193', '93314', '87827', \n                                                 '62017', \n                                                 '85067', '95390', '48091', \n                                                 '10261', \n                                                 '41790', '81845', '42853', \n                                                 '24675', \n                                                 '12840', '60065', '84430', \n                                                 '57451', \n                                                 '24021', '91735', '75335', \n                                                 '71935', \n                                                 '34482', '56943', '70695', \n                                                 '52147', \n                                                 '56251', '28411', '86653', \n                                                 '23005', \n                                                 '22478', '29031', '34398', \n                                                 '15365', \n                                                 '42460', '33337', '59433', \n                                                 '73943', \n                                                 '72477', '74081', '74430', \n                                                 '64605', \n                                                 '39006', '11226', '49057', \n                                                 '97308', \n                                                 '42663', '18187', '19768', \n                                                 '43454', \n                                                 '32147', '76637', '51975', \n                                                 '11181', \n                                                 '45630', '33129', '45995', \n                                                 '64386', \n                                                 '55522', '26697', '20963', \n                                                 '35154', \n                                                 '64587', '49752', '66386', \n                                                 '30586', \n                                                 '59286', '13177', '66646', \n                                                 '84195', \n                                                 '74316', '36853', '32927', \n                                                 '12469', \n                                                 '11904', '36269', '17724', \n                                                 '55346', \n                                                 '12595', '53988', '65439', \n                                                 '28015', \n                                                 '63268', '73590', '29216', \n                                                 '82575', \n                                                 '69267', '13805', '91678', \n                                                 '79460', \n                                                 '94152', '14961', '15419', \n                                                 '48277', \n                                                 '62588', '55493', '28360', \n                                                 '14152', \n                                                 '55225', '18007', '53705', \n                                                 '56573', \n                                                 '80245', '71769', '57348', \n                                                 '36845', \n                                                 '13039', '17270', '22363', \n                                                 '83474', \n                                                 '25294', '43269', '77666', \n                                                 '15488', \n                                                 '99146', '64441', '43338', \n                                                 '38736', \n                                                 '62754', '48556', '86057', \n                                                 '23090', \n                                                 '38114', '66061', '18910', \n                                                 '84385', \n                                                 '23600', '19975', '27883', \n                                                 '65719', \n                                                 '19933', '32085', '49731', \n                                                 '40473', \n                                                 '27190', '46192', '23949', \n                                                 '44738', \n                                                 '12436', '64794', '68741', \n                                                 '15333', \n                                                 '24282', '49085', '31844', \n                                                 '71156', \n                                                 '48441', '17100', '98207', \n                                                 '44982', \n                                                 '20277', '71496', '96299', \n                                                 '37583', \n                                                 '22206', '89174', '30589', \n                                                 '61924', \n                                                 '53079', '10976', '13104', \n                                                 '42794', \n                                                 '54772', '15809', '56434', \n                                                 '39975', \n                                                 '13874', '30753', '77598', \n                                                 '78229', \n                                                 '59478', '12345', '55547', \n                                                 '57422', \n                                                 '42600', '79444', '29074', \n                                                 '29752', \n                                                 '21676', '32096', '43044', \n                                                 '39383', \n                                                 '37296', '36295', '63077', \n                                                 '16572', \n                                                 '31275', '18701', '40197', \n                                                 '48242', \n                                                 '27219', '49865', '84175', \n                                                 '30446', \n                                                 '25165', '13807', '72142', \n                                                 '70499', \n                                                 '70464', '71429', '18111', \n                                                 '70857', \n                                                 '29545', '36425', '52706', \n                                                 '36194', \n                                                 '42963', '75068', '47921', \n                                                 '74763', \n                                                 '90990', '89456', '62073', \n                                                 '88397', \n                                                 '73963', '75885', '62657', \n                                                 '12530', \n                                                 '81146', '57434', '25099', \n                                                 '41429', \n                                                 '98441', '48713', '52552', \n                                                 '31667', \n                                                 '14072', '13903', '44709', \n                                                 '85429', \n                                                 '58017', '38295', '44875', \n                                                 '73541', \n                                                 '30091', '12707', '23762', \n                                                 '62258', \n                                                 '33247', '78722', '77431', \n                                                 '14510', \n                                                 '35656', '72428', '92082', \n                                                 '35267', \n                                                 '43759', '24354', '90952', \n                                                 '11512', \n                                                 '21242', '22579', '56114', \n                                                 '32339', \n                                                 '52282', '41791', '24484', \n                                                 '95020', \n                                                 '28408', '99710', '11899', \n                                                 '43344', \n                                                 '72915', '27644', '62708', \n                                                 '74479', \n                                                 '17177', '32619', '12351', \n                                                 '91339', \n                                                 '31169', '57081', '53522', \n                                                 '16712', \n                                                 '34419', '71779', '44187', \n                                                 '46206', \n                                                 '96099', '61910', '53664', \n                                                 '12295', \n                                                 '31837', '33096', '10813', \n                                                 '63048', \n                                                 '31732', '79118', '73084', \n                                                 '72783', \n                                                 '84952', '46965', '77956', \n                                                 '39815', \n                                                 '32311', '75329', '48156', \n                                                 '30826', \n                                                 '49661', '13736', '92076', \n                                                 '74865', \n                                                 '88149', '92397', '52777', \n                                                 '68453', \n                                                 '32012', '21222', '52721', \n                                                 '24626', \n                                                 '18210', '42177', '91791', \n                                                 '75251', \n                                                 '82075', '44372', '45542', \n                                                 '20609', \n                                                 '60115', '17362', '22750', \n                                                 '90434', \n                                                 '31852', '54071', '33762', \n                                                 '14705', \n                                                 '40718', '56433', '30996', \n                                                 '40657', \n                                                 '49056', '23585', '66455', \n                                                 '41021', \n                                                 '74736', '72151', '37007', \n                                                 '21729', \n                                                 '60177', '84558', '59027', \n                                                 '93855', \n                                                 '60022', '86443', '19541', \n                                                 '86886', \n                                                 '30532', '39062', '48532', \n                                                 '34713', \n                                                 '52077', '22564', '64638', \n                                                 '15273', \n                                                 '31677', '36138', '62367', \n                                                 '60261', \n                                                 '80213', '42818', '25113', \n                                                 '72378', \n                                                 '69802', '69096', '55443', \n                                                 '28820', \n                                                 '13848', '78258', '37490', \n                                                 '30556', \n                                                 '77380', '28447', '44550', \n                                                 '26791', \n                                                 '70609', '82182', '33306', \n                                                 '43224', \n                                                 '22322', '86959', '68519', \n                                                 '14308', \n                                                 '46501', '81131', '34056', \n                                                 '61991', \n                                                 '19896', '87804', '65774', \n                                                 '92564' ) \n                INTERSECT \n                SELECT ca_zip \n                FROM   (SELECT Substring(ca_zip, 1, 5) ca_zip, \n                               Count(*)             cnt \n                        FROM   customer_address, \n                               customer \n                        WHERE  ca_address_sk = c_current_addr_sk \n                               AND c_preferred_cust_flag = 'Y' \n                        GROUP  BY ca_zip \n                        HAVING Count(*) > 10)A1)A2) V1 \nWHERE  ss_store_sk = s_store_sk \n       AND ss_sold_date_sk = d_date_sk \n       AND d_qoy = 2 \n       AND d_year = 2000 \n       AND ( Substring(s_zip, 1, 2) = Substring(V1.ca_zip, 1, 2) ) \nGROUP  BY s_store_name \nORDER  BY s_store_name\nLIMIT 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"A1\" AS ( SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" HAVING COUNT ( * ) > 10 ) , \"A2\" AS ( SELECT SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) AS \"CA_ZIP\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" WHERE SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '67436' , '26121' , '38443' , '63157' , '68856' , '19485' , '86425' , '26741' , '70991' , '60899' , '63573' , '47556' , '56193' , '93314' , '87827' , '62017' , '85067' , '95390' , '48091' , '10261' , '41790' , '81845' , '42853' , '24675' , '12840' , '60065' , '84430' , '57451' , '24021' , '91735' , '75335' , '71935' , '34482' , '56943' , '70695' , '52147' , '56251' , '28411' , '86653' , '23005' , '22478' , '29031' , '34398' , '15365' , '42460' , '33337' , '59433' , '73943' , '72477' , '74081' , '74430' , '64605' , '39006' , '11226' , '49057' , '97308' , '42663' , '18187' , '19768' , '43454' , '32147' , '76637' , '51975' , '11181' , '45630' , '33129' , '45995' , '64386' , '55522' , '26697' , '20963' , '35154' , '64587' , '49752' , '66386' , '30586' , '59286' , '13177' , '66646' , '84195' , '74316' , '36853' , '32927' , '12469' , '11904' , '36269' , '17724' , '55346' , '12595' , '53988' , '65439' , '28015' , '63268' , '73590' , '29216' , '82575' , '69267' , '13805' , '91678' , '79460' , '94152' , '14961' , '15419' , '48277' , '62588' , '55493' , '28360' , '14152' , '55225' , '18007' , '53705' , '56573' , '80245' , '71769' , '57348' , '36845' , '13039' , '17270' , '22363' , '83474' , '25294' , '43269' , '77666' , '15488' , '99146' , '64441' , '43338' , '38736' , '62754' , '48556' , '86057' , '23090' , '38114' , '66061' , '18910' , '84385' , '23600' , '19975' , '27883' , '65719' , '19933' , '32085' , '49731' , '40473' , '27190' , '46192' , '23949' , '44738' , '12436' , '64794' , '68741' , '15333' , '24282' , '49085' , '31844' , '71156' , '48441' , '17100' , '98207' , '44982' , '20277' , '71496' , '96299' , '37583' , '22206' , '89174' , '30589' , '61924' , '53079' , '10976' , '13104' , '42794' , '54772' , '15809' , '56434' , '39975' , '13874' , '30753' , '77598' , '78229' , '59478' , '12345' , '55547' , '57422' , '42600' , '79444' , '29074' , '29752' , '21676' , '32096' , '43044' , '39383' , '37296' , '36295' , '63077' , '16572' , '31275' , '18701' , '40197' , '48242' , '27219' , '49865' , '84175' , '30446' , '25165' , '13807' , '72142' , '70499' , '70464' , '71429' , '18111' , '70857' , '29545' , '36425' , '52706' , '36194' , '42963' , '75068' , '47921' , '74763' , '90990' , '89456' , '62073' , '88397' , '73963' , '75885' , '62657' , '12530' , '81146' , '57434' , '25099' , '41429' , '98441' , '48713' , '52552' , '31667' , '14072' , '13903' , '44709' , '85429' , '58017' , '38295' , '44875' , '73541' , '30091' , '12707' , '23762' , '62258' , '33247' , '78722' , '77431' , '14510' , '35656' , '72428' , '92082' , '35267' , '43759' , '24354' , '90952' , '11512' , '21242' , '22579' , '56114' , '32339' , '52282' , '41791' , '24484' , '95020' , '28408' , '99710' , '11899' , '43344' , '72915' , '27644' , '62708' , '74479' , '17177' , '32619' , '12351' , '91339' , '31169' , '57081' , '53522' , '16712' , '34419' , '71779' , '44187' , '46206' , '96099' , '61910' , '53664' , '12295' , '31837' , '33096' , '10813' , '63048' , '31732' , '79118' , '73084' , '72783' , '84952' , '46965' , '77956' , '39815' , '32311' , '75329' , '48156' , '30826' , '49661' , '13736' , '92076' , '74865' , '88149' , '92397' , '52777' , '68453' , '32012' , '21222' , '52721' , '24626' , '18210' , '42177' , '91791' , '75251' , '82075' , '44372' , '45542' , '20609' , '60115' , '17362' , '22750' , '90434' , '31852' , '54071' , '33762' , '14705' , '40718' , '56433' , '30996' , '40657' , '49056' , '23585' , '66455' , '41021' , '74736' , '72151' , '37007' , '21729' , '60177' , '84558' , '59027' , '93855' , '60022' , '86443' , '19541' , '86886' , '30532' , '39062' , '48532' , '34713' , '52077' , '22564' , '64638' , '15273' , '31677' , '36138' , '62367' , '60261' , '80213' , '42818' , '25113' , '72378' , '69802' , '69096' , '55443' , '28820' , '13848' , '78258' , '37490' , '30556' , '77380' , '28447' , '44550' , '26791' , '70609' , '82182' , '33306' , '43224' , '22322' , '86959' , '68519' , '14308' , '46501' , '81131' , '34056' , '61991' , '19896' , '87804' , '65774' , '92564' ) INTERSECT SELECT \"A1\".\"CA_ZIP\" AS \"CA_ZIP\" FROM \"A1\" AS \"A1\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"A2\" AS \"A2\" ON SUBSTRING ( \"A2\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\" ORDER BY \"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name        _col_1\n0               -1.275468e+08\n1          able -1.532325e+09\n2          anti -7.594911e+08\n3         ation -1.008633e+09\n4           bar -1.908652e+09\n5         cally -2.021464e+09\n6          eing -1.265124e+09\n7           ese -1.512643e+09\n8          n st -1.129956e+09\n9         ought -3.793124e+08\n10          pri -6.316715e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01795,
                    "execution_time": 0.008724,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003339
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017361,
                    "execution_time": 0.007879,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003472
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" , 1 , 2 ) = SUBSTRING ( \"STORE\".\"S_ZIP\" , 1 , 2 ) GROUP BY \"STORE\".\"S_STORE_NAME\" ORDER BY \"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name        _col_1\n0               -1.275468e+08\n1          able -1.532325e+09\n2          anti -7.594911e+08\n3         ation -1.008633e+09\n4           bar -1.908652e+09\n5         cally -2.021464e+09\n6          eing -1.265124e+09\n7           ese -1.512643e+09\n8          n st -1.129956e+09\n9         ought -3.793124e+08\n10          pri -6.316715e+08*/"
    }
]