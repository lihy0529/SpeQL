[
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n group by cr_returning_customer_sk, ca_state)\nselect * from customer_total_return /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\"",
                "rewrite": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "with /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk\n join customer_address on cr_returning_customer_sk = ca_address_sk\n where d_year = 1999\n group by cr_returning_customer_sk, ca_state\n )\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.352835,
                    "execution_time": 1.013146,
                    "compile_time": 0.000456,
                    "planning_time": 0.041385,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.69807,
                    "execution_time": 1.108895,
                    "compile_time": 0.152456,
                    "planning_time": 0.116869,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            857397        VA           6847.48\n1           4298703        MT           3661.52\n2           2465885        TX           1006.15\n3            386298        IA           1032.28\n4           3672326        KY            337.22\n5           5465957        WA           3303.63\n6           3386573        GA           6527.49\n7           1331990        TX          11069.84\n8           3379188        MT           6274.31\n9           4429845        WA           5376.76\n10          5492569        OK           2939.24\n11          5931117        DC          12480.97\n12          5081919        NY            489.30\n13          1669892        NY           1833.49\n14          3006477        TX           2374.49\n15          2969416        IA           5815.04\n16           642413        TX            961.54\n17          5109408        SC           4497.65\n18          5680427        SD           9631.19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018008,
                    "execution_time": 0.007545,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.00352
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055221,
                    "execution_time": 0.008004,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038693
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            857397        VA           6847.48\n1           4298703        MT           3661.52\n2           2465885        TX           1006.15\n3            386298        IA           1032.28\n4           3672326        KY            337.22\n5           5465957        WA           3303.63\n6           3386573        GA           6527.49\n7           1331990        TX          11069.84\n8           3379188        MT           6274.31\n9           4429845        WA           5376.76\n10          5492569        OK           2939.24\n11          5931117        DC          12480.97\n12          5081919        NY            489.30\n13          1669892        NY           1833.49\n14          3006477        TX           2374.49\n15          2969416        IA           5815.04\n16           642413        TX            961.54\n17          5109408        SC           4497.65\n18          5680427        SD           9631.19\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk \n join customer_address on cr_returning_addr_sk = ca_address_sk \n where d_year =1999\n group by cr_returning_customer_sk, ca_state\n)\n/*CURSOR_IDENTIFIER*/\nselect * from customer_total_return;",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.427146,
                    "execution_time": 2.078044,
                    "compile_time": 0.000434,
                    "planning_time": 0.045399,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.664299,
                    "execution_time": 3.053089,
                    "compile_time": 0.181921,
                    "planning_time": 0.112541,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0          10985718        NC              7.86\n1           2729934        MO             69.84\n2          11375039        TX           2104.30\n3           1989645        TX            915.04\n4           4157045        NE            122.36\n5           4752115        ID          10858.38\n6           2915036        FL           5362.26\n7           7027014        IL            999.44\n8           8132025        GA            411.59\n9           3391702        TN           2162.69\n10          4123514        SD            269.21\n11          4464801        VA           4145.75\n12          2853045        VA            688.17\n13          5282024                      480.67\n14          1538612        VA           4174.43\n15         10976438        NE            118.80\n16          4252486        CA            316.33\n17           247394        ND             64.02\n18           949734        PA          13895.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017571,
                    "execution_time": 0.008246,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003358
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054938,
                    "execution_time": 0.007933,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038521
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0          10985718        NC              7.86\n1           2729934        MO             69.84\n2          11375039        TX           2104.30\n3           1989645        TX            915.04\n4           4157045        NE            122.36\n5           4752115        ID          10858.38\n6           2915036        FL           5362.26\n7           7027014        IL            999.44\n8           8132025        GA            411.59\n9           3391702        TN           2162.69\n10          4123514        SD            269.21\n11          4464801        VA           4145.75\n12          2853045        VA            688.17\n13          5282024                      480.67\n14          1538612        VA           4174.43\n15         10976438        NE            118.80\n16          4252486        CA            316.33\n17           247394        ND             64.02\n18           949734        PA          13895.29\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year = 1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk, ca_state\n)\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0          10903069        SD             30.09\n1           2603515        NH           6032.09\n2           9009692        TN           1013.17\n3           3426560        NJ           1071.36\n4          11511112        CT            136.60\n5           6161326        NM             31.88\n6           6975303        GA             80.17\n7           3563914        NE            206.85\n8           2455312        MO           1199.20\n9          11746677        IL           3489.99\n10          2608646        CA            123.81\n11          2200419        SD             84.58\n12          5176303        ID            334.21\n13          3316332        MN           1568.23\n14          2642559        MA            833.55\n15           515809        GA            407.63\n16         11161422        KY            272.76\n17          2532186        PA           1289.86\n18          3093994        MI           3661.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01736,
                    "execution_time": 0.008062,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017529,
                    "execution_time": 0.00812,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.00345
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0          10903069        SD             30.09\n1           2603515        NH           6032.09\n2           9009692        TN           1013.17\n3           3426560        NJ           1071.36\n4          11511112        CT            136.60\n5           6161326        NM             31.88\n6           6975303        GA             80.17\n7           3563914        NE            206.85\n8           2455312        MO           1199.20\n9          11746677        IL           3489.99\n10          2608646        CA            123.81\n11          2200419        SD             84.58\n12          5176303        ID            334.21\n13          3316332        MN           1568.23\n14          2642559        MA            833.55\n15           515809        GA            407.63\n16         11161422        KY            272.76\n17          2532186        PA           1289.86\n18          3093994        MI           3661.85\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           6527692        IN           2776.56\n1           3531188        NY           1305.82\n2           1824167        NC           1266.05\n3            976976        SC            709.02\n4           8021015        OK           1971.06\n5           4882346        GA           1269.52\n6           6412808        IA            160.10\n7           2635615        KS            193.80\n8           1703569        CT           1483.95\n9           3147230        KS           4119.38\n10          9462015        IL             80.60\n11          3768316        MO           1769.89\n12          1677271        VA             26.79\n13          8872806        MN            618.80\n14          9269173                      989.49\n15          2443436        IA            329.96\n16          6804075        MS            640.58\n17          4671988        VA             61.54\n18          8961847        TX            494.40\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017346,
                    "execution_time": 0.007527,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003661
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017282,
                    "execution_time": 0.008008,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003301
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           6527692        IN           2776.56\n1           3531188        NY           1305.82\n2           1824167        NC           1266.05\n3            976976        SC            709.02\n4           8021015        OK           1971.06\n5           4882346        GA           1269.52\n6           6412808        IA            160.10\n7           2635615        KS            193.80\n8           1703569        CT           1483.95\n9           3147230        KS           4119.38\n10          9462015        IL             80.60\n11          3768316        MO           1769.89\n12          1677271        VA             26.79\n13          8872806        MN            618.80\n14          9269173                      989.49\n15          2443436        IA            329.96\n16          6804075        MS            640.58\n17          4671988        VA             61.54\n18          8961847        TX            494.40\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.715379,
                    "execution_time": 0.548539,
                    "compile_time": 0.000239,
                    "planning_time": 0.002957,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.769957,
                    "execution_time": 0.537365,
                    "compile_time": 0.00025,
                    "planning_time": 0.057325,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number    ca_city       ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            617.71\n1   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             68.43\n2   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            464.16\n3   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            258.11\n4   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             51.92\n5   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           1004.01\n6   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            541.80\n7   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            564.18\n8   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           5789.01\n9   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             64.90\n10  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           1059.43\n11  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           2738.31\n12  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            573.71\n13  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           3549.44\n14  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             48.31\n15  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           1780.75\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.615579,
                    "execution_time": 1.575537,
                    "compile_time": 0.000171,
                    "planning_time": 0.030509
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.749285,
                    "execution_time": 1.638812,
                    "compile_time": 0.209992,
                    "planning_time": 0.097284
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number    ca_city       ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            617.71\n1   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             68.43\n2   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            464.16\n3   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            258.11\n4   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             51.92\n5   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           1004.01\n6   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            541.80\n7   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            564.18\n8   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           5789.01\n9   AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             64.90\n10  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           1059.43\n11  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           2738.31\n12  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment            573.71\n13  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           3549.44\n14  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment             48.31\n15  AAAAAAAAFAAAAAAA          Sir       Robert       Moran              365    Spring 12th             RD         Suite P  Fairfield  Bourbon County       KS  66192  United States           -6.0        apartment           1780.75\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_3\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081111,
                    "execution_time": 0.051197,
                    "compile_time": 0.000285,
                    "planning_time": 0.003471,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.141899,
                    "execution_time": 0.052088,
                    "compile_time": 0.000311,
                    "planning_time": 0.060158,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080119,
                    "execution_time": 0.051043,
                    "compile_time": 0.00028,
                    "planning_time": 0.00344,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.135747,
                    "execution_time": 0.050298,
                    "compile_time": 0.000291,
                    "planning_time": 0.058631,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.941928,
                    "execution_time": 0.695963,
                    "compile_time": 0.000245,
                    "planning_time": 0.003094,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.032757,
                    "execution_time": 0.723815,
                    "compile_time": 0.000255,
                    "planning_time": 0.064342,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.129434,
                    "execution_time": 0.100382,
                    "compile_time": 0.000261,
                    "planning_time": 0.003719,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.187995,
                    "execution_time": 0.101453,
                    "compile_time": 0.000259,
                    "planning_time": 0.059024,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number ca_city       ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2088.68\n1   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           8063.22\n2   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3841.85\n3   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           1843.12\n4   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2909.71\n5   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3702.90\n6   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2583.92\n7   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3259.68\n8   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           7059.73\n9   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2366.73\n10  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           4382.03\n11  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3287.06\n12  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2731.02\n13  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2094.12\n14  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2353.14\n15  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2781.60\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 51.11959,
                    "execution_time": 51.065063,
                    "compile_time": 0.000277,
                    "planning_time": 0.039263
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 52.858636,
                    "execution_time": 49.813444,
                    "compile_time": 2.929079,
                    "planning_time": 0.097164
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number ca_city       ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2088.68\n1   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           8063.22\n2   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3841.85\n3   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           1843.12\n4   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2909.71\n5   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3702.90\n6   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2583.92\n7   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3259.68\n8   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           7059.73\n9   AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2366.73\n10  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           4382.03\n11  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           3287.06\n12  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2731.02\n13  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2094.12\n14  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2353.14\n15  AAAAAAAALBCAAAAA          Mr.         John     Jackson              928   Pine Madison           Lane         Suite Q   Milan  Kanawha County       WV  26697  United States           -5.0            condo           2781.60\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number   ca_city       ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3198.81\n1   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2005.52\n2   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3790.05\n3   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1706.61\n4   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2404.16\n5   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2312.55\n6   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1870.52\n7   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1879.54\n8   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3144.80\n9   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2380.02\n10  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           4542.84\n11  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           4200.74\n12  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3299.46\n13  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1776.15\n14  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1816.27\n15  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2623.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.992961,
                    "execution_time": 0.935241,
                    "compile_time": 0.000342,
                    "planning_time": 0.039881
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.425125,
                    "execution_time": 0.957057,
                    "compile_time": 7.712498,
                    "planning_time": 0.109952
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number   ca_city       ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3198.81\n1   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2005.52\n2   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3790.05\n3   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1706.61\n4   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2404.16\n5   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2312.55\n6   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1870.52\n7   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1879.54\n8   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3144.80\n9   AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2380.02\n10  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           4542.84\n11  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           4200.74\n12  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           3299.46\n13  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1776.15\n14  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           1816.27\n15  AAAAAAAAHHLEBGAA          Dr.         Lori       Jones              150    Lincoln Oak         Avenue         Suite U  Red Hill  Bradley County       TN  34338  United States           -5.0        apartment           2623.53\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.130051,
                    "execution_time": 0.099914,
                    "compile_time": 0.000273,
                    "planning_time": 0.004119,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.310396,
                    "execution_time": 0.219489,
                    "compile_time": 0.000264,
                    "planning_time": 0.063894,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.307496,
                    "execution_time": 0.864988,
                    "compile_time": 0.07291,
                    "planning_time": 0.038313,
                    "create_size": 2432
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 21.442465,
                    "execution_time": 0.881349,
                    "compile_time": 19.10518,
                    "planning_time": 0.102861,
                    "create_size": 2432
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name  c_last_name ca_street_number   ca_street_name ca_street_type ca_suite_number         ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAOFNEJFAA          Ms.    Christina     Ferguson              122     Spruce Maple        Parkway       Suite 120    Walnut Grove   Humphreys County       TN  37752  United States           -5.0        apartment           3870.61\n1   AAAAAAAACNLNMDAA          Sir          Lee       Franks              549            Park              Ln         Suite V         Newport      Loudon County       TN  31521  United States           -6.0            condo           3065.40\n2   AAAAAAAABNLCCDAA          Sir          Rex     Sullivan              481     Franklin 1st           Cir.       Suite 380          Shiloh      Gibson County       TN  39275  United States           -5.0        apartment           4890.87\n3   AAAAAAAAEPEALHAA          Dr.       Bonnie        Lucas              575             5th            Road         Suite T      Enterprise     Dickson County       TN  31757  United States           -5.0            condo           3513.01\n4   AAAAAAAAHLMJOFAA         Miss      Dorothy        Unger              165       5th Cherry           Road       Suite 210      Enterprise       Wayne County       TN  31757  United States           -6.0        apartment           2103.37\n5   AAAAAAAADMBBCJAA         Miss        Carla      Hamrick               27          Wilson           Court         Suite V         Allison     Bedford County       TN  34167  United States           -5.0            condo           3683.58\n6   AAAAAAAAIMLJPAAA          Sir       Ronnie        Grant              160             1st       Boulevard         Suite E        Woodland      Carter County       TN  34854  United States           -5.0        apartment           4364.42\n7   AAAAAAAAOJBCMCAA          Sir       Robert       Brooks              114       South West          Court         Suite W        Leesburg      Unicoi County       TN  35605  United States           -6.0    single family           2087.00\n8   AAAAAAAAIDGECHAA          Mr.     Theodore        Palma               26  North Jefferson      Boulevard         Suite S     Cedar Grove     Weakley County       TN  30411  United States           -6.0    single family           3863.04\n9   AAAAAAAACMALOAAA          Dr.      Jessica       Ibarra              395    Davis Lincoln          Drive         Suite F   Highland Park    Grainger County       TN  36534  United States           -5.0            condo           2076.56\n10  AAAAAAAAGJBJICAA         Mrs.        Grace         Huff               80     Ridge Fourth           Road       Suite 340       Macedonia       Maury County       TN  31087  United States           -6.0            condo           8759.12\n11  AAAAAAAAKPBAJBAA         Mrs.        Amber  Satterfield              296            10th            Cir.       Suite 140      Springtown  Rutherford County       TN  39858  United States           -6.0        apartment           3967.80\n12  AAAAAAAACOAEOEAA          Dr.        Steve        James              287        Broadway          Circle         Suite Y       White Oak    Campbell County       TN  36668  United States           -5.0        apartment           3727.21\n13  AAAAAAAAJBMIHJAA          Dr.          Sun       Staley              273             Lee         Parkway         Suite D   Mountain View      Shelby County       TN  34466  United States           -6.0            condo           2015.35\n14  AAAAAAAAMKHDBGAA         Mrs.      Rosetta       Wright              235          Walnut            Lane       Suite 340    Forest Hills    Hardeman County       TN  39237  United States           -5.0    single family           8625.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021294,
                    "execution_time": 0.008031,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.005822
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.374803,
                    "execution_time": 0.00841,
                    "compile_time": 0.314892,
                    "planning_time": 0.042231
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name  c_last_name ca_street_number   ca_street_name ca_street_type ca_suite_number         ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAOFNEJFAA          Ms.    Christina     Ferguson              122     Spruce Maple        Parkway       Suite 120    Walnut Grove   Humphreys County       TN  37752  United States           -5.0        apartment           3870.61\n1   AAAAAAAACNLNMDAA          Sir          Lee       Franks              549            Park              Ln         Suite V         Newport      Loudon County       TN  31521  United States           -6.0            condo           3065.40\n2   AAAAAAAABNLCCDAA          Sir          Rex     Sullivan              481     Franklin 1st           Cir.       Suite 380          Shiloh      Gibson County       TN  39275  United States           -5.0        apartment           4890.87\n3   AAAAAAAAEPEALHAA          Dr.       Bonnie        Lucas              575             5th            Road         Suite T      Enterprise     Dickson County       TN  31757  United States           -5.0            condo           3513.01\n4   AAAAAAAAHLMJOFAA         Miss      Dorothy        Unger              165       5th Cherry           Road       Suite 210      Enterprise       Wayne County       TN  31757  United States           -6.0        apartment           2103.37\n5   AAAAAAAADMBBCJAA         Miss        Carla      Hamrick               27          Wilson           Court         Suite V         Allison     Bedford County       TN  34167  United States           -5.0            condo           3683.58\n6   AAAAAAAAIMLJPAAA          Sir       Ronnie        Grant              160             1st       Boulevard         Suite E        Woodland      Carter County       TN  34854  United States           -5.0        apartment           4364.42\n7   AAAAAAAAOJBCMCAA          Sir       Robert       Brooks              114       South West          Court         Suite W        Leesburg      Unicoi County       TN  35605  United States           -6.0    single family           2087.00\n8   AAAAAAAAIDGECHAA          Mr.     Theodore        Palma               26  North Jefferson      Boulevard         Suite S     Cedar Grove     Weakley County       TN  30411  United States           -6.0    single family           3863.04\n9   AAAAAAAACMALOAAA          Dr.      Jessica       Ibarra              395    Davis Lincoln          Drive         Suite F   Highland Park    Grainger County       TN  36534  United States           -5.0            condo           2076.56\n10  AAAAAAAAGJBJICAA         Mrs.        Grace         Huff               80     Ridge Fourth           Road       Suite 340       Macedonia       Maury County       TN  31087  United States           -6.0            condo           8759.12\n11  AAAAAAAAKPBAJBAA         Mrs.        Amber  Satterfield              296            10th            Cir.       Suite 140      Springtown  Rutherford County       TN  39858  United States           -6.0        apartment           3967.80\n12  AAAAAAAACOAEOEAA          Dr.        Steve        James              287        Broadway          Circle         Suite Y       White Oak    Campbell County       TN  36668  United States           -5.0        apartment           3727.21\n13  AAAAAAAAJBMIHJAA          Dr.          Sun       Staley              273             Lee         Parkway         Suite D   Mountain View      Shelby County       TN  34466  United States           -6.0            condo           2015.35\n14  AAAAAAAAMKHDBGAA         Mrs.      Rosetta       Wright              235          Walnut            Lane       Suite 340    Forest Hills    Hardeman County       TN  39237  United States           -5.0    single family           8625.37\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.029328,
                    "execution_time": 0.015038,
                    "compile_time": 0.000108,
                    "planning_time": 0.006562
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.18258,
                    "execution_time": 0.016103,
                    "compile_time": 0.115516,
                    "planning_time": 0.042444
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031493,
                    "execution_time": 0.016145,
                    "compile_time": 0.000112,
                    "planning_time": 0.007348
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.224677,
                    "execution_time": 0.015067,
                    "compile_time": 0.158259,
                    "planning_time": 0.04326
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" , \"CA_LOCATION_TYPE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031649,
                    "execution_time": 0.016151,
                    "compile_time": 0.000107,
                    "planning_time": 0.007474
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.205393,
                    "execution_time": 0.015593,
                    "compile_time": 0.137895,
                    "planning_time": 0.04372
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" , \"CA_LOCATION_TYPE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031435,
                    "execution_time": 0.015693,
                    "compile_time": 0.000117,
                    "planning_time": 0.0077
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.032243,
                    "execution_time": 0.016379,
                    "compile_time": 0.000109,
                    "planning_time": 0.007705
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number      ca_street_name ca_street_type ca_suite_number        ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAABEAA         Mrs.        Susan       Byers              966  Madison Washington          Drive       Suite 430        Belmont    Bradley County       TN  30191  United States           -5.0        apartment           3623.77\n1   AAAAAAAAAAABFAAA          Dr.        Tammy       Hayes              557       Lakeview Main      Boulevard       Suite 180    Centerville    Hickman County       TN  30059  United States           -5.0        apartment           2021.78\n2   AAAAAAAAAAADDGAA          Sir        James     Wilhelm              430               Mill            Lane         Suite R        Ashland      Lewis County       TN  34244  United States           -6.0            condo           2413.95\n3   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           1781.80\n4   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5037.08\n5   AAAAAAAAAAADICAA          Ms.     Kimberly    Mcdonald               27                5th             Dr.         Suite B       Highland    Bradley County       TN  39454  United States           -5.0    single family           5960.57\n6   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           1703.49\n7   AAAAAAAAAAADKGAA          Sir       Jeremy     Barkley              372         Madison 8th          Drive       Suite 250         Murphy    Weakley County       TN  32105  United States           -6.0    single family           4833.91\n8   AAAAAAAAAAAECKAA          Dr.      Gwyneth      Parker              326           Williams            Pkwy         Suite P          Union    Hancock County       TN  38721  United States           -5.0            condo           2023.32\n9   AAAAAAAAAAAEGLAA          Dr.        Frank    Stafford              485          3rd Cherry           Cir.         Suite P        Oakdale  Trousdale County       TN  39584  United States           -6.0    single family           6492.93\n10  AAAAAAAAAAAFBGAA         Mrs.    Charlotte       Berry              907         Washington            Blvd       Suite 440  Highland Park   Hamilton County       TN  36534  United States           -5.0        apartment           4541.99\n11  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           1864.68\n12  AAAAAAAAAAAFFDAA          Sir        David     Johnson              539                Oak            Cir.         Suite G        Oakland  Trousdale County       TN  39843  United States           -6.0    single family           2616.53\n13  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           2118.33\n14  AAAAAAAAAAAGFJAA          Ms.      Melissa    Ferguson              393             Second            Blvd       Suite 370          Globe     Warren County       TN  39614  United States           -6.0        apartment           8368.01\n...*/"
    }
]