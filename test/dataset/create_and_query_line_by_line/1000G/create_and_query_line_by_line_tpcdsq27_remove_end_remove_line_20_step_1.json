[
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        'unknown' as s_state, 0 as g_state,\n        0 as agg1,\n        0 as agg2,\n        0 as agg3,\n        0 as agg4\n from item\n where /*CURSOR_IDENTIFIER*/\n       1=1 -- Placeholder condition to fix syntax error\n)\nselect * from results;",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , 'unknown' AS \"S_STATE\" , 0 AS \"G_STATE\" , 0 AS \"AGG1\" , 0 AS \"AGG2\" , 0 AS \"AGG3\" , 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , 'unknown' AS \"S_STATE\" , 0 AS \"G_STATE\" , 0 AS \"AGG1\" , 0 AS \"AGG2\" , 0 AS \"AGG3\" , 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\" LIMIT 21",
                "preview": "\n/*           i_item_id  s_state  g_state  agg1  agg2  agg3  agg4\n0   AAAAAAAAOAAAAAAA  unknown        0     0     0     0     0\n1   AAAAAAAAKBAAAAAA  unknown        0     0     0     0     0\n2   AAAAAAAAKHAAAAAA  unknown        0     0     0     0     0\n3   AAAAAAAACJAAAAAA  unknown        0     0     0     0     0\n4   AAAAAAAAOLAAAAAA  unknown        0     0     0     0     0\n5   AAAAAAAAEMAAAAAA  unknown        0     0     0     0     0\n6   AAAAAAAALOAAAAAA  unknown        0     0     0     0     0\n7   AAAAAAAAAABAAAAA  unknown        0     0     0     0     0\n8   AAAAAAAABCBAAAAA  unknown        0     0     0     0     0\n9   AAAAAAAAKCBAAAAA  unknown        0     0     0     0     0\n10  AAAAAAAACEBAAAAA  unknown        0     0     0     0     0\n11  AAAAAAAAIFBAAAAA  unknown        0     0     0     0     0\n12  AAAAAAAAOFBAAAAA  unknown        0     0     0     0     0\n13  AAAAAAAAKGBAAAAA  unknown        0     0     0     0     0\n14  AAAAAAAACHBAAAAA  unknown        0     0     0     0     0\n15  AAAAAAAAEIBAAAAA  unknown        0     0     0     0     0\n16  AAAAAAAAHIBAAAAA  unknown        0     0     0     0     0\n17  AAAAAAAAKIBAAAAA  unknown        0     0     0     0     0\n18  AAAAAAAAJJBAAAAA  unknown        0     0     0     0     0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036856,
                    "execution_time": 0.004028,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.026571
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.447674,
                    "execution_time": 0.003968,
                    "compile_time": 0.35629,
                    "planning_time": 0.080185
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", 'unknown' AS \"S_STATE\", 0 AS \"G_STATE\", 0 AS \"AGG1\", 0 AS \"AGG2\", 0 AS \"AGG3\", 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", 'unknown' AS \"S_STATE\", 0 AS \"G_STATE\", 0 AS \"AGG1\", 0 AS \"AGG2\", 0 AS \"AGG3\", 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": "\n/*           i_item_id  s_state  g_state  agg1  agg2  agg3  agg4\n0   AAAAAAAAOAAAAAAA  unknown        0     0     0     0     0\n1   AAAAAAAAKBAAAAAA  unknown        0     0     0     0     0\n2   AAAAAAAAKHAAAAAA  unknown        0     0     0     0     0\n3   AAAAAAAACJAAAAAA  unknown        0     0     0     0     0\n4   AAAAAAAAOLAAAAAA  unknown        0     0     0     0     0\n5   AAAAAAAAEMAAAAAA  unknown        0     0     0     0     0\n6   AAAAAAAALOAAAAAA  unknown        0     0     0     0     0\n7   AAAAAAAAAABAAAAA  unknown        0     0     0     0     0\n8   AAAAAAAABCBAAAAA  unknown        0     0     0     0     0\n9   AAAAAAAAKCBAAAAA  unknown        0     0     0     0     0\n10  AAAAAAAACEBAAAAA  unknown        0     0     0     0     0\n11  AAAAAAAAIFBAAAAA  unknown        0     0     0     0     0\n12  AAAAAAAAOFBAAAAA  unknown        0     0     0     0     0\n13  AAAAAAAAKGBAAAAA  unknown        0     0     0     0     0\n14  AAAAAAAACHBAAAAA  unknown        0     0     0     0     0\n15  AAAAAAAAEIBAAAAA  unknown        0     0     0     0     0\n16  AAAAAAAAHIBAAAAA  unknown        0     0     0     0     0\n17  AAAAAAAAKIBAAAAA  unknown        0     0     0     0     0\n18  AAAAAAAAJJBAAAAA  unknown        0     0     0     0     0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity as agg1,\n        ss_list_price as agg2,\n        ss_coupon_amt as agg3,\n        ss_sales_price as agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n) /*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.634258,
                    "execution_time": 4.829132,
                    "compile_time": 0.12559,
                    "planning_time": 0.066333,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 16.941146,
                    "execution_time": 8.652718,
                    "compile_time": 7.515111,
                    "planning_time": 0.141116,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAJCEFCAAA      TX        0    63    4.46     0.00    2.00\n1   AAAAAAAAIKPDEAAA      TX        0    17   70.81     0.00    6.37\n2   AAAAAAAACJJBEAAA      TX        0    69   10.60     0.00    6.14\n3   AAAAAAAACKEFCAAA      TX        0    93   82.75  4520.06   54.61\n4   AAAAAAAAMAKCEAAA      TX        0    90  125.39  5561.86   66.45\n5   AAAAAAAAMOOAAAAA      TX        0    66   85.76     0.00   54.02\n6   AAAAAAAAJBGGDAAA      TX        0    29   23.77     0.00    0.00\n7   AAAAAAAAEBACDAAA      MN        0    23    6.12     0.00    5.07\n8   AAAAAAAAGEONDAAA      MN        0    69   21.07     0.00    1.26\n9   AAAAAAAAOAENDAAA      MN        0    87   46.39     0.00   41.28\n10  AAAAAAAALPJACAAA      MN        0    66  188.64     0.00   43.38\n11  AAAAAAAAGJHAAAAA      MN        0    38   43.06     0.00   26.69\n12  AAAAAAAAOLPOBAAA      MN        0    79   33.64   198.65   11.43\n13  AAAAAAAACPPKCAAA      MN        0    44   95.23     0.00   62.85\n14  AAAAAAAAKAFHEAAA      MN        0    26    9.23     0.00    0.64\n15  AAAAAAAALDPPCAAA      MN        0    14   48.24     0.00   45.34\n16  AAAAAAAACJALBAAA      MN        0   100   32.30     0.00   20.99\n17  AAAAAAAALCCOCAAA      MN        0    83   55.43     0.00    0.55\n18  AAAAAAAAODLHDAAA      MN        0    27   42.60     0.00    9.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017873,
                    "execution_time": 0.007479,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004236
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056318,
                    "execution_time": 0.008051,
                    "compile_time": 0.001083,
                    "planning_time": 0.039394
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAJCEFCAAA      TX        0    63    4.46     0.00    2.00\n1   AAAAAAAAIKPDEAAA      TX        0    17   70.81     0.00    6.37\n2   AAAAAAAACJJBEAAA      TX        0    69   10.60     0.00    6.14\n3   AAAAAAAACKEFCAAA      TX        0    93   82.75  4520.06   54.61\n4   AAAAAAAAMAKCEAAA      TX        0    90  125.39  5561.86   66.45\n5   AAAAAAAAMOOAAAAA      TX        0    66   85.76     0.00   54.02\n6   AAAAAAAAJBGGDAAA      TX        0    29   23.77     0.00    0.00\n7   AAAAAAAAEBACDAAA      MN        0    23    6.12     0.00    5.07\n8   AAAAAAAAGEONDAAA      MN        0    69   21.07     0.00    1.26\n9   AAAAAAAAOAENDAAA      MN        0    87   46.39     0.00   41.28\n10  AAAAAAAALPJACAAA      MN        0    66  188.64     0.00   43.38\n11  AAAAAAAAGJHAAAAA      MN        0    38   43.06     0.00   26.69\n12  AAAAAAAAOLPOBAAA      MN        0    79   33.64   198.65   11.43\n13  AAAAAAAACPPKCAAA      MN        0    44   95.23     0.00   62.85\n14  AAAAAAAAKAFHEAAA      MN        0    26    9.23     0.00    0.64\n15  AAAAAAAALDPPCAAA      MN        0    14   48.24     0.00   45.34\n16  AAAAAAAACJALBAAA      MN        0   100   32.30     0.00   20.99\n17  AAAAAAAALCCOCAAA      MN        0    83   55.43     0.00    0.55\n18  AAAAAAAAODLHDAAA      MN        0    27   42.60     0.00    9.79\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n ) \n/*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAMEGOCAAA      SD        0    83   67.44     0.00    2.69\n1   AAAAAAAABOLFAAAA      SD        0    70   94.76  1991.80   72.96\n2   AAAAAAAAAPOHBAAA      SD        0    19   88.52     0.00   46.03\n3   AAAAAAAADOIJAAAA      SD        0    90   94.90     0.00   58.83\n4   AAAAAAAAOKMDCAAA      SD        0    93    7.70     0.00    4.77\n5   AAAAAAAAGADLAAAA      SD        0    19   65.13     0.00   49.49\n6   AAAAAAAAAOPPAAAA      SD        0    20   62.44     0.00   23.10\n7   AAAAAAAAAGPJBAAA      SD        0    60   25.10     0.00    8.28\n8   AAAAAAAANKPFDAAA      SD        0    61  104.01     0.00   12.48\n9   AAAAAAAALEECBAAA      SD        0    77   77.32     0.00    5.41\n10  AAAAAAAANGPJDAAA      NM        0    19  128.81     0.00   85.01\n11  AAAAAAAAABEDCAAA      NM        0     6    3.67     0.00    0.33\n12  AAAAAAAAGBJDDAAA      NM        0    21   85.52   186.73   13.68\n13  AAAAAAAAIOFGCAAA      NM        0    76   25.34     0.00    1.01\n14  AAAAAAAAIJMEEAAA      NM        0    23  125.64   296.46   47.74\n15  AAAAAAAADBFFCAAA      NM        0    25  153.08     0.00  136.24\n16  AAAAAAAACJCDAAAA      NM        0    27  155.20     0.00   91.56\n17  AAAAAAAANPKLDAAA      NM        0     6   33.97     0.00   15.28\n18  AAAAAAAAGAAJBAAA      NM        0    91  109.59     0.00   39.45\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018437,
                    "execution_time": 0.008443,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003715
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0527,
                    "execution_time": 0.007628,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038823
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAMEGOCAAA      SD        0    83   67.44     0.00    2.69\n1   AAAAAAAABOLFAAAA      SD        0    70   94.76  1991.80   72.96\n2   AAAAAAAAAPOHBAAA      SD        0    19   88.52     0.00   46.03\n3   AAAAAAAADOIJAAAA      SD        0    90   94.90     0.00   58.83\n4   AAAAAAAAOKMDCAAA      SD        0    93    7.70     0.00    4.77\n5   AAAAAAAAGADLAAAA      SD        0    19   65.13     0.00   49.49\n6   AAAAAAAAAOPPAAAA      SD        0    20   62.44     0.00   23.10\n7   AAAAAAAAAGPJBAAA      SD        0    60   25.10     0.00    8.28\n8   AAAAAAAANKPFDAAA      SD        0    61  104.01     0.00   12.48\n9   AAAAAAAALEECBAAA      SD        0    77   77.32     0.00    5.41\n10  AAAAAAAANGPJDAAA      NM        0    19  128.81     0.00   85.01\n11  AAAAAAAAABEDCAAA      NM        0     6    3.67     0.00    0.33\n12  AAAAAAAAGBJDDAAA      NM        0    21   85.52   186.73   13.68\n13  AAAAAAAAIOFGCAAA      NM        0    76   25.34     0.00    1.01\n14  AAAAAAAAIJMEEAAA      NM        0    23  125.64   296.46   47.74\n15  AAAAAAAADBFFCAAA      NM        0    25  153.08     0.00  136.24\n16  AAAAAAAACJCDAAAA      NM        0    27  155.20     0.00   91.56\n17  AAAAAAAANPKLDAAA      NM        0     6   33.97     0.00   15.28\n18  AAAAAAAAGAAJBAAA      NM        0    91  109.59     0.00   39.45\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n/*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAMEGOCAAA      SD        0    83   67.44     0.00    2.69\n1   AAAAAAAABOLFAAAA      SD        0    70   94.76  1991.80   72.96\n2   AAAAAAAAAPOHBAAA      SD        0    19   88.52     0.00   46.03\n3   AAAAAAAADOIJAAAA      SD        0    90   94.90     0.00   58.83\n4   AAAAAAAAOKMDCAAA      SD        0    93    7.70     0.00    4.77\n5   AAAAAAAAGADLAAAA      SD        0    19   65.13     0.00   49.49\n6   AAAAAAAAAOPPAAAA      SD        0    20   62.44     0.00   23.10\n7   AAAAAAAAAGPJBAAA      SD        0    60   25.10     0.00    8.28\n8   AAAAAAAANKPFDAAA      SD        0    61  104.01     0.00   12.48\n9   AAAAAAAALEECBAAA      SD        0    77   77.32     0.00    5.41\n10  AAAAAAAANGPJDAAA      NM        0    19  128.81     0.00   85.01\n11  AAAAAAAAABEDCAAA      NM        0     6    3.67     0.00    0.33\n12  AAAAAAAAGBJDDAAA      NM        0    21   85.52   186.73   13.68\n13  AAAAAAAAIOFGCAAA      NM        0    76   25.34     0.00    1.01\n14  AAAAAAAAIJMEEAAA      NM        0    23  125.64   296.46   47.74\n15  AAAAAAAADBFFCAAA      NM        0    25  153.08     0.00  136.24\n16  AAAAAAAACJCDAAAA      NM        0    27  155.20     0.00   91.56\n17  AAAAAAAANPKLDAAA      NM        0     6   33.97     0.00   15.28\n18  AAAAAAAAGAAJBAAA      NM        0    91  109.59     0.00   39.45\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01832,
                    "execution_time": 0.008367,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003752
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017584,
                    "execution_time": 0.007484,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003811
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAMEGOCAAA      SD        0    83   67.44     0.00    2.69\n1   AAAAAAAABOLFAAAA      SD        0    70   94.76  1991.80   72.96\n2   AAAAAAAAAPOHBAAA      SD        0    19   88.52     0.00   46.03\n3   AAAAAAAADOIJAAAA      SD        0    90   94.90     0.00   58.83\n4   AAAAAAAAOKMDCAAA      SD        0    93    7.70     0.00    4.77\n5   AAAAAAAAGADLAAAA      SD        0    19   65.13     0.00   49.49\n6   AAAAAAAAAOPPAAAA      SD        0    20   62.44     0.00   23.10\n7   AAAAAAAAAGPJBAAA      SD        0    60   25.10     0.00    8.28\n8   AAAAAAAANKPFDAAA      SD        0    61  104.01     0.00   12.48\n9   AAAAAAAALEECBAAA      SD        0    77   77.32     0.00    5.41\n10  AAAAAAAANGPJDAAA      NM        0    19  128.81     0.00   85.01\n11  AAAAAAAAABEDCAAA      NM        0     6    3.67     0.00    0.33\n12  AAAAAAAAGBJDDAAA      NM        0    21   85.52   186.73   13.68\n13  AAAAAAAAIOFGCAAA      NM        0    76   25.34     0.00    1.01\n14  AAAAAAAAIJMEEAAA      NM        0    23  125.64   296.46   47.74\n15  AAAAAAAADBFFCAAA      NM        0    25  153.08     0.00  136.24\n16  AAAAAAAACJCDAAAA      NM        0    27  155.20     0.00   91.56\n17  AAAAAAAANPKLDAAA      NM        0     6   33.97     0.00   15.28\n18  AAAAAAAAGAAJBAAA      NM        0    91  109.59     0.00   39.45\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id\n/*CURSOR_IDENTIFIER*/ from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.330247,
                    "execution_time": 0.215787,
                    "compile_time": 0.000251,
                    "planning_time": 0.002848,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.693793,
                    "execution_time": 0.221803,
                    "compile_time": 0.293019,
                    "planning_time": 0.063427,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id\n0   AAAAAAAAKBAECAAA\n1   AAAAAAAAEBACEAAA\n2   AAAAAAAAFBGGEAAA\n3   AAAAAAAADLFIBAAA\n4   AAAAAAAAMEDCEAAA\n5   AAAAAAAAAFEBEAAA\n6   AAAAAAAACAFIEAAA\n7   AAAAAAAALHJEAAAA\n8   AAAAAAAAGGOKCAAA\n9   AAAAAAAANKIPAAAA\n10  AAAAAAAAGOBLDAAA\n11  AAAAAAAAKLOFBAAA\n12  AAAAAAAAOMEKBAAA\n13  AAAAAAAALLBMCAAA\n14  AAAAAAAADAEPAAAA\n15  AAAAAAAADBIGEAAA\n16  AAAAAAAAMLMMDAAA\n17  AAAAAAAAIPMIDAAA\n18  AAAAAAAAAJEHCAAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016315,
                    "execution_time": 0.007696,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002889
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052416,
                    "execution_time": 0.00741,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.037749
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id\n0   AAAAAAAAKBAECAAA\n1   AAAAAAAAEBACEAAA\n2   AAAAAAAAFBGGEAAA\n3   AAAAAAAADLFIBAAA\n4   AAAAAAAAMEDCEAAA\n5   AAAAAAAAAFEBEAAA\n6   AAAAAAAACAFIEAAA\n7   AAAAAAAALHJEAAAA\n8   AAAAAAAAGGOKCAAA\n9   AAAAAAAANKIPAAAA\n10  AAAAAAAAGOBLDAAA\n11  AAAAAAAAKLOFBAAA\n12  AAAAAAAAOMEKBAAA\n13  AAAAAAAALLBMCAAA\n14  AAAAAAAADAEPAAAA\n15  AAAAAAAADBIGEAAA\n16  AAAAAAAAMLMMDAAA\n17  AAAAAAAAIPMIDAAA\n18  AAAAAAAAAJEHCAAA\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAJCEFCAAA      TX        0    63    4.46     0.00    2.00\n1   AAAAAAAAIKPDEAAA      TX        0    17   70.81     0.00    6.37\n2   AAAAAAAACJJBEAAA      TX        0    69   10.60     0.00    6.14\n3   AAAAAAAACKEFCAAA      TX        0    93   82.75  4520.06   54.61\n4   AAAAAAAAMAKCEAAA      TX        0    90  125.39  5561.86   66.45\n5   AAAAAAAAMOOAAAAA      TX        0    66   85.76     0.00   54.02\n6   AAAAAAAAJBGGDAAA      TX        0    29   23.77     0.00    0.00\n7   AAAAAAAAEBACDAAA      MN        0    23    6.12     0.00    5.07\n8   AAAAAAAAGEONDAAA      MN        0    69   21.07     0.00    1.26\n9   AAAAAAAAOAENDAAA      MN        0    87   46.39     0.00   41.28\n10  AAAAAAAALPJACAAA      MN        0    66  188.64     0.00   43.38\n11  AAAAAAAAGJHAAAAA      MN        0    38   43.06     0.00   26.69\n12  AAAAAAAAOLPOBAAA      MN        0    79   33.64   198.65   11.43\n13  AAAAAAAACPPKCAAA      MN        0    44   95.23     0.00   62.85\n14  AAAAAAAAKAFHEAAA      MN        0    26    9.23     0.00    0.64\n15  AAAAAAAALDPPCAAA      MN        0    14   48.24     0.00   45.34\n16  AAAAAAAACJALBAAA      MN        0   100   32.30     0.00   20.99\n17  AAAAAAAALCCOCAAA      MN        0    83   55.43     0.00    0.55\n18  AAAAAAAAODLHDAAA      MN        0    27   42.60     0.00    9.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018692,
                    "execution_time": 0.008479,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003763
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018592,
                    "execution_time": 0.008405,
                    "compile_time": 5e-05,
                    "planning_time": 0.003835
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAJCEFCAAA      TX        0    63    4.46     0.00    2.00\n1   AAAAAAAAIKPDEAAA      TX        0    17   70.81     0.00    6.37\n2   AAAAAAAACJJBEAAA      TX        0    69   10.60     0.00    6.14\n3   AAAAAAAACKEFCAAA      TX        0    93   82.75  4520.06   54.61\n4   AAAAAAAAMAKCEAAA      TX        0    90  125.39  5561.86   66.45\n5   AAAAAAAAMOOAAAAA      TX        0    66   85.76     0.00   54.02\n6   AAAAAAAAJBGGDAAA      TX        0    29   23.77     0.00    0.00\n7   AAAAAAAAEBACDAAA      MN        0    23    6.12     0.00    5.07\n8   AAAAAAAAGEONDAAA      MN        0    69   21.07     0.00    1.26\n9   AAAAAAAAOAENDAAA      MN        0    87   46.39     0.00   41.28\n10  AAAAAAAALPJACAAA      MN        0    66  188.64     0.00   43.38\n11  AAAAAAAAGJHAAAAA      MN        0    38   43.06     0.00   26.69\n12  AAAAAAAAOLPOBAAA      MN        0    79   33.64   198.65   11.43\n13  AAAAAAAACPPKCAAA      MN        0    44   95.23     0.00   62.85\n14  AAAAAAAAKAFHEAAA      MN        0    26    9.23     0.00    0.64\n15  AAAAAAAALDPPCAAA      MN        0    14   48.24     0.00   45.34\n16  AAAAAAAACJALBAAA      MN        0   100   32.30     0.00   20.99\n17  AAAAAAAALCCOCAAA      MN        0    83   55.43     0.00    0.55\n18  AAAAAAAAODLHDAAA      MN        0    27   42.60     0.00    9.79\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3    agg4\n0   AAAAAAAACKNHCAAA      MI        0    74   67.33    0.00   19.52\n1   AAAAAAAAFFLBAAAA      MI        0    26  134.43    0.00   67.21\n2   AAAAAAAAGOGDDAAA      MI        0    37    8.96    0.00    4.56\n3   AAAAAAAABFKJDAAA      MI        0    35   87.28    0.00   84.66\n4   AAAAAAAAAKAHAAAA      MI        0    45   65.74    0.00   44.70\n5   AAAAAAAAFPJOAAAA      MI        0     4  179.74    0.00  168.95\n6   AAAAAAAALLCNDAAA      MI        0    67   11.52    0.00   10.02\n7   AAAAAAAABICNBAAA      MI        0    23   60.92    0.00   50.56\n8   AAAAAAAAAADHAAAA      MI        0    79   20.77    0.00   14.53\n9   AAAAAAAAKFCIDAAA      TX        0    47   16.55    0.00    0.00\n10  AAAAAAAAAMGFAAAA      TX        0     3    1.44    0.00    1.39\n11  AAAAAAAAKEALBAAA      TX        0    56   81.99    5.49    4.91\n12  AAAAAAAAPEAKCAAA      TX        0    67   49.86    0.00   39.88\n13  AAAAAAAAGHDHCAAA      TX        0    66   93.14    0.00   52.15\n14  AAAAAAAAMHJJBAAA      TX        0    89   13.68    0.00    8.34\n15  AAAAAAAAKHNKDAAA      TX        0    39   28.57    0.00    3.99\n16  AAAAAAAALJCDDAAA      TX        0     9   47.24    0.00   22.67\n17  AAAAAAAALCMDDAAA      TX        0    27   22.38    0.00   20.58\n18  AAAAAAAAFNKIBAAA      TX        0    92  121.62    0.00    7.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017217,
                    "execution_time": 0.007417,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003683
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018734,
                    "execution_time": 0.007584,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003813
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3    agg4\n0   AAAAAAAACKNHCAAA      MI        0    74   67.33    0.00   19.52\n1   AAAAAAAAFFLBAAAA      MI        0    26  134.43    0.00   67.21\n2   AAAAAAAAGOGDDAAA      MI        0    37    8.96    0.00    4.56\n3   AAAAAAAABFKJDAAA      MI        0    35   87.28    0.00   84.66\n4   AAAAAAAAAKAHAAAA      MI        0    45   65.74    0.00   44.70\n5   AAAAAAAAFPJOAAAA      MI        0     4  179.74    0.00  168.95\n6   AAAAAAAALLCNDAAA      MI        0    67   11.52    0.00   10.02\n7   AAAAAAAABICNBAAA      MI        0    23   60.92    0.00   50.56\n8   AAAAAAAAAADHAAAA      MI        0    79   20.77    0.00   14.53\n9   AAAAAAAAKFCIDAAA      TX        0    47   16.55    0.00    0.00\n10  AAAAAAAAAMGFAAAA      TX        0     3    1.44    0.00    1.39\n11  AAAAAAAAKEALBAAA      TX        0    56   81.99    5.49    4.91\n12  AAAAAAAAPEAKCAAA      TX        0    67   49.86    0.00   39.88\n13  AAAAAAAAGHDHCAAA      TX        0    66   93.14    0.00   52.15\n14  AAAAAAAAMHJJBAAA      TX        0    89   13.68    0.00    8.34\n15  AAAAAAAAKHNKDAAA      TX        0    39   28.57    0.00    3.99\n16  AAAAAAAALJCDDAAA      TX        0     9   47.24    0.00   22.67\n17  AAAAAAAALCMDDAAA      TX        0    27   22.38    0.00   20.58\n18  AAAAAAAAFNKIBAAA      TX        0    92  121.62    0.00    7.29\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\ngroup by i_item_id, s_state /*CURSOR_IDENTIFIER*/ )",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.278527,
                    "execution_time": 1.581355,
                    "compile_time": 0.000666,
                    "planning_time": 0.06367,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.379628,
                    "execution_time": 1.68965,
                    "compile_time": 5.900038,
                    "planning_time": 0.146094,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAANJHAAAA      TX        0    43   78.33     0.00  12.53\n1   AAAAAAAAKBBGEAAA      MN        0    58   86.56    19.96  25.74\n2   AAAAAAAAJPCEBAAA      NM        0    44   76.28   385.86  56.24\n3   AAAAAAAAELPKAAAA      NM        0    48   73.89   969.27  36.60\n4   AAAAAAAAGKJBAAAA      NM        0    80  130.71     0.00  34.99\n5   AAAAAAAAGKAFCAAA      MN        0    33   72.36   629.89  61.20\n6   AAAAAAAANIHHCAAA      MN        0    39   88.43     0.00  21.77\n7   AAAAAAAAALDEBAAA      MI        0    42   81.89   191.63  47.94\n8   AAAAAAAAKOJNBAAA      MI        0    61   69.32   185.44  39.82\n9   AAAAAAAAHNLBCAAA      MI        0    49  112.17  1232.60  83.69\n10  AAAAAAAABGODEAAA      SD        0    23   98.67     0.00  66.10\n11  AAAAAAAAFILGBAAA      MN        0    67   74.47     0.00  39.69\n12  AAAAAAAACDMFDAAA      MN        0    60   91.87   186.31  40.76\n13  AAAAAAAANKEHDAAA      MI        0    46  105.74   116.56  67.15\n14  AAAAAAAANHIPDAAA      MI        0    50   43.76   515.16  19.42\n15  AAAAAAAANKKGEAAA      MN        0    57   76.09     0.00  49.78\n16  AAAAAAAACFKIBAAA      MN        0    32   70.67     0.00  38.10\n17  AAAAAAAAEDJMBAAA      SD        0    36   76.40     0.00  51.90\n18  AAAAAAAACDLGEAAA      SD        0    68   63.05     0.00  14.22\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018338,
                    "execution_time": 0.008241,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003857
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05608,
                    "execution_time": 0.008471,
                    "compile_time": 0.001188,
                    "planning_time": 0.039199
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"STORE\".\"S_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAANJHAAAA      TX        0    43   78.33     0.00  12.53\n1   AAAAAAAAKBBGEAAA      MN        0    58   86.56    19.96  25.74\n2   AAAAAAAAJPCEBAAA      NM        0    44   76.28   385.86  56.24\n3   AAAAAAAAELPKAAAA      NM        0    48   73.89   969.27  36.60\n4   AAAAAAAAGKJBAAAA      NM        0    80  130.71     0.00  34.99\n5   AAAAAAAAGKAFCAAA      MN        0    33   72.36   629.89  61.20\n6   AAAAAAAANIHHCAAA      MN        0    39   88.43     0.00  21.77\n7   AAAAAAAAALDEBAAA      MI        0    42   81.89   191.63  47.94\n8   AAAAAAAAKOJNBAAA      MI        0    61   69.32   185.44  39.82\n9   AAAAAAAAHNLBCAAA      MI        0    49  112.17  1232.60  83.69\n10  AAAAAAAABGODEAAA      SD        0    23   98.67     0.00  66.10\n11  AAAAAAAAFILGBAAA      MN        0    67   74.47     0.00  39.69\n12  AAAAAAAACDMFDAAA      MN        0    60   91.87   186.31  40.76\n13  AAAAAAAANKEHDAAA      MI        0    46  105.74   116.56  67.15\n14  AAAAAAAANHIPDAAA      MI        0    50   43.76   515.16  19.42\n15  AAAAAAAANKKGEAAA      MN        0    57   76.09     0.00  49.78\n16  AAAAAAAACFKIBAAA      MN        0    32   70.67     0.00  38.10\n17  AAAAAAAAEDJMBAAA      SD        0    36   76.40     0.00  51.90\n18  AAAAAAAACDLGEAAA      SD        0    68   63.05     0.00  14.22\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n/*CURSOR_IDENTIFIER*/\n   ) as t",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAALAACDAAA      TX        0    93   33.83     0.00   2.70\n1   AAAAAAAAGLINCAAA      TX        0    14   46.45    60.46  43.19\n2   AAAAAAAAMODHCAAA      MN        0    48   79.24  1532.16  54.90\n3   AAAAAAAAKDJKDAAA      MN        0    79   68.02     0.00  33.18\n4   AAAAAAAAPNKACAAA      NM        0    66  104.51  2613.00  70.76\n5   AAAAAAAAMIKHDAAA      NM        0     2  104.75    20.98  54.46\n6   AAAAAAAAINBAEAAA      MN        0    90   81.46     0.00  17.79\n7   AAAAAAAAGIJKBAAA      MN        0    40   95.31     0.00  61.21\n8   AAAAAAAAANPEAAAA      MI        0    55   72.86     0.00  31.52\n9   AAAAAAAAKJOEAAAA      SD        0    75   54.90     0.00  43.39\n10  AAAAAAAANMBGCAAA      SD        0    74   89.89  1096.80  43.50\n11  AAAAAAAAPPHADAAA      MN        0    44   97.73   284.62  42.30\n12  AAAAAAAAJEPADAAA      MI        0    78   97.62     0.00  10.83\n13  AAAAAAAAMLBPCAAA      MI        0    46   59.91     0.00  33.97\n14  AAAAAAAAHAPFEAAA      MI        0    64   88.12     0.00  13.75\n15  AAAAAAAAGGJGCAAA      MI        0    59   45.72     0.00  31.36\n16  AAAAAAAAGDAEDAAA      MI        0    68   88.61   806.96  40.19\n17  AAAAAAAAIBEICAAA      MN        0    44   96.19     0.00  47.47\n18  AAAAAAAAPNDMDAAA      MN        0    43   61.64   174.76  12.08\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018085,
                    "execution_time": 0.007905,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003936
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018774,
                    "execution_time": 0.008301,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004055
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAALAACDAAA      TX        0    93   33.83     0.00   2.70\n1   AAAAAAAAGLINCAAA      TX        0    14   46.45    60.46  43.19\n2   AAAAAAAAMODHCAAA      MN        0    48   79.24  1532.16  54.90\n3   AAAAAAAAKDJKDAAA      MN        0    79   68.02     0.00  33.18\n4   AAAAAAAAPNKACAAA      NM        0    66  104.51  2613.00  70.76\n5   AAAAAAAAMIKHDAAA      NM        0     2  104.75    20.98  54.46\n6   AAAAAAAAINBAEAAA      MN        0    90   81.46     0.00  17.79\n7   AAAAAAAAGIJKBAAA      MN        0    40   95.31     0.00  61.21\n8   AAAAAAAAANPEAAAA      MI        0    55   72.86     0.00  31.52\n9   AAAAAAAAKJOEAAAA      SD        0    75   54.90     0.00  43.39\n10  AAAAAAAANMBGCAAA      SD        0    74   89.89  1096.80  43.50\n11  AAAAAAAAPPHADAAA      MN        0    44   97.73   284.62  42.30\n12  AAAAAAAAJEPADAAA      MI        0    78   97.62     0.00  10.83\n13  AAAAAAAAMLBPCAAA      MI        0    46   59.91     0.00  33.97\n14  AAAAAAAAHAPFEAAA      MI        0    64   88.12     0.00  13.75\n15  AAAAAAAAGGJGCAAA      MI        0    59   45.72     0.00  31.36\n16  AAAAAAAAGDAEDAAA      MI        0    68   88.61   806.96  40.19\n17  AAAAAAAAIBEICAAA      MN        0    44   96.19     0.00  47.47\n18  AAAAAAAAPNDMDAAA      MN        0    43   61.64   174.76  12.08\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n/*CURSOR_IDENTIFIER*/ select i_item_id, s_state, 0 as g_state, sum(agg1) agg1, sum(agg2) agg2, sum(agg3) agg3, sum(agg4) agg4 from results group by i_item_id, s_state ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , SUM ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.028859,
                    "execution_time": 0.445583,
                    "compile_time": 0.000382,
                    "planning_time": 0.003747,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.129347,
                    "execution_time": 0.486901,
                    "compile_time": 0.002516,
                    "planning_time": 0.05895,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.303753,
                    "execution_time": 0.682996,
                    "compile_time": 0.00055,
                    "planning_time": 0.009713,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.406384,
                    "execution_time": 0.730016,
                    "compile_time": 0.006308,
                    "planning_time": 0.051454,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAACDKJCAAA      MI        0    35  105.09  203.93  49.67\n1   AAAAAAAABCNADAAA      MN        0    64   70.45    0.00  39.75\n2   AAAAAAAAAGDICAAA      MN        0    68   60.11  894.64  42.84\n3   AAAAAAAALJCJAAAA      MN        0    42   93.49    0.00  39.42\n4   AAAAAAAAALBOAAAA      SD        0    25  130.55    0.00  64.85\n5   AAAAAAAABAMJAAAA      SD        0    42   77.54    0.00  14.95\n6   AAAAAAAAEPBCAAAA      MN        0    69  112.31    0.00  67.71\n7   AAAAAAAAMKDPDAAA      MN        0    33   99.49   29.40  41.71\n8   AAAAAAAAMOKMCAAA      MN        0    54   57.45  123.67  52.00\n9   AAAAAAAAMPHLBAAA      MI        0    45   62.44   87.72  19.69\n10  AAAAAAAACJHDBAAA      MI        0    56   94.33  801.06  38.14\n11  AAAAAAAALEPOCAAA      MI        0    43   75.85    0.00  48.57\n12  AAAAAAAAGPGAEAAA      TX        0    56   47.53  562.70  37.43\n13  AAAAAAAAADACDAAA      TX        0    46  118.61    0.00  41.24\n14  AAAAAAAAHNKDBAAA      MI        0    61  114.81  603.40  34.54\n15  AAAAAAAAGCKNAAAA      MN        0    56   17.70    0.00  11.12\n16  AAAAAAAAOKJEDAAA      MN        0    44   50.63  281.98  36.09\n17  AAAAAAAAGKDKDAAA      MN        0    55   68.56  137.52  20.72\n18  AAAAAAAAOKHHAAAA      MN        0    55   75.23   12.56  45.74\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017886,
                    "execution_time": 0.007748,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003971
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055411,
                    "execution_time": 0.008055,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039656
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAACDKJCAAA      MI        0    35  105.09  203.93  49.67\n1   AAAAAAAABCNADAAA      MN        0    64   70.45    0.00  39.75\n2   AAAAAAAAAGDICAAA      MN        0    68   60.11  894.64  42.84\n3   AAAAAAAALJCJAAAA      MN        0    42   93.49    0.00  39.42\n4   AAAAAAAAALBOAAAA      SD        0    25  130.55    0.00  64.85\n5   AAAAAAAABAMJAAAA      SD        0    42   77.54    0.00  14.95\n6   AAAAAAAAEPBCAAAA      MN        0    69  112.31    0.00  67.71\n7   AAAAAAAAMKDPDAAA      MN        0    33   99.49   29.40  41.71\n8   AAAAAAAAMOKMCAAA      MN        0    54   57.45  123.67  52.00\n9   AAAAAAAAMPHLBAAA      MI        0    45   62.44   87.72  19.69\n10  AAAAAAAACJHDBAAA      MI        0    56   94.33  801.06  38.14\n11  AAAAAAAALEPOCAAA      MI        0    43   75.85    0.00  48.57\n12  AAAAAAAAGPGAEAAA      TX        0    56   47.53  562.70  37.43\n13  AAAAAAAAADACDAAA      TX        0    46  118.61    0.00  41.24\n14  AAAAAAAAHNKDBAAA      MI        0    61  114.81  603.40  34.54\n15  AAAAAAAAGCKNAAAA      MN        0    56   17.70    0.00  11.12\n16  AAAAAAAAOKJEDAAA      MN        0    44   50.63  281.98  36.09\n17  AAAAAAAAGKDKDAAA      MN        0    55   68.56  137.52  20.72\n18  AAAAAAAAOKHHAAAA      MN        0    55   75.23   12.56  45.74\n...*/"
    },
    {
        "input": "with /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX', 'MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4)\n/*CURSOR_IDENTIFIER*/\n        from results\n        group by i_item_id\n   )",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.783909,
                    "execution_time": 1.196927,
                    "compile_time": 0.095298,
                    "planning_time": 0.062,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.215503,
                    "execution_time": 1.310504,
                    "compile_time": 8.31379,
                    "planning_time": 0.153539,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_6\" AS \"_COL_6\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1   agg2    agg3  _col_6\n0   AAAAAAAAPIBDEAAA    None        1    40  61.59  349.83   32.19\n1   AAAAAAAAMIPLAAAA    None        1    51  92.81    7.26   40.48\n2   AAAAAAAACAMDDAAA    None        1    59  75.57   47.39   25.25\n3   AAAAAAAAAJMKBAAA    None        1    50  81.70   11.65   42.01\n4   AAAAAAAAILKNBAAA    None        1    45  66.07    1.36   29.34\n5   AAAAAAAAEBEKDAAA    None        1    48  70.93  325.28   44.19\n6   AAAAAAAAGOLAAAAA    None        1    37  81.00   80.02   34.72\n7   AAAAAAAABFBLBAAA    None        1    47  79.87   17.36   36.73\n8   AAAAAAAAKHENDAAA    None        1    45  73.91   33.73   44.61\n9   AAAAAAAAJLKBDAAA    None        1    44  74.12   30.42   49.71\n10  AAAAAAAABNBHDAAA    None        1    43  84.29   85.98   36.38\n11  AAAAAAAAAMGNAAAA    None        1    40  70.88  177.87   29.70\n12  AAAAAAAALMJHBAAA    None        1    43  85.58    0.00   50.90\n13  AAAAAAAADNOICAAA    None        1    49  69.87   11.97   35.78\n14  AAAAAAAAKBCGAAAA    None        1    44  66.85  290.13   29.55\n15  AAAAAAAAONDCDAAA    None        1    42  87.07  195.89   43.79\n16  AAAAAAAAEDHJCAAA    None        1    45  71.36   79.19   35.99\n17  AAAAAAAACEGBBAAA    None        1    55  71.44    1.43   48.97\n18  AAAAAAAAFEDDBAAA    None        1    43  69.40    2.59   38.61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018234,
                    "execution_time": 0.008164,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003881
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056171,
                    "execution_time": 0.008263,
                    "compile_time": 0.001098,
                    "planning_time": 0.039053
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_6\" AS \"_COL_6\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1   agg2    agg3  _col_6\n0   AAAAAAAAPIBDEAAA    None        1    40  61.59  349.83   32.19\n1   AAAAAAAAMIPLAAAA    None        1    51  92.81    7.26   40.48\n2   AAAAAAAACAMDDAAA    None        1    59  75.57   47.39   25.25\n3   AAAAAAAAAJMKBAAA    None        1    50  81.70   11.65   42.01\n4   AAAAAAAAILKNBAAA    None        1    45  66.07    1.36   29.34\n5   AAAAAAAAEBEKDAAA    None        1    48  70.93  325.28   44.19\n6   AAAAAAAAGOLAAAAA    None        1    37  81.00   80.02   34.72\n7   AAAAAAAABFBLBAAA    None        1    47  79.87   17.36   36.73\n8   AAAAAAAAKHENDAAA    None        1    45  73.91   33.73   44.61\n9   AAAAAAAAJLKBDAAA    None        1    44  74.12   30.42   49.71\n10  AAAAAAAABNBHDAAA    None        1    43  84.29   85.98   36.38\n11  AAAAAAAAAMGNAAAA    None        1    40  70.88  177.87   29.70\n12  AAAAAAAALMJHBAAA    None        1    43  85.58    0.00   50.90\n13  AAAAAAAADNOICAAA    None        1    49  69.87   11.97   35.78\n14  AAAAAAAAKBCGAAAA    None        1    44  66.85  290.13   29.55\n15  AAAAAAAAONDCDAAA    None        1    42  87.07  195.89   43.79\n16  AAAAAAAAEDHJCAAA    None        1    45  71.36   79.19   35.99\n17  AAAAAAAACEGBBAAA    None        1    55  71.44    1.43   48.97\n18  AAAAAAAAFEDDBAAA    None        1    43  69.40    2.59   38.61\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\ngroup by i_item_id /*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.669532,
                    "execution_time": 1.171491,
                    "compile_time": 0.000671,
                    "planning_time": 0.063511,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.850092,
                    "execution_time": 1.268555,
                    "compile_time": 0.000659,
                    "planning_time": 0.144218,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1   agg2    agg3   agg4\n0   AAAAAAAAKBHCDAAA    None        1    55  61.71   26.25  34.26\n1   AAAAAAAAKMIOAAAA    None        1    45  67.52  341.88  39.37\n2   AAAAAAAAIDDBEAAA    None        1    50  72.72   24.77  35.37\n3   AAAAAAAADDPEAAAA    None        1    61  74.08  630.31  32.13\n4   AAAAAAAAPAPOCAAA    None        1    51  92.73  509.22  42.58\n5   AAAAAAAAKBECAAAA    None        1    58  77.01  631.09  35.91\n6   AAAAAAAAFLLAEAAA    None        1    62  80.26   69.90  29.60\n7   AAAAAAAAOBBPDAAA    None        1    51  60.26   30.91  26.24\n8   AAAAAAAAEJKHCAAA    None        1    46  65.64  282.30  31.58\n9   AAAAAAAALDNFCAAA    None        1    41  90.86   47.97  47.29\n10  AAAAAAAAOMAECAAA    None        1    56  67.43  104.55  36.00\n11  AAAAAAAAIJHHBAAA    None        1    46  74.40   60.26  35.03\n12  AAAAAAAAIMKCCAAA    None        1    47  71.72  282.51  35.61\n13  AAAAAAAAGAFDAAAA    None        1    54  69.64  221.60  40.51\n14  AAAAAAAACPICCAAA    None        1    50  54.65  343.46  32.77\n15  AAAAAAAAGGDBEAAA    None        1    56  61.09  385.02  40.70\n16  AAAAAAAAELOFDAAA    None        1    47  84.38    0.00  35.75\n17  AAAAAAAANGGDDAAA    None        1    49  67.85   26.47  32.51\n18  AAAAAAAAGDDAEAAA    None        1    51  80.91  126.93  33.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017411,
                    "execution_time": 0.007348,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003845
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053331,
                    "execution_time": 0.007718,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039164
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1   agg2    agg3   agg4\n0   AAAAAAAAKBHCDAAA    None        1    55  61.71   26.25  34.26\n1   AAAAAAAAKMIOAAAA    None        1    45  67.52  341.88  39.37\n2   AAAAAAAAIDDBEAAA    None        1    50  72.72   24.77  35.37\n3   AAAAAAAADDPEAAAA    None        1    61  74.08  630.31  32.13\n4   AAAAAAAAPAPOCAAA    None        1    51  92.73  509.22  42.58\n5   AAAAAAAAKBECAAAA    None        1    58  77.01  631.09  35.91\n6   AAAAAAAAFLLAEAAA    None        1    62  80.26   69.90  29.60\n7   AAAAAAAAOBBPDAAA    None        1    51  60.26   30.91  26.24\n8   AAAAAAAAEJKHCAAA    None        1    46  65.64  282.30  31.58\n9   AAAAAAAALDNFCAAA    None        1    41  90.86   47.97  47.29\n10  AAAAAAAAOMAECAAA    None        1    56  67.43  104.55  36.00\n11  AAAAAAAAIJHHBAAA    None        1    46  74.40   60.26  35.03\n12  AAAAAAAAIMKCCAAA    None        1    47  71.72  282.51  35.61\n13  AAAAAAAAGAFDAAAA    None        1    54  69.64  221.60  40.51\n14  AAAAAAAACPICCAAA    None        1    50  54.65  343.46  32.77\n15  AAAAAAAAGGDBEAAA    None        1    56  61.09  385.02  40.70\n16  AAAAAAAAELOFDAAA    None        1    47  84.38    0.00  35.75\n17  AAAAAAAANGGDDAAA    None        1    49  67.85   26.47  32.51\n18  AAAAAAAAGDDAEAAA    None        1    51  80.91  126.93  33.29\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.243451,
                    "execution_time": 0.600635,
                    "compile_time": 0.000569,
                    "planning_time": 0.009605,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.367858,
                    "execution_time": 0.700773,
                    "compile_time": 0.002464,
                    "planning_time": 0.05112,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAADLEFCAAA      MN        0    36   61.65   11.62  31.79\n1   AAAAAAAAHFAAEAAA      MN        0    64   81.32  669.48  45.08\n2   AAAAAAAACLJDEAAA      SD        0    58   69.70   14.23  36.85\n3   AAAAAAAAIGLHCAAA      NM        0    27  112.64    0.00  28.41\n4   AAAAAAAACABCAAAA      NM        0    84  125.61    0.00  61.20\n5   AAAAAAAALAACAAAA      MI        0    40   79.10    0.00  27.41\n6   AAAAAAAANLHOBAAA      SD        0    64  100.27    0.00  49.50\n7   AAAAAAAADCFMAAAA      MN        0    53   72.56  390.06  33.71\n8   AAAAAAAAEIDEDAAA      MN        0    42   72.33   87.74  28.25\n9   AAAAAAAAOCEFEAAA      MI        0    56   92.14   18.75  46.56\n10  AAAAAAAABADECAAA      MI        0    60   95.96   46.25  48.95\n11  AAAAAAAAJIEJBAAA      MI        0    42   85.17   91.50  37.26\n12  AAAAAAAAGABICAAA      NM        0    34   72.41  246.53  51.35\n13  AAAAAAAAOGKBAAAA      NM        0    38   91.84    0.00  57.90\n14  AAAAAAAAAEOLCAAA      MN        0    43   91.99  256.19  37.78\n15  AAAAAAAALJNICAAA      SD        0    37   65.14    0.00   5.30\n16  AAAAAAAACJNHAAAA      MI        0    60   24.30   24.43  14.97\n17  AAAAAAAAMMJGBAAA      MN        0    68   81.89  377.21  34.37\n18  AAAAAAAANBMKBAAA      MI        0    40   84.57  165.80  38.81\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018062,
                    "execution_time": 0.007786,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004039
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054873,
                    "execution_time": 0.008221,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039428
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAADLEFCAAA      MN        0    36   61.65   11.62  31.79\n1   AAAAAAAAHFAAEAAA      MN        0    64   81.32  669.48  45.08\n2   AAAAAAAACLJDEAAA      SD        0    58   69.70   14.23  36.85\n3   AAAAAAAAIGLHCAAA      NM        0    27  112.64    0.00  28.41\n4   AAAAAAAACABCAAAA      NM        0    84  125.61    0.00  61.20\n5   AAAAAAAALAACAAAA      MI        0    40   79.10    0.00  27.41\n6   AAAAAAAANLHOBAAA      SD        0    64  100.27    0.00  49.50\n7   AAAAAAAADCFMAAAA      MN        0    53   72.56  390.06  33.71\n8   AAAAAAAAEIDEDAAA      MN        0    42   72.33   87.74  28.25\n9   AAAAAAAAOCEFEAAA      MI        0    56   92.14   18.75  46.56\n10  AAAAAAAABADECAAA      MI        0    60   95.96   46.25  48.95\n11  AAAAAAAAJIEJBAAA      MI        0    42   85.17   91.50  37.26\n12  AAAAAAAAGABICAAA      NM        0    34   72.41  246.53  51.35\n13  AAAAAAAAOGKBAAAA      NM        0    38   91.84    0.00  57.90\n14  AAAAAAAAAEOLCAAA      MN        0    43   91.99  256.19  37.78\n15  AAAAAAAALJNICAAA      SD        0    37   65.14    0.00   5.30\n16  AAAAAAAACJNHAAAA      MI        0    60   24.30   24.43  14.97\n17  AAAAAAAAMMJGBAAA      MN        0    68   81.89  377.21  34.37\n18  AAAAAAAANBMKBAAA      MI        0    40   84.57  165.80  38.81\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\nselect NULL AS i_item_id, NULL AS s_state, 2 AS g_state, sum(agg1) agg1, sum(agg2) agg2, sum(agg3) agg3, sum(agg4) agg4 from results\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 2 AS \"G_STATE\" , SUM ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 2 AS \"G_STATE\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.262089,
                    "execution_time": 0.604036,
                    "compile_time": 0.000683,
                    "planning_time": 0.013348,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.726356,
                    "execution_time": 1.036968,
                    "compile_time": 0.003379,
                    "planning_time": 0.055451,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAANIPCCAAA      SD        0    39   77.30     0.00  47.40\n1   AAAAAAAAOGCJBAAA      SD        0    77   93.75  1368.72  52.20\n2   AAAAAAAAOFAMAAAA      MN        0    54   65.54   101.42  33.55\n3   AAAAAAAAMCAJCAAA      TX        0    45   45.61   360.49  27.79\n4   AAAAAAAADAJEAAAA      MN        0    51   52.34   108.70  23.81\n5   AAAAAAAANIPLCAAA      MN        0    24   71.88     0.00  30.87\n6   AAAAAAAAMCBBBAAA      MN        0    52  104.10   974.83  93.68\n7   AAAAAAAAIMKODAAA      MN        0    66   65.36    25.94  45.14\n8   AAAAAAAAAEGFCAAA      MN        0    82   74.49   270.23  47.30\n9   AAAAAAAAMOMBCAAA      MN        0    60   46.23     0.00  38.49\n10  AAAAAAAAEBFGBAAA      MN        0    58   64.63     0.00  18.77\n11  AAAAAAAAOFLJCAAA      SD        0    56   77.66    21.84  21.39\n12  AAAAAAAAFIELDAAA      SD        0    35   66.49   276.60  29.71\n13  AAAAAAAABEGHBAAA      SD        0    45   42.19    34.39  38.76\n14  AAAAAAAAHHHNDAAA      SD        0    72   61.16   166.01  39.19\n15  AAAAAAAAPKKHBAAA      NM        0    48   86.08     0.00  35.52\n16  AAAAAAAAPCIHCAAA      NM        0    70   75.59     0.00  48.69\n17  AAAAAAAAOPBNDAAA      NM        0    58  116.51   404.23  65.10\n18  AAAAAAAAGHHIBAAA      NM        0    16   55.01     0.00  26.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018328,
                    "execution_time": 0.007967,
                    "compile_time": 5e-05,
                    "planning_time": 0.003982
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054109,
                    "execution_time": 0.007895,
                    "compile_time": 5e-05,
                    "planning_time": 0.039708
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAANIPCCAAA      SD        0    39   77.30     0.00  47.40\n1   AAAAAAAAOGCJBAAA      SD        0    77   93.75  1368.72  52.20\n2   AAAAAAAAOFAMAAAA      MN        0    54   65.54   101.42  33.55\n3   AAAAAAAAMCAJCAAA      TX        0    45   45.61   360.49  27.79\n4   AAAAAAAADAJEAAAA      MN        0    51   52.34   108.70  23.81\n5   AAAAAAAANIPLCAAA      MN        0    24   71.88     0.00  30.87\n6   AAAAAAAAMCBBBAAA      MN        0    52  104.10   974.83  93.68\n7   AAAAAAAAIMKODAAA      MN        0    66   65.36    25.94  45.14\n8   AAAAAAAAAEGFCAAA      MN        0    82   74.49   270.23  47.30\n9   AAAAAAAAMOMBCAAA      MN        0    60   46.23     0.00  38.49\n10  AAAAAAAAEBFGBAAA      MN        0    58   64.63     0.00  18.77\n11  AAAAAAAAOFLJCAAA      SD        0    56   77.66    21.84  21.39\n12  AAAAAAAAFIELDAAA      SD        0    35   66.49   276.60  29.71\n13  AAAAAAAABEGHBAAA      SD        0    45   42.19    34.39  38.76\n14  AAAAAAAAHHHNDAAA      SD        0    72   61.16   166.01  39.19\n15  AAAAAAAAPKKHBAAA      NM        0    48   86.08     0.00  35.52\n16  AAAAAAAAPCIHCAAA      NM        0    70   75.59     0.00  48.69\n17  AAAAAAAAOPBNDAAA      NM        0    58  116.51   404.23  65.10\n18  AAAAAAAAGHHIBAAA      NM        0    16   55.01     0.00  26.42\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity as agg1,\n        ss_list_price as agg2,\n        ss_coupon_amt as agg3,\n        ss_sales_price as agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3, avg(agg4) as agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3,\n         avg(agg4) as agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3,\n/*CURSOR_IDENTIFIER*/ avg(agg4) as agg4 from results)",
        "optimize": [
            "SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.070854,
                    "execution_time": 0.971995,
                    "compile_time": 0.000536,
                    "planning_time": 0.061606,
                    "create_size": 10
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.32708,
                    "execution_time": 0.977056,
                    "compile_time": 4.162166,
                    "planning_time": 0.145214,
                    "create_size": 10
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*  i_item_id s_state  g_state  agg1   agg2    agg3  agg4\n0      None    None        1    50  75.79  192.61  37.9*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017054,
                    "execution_time": 0.007041,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003908
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.179191,
                    "execution_time": 0.007821,
                    "compile_time": 0.124661,
                    "planning_time": 0.039366
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*  i_item_id s_state  g_state  agg1   agg2    agg3  agg4\n0      None    None        1    50  75.79  192.61  37.9*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.247869,
                    "execution_time": 0.600243,
                    "compile_time": 0.000684,
                    "planning_time": 0.013065,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.82506,
                    "execution_time": 1.138408,
                    "compile_time": 0.001605,
                    "planning_time": 0.055821,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAMFHGBAAA      MI        0    38   73.36   302.10  11.35\n1   AAAAAAAACIDICAAA      SD        0    39   61.93   447.17  46.84\n2   AAAAAAAAMBHODAAA      SD        0    30  114.50   626.08  74.65\n3   AAAAAAAAOONBEAAA      MN        0    56   92.11   531.46  39.96\n4   AAAAAAAABKENDAAA      SD        0    54   84.86     0.00  56.05\n5   AAAAAAAAOHFODAAA      SD        0    50   54.81     5.74  34.50\n6   AAAAAAAABHCDDAAA      MN        0    51   92.51   429.69  47.37\n7   AAAAAAAAKBACEAAA      MN        0    56   83.64    24.40  29.27\n8   AAAAAAAACNPPCAAA      MN        0    43   90.18     0.00  45.37\n9   AAAAAAAAMEPJAAAA      TX        0    37   74.60   691.35  39.53\n10  AAAAAAAAMAHAEAAA      MN        0    55   63.49    17.76  43.61\n11  AAAAAAAACFKFAAAA      MN        0    42  111.71     0.00  31.73\n12  AAAAAAAAECOIAAAA      SD        0    42   85.51  1343.42  47.34\n13  AAAAAAAAMNEHBAAA      SD        0    54  110.10   319.09  12.29\n14  AAAAAAAAEAEIBAAA      SD        0    66   70.28     0.00  40.36\n15  AAAAAAAAMABCCAAA      SD        0    35   68.21   170.61  34.02\n16  AAAAAAAACJILCAAA      MN        0    71   74.07     6.59  21.58\n17  AAAAAAAAOBGACAAA      MI        0    48   74.61     0.00  51.78\n18  AAAAAAAAPDFPCAAA      SD        0    76   33.79     0.00   7.15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017684,
                    "execution_time": 0.007542,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.00394
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05413,
                    "execution_time": 0.008423,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039323
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAMFHGBAAA      MI        0    38   73.36   302.10  11.35\n1   AAAAAAAACIDICAAA      SD        0    39   61.93   447.17  46.84\n2   AAAAAAAAMBHODAAA      SD        0    30  114.50   626.08  74.65\n3   AAAAAAAAOONBEAAA      MN        0    56   92.11   531.46  39.96\n4   AAAAAAAABKENDAAA      SD        0    54   84.86     0.00  56.05\n5   AAAAAAAAOHFODAAA      SD        0    50   54.81     5.74  34.50\n6   AAAAAAAABHCDDAAA      MN        0    51   92.51   429.69  47.37\n7   AAAAAAAAKBACEAAA      MN        0    56   83.64    24.40  29.27\n8   AAAAAAAACNPPCAAA      MN        0    43   90.18     0.00  45.37\n9   AAAAAAAAMEPJAAAA      TX        0    37   74.60   691.35  39.53\n10  AAAAAAAAMAHAEAAA      MN        0    55   63.49    17.76  43.61\n11  AAAAAAAACFKFAAAA      MN        0    42  111.71     0.00  31.73\n12  AAAAAAAAECOIAAAA      SD        0    42   85.51  1343.42  47.34\n13  AAAAAAAAMNEHBAAA      SD        0    54  110.10   319.09  12.29\n14  AAAAAAAAEAEIBAAA      SD        0    66   70.28     0.00  40.36\n15  AAAAAAAAMABCCAAA      SD        0    35   68.21   170.61  34.02\n16  AAAAAAAACJILCAAA      MN        0    71   74.07     6.59  21.58\n17  AAAAAAAAOBGACAAA      MI        0    48   74.61     0.00  51.78\n18  AAAAAAAAPDFPCAAA      SD        0    76   33.79     0.00   7.15\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAPBMIEAAA      MI        0    50   88.88     8.52  57.85\n1   AAAAAAAAIMNODAAA      MI        0    46  105.24    10.86  74.48\n2   AAAAAAAAOGJPCAAA      MI        0    31   82.27     0.00  54.14\n3   AAAAAAAACNJGBAAA      MI        0    43   91.93     0.00  58.74\n4   AAAAAAAACFMLCAAA      MI        0    60  111.07   569.53  56.92\n5   AAAAAAAAOLNJDAAA      MI        0    49   65.10   276.60  23.64\n6   AAAAAAAADOEGBAAA      NM        0    61   53.49   928.32  27.48\n7   AAAAAAAAOHBAEAAA      MN        0    42   71.84     0.00  39.34\n8   AAAAAAAAMBFFCAAA      MN        0    65   67.70     0.00  34.54\n9   AAAAAAAAJLPIAAAA      MN        0    56   98.50   556.46  50.17\n10  AAAAAAAADNALBAAA      MN        0    29  115.29   205.06  63.67\n11  AAAAAAAAFKCPCAAA      MN        0    56   69.88     0.00  21.02\n12  AAAAAAAAAGEOCAAA      TX        0    40   72.24     0.00  50.38\n13  AAAAAAAAKDMKDAAA      SD        0    44   56.80     0.00   5.11\n14  AAAAAAAABHPCDAAA      SD        0    51   78.44     0.00  22.98\n15  AAAAAAAAKHGIAAAA      MI        0    15   55.83     0.00  23.46\n16  AAAAAAAACABCDAAA      SD        0    40   70.65  1035.86  36.20\n17  AAAAAAAAEMDIBAAA      NM        0    34   73.75    19.50  36.42\n18  AAAAAAAAHNHDEAAA      NM        0    57   41.90    40.61  19.21\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018247,
                    "execution_time": 0.007996,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003952
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018553,
                    "execution_time": 0.007537,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004233
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAPBMIEAAA      MI        0    50   88.88     8.52  57.85\n1   AAAAAAAAIMNODAAA      MI        0    46  105.24    10.86  74.48\n2   AAAAAAAAOGJPCAAA      MI        0    31   82.27     0.00  54.14\n3   AAAAAAAACNJGBAAA      MI        0    43   91.93     0.00  58.74\n4   AAAAAAAACFMLCAAA      MI        0    60  111.07   569.53  56.92\n5   AAAAAAAAOLNJDAAA      MI        0    49   65.10   276.60  23.64\n6   AAAAAAAADOEGBAAA      NM        0    61   53.49   928.32  27.48\n7   AAAAAAAAOHBAEAAA      MN        0    42   71.84     0.00  39.34\n8   AAAAAAAAMBFFCAAA      MN        0    65   67.70     0.00  34.54\n9   AAAAAAAAJLPIAAAA      MN        0    56   98.50   556.46  50.17\n10  AAAAAAAADNALBAAA      MN        0    29  115.29   205.06  63.67\n11  AAAAAAAAFKCPCAAA      MN        0    56   69.88     0.00  21.02\n12  AAAAAAAAAGEOCAAA      TX        0    40   72.24     0.00  50.38\n13  AAAAAAAAKDMKDAAA      SD        0    44   56.80     0.00   5.11\n14  AAAAAAAABHPCDAAA      SD        0    51   78.44     0.00  22.98\n15  AAAAAAAAKHGIAAAA      MI        0    15   55.83     0.00  23.46\n16  AAAAAAAACABCDAAA      SD        0    40   70.65  1035.86  36.20\n17  AAAAAAAAEMDIBAAA      NM        0    34   73.75    19.50  36.42\n18  AAAAAAAAHNHDEAAA      NM        0    57   41.90    40.61  19.21\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA      MI        0    59   67.65   122.77  29.24\n1   AAAAAAAAAAAABAAA      MN        0    41   86.02   159.66  54.68\n2   AAAAAAAAAAAABAAA      SD        0    72   92.69   923.99  39.80\n3   AAAAAAAAAAAABAAA      TX        0    59   24.33     0.00   0.00\n4   AAAAAAAAAAAABAAA    None        1    57   81.36   425.09  40.96\n5   AAAAAAAAAAAACAAA      MI        0    57   98.20     0.00  82.05\n6   AAAAAAAAAAAACAAA      MN        0    41  100.73     0.00  51.02\n7   AAAAAAAAAAAACAAA      SD        0    65   21.42     0.00  13.18\n8   AAAAAAAAAAAACAAA      TX        0    46   62.86     0.00  55.94\n9   AAAAAAAAAAAACAAA    None        1    52   84.45     0.00  59.89\n10  AAAAAAAAAAAAEAAA      MI        0    27  105.06     0.00  25.70\n11  AAAAAAAAAAAAEAAA      MN        0    56  109.77   103.30  75.87\n12  AAAAAAAAAAAAEAAA      NM        0    41    5.84     0.00   4.38\n13  AAAAAAAAAAAAEAAA      SD        0    58   50.26     0.00  46.23\n14  AAAAAAAAAAAAEAAA      TX        0    48   42.89     0.00   4.71\n15  AAAAAAAAAAAAEAAA    None        1    46   87.55    46.95  46.52\n16  AAAAAAAAAAABAAAA      MI        0    21  104.43  1443.93  66.62\n17  AAAAAAAAAAABAAAA      MN        0    55   49.45   301.69  28.95\n18  AAAAAAAAAAABAAAA      NM        0    46   14.48     0.00   6.38\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024385,
                    "execution_time": 0.013495,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.004173
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.388822,
                    "execution_time": 0.013006,
                    "compile_time": 0.339409,
                    "planning_time": 0.03968
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA      MI        0    59   67.65   122.77  29.24\n1   AAAAAAAAAAAABAAA      MN        0    41   86.02   159.66  54.68\n2   AAAAAAAAAAAABAAA      SD        0    72   92.69   923.99  39.80\n3   AAAAAAAAAAAABAAA      TX        0    59   24.33     0.00   0.00\n4   AAAAAAAAAAAABAAA    None        1    57   81.36   425.09  40.96\n5   AAAAAAAAAAAACAAA      MI        0    57   98.20     0.00  82.05\n6   AAAAAAAAAAAACAAA      MN        0    41  100.73     0.00  51.02\n7   AAAAAAAAAAAACAAA      SD        0    65   21.42     0.00  13.18\n8   AAAAAAAAAAAACAAA      TX        0    46   62.86     0.00  55.94\n9   AAAAAAAAAAAACAAA    None        1    52   84.45     0.00  59.89\n10  AAAAAAAAAAAAEAAA      MI        0    27  105.06     0.00  25.70\n11  AAAAAAAAAAAAEAAA      MN        0    56  109.77   103.30  75.87\n12  AAAAAAAAAAAAEAAA      NM        0    41    5.84     0.00   4.38\n13  AAAAAAAAAAAAEAAA      SD        0    58   50.26     0.00  46.23\n14  AAAAAAAAAAAAEAAA      TX        0    48   42.89     0.00   4.71\n15  AAAAAAAAAAAAEAAA    None        1    46   87.55    46.95  46.52\n16  AAAAAAAAAAABAAAA      MI        0    21  104.43  1443.93  66.62\n17  AAAAAAAAAAABAAAA      MN        0    55   49.45   301.69  28.95\n18  AAAAAAAAAAABAAAA      NM        0    46   14.48     0.00   6.38\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA      MI        0    59   67.65   122.77  29.24\n1   AAAAAAAAAAAABAAA      MN        0    41   86.02   159.66  54.68\n2   AAAAAAAAAAAABAAA      SD        0    72   92.69   923.99  39.80\n3   AAAAAAAAAAAABAAA      TX        0    59   24.33     0.00   0.00\n4   AAAAAAAAAAAABAAA    None        1    57   81.36   425.09  40.96\n5   AAAAAAAAAAAACAAA      MI        0    57   98.20     0.00  82.05\n6   AAAAAAAAAAAACAAA      MN        0    41  100.73     0.00  51.02\n7   AAAAAAAAAAAACAAA      SD        0    65   21.42     0.00  13.18\n8   AAAAAAAAAAAACAAA      TX        0    46   62.86     0.00  55.94\n9   AAAAAAAAAAAACAAA    None        1    52   84.45     0.00  59.89\n10  AAAAAAAAAAAAEAAA      MI        0    27  105.06     0.00  25.70\n11  AAAAAAAAAAAAEAAA      MN        0    56  109.77   103.30  75.87\n12  AAAAAAAAAAAAEAAA      NM        0    41    5.84     0.00   4.38\n13  AAAAAAAAAAAAEAAA      SD        0    58   50.26     0.00  46.23\n14  AAAAAAAAAAAAEAAA      TX        0    48   42.89     0.00   4.71\n15  AAAAAAAAAAAAEAAA    None        1    46   87.55    46.95  46.52\n16  AAAAAAAAAAABAAAA      MI        0    21  104.43  1443.93  66.62\n17  AAAAAAAAAAABAAAA      MN        0    55   49.45   301.69  28.95\n18  AAAAAAAAAAABAAAA      NM        0    46   14.48     0.00   6.38\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023942,
                    "execution_time": 0.013449,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.004079
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.024925,
                    "execution_time": 0.013945,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004315
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA      MI        0    59   67.65   122.77  29.24\n1   AAAAAAAAAAAABAAA      MN        0    41   86.02   159.66  54.68\n2   AAAAAAAAAAAABAAA      SD        0    72   92.69   923.99  39.80\n3   AAAAAAAAAAAABAAA      TX        0    59   24.33     0.00   0.00\n4   AAAAAAAAAAAABAAA    None        1    57   81.36   425.09  40.96\n5   AAAAAAAAAAAACAAA      MI        0    57   98.20     0.00  82.05\n6   AAAAAAAAAAAACAAA      MN        0    41  100.73     0.00  51.02\n7   AAAAAAAAAAAACAAA      SD        0    65   21.42     0.00  13.18\n8   AAAAAAAAAAAACAAA      TX        0    46   62.86     0.00  55.94\n9   AAAAAAAAAAAACAAA    None        1    52   84.45     0.00  59.89\n10  AAAAAAAAAAAAEAAA      MI        0    27  105.06     0.00  25.70\n11  AAAAAAAAAAAAEAAA      MN        0    56  109.77   103.30  75.87\n12  AAAAAAAAAAAAEAAA      NM        0    41    5.84     0.00   4.38\n13  AAAAAAAAAAAAEAAA      SD        0    58   50.26     0.00  46.23\n14  AAAAAAAAAAAAEAAA      TX        0    48   42.89     0.00   4.71\n15  AAAAAAAAAAAAEAAA    None        1    46   87.55    46.95  46.52\n16  AAAAAAAAAAABAAAA      MI        0    21  104.43  1443.93  66.62\n17  AAAAAAAAAAABAAAA      MN        0    55   49.45   301.69  28.95\n18  AAAAAAAAAAABAAAA      NM        0    46   14.48     0.00   6.38\n...*/"
    }
]