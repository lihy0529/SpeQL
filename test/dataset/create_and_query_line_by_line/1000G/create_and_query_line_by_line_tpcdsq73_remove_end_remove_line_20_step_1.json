[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n/*CURSOR_IDENTIFIER*/\n          ,count(*) as cnt\n     from store_sales\n     group by ss_ticket_number, ss_customer_sk\n   ) subquery\njoin customer on subquery.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 25.042689,
                    "execution_time": 24.872178,
                    "compile_time": 0.000279,
                    "planning_time": 0.02484,
                    "create_size": 7297
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 32.654849,
                    "execution_time": 32.381765,
                    "compile_time": 0.00029,
                    "planning_time": 0.125295,
                    "create_size": 7297
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0          123960140        604540.0   10\n1          161558960       3247218.0    8\n2           48566608       3111690.0    8\n3           81786205      11816524.0   15\n4           96038938       4754842.0    8\n5          148579264             NaN    3\n6          162973518       6336516.0   11\n7          207091953             NaN    1\n8          235566643             NaN    1\n9          152662934       2688728.0   14\n10         228079871       5659391.0    7\n11         121496821        204369.0   15\n12         169721460       3681153.0    9\n13          28285851             NaN    1\n14          45148017       1222781.0   10\n15          75211144       3958951.0   14\n16         239513818       8652156.0   10\n17          23262741             NaN    1\n18          24080275       1892376.0   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017415,
                    "execution_time": 0.007641,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003534
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057124,
                    "execution_time": 0.008731,
                    "compile_time": 0.001,
                    "planning_time": 0.038869
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", COUNT(*) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0          123960140        604540.0   10\n1          161558960       3247218.0    8\n2           48566608       3111690.0    8\n3           81786205      11816524.0   15\n4           96038938       4754842.0    8\n5          148579264             NaN    3\n6          162973518       6336516.0   11\n7          207091953             NaN    1\n8          235566643             NaN    1\n9          152662934       2688728.0   14\n10         228079871       5659391.0    7\n11         121496821        204369.0   15\n12         169721460       3681153.0    9\n13          28285851             NaN    1\n14          45148017       1222781.0   10\n15          75211144       3958951.0   14\n16         239513818       8652156.0   10\n17          23262741             NaN    1\n18          24080275       1892376.0   12\n...*/"
    },
    {
        "input": "select /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) as cnt\n          from store_sales\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/\n   join customer\n   on ss_customer_sk = c_customer_sk",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.905073,
                    "execution_time": 11.450247,
                    "compile_time": 0.000475,
                    "planning_time": 0.026659,
                    "create_size": 12032
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 24.446547,
                    "execution_time": 23.925017,
                    "compile_time": 0.000469,
                    "planning_time": 0.089886,
                    "create_size": 12032
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Battles         Paul          Dr.                     Y         223744570   12\n1        Mason      Kenneth          Sir                     N          65898210   12\n2        Adams          Wes          Sir                     N         126818911   11\n3        Reyes        David          Dr.                     Y         215657989   11\n4       Carney      Kristen          Ms.                     Y         105315958    8\n5      Manning   Marquerite         Mrs.                     N         153063293   14\n6       Dunlap     Kimberly         Miss                     Y         157962640   14\n7     Harrison      Vincent          Sir                     Y          22767141   13\n8                  Giovanni          Dr.                               113016130   15\n9         Pike      Kathryn         Mrs.                     N         153001453    9\n10         Cox     Margaret         Miss                     N         163549712   11\n11  Mcclintock    Valentine          Mr.                     N          84894127   16\n12                    Bryan          Sir                               139250672   10\n13        Bean        Billy          Mr.                     N         235935311   10\n14      Rogers          Amy          Dr.                     Y         188343169    8\n15        Finn       Rafael          Dr.                     N         206060761   16\n16     Wilkins        Brian          Dr.                     N         195887391    9\n17      Harmon     Virginia          Ms.                     N          50559446    9\n18       Hicks      Michael          Sir                     Y         149371364    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018369,
                    "execution_time": 0.007961,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004063
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055068,
                    "execution_time": 0.008915,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039734
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Battles         Paul          Dr.                     Y         223744570   12\n1        Mason      Kenneth          Sir                     N          65898210   12\n2        Adams          Wes          Sir                     N         126818911   11\n3        Reyes        David          Dr.                     Y         215657989   11\n4       Carney      Kristen          Ms.                     Y         105315958    8\n5      Manning   Marquerite         Mrs.                     N         153063293   14\n6       Dunlap     Kimberly         Miss                     Y         157962640   14\n7     Harrison      Vincent          Sir                     Y          22767141   13\n8                  Giovanni          Dr.                               113016130   15\n9         Pike      Kathryn         Mrs.                     N         153001453    9\n10         Cox     Margaret         Miss                     N         163549712   11\n11  Mcclintock    Valentine          Mr.                     N          84894127   16\n12                    Bryan          Sir                               139250672   10\n13        Bean        Billy          Mr.                     N         235935311   10\n14      Rogers          Amy          Dr.                     Y         188343169    8\n15        Finn       Rafael          Dr.                     N         206060761   16\n16     Wilkins        Brian          Dr.                     N         195887391    9\n17      Harmon     Virginia          Ms.                     N          50559446    9\n18       Hicks      Michael          Sir                     Y         149371364    8\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\"",
                "rewrite": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\"",
                "rewrite": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 35.395125,
                    "execution_time": 35.18271,
                    "compile_time": 0.000416,
                    "planning_time": 0.049317,
                    "create_size": 5888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 35.43773,
                    "execution_time": 35.144466,
                    "compile_time": 0.00042,
                    "planning_time": 0.127991,
                    "create_size": 5888
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.384105,
                    "execution_time": 10.923914,
                    "compile_time": 0.00047,
                    "planning_time": 0.026888,
                    "create_size": 12032
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.495421,
                    "execution_time": 10.96955,
                    "compile_time": 0.00048,
                    "planning_time": 0.087142,
                    "create_size": 12032
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Harbin       Gertie         Miss                     N         228933220   12\n1         Popp      Richard          Mr.                     N          77323346    8\n2         Reed       Edward          Sir                     Y         120884888   15\n3        Moore       Andrew          Dr.                     N          46987714   13\n4                      Paul                                             43596168   12\n5       Gibson       Santos          Dr.                     N          51036808   11\n6       Samson         Toby          Dr.                     N          66025471   12\n7       Rhodes     Herminia         Mrs.                     N         147139461   12\n8        Hooks        James          Sir                     Y         159290816   10\n9        Price         Rose         Mrs.                     Y          44740593    7\n10     Jarrett        Steve          Sir                     N         106191018   10\n11                                                           N          15645303   12\n12       Brown       Albert          Ms.                     Y          55776897    9\n13      Pauley        Jason          Dr.                     N         239926688    9\n14        Wood          Jon          Sir                     Y         110438418   14\n15       White        Roger          Sir                     Y         176830948   15\n16     Chapman        Louis          Sir                     N         236699496   12\n17     Lindsay         Gary          Dr.                     Y          57940808   13\n18    Robinson       Howard          Mr.                     N         182420971    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019928,
                    "execution_time": 0.009152,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004164
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055653,
                    "execution_time": 0.009086,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039907
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Harbin       Gertie         Miss                     N         228933220   12\n1         Popp      Richard          Mr.                     N          77323346    8\n2         Reed       Edward          Sir                     Y         120884888   15\n3        Moore       Andrew          Dr.                     N          46987714   13\n4                      Paul                                             43596168   12\n5       Gibson       Santos          Dr.                     N          51036808   11\n6       Samson         Toby          Dr.                     N          66025471   12\n7       Rhodes     Herminia         Mrs.                     N         147139461   12\n8        Hooks        James          Sir                     Y         159290816   10\n9        Price         Rose         Mrs.                     Y          44740593    7\n10     Jarrett        Steve          Sir                     N         106191018   10\n11                                                           N          15645303   12\n12       Brown       Albert          Ms.                     Y          55776897    9\n13      Pauley        Jason          Dr.                     N         239926688    9\n14        Wood          Jon          Sir                     Y         110438418   14\n15       White        Roger          Sir                     Y         176830948   15\n16     Chapman        Louis          Sir                     N         236699496   12\n17     Lindsay         Gary          Dr.                     Y          57940808   13\n18    Robinson       Howard          Mr.                     N         182420971    9\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 22.631334,
                    "execution_time": 22.415651,
                    "compile_time": 0.000404,
                    "planning_time": 0.052698,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 38.658368,
                    "execution_time": 38.35245,
                    "compile_time": 0.000411,
                    "planning_time": 0.129961,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.200454,
                    "execution_time": 1.742693,
                    "compile_time": 0.0005,
                    "planning_time": 0.026808,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.229214,
                    "execution_time": 1.702089,
                    "compile_time": 0.000473,
                    "planning_time": 0.089806,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                      Sara          Dr.                     N         206798040   13\n1          Cox       Andrew          Dr.                     N         147166321    7\n2          Cox       Andrew          Dr.                     N         155470651    9\n3       Borden         Paul          Sir                     N          91007751   12\n4         Ford      Michael          Mr.                     N         107215837   15\n5                     Jason                                  N         175361296   12\n6         Dunn      Roberto          Sir                     N          37947930   12\n7      Aguilar       Donald          Dr.                     N         237771955    8\n8      Jackson      Heather          Ms.                     Y          97683349   12\n9        Ramos       Joshua          Sir                     N          66756797   15\n10     Clinton    Geraldine         Mrs.                     Y         131617162    9\n11      Burley                                                         215105340   16\n12      Bryant    Elizabeth          Dr.                     Y         156292110    7\n13      Bryant    Elizabeth          Dr.                     Y          44179023   10\n14     Vincent      Dorothy          Ms.                     N         138677091   11\n15      Ludwig       Gerald          Dr.                     N         141254645    9\n16      Glaser         Ruth          Dr.                     N         122482187    7\n17   Pendleton      Patrick          Sir                     N         218353426   15\n18       Dewey       Joanne         Mrs.                     Y         160901313    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018312,
                    "execution_time": 0.007746,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004077
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056932,
                    "execution_time": 0.008152,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.039711
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                      Sara          Dr.                     N         206798040   13\n1          Cox       Andrew          Dr.                     N         147166321    7\n2          Cox       Andrew          Dr.                     N         155470651    9\n3       Borden         Paul          Sir                     N          91007751   12\n4         Ford      Michael          Mr.                     N         107215837   15\n5                     Jason                                  N         175361296   12\n6         Dunn      Roberto          Sir                     N          37947930   12\n7      Aguilar       Donald          Dr.                     N         237771955    8\n8      Jackson      Heather          Ms.                     Y          97683349   12\n9        Ramos       Joshua          Sir                     N          66756797   15\n10     Clinton    Geraldine         Mrs.                     Y         131617162    9\n11      Burley                                                         215105340   16\n12      Bryant    Elizabeth          Dr.                     Y         156292110    7\n13      Bryant    Elizabeth          Dr.                     Y          44179023   10\n14     Vincent      Dorothy          Ms.                     N         138677091   11\n15      Ludwig       Gerald          Dr.                     N         141254645    9\n16      Glaser         Ruth          Dr.                     N         122482187    7\n17   Pendleton      Patrick          Sir                     N         218353426   15\n18       Dewey       Joanne         Mrs.                     Y         160901313    9\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n/*CURSOR_IDENTIFIER*/\n    household_demographics.hd_buy_potential = '1001-1500')\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 20.933709,
                    "execution_time": 20.708009,
                    "compile_time": 0.000421,
                    "planning_time": 0.062867,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 27.774902,
                    "execution_time": 27.477145,
                    "compile_time": 0.000428,
                    "planning_time": 0.12913,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0          150020692         8758295   15\n1          217257921         5334904   11\n2          157301127        10018261    5\n3          135033602         3542593   11\n4           89920090         2581244   14\n5          134894215         2543840   10\n6          120096303         4301027   15\n7          134908041         4661039   12\n8             108346         6764506   11\n9          217372547        11469464   15\n10         157432954          481928   11\n11          74894783        11944415    9\n12         232666182         2201644   14\n13         224941550        11411992    8\n14          52933879         6724051   11\n15          60446324         7174141    8\n16          45182248         9132314   14\n17          82992274         1713498   11\n18          75240555         3545715    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017768,
                    "execution_time": 0.008013,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003578
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056083,
                    "execution_time": 0.008571,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038938
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", COUNT(*) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON (\"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000') AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0          150020692         8758295   15\n1          217257921         5334904   11\n2          157301127        10018261    5\n3          135033602         3542593   11\n4           89920090         2581244   14\n5          134894215         2543840   10\n6          120096303         4301027   15\n7          134908041         4661039   12\n8             108346         6764506   11\n9          217372547        11469464   15\n10         157432954          481928   11\n11          74894783        11944415    9\n12         232666182         2201644   14\n13         224941550        11411992    8\n14          52933879         6724051   11\n15          60446324         7174141    8\n16          45182248         9132314   14\n17          82992274         1713498   11\n18          75240555         3545715    9\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 20.957657,
                    "execution_time": 20.731622,
                    "compile_time": 0.000422,
                    "planning_time": 0.051476,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 27.754041,
                    "execution_time": 27.455235,
                    "compile_time": 0.000429,
                    "planning_time": 0.130799,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.435663,
                    "execution_time": 0.981954,
                    "compile_time": 0.000493,
                    "planning_time": 0.026388,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.507009,
                    "execution_time": 0.979729,
                    "compile_time": 0.000478,
                    "planning_time": 0.088429,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Stephenson         Jane         Mrs.                     Y          16410023   13\n1   Stephenson         Jane         Mrs.                     Y          19916726    9\n2         Thao       Dollie          Ms.                     N         210186249   14\n3       Newman    Catherine          Dr.                     N         218605412    7\n4          Lee        Ricky          Dr.                     Y          21102862   15\n5          Lee        Ricky          Dr.                     Y         117363822   10\n6          Lee        Ricky          Dr.                     Y         163853323   15\n7          Lee        Ricky          Dr.                     Y         164380198    9\n8    Hernandez      Barbara         Miss                     Y           3262588   11\n9    Hernandez      Barbara         Miss                     Y          91217527   13\n10    Martinez       Walter          Sir                     Y         113360685   12\n11     Guevara     Lawrence          Mr.                     N          67669613   13\n12      Palmer     Fletcher          Mr.                     Y         161473873    8\n13    Williams        Julia          Dr.                     N         177223181   14\n14       Lyons       Robert          Mr.                     Y           7845328   11\n15  Cunningham        Henry          Sir                     Y         132674582   10\n16  Cunningham        Henry          Sir                     Y         197298917    9\n17                    James          Mr.                     N            397774   14\n18       Cooks       Robert          Sir                     Y          77845768   13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018255,
                    "execution_time": 0.00777,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004078
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057071,
                    "execution_time": 0.008297,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039828
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Stephenson         Jane         Mrs.                     Y          16410023   13\n1   Stephenson         Jane         Mrs.                     Y          19916726    9\n2         Thao       Dollie          Ms.                     N         210186249   14\n3       Newman    Catherine          Dr.                     N         218605412    7\n4          Lee        Ricky          Dr.                     Y          21102862   15\n5          Lee        Ricky          Dr.                     Y         117363822   10\n6          Lee        Ricky          Dr.                     Y         163853323   15\n7          Lee        Ricky          Dr.                     Y         164380198    9\n8    Hernandez      Barbara         Miss                     Y           3262588   11\n9    Hernandez      Barbara         Miss                     Y          91217527   13\n10    Martinez       Walter          Sir                     Y         113360685   12\n11     Guevara     Lawrence          Mr.                     N          67669613   13\n12      Palmer     Fletcher          Mr.                     Y         161473873    8\n13    Williams        Julia          Dr.                     N         177223181   14\n14       Lyons       Robert          Mr.                     Y           7845328   11\n15  Cunningham        Henry          Sir                     Y         132674582   10\n16  Cunningham        Henry          Sir                     Y         197298917    9\n17                    James          Mr.                     N            397774   14\n18       Cooks       Robert          Sir                     Y          77845768   13\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 20.937302,
                    "execution_time": 20.720841,
                    "compile_time": 0.00043,
                    "planning_time": 0.052832,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 26.983999,
                    "execution_time": 26.688428,
                    "compile_time": 0.000435,
                    "planning_time": 0.127698,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.296949,
                    "execution_time": 0.836197,
                    "compile_time": 0.000486,
                    "planning_time": 0.026649,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 36.356222,
                    "execution_time": 0.870406,
                    "compile_time": 0.000482,
                    "planning_time": 35.046379,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Morris        Frank          Mr.                     N         133715441   11\n1        Morris        Frank          Mr.                     N          26037039   10\n2      Sandoval         Rich          Mr.                     N         130595017   10\n3      Sandoval         Rich          Mr.                     N          20398661   14\n4          Hall       Theron          Sir                     Y          69462316    8\n5      Martinez         Jane         Miss                     N         121264161   15\n6          Mann        Ricky          Dr.                     Y          50033030   13\n7          Mann        Ricky          Dr.                     Y         206168922   13\n8        Nguyen          Eva          Ms.                     N          44719049   12\n9         Davis       Darryl          Dr.                     Y          58394166    9\n10       Whalen       Regina         Miss                                17317897   10\n11       Watson        David          Mr.                     N         218059439    8\n12  Christensen        Irene          Ms.                     N         190389194    9\n13          Fox      Everett          Dr.                     Y         155428561    7\n14        Wiles      Douglas          Mr.                     N          98820457   10\n15                                    Sir                     Y         192065769   11\n16        Morse      Janette         Mrs.                     Y          24688949   11\n17     Williams       Isidro          Dr.                     Y         209992471   12\n18       Flores      Kristin         Miss                     Y          96774758    6\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019215,
                    "execution_time": 0.008304,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.00428
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057219,
                    "execution_time": 0.00803,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040038
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Morris        Frank          Mr.                     N         133715441   11\n1        Morris        Frank          Mr.                     N          26037039   10\n2      Sandoval         Rich          Mr.                     N         130595017   10\n3      Sandoval         Rich          Mr.                     N          20398661   14\n4          Hall       Theron          Sir                     Y          69462316    8\n5      Martinez         Jane         Miss                     N         121264161   15\n6          Mann        Ricky          Dr.                     Y          50033030   13\n7          Mann        Ricky          Dr.                     Y         206168922   13\n8        Nguyen          Eva          Ms.                     N          44719049   12\n9         Davis       Darryl          Dr.                     Y          58394166    9\n10       Whalen       Regina         Miss                                17317897   10\n11       Watson        David          Mr.                     N         218059439    8\n12  Christensen        Irene          Ms.                     N         190389194    9\n13          Fox      Everett          Dr.                     Y         155428561    7\n14        Wiles      Douglas          Mr.                     N          98820457   10\n15                                    Sir                     Y         192065769   11\n16        Morse      Janette         Mrs.                     Y          24688949   11\n17     Williams       Isidro          Dr.                     Y         209992471   12\n18       Flores      Kristin         Miss                     Y          96774758    6\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt \nfrom\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    group by ss_ticket_number, ss_customer_sk\n   ) subquery\njoin customer\non subquery.ss_customer_sk = customer.c_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Norfleet       Arthur         Mrs.                     N         105772295   12\n1      Norfleet       Arthur         Mrs.                     N         201937946    9\n2          King        Tonya         Miss                     N         195812774    7\n3        Berger     Kimberly         Miss                     Y         134087844    9\n4       Dunaway         Alan          Mr.                     N         152677658   12\n5       Ramirez          Ira          Mr.                     Y         212712730    8\n6      Melendez        Betty          Dr.                     N          11231916    8\n7         Lyons       Robert          Mr.                     Y         150823391    8\n8       Burgess         Gene          Sir                     N          88904415   10\n9   Southerland        Roger          Mr.                     N         203963704   15\n10        Xiong     Samantha         Miss                     Y          38188307   11\n11       Barker        Jaime          Sir                     Y          66294605    8\n12       Barker        Jaime          Sir                     Y         137892460   13\n13         Ward      Natalie          Ms.                     Y         231107784    9\n14         Ward      Natalie          Ms.                     Y         152456783    8\n15        Casas       Bryant          Sir                     Y          52797753   14\n16     Cardenas    Francisca         Miss                     Y         218140972   11\n17         Bass       Renato          Mr.                     Y          42232593    9\n18         King     Mercedes          Dr.                     N          92648672   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019072,
                    "execution_time": 0.008348,
                    "compile_time": 5e-05,
                    "planning_time": 0.004143
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054261,
                    "execution_time": 0.008523,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039181
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Norfleet       Arthur         Mrs.                     N         105772295   12\n1      Norfleet       Arthur         Mrs.                     N         201937946    9\n2          King        Tonya         Miss                     N         195812774    7\n3        Berger     Kimberly         Miss                     Y         134087844    9\n4       Dunaway         Alan          Mr.                     N         152677658   12\n5       Ramirez          Ira          Mr.                     Y         212712730    8\n6      Melendez        Betty          Dr.                     N          11231916    8\n7         Lyons       Robert          Mr.                     Y         150823391    8\n8       Burgess         Gene          Sir                     N          88904415   10\n9   Southerland        Roger          Mr.                     N         203963704   15\n10        Xiong     Samantha         Miss                     Y          38188307   11\n11       Barker        Jaime          Sir                     Y          66294605    8\n12       Barker        Jaime          Sir                     Y         137892460   13\n13         Ward      Natalie          Ms.                     Y         231107784    9\n14         Ward      Natalie          Ms.                     Y         152456783    8\n15        Casas       Bryant          Sir                     Y          52797753   14\n16     Cardenas    Francisca         Miss                     Y         218140972   11\n17         Bass       Renato          Mr.                     Y          42232593    9\n18         King     Mercedes          Dr.                     N          92648672   12\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 20.910492,
                    "execution_time": 20.693306,
                    "compile_time": 0.000417,
                    "planning_time": 0.053312,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 27.756726,
                    "execution_time": 27.439257,
                    "compile_time": 0.000444,
                    "planning_time": 0.135829,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.212351,
                    "execution_time": 0.754432,
                    "compile_time": 0.000451,
                    "planning_time": 0.030026,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.233145,
                    "execution_time": 0.712298,
                    "compile_time": 0.000467,
                    "planning_time": 0.088222,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Peterman        Cecil          Mr.                     Y          74695850    7\n1        Chapa      Marilyn         Miss                     Y          61320241   12\n2          Lee                       Sir                     Y         193219286   13\n3         Hill       Andrea          Dr.                     N          49067697   11\n4      Mercado       Leanne         Miss                     Y         224869637   10\n5        Hayes       Darren          Dr.                     Y         163173392   12\n6   Scarbrough       Angela          Dr.                     N          99436285   12\n7         Hale          Ann         Mrs.                     Y           2190781   16\n8        Hurst         Lois         Miss                     Y          94198512   14\n9       Keller          Ian          Dr.                     N         127152375    8\n10       Sweet        Harry          Mr.                     N          81415232   13\n11     Fleming      Timothy          Dr.                     Y          40149962    9\n12    Williams       Lorena         Miss                     Y         101933327   15\n13     Fischer        Susan         Mrs.                     Y          17296011   10\n14       Hanna         Kate         Mrs.                     Y         118862334    9\n15      Creech                       Mr.                     Y         106940504   11\n16      Burton      Richard          Dr.                     Y         203931708    7\n17       Smith        Janet                                            146592952   13\n18       Baird       Louise         Mrs.                     N          56119108    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018274,
                    "execution_time": 0.007505,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004265
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057635,
                    "execution_time": 0.00858,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.039918
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Peterman        Cecil          Mr.                     Y          74695850    7\n1        Chapa      Marilyn         Miss                     Y          61320241   12\n2          Lee                       Sir                     Y         193219286   13\n3         Hill       Andrea          Dr.                     N          49067697   11\n4      Mercado       Leanne         Miss                     Y         224869637   10\n5        Hayes       Darren          Dr.                     Y         163173392   12\n6   Scarbrough       Angela          Dr.                     N          99436285   12\n7         Hale          Ann         Mrs.                     Y           2190781   16\n8        Hurst         Lois         Miss                     Y          94198512   14\n9       Keller          Ian          Dr.                     N         127152375    8\n10       Sweet        Harry          Mr.                     N          81415232   13\n11     Fleming      Timothy          Dr.                     Y          40149962    9\n12    Williams       Lorena         Miss                     Y         101933327   15\n13     Fischer        Susan         Mrs.                     Y          17296011   10\n14       Hanna         Kate         Mrs.                     Y         118862334    9\n15      Creech                       Mr.                     Y         106940504   11\n16      Burton      Richard          Dr.                     Y         203931708    7\n17       Smith        Janet                                            146592952   13\n18       Baird       Louise         Mrs.                     N          56119108    9\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.273863,
                    "execution_time": 1.056067,
                    "compile_time": 0.000423,
                    "planning_time": 0.054315,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.526724,
                    "execution_time": 4.992005,
                    "compile_time": 4.226612,
                    "planning_time": 0.139482,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.088853,
                    "execution_time": 0.631839,
                    "compile_time": 0.000472,
                    "planning_time": 0.027935,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.162067,
                    "execution_time": 0.634924,
                    "compile_time": 0.000456,
                    "planning_time": 0.092563,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Ingram        Irvin          Dr.                     Y         162655529    6\n1          Cox       Andrew          Dr.                     N         155470651    9\n2      Jackson      Heather          Ms.                     Y          97683349   12\n3        Dewey       Joanne         Mrs.                     Y         160901313    9\n4          Ott    Elizabeth          Ms.                     N         167403866   11\n5     Robinson       Thomas          Sir                     N          51171121   13\n6       Joseph       Ronald          Sir                     Y         202823431   13\n7      Rosales      Shantel          Dr.                     N         133436196   15\n8        Jones        Donna          Ms.                     N          77794419   14\n9     Sullivan        David          Mr.                     Y         110202488   12\n10       Moore      Charles          Sir                     Y          32233171    8\n11        Gray          Ann          Dr.                     N         167096031   14\n12     Lanning      Brandon          Dr.                     N          65085441   13\n13     Dickson         Faye         Mrs.                     N          27377438   14\n14     Mickens        Casey          Sir                     N         131887865   13\n15   Castaneda        Helen          Dr.                     N         203749923    8\n16      Henson      Zachary          Sir                     N         221065880   10\n17       Price       Robert          Dr.                     Y         142504488    9\n18        Bell     Veronica         Mrs.                     Y          59563240    7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018873,
                    "execution_time": 0.008006,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004292
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057009,
                    "execution_time": 0.008134,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.040051
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Ingram        Irvin          Dr.                     Y         162655529    6\n1          Cox       Andrew          Dr.                     N         155470651    9\n2      Jackson      Heather          Ms.                     Y          97683349   12\n3        Dewey       Joanne         Mrs.                     Y         160901313    9\n4          Ott    Elizabeth          Ms.                     N         167403866   11\n5     Robinson       Thomas          Sir                     N          51171121   13\n6       Joseph       Ronald          Sir                     Y         202823431   13\n7      Rosales      Shantel          Dr.                     N         133436196   15\n8        Jones        Donna          Ms.                     N          77794419   14\n9     Sullivan        David          Mr.                     Y         110202488   12\n10       Moore      Charles          Sir                     Y          32233171    8\n11        Gray          Ann          Dr.                     N         167096031   14\n12     Lanning      Brandon          Dr.                     N          65085441   13\n13     Dickson         Faye         Mrs.                     N          27377438   14\n14     Mickens        Casey          Sir                     N         131887865   13\n15   Castaneda        Helen          Dr.                     N         203749923    8\n16      Henson      Zachary          Sir                     N         221065880   10\n17       Price       Robert          Dr.                     Y         142504488    9\n18        Bell     Veronica         Mrs.                     Y          59563240    7\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.922857,
                    "execution_time": 0.684541,
                    "compile_time": 0.081889,
                    "planning_time": 0.056159,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 18.255114,
                    "execution_time": 14.440771,
                    "compile_time": 3.560522,
                    "planning_time": 0.137304,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.496998,
                    "execution_time": 0.260379,
                    "compile_time": 0.000338,
                    "planning_time": 0.026913,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.563414,
                    "execution_time": 0.259346,
                    "compile_time": 0.000345,
                    "planning_time": 0.089781,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Mcdaniel    Catherine          Ms.                     Y          46678833   10\n1        Tracy      William          Dr.                     N          70819752    8\n2        Beach       Walter          Dr.                     Y         172465606    9\n3     Baughman     Florence         Mrs.                     Y         175537692   13\n4        Reyes       Ernest          Dr.                     Y         140926326   11\n5      Aguilar          Ali          Ms.                     N          58368016   12\n6    Rasmussen       Arthur          Dr.                     Y          63084728    9\n7        Davis       Angela         Mrs.                     Y          61597575   10\n8       Hansen         Lisa         Mrs.                     N          90527871   10\n9      Knudson      Ethelyn          Dr.                     Y         191932336    6\n10      Martin     Lorraine         Mrs.                     Y           9925038   13\n11        Rich      Melissa          Dr.                     N          49830831   12\n12       Moore      Imogene         Miss                     Y          63343077   13\n13      Conway       Jeremy          Dr.                     N          72643438    9\n14      Atkins    Ernestine         Mrs.                     Y         179614949    7\n15      Mcghee     Samantha          Dr.                     N           8958058    8\n16      Newman      Armando          Sir                     Y         194774269   12\n17     Borders        Ricky          Sir                     N          13234144   11\n18       Brown         Ruth         Miss                     N          45555415    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01828,
                    "execution_time": 0.007645,
                    "compile_time": 5e-05,
                    "planning_time": 0.004203
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055491,
                    "execution_time": 0.007839,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039608
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Mcdaniel    Catherine          Ms.                     Y          46678833   10\n1        Tracy      William          Dr.                     N          70819752    8\n2        Beach       Walter          Dr.                     Y         172465606    9\n3     Baughman     Florence         Mrs.                     Y         175537692   13\n4        Reyes       Ernest          Dr.                     Y         140926326   11\n5      Aguilar          Ali          Ms.                     N          58368016   12\n6    Rasmussen       Arthur          Dr.                     Y          63084728    9\n7        Davis       Angela         Mrs.                     Y          61597575   10\n8       Hansen         Lisa         Mrs.                     N          90527871   10\n9      Knudson      Ethelyn          Dr.                     Y         191932336    6\n10      Martin     Lorraine         Mrs.                     Y           9925038   13\n11        Rich      Melissa          Dr.                     N          49830831   12\n12       Moore      Imogene         Miss                     Y          63343077   13\n13      Conway       Jeremy          Dr.                     N          72643438    9\n14      Atkins    Ernestine         Mrs.                     Y         179614949    7\n15      Mcghee     Samantha          Dr.                     N           8958058    8\n16      Newman      Armando          Sir                     Y         194774269   12\n17     Borders        Ricky          Sir                     N          13234144   11\n18       Brown         Ruth         Miss                     N          45555415    8\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.121495,
                    "execution_time": 0.049397,
                    "compile_time": 0.000248,
                    "planning_time": 0.003293,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.186981,
                    "execution_time": 0.052626,
                    "compile_time": 0.001382,
                    "planning_time": 0.06018,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Reynolds      Kathryn          Ms.                     Y         149360466    9\n1     Reynolds      Kathryn          Ms.                     Y         192100442    9\n2     Reynolds      Kathryn          Ms.                     Y         202185703    8\n3     Reynolds      Kathryn          Ms.                     Y          52204694   16\n4     Reynolds      Kathryn          Ms.                     Y          74532780   13\n5     Reynolds      Kathryn          Ms.                     Y          49147317    9\n6     Reynolds      Kathryn          Ms.                     Y          79199630   11\n7     Reynolds      Kathryn          Ms.                     Y         184304174   12\n8     Reynolds      Kathryn          Ms.                     Y         206961422   10\n9     Reynolds      Kathryn          Ms.                     Y          74673571    6\n10    Reynolds      Kathryn          Ms.                     Y         226462517   13\n11    Reynolds      Kathryn          Ms.                     Y         100191755   12\n12    Reynolds      Kathryn          Ms.                     Y          77544262   15\n13    Reynolds      Kathryn          Ms.                     Y         234112715   12\n14    Reynolds      Kathryn          Ms.                     Y         151646200   13\n15    Reynolds      Kathryn          Ms.                     Y          54132385   12\n16    Reynolds      Kathryn          Ms.                     Y         144145303   13\n17    Reynolds      Kathryn          Ms.                     Y         166651224   14\n18    Reynolds      Kathryn          Ms.                     Y         151676728    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.047071,
                    "execution_time": 0.014082,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.025404
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.194459,
                    "execution_time": 0.082101,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.090766
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Reynolds      Kathryn          Ms.                     Y         149360466    9\n1     Reynolds      Kathryn          Ms.                     Y         192100442    9\n2     Reynolds      Kathryn          Ms.                     Y         202185703    8\n3     Reynolds      Kathryn          Ms.                     Y          52204694   16\n4     Reynolds      Kathryn          Ms.                     Y          74532780   13\n5     Reynolds      Kathryn          Ms.                     Y          49147317    9\n6     Reynolds      Kathryn          Ms.                     Y          79199630   11\n7     Reynolds      Kathryn          Ms.                     Y         184304174   12\n8     Reynolds      Kathryn          Ms.                     Y         206961422   10\n9     Reynolds      Kathryn          Ms.                     Y          74673571    6\n10    Reynolds      Kathryn          Ms.                     Y         226462517   13\n11    Reynolds      Kathryn          Ms.                     Y         100191755   12\n12    Reynolds      Kathryn          Ms.                     Y          77544262   15\n13    Reynolds      Kathryn          Ms.                     Y         234112715   12\n14    Reynolds      Kathryn          Ms.                     Y         151646200   13\n15    Reynolds      Kathryn          Ms.                     Y          54132385   12\n16    Reynolds      Kathryn          Ms.                     Y         144145303   13\n17    Reynolds      Kathryn          Ms.                     Y         166651224   14\n18    Reynolds      Kathryn          Ms.                     Y         151676728    8\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Booth        Melva          Dr.                     N         184618742    9\n1       Sasser      Melonie         Mrs.                     Y          48527787    8\n2      Killian        Jacob          Sir                     Y         126281752    8\n3     Robinson        Craig          Dr.                     N          81898116    9\n4       Jacoby        David          Mr.                     Y         137872019   10\n5      Mendoza      Jeffrey          Dr.                     N          44138339   12\n6                                    Sir                     Y         192065769   11\n7        Jones     Virginia         Mrs.                     Y         215992987   15\n8     Bartlett      Clinton          Sir                     N          28844704   10\n9         Hurt      Leonard          Mr.                     N         211396129   13\n10                      Jim                                             95860523   10\n11      Norton        Rosie          Ms.                     N         141147920   10\n12       House        Diana          Ms.                     Y         136068686   13\n13       Price       Regina         Mrs.                     Y         230538120   11\n14      Wright        Rosie         Mrs.                     Y          72485032   13\n15        Tran        Betty         Miss                     Y         217968028   10\n16       Bravo        James          Mr.                     Y         113021255   11\n17       Elder       Judith         Miss                     N          18103950    8\n18      Bunker          Jay          Dr.                     N         172699128   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024378,
                    "execution_time": 0.01421,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00393
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053431,
                    "execution_time": 0.007786,
                    "compile_time": 5e-05,
                    "planning_time": 0.039193
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Booth        Melva          Dr.                     N         184618742    9\n1       Sasser      Melonie         Mrs.                     Y          48527787    8\n2      Killian        Jacob          Sir                     Y         126281752    8\n3     Robinson        Craig          Dr.                     N          81898116    9\n4       Jacoby        David          Mr.                     Y         137872019   10\n5      Mendoza      Jeffrey          Dr.                     N          44138339   12\n6                                    Sir                     Y         192065769   11\n7        Jones     Virginia         Mrs.                     Y         215992987   15\n8     Bartlett      Clinton          Sir                     N          28844704   10\n9         Hurt      Leonard          Mr.                     N         211396129   13\n10                      Jim                                             95860523   10\n11      Norton        Rosie          Ms.                     N         141147920   10\n12       House        Diana          Ms.                     Y         136068686   13\n13       Price       Regina         Mrs.                     Y         230538120   11\n14      Wright        Rosie         Mrs.                     Y          72485032   13\n15        Tran        Betty         Miss                     Y         217968028   10\n16       Bravo        James          Mr.                     Y         113021255   11\n17       Elder       Judith         Miss                     N          18103950    8\n18      Bunker          Jay          Dr.                     N         172699128   12\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\" WHERE \"DJ\".\"CNT\" <= 5 AND \"DJ\".\"CNT\" >= 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.07015,
                    "execution_time": 0.038292,
                    "compile_time": 0.000256,
                    "planning_time": 0.00513,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.304996,
                    "execution_time": 0.208917,
                    "compile_time": 0.001428,
                    "planning_time": 0.062898,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Hunter       Ronald          Sir                     N          55061916    5\n1       Harvey         John          Sir                     Y         194023485    5\n2        Klein        Joyce          Ms.                     N          81074491    5\n3       Orozco     Sharonda         Mrs.                     Y         151921247    5\n4       Obrien        Edwin          Dr.                     N         116353070    5\n5         Moss        Rocio          Dr.                     Y         179844345    5\n6     Triplett      Carolyn          Ms.                     N         193981153    5\n7      Webster         John          Mr.                     Y         141765816    5\n8       Phelps      Michael          Sir                     N          46531654    4\n9      Matheny      Michael          Dr.                     Y          15624695    5\n10       Wyman        David          Sir                     Y         127348078    5\n11    Hatfield      Charles          Sir                     N          20303592    3\n12      Sierra       Robert          Sir                     N         195592541    5\n13   Hutchison      Linwood          Mr.                     N         197751822    5\n14       Perez        James          Mr.                     N          32520106    4\n15   Stapleton        Doris          Dr.                     Y          81528491    5\n16      Farrar        Marie          Ms.                     N         135964599    5\n17      Lawson       German          Dr.                     N         141182575    5\n18   Rosenbaum         Jose          Sir                     Y          37446944    5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019041,
                    "execution_time": 0.008051,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004198
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05493,
                    "execution_time": 0.007394,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039607
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" >= 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Hunter       Ronald          Sir                     N          55061916    5\n1       Harvey         John          Sir                     Y         194023485    5\n2        Klein        Joyce          Ms.                     N          81074491    5\n3       Orozco     Sharonda         Mrs.                     Y         151921247    5\n4       Obrien        Edwin          Dr.                     N         116353070    5\n5         Moss        Rocio          Dr.                     Y         179844345    5\n6     Triplett      Carolyn          Ms.                     N         193981153    5\n7      Webster         John          Mr.                     Y         141765816    5\n8       Phelps      Michael          Sir                     N          46531654    4\n9      Matheny      Michael          Dr.                     Y          15624695    5\n10       Wyman        David          Sir                     Y         127348078    5\n11    Hatfield      Charles          Sir                     N          20303592    3\n12      Sierra       Robert          Sir                     N         195592541    5\n13   Hutchison      Linwood          Mr.                     N         197751822    5\n14       Perez        James          Mr.                     N          32520106    4\n15   Stapleton        Doris          Dr.                     Y          81528491    5\n16      Farrar        Marie          Ms.                     N         135964599    5\n17      Lawson       German          Dr.                     N         141182575    5\n18   Rosenbaum         Jose          Sir                     Y          37446944    5\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\" WHERE \"DJ\".\"CNT\" <= 5 AND \"DJ\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC , \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y          94428716    5\n1                                                            N         189395825    5\n2                      Kirk          Sir                               234769290    5\n3                     Mario                                            166100789    5\n4                     Cindy          Dr.                     Y         121133692    5\n5                       Sam                                  Y          61573910    5\n6                   Destiny         Mrs.                               173271174    5\n7                                                            N         168163141    5\n8        Aaron      Darlene          Ms.                     Y         204812784    5\n9         Adam       Gerard          Dr.                     Y         212266734    5\n10       Adams       Ramiro          Sir                     N         127248956    5\n11        Akin      Bernice         Mrs.                     N         212639465    5\n12    Albrecht         Paul          Dr.                     N           2956217    5\n13     Anthony     Nicholas          Mr.                     Y         128437699    5\n14      Aragon        Amber          Dr.                     Y         190607209    5\n15      Archer      Blanche          Ms.                     Y         108800056    5\n16        Ault       Martin          Dr.                     N          95974624    5\n17      Bailey         John          Mr.                     N         186983461    5\n18       Baker  Christopher          Sir                     N          50097993    5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022037,
                    "execution_time": 0.010074,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.005216
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.223549,
                    "execution_time": 0.010718,
                    "compile_time": 0.162377,
                    "planning_time": 0.041019
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y          94428716    5\n1                                                            N         189395825    5\n2                      Kirk          Sir                               234769290    5\n3                     Mario                                            166100789    5\n4                     Cindy          Dr.                     Y         121133692    5\n5                       Sam                                  Y          61573910    5\n6                   Destiny         Mrs.                               173271174    5\n7                                                            N         168163141    5\n8        Aaron      Darlene          Ms.                     Y         204812784    5\n9         Adam       Gerard          Dr.                     Y         212266734    5\n10       Adams       Ramiro          Sir                     N         127248956    5\n11        Akin      Bernice         Mrs.                     N         212639465    5\n12    Albrecht         Paul          Dr.                     N           2956217    5\n13     Anthony     Nicholas          Mr.                     Y         128437699    5\n14      Aragon        Amber          Dr.                     Y         190607209    5\n15      Archer      Blanche          Ms.                     Y         108800056    5\n16        Ault       Martin          Dr.                     N          95974624    5\n17      Bailey         John          Mr.                     N         186983461    5\n18       Baker  Christopher          Sir                     N          50097993    5\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\" WHERE \"DJ\".\"CNT\" <= 5 AND \"DJ\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC , \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y          94428716    5\n1                                                            N         189395825    5\n2                      Kirk          Sir                               234769290    5\n3                     Mario                                            166100789    5\n4                     Cindy          Dr.                     Y         121133692    5\n5                       Sam                                  Y          61573910    5\n6                   Destiny         Mrs.                               173271174    5\n7                                                            N         168163141    5\n8        Aaron      Darlene          Ms.                     Y         204812784    5\n9         Adam       Gerard          Dr.                     Y         212266734    5\n10       Adams       Ramiro          Sir                     N         127248956    5\n11        Akin      Bernice         Mrs.                     N         212639465    5\n12    Albrecht         Paul          Dr.                     N           2956217    5\n13     Anthony     Nicholas          Mr.                     Y         128437699    5\n14      Aragon        Amber          Dr.                     Y         190607209    5\n15      Archer      Blanche          Ms.                     Y         108800056    5\n16        Ault       Martin          Dr.                     N          95974624    5\n17      Bailey         John          Mr.                     N         186983461    5\n18       Baker  Christopher          Sir                     N          50097993    5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022424,
                    "execution_time": 0.010493,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.005203
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023119,
                    "execution_time": 0.010662,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.005365
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y          94428716    5\n1                                                            N         189395825    5\n2                      Kirk          Sir                               234769290    5\n3                     Mario                                            166100789    5\n4                     Cindy          Dr.                     Y         121133692    5\n5                       Sam                                  Y          61573910    5\n6                   Destiny         Mrs.                               173271174    5\n7                                                            N         168163141    5\n8        Aaron      Darlene          Ms.                     Y         204812784    5\n9         Adam       Gerard          Dr.                     Y         212266734    5\n10       Adams       Ramiro          Sir                     N         127248956    5\n11        Akin      Bernice         Mrs.                     N         212639465    5\n12    Albrecht         Paul          Dr.                     N           2956217    5\n13     Anthony     Nicholas          Mr.                     Y         128437699    5\n14      Aragon        Amber          Dr.                     Y         190607209    5\n15      Archer      Blanche          Ms.                     Y         108800056    5\n16        Ault       Martin          Dr.                     N          95974624    5\n17      Bailey         John          Mr.                     N         186983461    5\n18       Baker  Christopher          Sir                     N          50097993    5\n...*/"
    }
]