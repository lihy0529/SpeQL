[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query99.tpl 0.94 */  \n   '' as w_warehouse_name\n  ,'' as sm_type\n  ,'' as cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name sm_type cc_name    30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                   465703528   481747391   481726434            0            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.655105,
                    "execution_time": 2.614745,
                    "compile_time": 0.000115,
                    "planning_time": 0.030988
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.920941,
                    "execution_time": 4.822447,
                    "compile_time": 0.00011,
                    "planning_time": 0.086724
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "rewrite": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
            }
        ],
        "preview": "\n/*  w_warehouse_name sm_type cc_name    30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                   465703528   481747391   481726434            0            0*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20) /* Add to GROUP BY clause */\n  , '' as sm_type\n  , '' as cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\ngroup by\n   w_warehouse_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", '' AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20) /* Adding 'w_warehouse_name' to the GROUP BY clause */\n  ,sm_type\n  ,'' as cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\ngroup by\n   w_warehouse_name, sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "SELECT SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LIMIT 21",
                "preview": "\n/*     30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  465703528   481747391   481726434            0            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.662352,
                    "execution_time": 2.624054,
                    "compile_time": 0.000108,
                    "planning_time": 0.029299
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.383159,
                    "execution_time": 4.287041,
                    "compile_time": 0.000111,
                    "planning_time": 0.086821
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "rewrite": "SELECT SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
            }
        ],
        "preview": "\n/*     30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  465703528   481747391   481726434            0            0*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.446487,
                    "execution_time": 4.337046,
                    "compile_time": 0.000486,
                    "planning_time": 0.067654,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.068879,
                    "execution_time": 7.140672,
                    "compile_time": 4.733308,
                    "planning_time": 0.149267,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type          cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          Important dem  OVERNIGHT  North Midwest_2    33041       34047       34281            0            0\n1    Conventional childr    REGULAR  North Midwest_1    32743       34179       34047            0            0\n2            Months woul    EXPRESS  North Midwest_1    44309       45453       45696            0            0\n3                          NEXT DAY  North Midwest_1    44080       46128       45631            0            0\n4     Governments should   NEXT DAY  North Midwest_1    44029       45300       45534            0            0\n5          Therefore urg    EXPRESS       NY Metro_2    44087       45495       45735            0            0\n6       National, comple   NEXT DAY         NY Metro    44178       45517       45825            0            0\n7   Bad cards must make.  OVERNIGHT         NY Metro    33013       34062       33853            0            0\n8       Please central m    REGULAR   Mid Atlantic_3    33100       34278       34471            0            0\n9    Conventional childr    TWO DAY  Hawaii/Alaska_1    32966       34172       34271            0            0\n10      Please central m  OVERNIGHT  North Midwest_3    33593       34121       33911            0            0\n11  Important issues liv   NEXT DAY  North Midwest_3    44113       45935       45722            0            0\n12  Local, mass universi    EXPRESS  North Midwest_3    44052       45601       45529            0            0\n13       Surprising emot   NEXT DAY    North Midwest    44120       45678       45638            0            0\n14    New proceedings fo    LIBRARY   Mid Atlantic_1    33315       34390       34313            0            0\n15         Important dem    EXPRESS       California    43706       45584       45698            0            0\n16  Local, mass universi  OVERNIGHT  North Midwest_3    33265       34087       34092            0            0\n17           Doors canno    EXPRESS  North Midwest_3    43950       45758       45525            0            0\n18       Surprising emot    EXPRESS  North Midwest_3    43933       45426       45557            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018622,
                    "execution_time": 0.007726,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004397
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057716,
                    "execution_time": 0.008435,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040456
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type          cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          Important dem  OVERNIGHT  North Midwest_2    33041       34047       34281            0            0\n1    Conventional childr    REGULAR  North Midwest_1    32743       34179       34047            0            0\n2            Months woul    EXPRESS  North Midwest_1    44309       45453       45696            0            0\n3                          NEXT DAY  North Midwest_1    44080       46128       45631            0            0\n4     Governments should   NEXT DAY  North Midwest_1    44029       45300       45534            0            0\n5          Therefore urg    EXPRESS       NY Metro_2    44087       45495       45735            0            0\n6       National, comple   NEXT DAY         NY Metro    44178       45517       45825            0            0\n7   Bad cards must make.  OVERNIGHT         NY Metro    33013       34062       33853            0            0\n8       Please central m    REGULAR   Mid Atlantic_3    33100       34278       34471            0            0\n9    Conventional childr    TWO DAY  Hawaii/Alaska_1    32966       34172       34271            0            0\n10      Please central m  OVERNIGHT  North Midwest_3    33593       34121       33911            0            0\n11  Important issues liv   NEXT DAY  North Midwest_3    44113       45935       45722            0            0\n12  Local, mass universi    EXPRESS  North Midwest_3    44052       45601       45529            0            0\n13       Surprising emot   NEXT DAY    North Midwest    44120       45678       45638            0            0\n14    New proceedings fo    LIBRARY   Mid Atlantic_1    33315       34390       34313            0            0\n15         Important dem    EXPRESS       California    43706       45584       45698            0            0\n16  Local, mass universi  OVERNIGHT  North Midwest_3    33265       34087       34092            0            0\n17           Doors canno    EXPRESS  North Midwest_3    43950       45758       45525            0            0\n18       Surprising emot    EXPRESS  North Midwest_3    43933       45426       45557            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\nsubstring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS         California    44191       45489       45835            0            0\n1            LIBRARY     Mid Atlantic_2    33080       34208       34263            0            0\n2            REGULAR         California    32959       33847       34255            0            0\n3            EXPRESS      Hawaii/Alaska    43969       45709       45815            0            0\n4           NEXT DAY     Mid Atlantic_2    43895       46062       45202            0            0\n5           NEXT DAY     Mid Atlantic_3    44033       45600       45782            0            0\n6            LIBRARY     Mid Atlantic_3    33351       34190       34151            0            0\n7            LIBRARY      North Midwest    32846       34543       34302            0            0\n8           NEXT DAY           NY Metro    44313       45515       45776            0            0\n9          OVERNIGHT    North Midwest_1    32918       34215       34327            0            0\n10           TWO DAY       California_1    33243       34143       34410            0            0\n11         OVERNIGHT     Mid Atlantic_2    32698       34271       34113            0            0\n12           LIBRARY         California    33166       34216       33517            0            0\n13           REGULAR     Mid Atlantic_2    32910       34389       34281            0            0\n14          NEXT DAY    Hawaii/Alaska_1    44231       45278       45265            0            0\n15         OVERNIGHT  Pacific Northwest    32828       34118       34403            0            0\n16          NEXT DAY         NY Metro_3    43888       45474       45622            0            0\n17           LIBRARY       California_2    33737       34239       34360            0            0\n18           TWO DAY    North Midwest_2    33089       34490       34274            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019372,
                    "execution_time": 0.008224,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004625
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057148,
                    "execution_time": 0.009006,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.040006
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS         California    44191       45489       45835            0            0\n1            LIBRARY     Mid Atlantic_2    33080       34208       34263            0            0\n2            REGULAR         California    32959       33847       34255            0            0\n3            EXPRESS      Hawaii/Alaska    43969       45709       45815            0            0\n4           NEXT DAY     Mid Atlantic_2    43895       46062       45202            0            0\n5           NEXT DAY     Mid Atlantic_3    44033       45600       45782            0            0\n6            LIBRARY     Mid Atlantic_3    33351       34190       34151            0            0\n7            LIBRARY      North Midwest    32846       34543       34302            0            0\n8           NEXT DAY           NY Metro    44313       45515       45776            0            0\n9          OVERNIGHT    North Midwest_1    32918       34215       34327            0            0\n10           TWO DAY       California_1    33243       34143       34410            0            0\n11         OVERNIGHT     Mid Atlantic_2    32698       34271       34113            0            0\n12           LIBRARY         California    33166       34216       33517            0            0\n13           REGULAR     Mid Atlantic_2    32910       34389       34281            0            0\n14          NEXT DAY    Hawaii/Alaska_1    44231       45278       45265            0            0\n15         OVERNIGHT  Pacific Northwest    32828       34118       34403            0            0\n16          NEXT DAY         NY Metro_3    43888       45474       45622            0            0\n17           LIBRARY       California_2    33737       34239       34360            0            0\n18           TWO DAY    North Midwest_2    33089       34490       34274            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" LIMIT 21",
                "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           NY Metro_2    44148       45353       45550            0            0\n1          EXPRESS       Mid Atlantic_3    44088       45582       46035            0            0\n2          EXPRESS      North Midwest_3    43833       45314       45435            0            0\n3          EXPRESS         California_1    44250       45416       45587            0            0\n4          EXPRESS  Pacific Northwest_2    44326       45716       45621            0            0\n5          EXPRESS        Hawaii/Alaska    43969       45709       45815            0            0\n6          EXPRESS           California    44191       45489       45835            0            0\n7          EXPRESS       Mid Atlantic_2    44231       45627       45518            0            0\n8          EXPRESS       Mid Atlantic_1    44468       45944       45537            0            0\n9          EXPRESS    Pacific Northwest    44304       45901       45705            0            0\n10         EXPRESS        North Midwest    44043       45374       45673            0            0\n11         EXPRESS         California_2    43971       45758       45456            0            0\n12         EXPRESS             NY Metro    43857       45909       45094            0            0\n13         EXPRESS  Pacific Northwest_1    44136       45597       45809            0            0\n14         EXPRESS           NY Metro_1    44001       45256       45784            0            0\n15         EXPRESS      North Midwest_1    44058       45857       45211            0            0\n16         EXPRESS           NY Metro_3    43967       45340       45670            0            0\n17         EXPRESS      Hawaii/Alaska_2    44234       45929       45545            0            0\n18         EXPRESS      Hawaii/Alaska_1    44063       45399       45421            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01984,
                    "execution_time": 0.008884,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004505
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055323,
                    "execution_time": 0.008411,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.04026
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           NY Metro_2    44148       45353       45550            0            0\n1          EXPRESS       Mid Atlantic_3    44088       45582       46035            0            0\n2          EXPRESS      North Midwest_3    43833       45314       45435            0            0\n3          EXPRESS         California_1    44250       45416       45587            0            0\n4          EXPRESS  Pacific Northwest_2    44326       45716       45621            0            0\n5          EXPRESS        Hawaii/Alaska    43969       45709       45815            0            0\n6          EXPRESS           California    44191       45489       45835            0            0\n7          EXPRESS       Mid Atlantic_2    44231       45627       45518            0            0\n8          EXPRESS       Mid Atlantic_1    44468       45944       45537            0            0\n9          EXPRESS    Pacific Northwest    44304       45901       45705            0            0\n10         EXPRESS        North Midwest    44043       45374       45673            0            0\n11         EXPRESS         California_2    43971       45758       45456            0            0\n12         EXPRESS             NY Metro    43857       45909       45094            0            0\n13         EXPRESS  Pacific Northwest_1    44136       45597       45809            0            0\n14         EXPRESS           NY Metro_1    44001       45256       45784            0            0\n15         EXPRESS      North Midwest_1    44058       45857       45211            0            0\n16         EXPRESS           NY Metro_3    43967       45340       45670            0            0\n17         EXPRESS      Hawaii/Alaska_2    44234       45929       45545            0            0\n18         EXPRESS      Hawaii/Alaska_1    44063       45399       45421            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"CC_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California    44191       45489       45835            0            0\n1          EXPRESS         California_1    44250       45416       45587            0            0\n2          EXPRESS         California_2    43971       45758       45456            0            0\n3          EXPRESS        Hawaii/Alaska    43969       45709       45815            0            0\n4          EXPRESS      Hawaii/Alaska_1    44063       45399       45421            0            0\n5          EXPRESS      Hawaii/Alaska_2    44234       45929       45545            0            0\n6          EXPRESS         Mid Atlantic    43902       45654       45520            0            0\n7          EXPRESS       Mid Atlantic_1    44468       45944       45537            0            0\n8          EXPRESS       Mid Atlantic_2    44231       45627       45518            0            0\n9          EXPRESS       Mid Atlantic_3    44088       45582       46035            0            0\n10         EXPRESS             NY Metro    43857       45909       45094            0            0\n11         EXPRESS           NY Metro_1    44001       45256       45784            0            0\n12         EXPRESS           NY Metro_2    44148       45353       45550            0            0\n13         EXPRESS           NY Metro_3    43967       45340       45670            0            0\n14         EXPRESS        North Midwest    44043       45374       45673            0            0\n15         EXPRESS      North Midwest_1    44058       45857       45211            0            0\n16         EXPRESS      North Midwest_2    43949       45633       45768            0            0\n17         EXPRESS      North Midwest_3    43833       45314       45435            0            0\n18         EXPRESS    Pacific Northwest    44304       45901       45705            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019962,
                    "execution_time": 0.008812,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.004692
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056047,
                    "execution_time": 0.00888,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.040447
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"CC_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California    44191       45489       45835            0            0\n1          EXPRESS         California_1    44250       45416       45587            0            0\n2          EXPRESS         California_2    43971       45758       45456            0            0\n3          EXPRESS        Hawaii/Alaska    43969       45709       45815            0            0\n4          EXPRESS      Hawaii/Alaska_1    44063       45399       45421            0            0\n5          EXPRESS      Hawaii/Alaska_2    44234       45929       45545            0            0\n6          EXPRESS         Mid Atlantic    43902       45654       45520            0            0\n7          EXPRESS       Mid Atlantic_1    44468       45944       45537            0            0\n8          EXPRESS       Mid Atlantic_2    44231       45627       45518            0            0\n9          EXPRESS       Mid Atlantic_3    44088       45582       46035            0            0\n10         EXPRESS             NY Metro    43857       45909       45094            0            0\n11         EXPRESS           NY Metro_1    44001       45256       45784            0            0\n12         EXPRESS           NY Metro_2    44148       45353       45550            0            0\n13         EXPRESS           NY Metro_3    43967       45340       45670            0            0\n14         EXPRESS        North Midwest    44043       45374       45673            0            0\n15         EXPRESS      North Midwest_1    44058       45857       45211            0            0\n16         EXPRESS      North Midwest_2    43949       45633       45768            0            0\n17         EXPRESS      North Midwest_3    43833       45314       45435            0            0\n18         EXPRESS    Pacific Northwest    44304       45901       45705            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"CC_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California    44191       45489       45835            0            0\n1          EXPRESS         California_1    44250       45416       45587            0            0\n2          EXPRESS         California_2    43971       45758       45456            0            0\n3          EXPRESS        Hawaii/Alaska    43969       45709       45815            0            0\n4          EXPRESS      Hawaii/Alaska_1    44063       45399       45421            0            0\n5          EXPRESS      Hawaii/Alaska_2    44234       45929       45545            0            0\n6          EXPRESS         Mid Atlantic    43902       45654       45520            0            0\n7          EXPRESS       Mid Atlantic_1    44468       45944       45537            0            0\n8          EXPRESS       Mid Atlantic_2    44231       45627       45518            0            0\n9          EXPRESS       Mid Atlantic_3    44088       45582       46035            0            0\n10         EXPRESS             NY Metro    43857       45909       45094            0            0\n11         EXPRESS           NY Metro_1    44001       45256       45784            0            0\n12         EXPRESS           NY Metro_2    44148       45353       45550            0            0\n13         EXPRESS           NY Metro_3    43967       45340       45670            0            0\n14         EXPRESS        North Midwest    44043       45374       45673            0            0\n15         EXPRESS      North Midwest_1    44058       45857       45211            0            0\n16         EXPRESS      North Midwest_2    43949       45633       45768            0            0\n17         EXPRESS      North Midwest_3    43833       45314       45435            0            0\n18         EXPRESS    Pacific Northwest    44304       45901       45705            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020327,
                    "execution_time": 0.008995,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004783
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019824,
                    "execution_time": 0.008341,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004867
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"CC_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California    44191       45489       45835            0            0\n1          EXPRESS         California_1    44250       45416       45587            0            0\n2          EXPRESS         California_2    43971       45758       45456            0            0\n3          EXPRESS        Hawaii/Alaska    43969       45709       45815            0            0\n4          EXPRESS      Hawaii/Alaska_1    44063       45399       45421            0            0\n5          EXPRESS      Hawaii/Alaska_2    44234       45929       45545            0            0\n6          EXPRESS         Mid Atlantic    43902       45654       45520            0            0\n7          EXPRESS       Mid Atlantic_1    44468       45944       45537            0            0\n8          EXPRESS       Mid Atlantic_2    44231       45627       45518            0            0\n9          EXPRESS       Mid Atlantic_3    44088       45582       46035            0            0\n10         EXPRESS             NY Metro    43857       45909       45094            0            0\n11         EXPRESS           NY Metro_1    44001       45256       45784            0            0\n12         EXPRESS           NY Metro_2    44148       45353       45550            0            0\n13         EXPRESS           NY Metro_3    43967       45340       45670            0            0\n14         EXPRESS        North Midwest    44043       45374       45673            0            0\n15         EXPRESS      North Midwest_1    44058       45857       45211            0            0\n16         EXPRESS      North Midwest_2    43949       45633       45768            0            0\n17         EXPRESS      North Midwest_3    43833       45314       45435            0            0\n18         EXPRESS    Pacific Northwest    44304       45901       45705            0            0\n...*/"
    }
]