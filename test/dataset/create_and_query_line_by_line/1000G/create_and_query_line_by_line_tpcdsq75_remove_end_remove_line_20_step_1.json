[
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT * FROM all_sales /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"D_YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"ALL_SALES\".\"SALES_CNT\" AS \"SALES_CNT\" , \"ALL_SALES\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"ALL_SALES\" AS \"ALL_SALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101745,
                    "execution_time": 0.039801,
                    "compile_time": 0.000228,
                    "planning_time": 0.022002,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.16497,
                    "execution_time": 0.041738,
                    "compile_time": 0.000237,
                    "planning_time": 0.081938,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.130292,
                    "execution_time": 0.053408,
                    "compile_time": 0.000252,
                    "planning_time": 0.024405,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.392029,
                    "execution_time": 1.994973,
                    "compile_time": 0.257451,
                    "planning_time": 0.083245,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT * FROM ALL_SALES LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON item.i_item_sk=catalog_sales.cs_item_sk\n                          JOIN date_dim ON date_dim.d_date_sk=catalog_sales.cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (catalog_sales.cs_order_number=catalog_returns.cr_order_number \n                                                    AND catalog_sales.cs_item_sk=catalog_returns.cr_item_sk)\n       WHERE item.i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON item.i_item_sk=store_sales.ss_item_sk\n                        JOIN date_dim ON date_dim.d_date_sk=store_sales.ss_sold_date_sk\n                        LEFT JOIN store_returns ON (store_sales.ss_ticket_number=store_returns.sr_ticket_number \n                                                AND store_sales.ss_item_sk=store_returns.sr_item_sk)\n       WHERE item.i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON item.i_item_sk=web_sales.ws_item_sk\n                      JOIN date_dim ON date_dim.d_date_sk=web_sales.ws_sold_date_sk\n                      LEFT JOIN web_returns ON (web_sales.ws_order_number=web_returns.wr_order_number \n                                            AND web_sales.ws_item_sk=web_returns.wr_item_sk)\n       WHERE item.i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  all_sales.d_year AS prev_year\n/*CURSOR_IDENTIFIER*/ FROM all_sales",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"ALL_SALES\" AS \"ALL_SALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK JOIN DATE_DIM ON DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CATALOG_SALES.CS_ORDER_NUMBER = CATALOG_RETURNS.CR_ORDER_NUMBER AND CATALOG_SALES.CS_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK ) WHERE ITEM.I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK JOIN DATE_DIM ON DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( STORE_SALES.SS_TICKET_NUMBER = STORE_RETURNS.SR_TICKET_NUMBER AND STORE_SALES.SS_ITEM_SK = STORE_RETURNS.SR_ITEM_SK ) WHERE ITEM.I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK JOIN DATE_DIM ON DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WEB_SALES.WS_ORDER_NUMBER = WEB_RETURNS.WR_ORDER_NUMBER AND WEB_SALES.WS_ITEM_SK = WEB_RETURNS.WR_ITEM_SK ) WHERE ITEM.I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT ALL_SALES.D_YEAR AS PREV_YEAR FROM ALL_SALES LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year\n      ,curr_yr.d_year AS year\n/*CURSOR_IDENTIFIER*/\nFROM all_sales prev_yr\n     JOIN all_sales curr_yr ON prev_yr.i_brand_id = curr_yr.i_brand_id\n                              AND prev_yr.i_class_id = curr_yr.i_class_id\n                              AND prev_yr.i_category_id = curr_yr.i_category_id\n                              AND prev_yr.i_manufact_id = curr_yr.i_manufact_id\n                              AND prev_yr.d_year = curr_yr.d_year - 1",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"ALL_SALES\" AS \"PREV_YR\" JOIN \"ALL_SALES\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR FROM ALL_SALES AS PREV_YR JOIN ALL_SALES AS CURR_YR ON PREV_YR.I_BRAND_ID = CURR_YR.I_BRAND_ID AND PREV_YR.I_CLASS_ID = CURR_YR.I_CLASS_ID AND PREV_YR.I_CATEGORY_ID = CURR_YR.I_CATEGORY_ID AND PREV_YR.I_MANUFACT_ID = CURR_YR.I_MANUFACT_ID AND PREV_YR.D_YEAR = CURR_YR.D_YEAR - 1 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT a1.d_year - 1 AS prev_year\n      ,a1.d_year AS year\n      ,a1.i_brand_id\n/*CURSOR_IDENTIFIER*/\nFROM all_sales a1\nJOIN all_sales a2 ON a1.i_brand_id = a2.i_brand_id\n                 AND a1.i_class_id = a2.i_class_id\n                 AND a1.i_category_id = a2.i_category_id\n                 AND a1.i_manufact_id = a2.i_manufact_id\n                 AND a1.d_year = a2.d_year - 1;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"ALL_SALES\" AS \"A1\" JOIN \"ALL_SALES\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT A1.D_YEAR - 1 AS PREV_YEAR , A1.D_YEAR AS YEAR , A1.I_BRAND_ID FROM ALL_SALES AS A1 JOIN ALL_SALES AS A2 ON A1.I_BRAND_ID = A2.I_BRAND_ID AND A1.I_CLASS_ID = A2.I_CLASS_ID AND A1.I_CATEGORY_ID = A2.I_CATEGORY_ID AND A1.I_MANUFACT_ID = A2.I_MANUFACT_ID AND A1.D_YEAR = A2.D_YEAR - 1 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  NULL AS prev_year\n                          ,NULL AS year\n                          ,NULL AS i_brand_id\n                          ,NULL AS i_class_id\n                          ,NULL AS i_category_id\n                          ,NULL AS i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*  prev_year  year i_brand_id i_class_id i_category_id i_manufact_id\n0      None  None       None       None          None          None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.825586,
                    "execution_time": 0.572253,
                    "compile_time": 0.000363,
                    "planning_time": 0.080155
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60.253162,
                    "execution_time": 17.281203,
                    "compile_time": 0.000545,
                    "planning_time": 0.447399
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\"",
                "rewrite": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\""
            }
        ],
        "preview": "\n/*  prev_year  year i_brand_id i_class_id i_category_id i_manufact_id\n0      None  None       None       None          None          None*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')) sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  lag(d_year, 1) over (PARTITION BY i_brand_id, i_class_id, i_category_id, i_manufact_id ORDER BY d_year) AS prev_year\n                          ,d_year AS year\n                          ,i_brand_id\n                          ,i_class_id\n                          ,i_category_id\n                          ,i_manufact_id\n                          ,SUM(sales_cnt) AS prev_yr_cnt\nFROM all_sales\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' GROUP BY \"ITEM\".\"I_CATEGORY_ID\" ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_0\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" LEFT JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_1\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_2\".\"I_CATEGORY_ID\" IS NULL ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT LAG ( \"ALL_SALES\".\"D_YEAR\" , 1 ) OVER ( PARTITION BY \"ALL_SALES\".\"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" ORDER BY \"ALL_SALES\".\"D_YEAR\" NULLS LAST ) AS \"PREV_YEAR\" , \"ALL_SALES\".\"D_YEAR\" AS \"YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"ALL_SALES\".\"SALES_CNT\" ) AS \"PREV_YR_CNT\" FROM \"ALL_SALES\" AS \"ALL_SALES\" GROUP BY \"ALL_SALES\".\"D_YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.444447,
                    "execution_time": 0.199069,
                    "compile_time": 0.000393,
                    "planning_time": 0.024613,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.810394,
                    "execution_time": 0.199219,
                    "compile_time": 0.269733,
                    "planning_time": 0.115404,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' GROUP BY \"ITEM\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085847,
                    "execution_time": 0.035002,
                    "compile_time": 0.000308,
                    "planning_time": 0.024289,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.153614,
                    "execution_time": 0.036716,
                    "compile_time": 0.000319,
                    "planning_time": 0.084733,
                    "create_size": 8
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_1\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_2\".\"I_CATEGORY_ID\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY_ID IN ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY_ID IN ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY_ID IN ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' ) ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT LAG ( D_YEAR , 1 ) OVER ( PARTITION BY I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ORDER BY D_YEAR NULLS FIRST ) AS PREV_YEAR , D_YEAR AS YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS PREV_YR_CNT FROM ALL_SALES GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)) sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id),\n prev_yr AS (\n   SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt\n   FROM all_sales \n   WHERE d_year = (SELECT MAX(d_year) FROM all_sales) - 1\n ), \n curr_yr AS (\n   SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt\n   FROM all_sales \n   WHERE d_year = (SELECT MAX(d_year) FROM all_sales)\n )\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n/*CURSOR_IDENTIFIER*/ \nFROM prev_yr \nJOIN curr_yr \nON prev_yr.i_brand_id = curr_yr.i_brand_id \nAND prev_yr.i_class_id = curr_yr.i_class_id \nAND prev_yr.i_category_id = curr_yr.i_category_id \nAND prev_yr.i_manufact_id = curr_yr.i_manufact_id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' LIMIT 1 ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) , \"_U_3\" AS ( SELECT MAX ( \"ALL_SALES\".\"D_YEAR\" ) AS \"_COL_0\" FROM \"ALL_SALES\" AS \"ALL_SALES\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"PREV_YEAR\" , \"ALL_SALES_2\".\"D_YEAR\" AS \"YEAR\" , \"ALL_SALES_2\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES_2\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES_2\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"ALL_SALES\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"ALL_SALES_2\".\"SALES_CNT\" AS \"CURR_YR_CNT\" FROM \"ALL_SALES\" AS \"ALL_SALES\" JOIN \"_U_3\" AS \"_U_3\" ON \"ALL_SALES\".\"D_YEAR\" = \"_U_3\".\"_COL_0\" - 1 JOIN \"ALL_SALES\" AS \"ALL_SALES_2\" ON \"ALL_SALES\".\"I_BRAND_ID\" = \"ALL_SALES_2\".\"I_BRAND_ID\" AND \"ALL_SALES\".\"I_CATEGORY_ID\" = \"ALL_SALES_2\".\"I_CATEGORY_ID\" AND \"ALL_SALES\".\"I_CLASS_ID\" = \"ALL_SALES_2\".\"I_CLASS_ID\" AND \"ALL_SALES\".\"I_MANUFACT_ID\" = \"ALL_SALES_2\".\"I_MANUFACT_ID\" JOIN \"_U_3\" AS \"_U_4\" ON \"_U_4\".\"_COL_0\" = \"ALL_SALES_2\".\"D_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063361,
                    "execution_time": 0.035007,
                    "compile_time": 0.000245,
                    "planning_time": 0.003078,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.12565,
                    "execution_time": 0.037881,
                    "compile_time": 0.000262,
                    "planning_time": 0.058134,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) , PREV_YR AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SALES_CNT FROM ALL_SALES WHERE D_YEAR = ( SELECT MAX ( D_YEAR ) FROM ALL_SALES ) - 1 ) , CURR_YR AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SALES_CNT FROM ALL_SALES WHERE D_YEAR = ( SELECT MAX ( D_YEAR ) FROM ALL_SALES ) ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT FROM PREV_YR JOIN CURR_YR ON PREV_YR.I_BRAND_ID = CURR_YR.I_BRAND_ID AND PREV_YR.I_CLASS_ID = CURR_YR.I_CLASS_ID AND PREV_YR.I_CATEGORY_ID = CURR_YR.I_CATEGORY_ID AND PREV_YR.I_MANUFACT_ID = CURR_YR.I_MANUFACT_ID",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" CROSS JOIN \"ALL_SALES\" AS \"PREV_YR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID AND CURR_YR.I_MANUFACT_ID = PREV_YR.I_MANUFACT_ID LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID AND CURR_YR.I_MANUFACT_ID = PREV_YR.I_MANUFACT_ID AND CURR_YR.D_YEAR = 2000 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID AND CURR_YR.I_MANUFACT_ID = PREV_YR.I_MANUFACT_ID AND CURR_YR.D_YEAR = 2000 AND PREV_YR.D_YEAR = 2000 - 1 LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003002           3              4             62      1203233      1815586          612353     28145365.65\n1        1999  2000     4004001           4              4             60      1226970       913295         -313675    -13839465.03\n2        1999  2000     4004001           4              4            681       303562       304777            1215        28346.21\n3        1999  2000     4003002           3              4             47       303668       620149          316481     14316872.04\n4        1999  2000     4004001           4              4              6      1219823       615571         -604252    -26160346.42\n5        1999  2000     4003002           3              4            497       307938       310408            2470       228072.04\n6        1999  2000     4004001           4              4            497       911518       619514         -292004    -13188995.17\n7        1999  2000     4004001           4              4            309      1208249       617746         -590503    -25818120.08\n8        1999  2000     4004001           4              4            557       620743       607747          -12996      -327020.88\n9        1999  2000     4004001           4              4            750       306241       613610          307369     14069558.64\n10       1999  2000     4003002           3              4            496       909664       915591            5927       664367.60\n11       1999  2000     4004001           4              4            494       620107       609040          -11067      -289687.01\n12       1999  2000     4003002           3              4            285       301697       910963          609266     26859865.12\n13       1999  2000     4003002           3              4            307       907747       917177            9430      -218136.58\n14       1999  2000     4003002           3              4            204       612829       617669            4840       242628.10\n15       1999  2000     4003002           3              4            861       309883       310807             924        20070.75\n16       1999  2000     4003002           3              4            442       310418       611420          301002     13090990.88\n17       1999  2000     4004001           4              4            575       911455       630533         -280922    -11890889.01\n18       1999  2000     4004001           4              4            328      1506016      1215280         -290736    -12073024.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 37.206131,
                    "execution_time": 36.849372,
                    "compile_time": 0.001753,
                    "planning_time": 0.285062
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 41.140626,
                    "execution_time": 40.611576,
                    "compile_time": 0.217578,
                    "planning_time": 0.406837
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003002           3              4             62      1203233      1815586          612353     28145365.65\n1        1999  2000     4004001           4              4             60      1226970       913295         -313675    -13839465.03\n2        1999  2000     4004001           4              4            681       303562       304777            1215        28346.21\n3        1999  2000     4003002           3              4             47       303668       620149          316481     14316872.04\n4        1999  2000     4004001           4              4              6      1219823       615571         -604252    -26160346.42\n5        1999  2000     4003002           3              4            497       307938       310408            2470       228072.04\n6        1999  2000     4004001           4              4            497       911518       619514         -292004    -13188995.17\n7        1999  2000     4004001           4              4            309      1208249       617746         -590503    -25818120.08\n8        1999  2000     4004001           4              4            557       620743       607747          -12996      -327020.88\n9        1999  2000     4004001           4              4            750       306241       613610          307369     14069558.64\n10       1999  2000     4003002           3              4            496       909664       915591            5927       664367.60\n11       1999  2000     4004001           4              4            494       620107       609040          -11067      -289687.01\n12       1999  2000     4003002           3              4            285       301697       910963          609266     26859865.12\n13       1999  2000     4003002           3              4            307       907747       917177            9430      -218136.58\n14       1999  2000     4003002           3              4            204       612829       617669            4840       242628.10\n15       1999  2000     4003002           3              4            861       309883       310807             924        20070.75\n16       1999  2000     4003002           3              4            442       310418       611420          301002     13090990.88\n17       1999  2000     4004001           4              4            575       911455       630533         -280922    -11890889.01\n18       1999  2000     4004001           4              4            328      1506016      1215280         -290736    -12073024.04\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID AND CURR_YR.I_MANUFACT_ID = PREV_YR.I_MANUFACT_ID AND CURR_YR.D_YEAR = 2000 AND PREV_YR.D_YEAR = 2000 - 1 AND CAST ( CURR_YR.SALES_CNT AS DECIMAL ( 17 , 2 ) ) / CAST ( PREV_YR.SALES_CNT AS DECIMAL ( 17 , 2 ) ) < 0.9 LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4             82      1220953       603276         -617677    -26853962.88\n1        1999  2000     4003001           3              4            332      2075701       927610        -1148091    -51388763.15\n2        1999  2000     4003001           3              4             35      2102378      1508565         -593813    -27717436.42\n3        1999  2000     4003001           3              4             24      1501656      1207529         -294127    -13107830.34\n4        1999  2000     4003001           3              4            209      1206656       603639         -603017    -26811002.20\n5        1999  2000     4003001           3              4            492      1806767       618872        -1187895    -52696656.57\n6        1999  2000     4003001           3              4            199      1198227       917289         -280938    -12266367.14\n7        1999  2000     4003001           3              4            303      1785321       607699        -1177622    -53232830.26\n8        1999  2000     4003001           3              4             43       905151       318351         -586800    -26038195.04\n9        1999  2000     4003001           3              4            241      1780652       618366        -1162286    -52086959.69\n10       1999  2000     4003001           3              4            254      1501739       911371         -590368    -26731813.49\n11       1999  2000     4003001           3              4            211       604913       303937         -300976    -13263382.53\n12       1999  2000     4003001           3              4             85      1812007      1214576         -597431    -26783497.28\n13       1999  2000     4003001           3              4            250      2059070      1500536         -558534    -25711981.73\n14       1999  2000     4003001           3              4            196      1817102      1197856         -619246    -27684091.02\n15       1999  2000     4003001           3              4            484      1800820      1226418         -574402    -26687553.03\n16       1999  2000     4003001           3              4             16       912803       600921         -311882    -13717259.03\n17       1999  2000     4003001           3              4            247      1196880       920774         -276106    -12061856.21\n18       1999  2000     4003001           3              4            589      1217296       911810         -305486    -13793790.22\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 37.030075,
                    "execution_time": 36.678655,
                    "compile_time": 0.001725,
                    "planning_time": 0.279682
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 37.819653,
                    "execution_time": 37.298387,
                    "compile_time": 0.047679,
                    "planning_time": 0.399936
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4             82      1220953       603276         -617677    -26853962.88\n1        1999  2000     4003001           3              4            332      2075701       927610        -1148091    -51388763.15\n2        1999  2000     4003001           3              4             35      2102378      1508565         -593813    -27717436.42\n3        1999  2000     4003001           3              4             24      1501656      1207529         -294127    -13107830.34\n4        1999  2000     4003001           3              4            209      1206656       603639         -603017    -26811002.20\n5        1999  2000     4003001           3              4            492      1806767       618872        -1187895    -52696656.57\n6        1999  2000     4003001           3              4            199      1198227       917289         -280938    -12266367.14\n7        1999  2000     4003001           3              4            303      1785321       607699        -1177622    -53232830.26\n8        1999  2000     4003001           3              4             43       905151       318351         -586800    -26038195.04\n9        1999  2000     4003001           3              4            241      1780652       618366        -1162286    -52086959.69\n10       1999  2000     4003001           3              4            254      1501739       911371         -590368    -26731813.49\n11       1999  2000     4003001           3              4            211       604913       303937         -300976    -13263382.53\n12       1999  2000     4003001           3              4             85      1812007      1214576         -597431    -26783497.28\n13       1999  2000     4003001           3              4            250      2059070      1500536         -558534    -25711981.73\n14       1999  2000     4003001           3              4            196      1817102      1197856         -619246    -27684091.02\n15       1999  2000     4003001           3              4            484      1800820      1226418         -574402    -26687553.03\n16       1999  2000     4003001           3              4             16       912803       600921         -311882    -13717259.03\n17       1999  2000     4003001           3              4            247      1196880       920774         -276106    -12061856.21\n18       1999  2000     4003001           3              4            589      1217296       911810         -305486    -13793790.22\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID AND CURR_YR.I_MANUFACT_ID = PREV_YR.I_MANUFACT_ID AND CURR_YR.D_YEAR = 2000 AND PREV_YR.D_YEAR = 2000 - 1 AND CAST ( CURR_YR.SALES_CNT AS DECIMAL ( 17 , 2 ) ) / CAST ( PREV_YR.SALES_CNT AS DECIMAL ( 17 , 2 ) ) < 0.9 ORDER BY SALES_CNT_DIFF NULLS FIRST , SALES_AMT_DIFF NULLS FIRST LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325      2931936        12867        -2919069   -1.316202e+08\n1        1999  2000     4001001           1              4             25      2959994       636361        -2323633   -1.043919e+08\n2        1999  2000     4004001           4              4              1      3222779       923270        -2299509   -1.046268e+08\n3        1999  2000     4003001           3              4            177      2093958         9655        -2084303   -9.318227e+07\n4        1999  2000     4004001           4              4            304      2078007         9898        -2068109   -9.146429e+07\n5        1999  2000     4001001           1              4             45      2074216         9928        -2064288   -9.209382e+07\n6        1999  2000     4003001           3              4            297      2678015       620406        -2057609   -9.347262e+07\n7        1999  2000     4003001           3              4            331      2363259       321466        -2041793   -9.140894e+07\n8        1999  2000     4002001           2              4            145      2948074       919756        -2028318   -9.141396e+07\n9        1999  2000     4003001           3              4            124      3475682      1503367        -1972315   -9.002480e+07\n10       1999  2000     4004001           4              4            609      1802717         7907        -1794810   -8.028244e+07\n11       1999  2000     4004001           4              4            147      1795873         7214        -1788659   -7.932226e+07\n12       1999  2000     4001001           1              4             10      2078572       310172        -1768400   -7.875290e+07\n13       1999  2000     4001001           1              4            124      2395355       629962        -1765393   -7.827874e+07\n14       1999  2000     4001001           1              4            287      2380774       616691        -1764083   -7.937839e+07\n15       1999  2000     4001001           1              4             48      2675402       915188        -1760214   -7.864067e+07\n16       1999  2000     4002001           2              4            239      2685500       925837        -1759663   -7.984875e+07\n17       1999  2000     4003001           3              4            115      2367440       616400        -1751040   -7.910920e+07\n18       1999  2000     4001001           1              4             46      2362254       628179        -1734075   -7.675331e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 37.424881,
                    "execution_time": 37.062904,
                    "compile_time": 0.00175,
                    "planning_time": 0.288813
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 37.987056,
                    "execution_time": 37.461611,
                    "compile_time": 0.088034,
                    "planning_time": 0.398334
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325      2931936        12867        -2919069   -1.316202e+08\n1        1999  2000     4001001           1              4             25      2959994       636361        -2323633   -1.043919e+08\n2        1999  2000     4004001           4              4              1      3222779       923270        -2299509   -1.046268e+08\n3        1999  2000     4003001           3              4            177      2093958         9655        -2084303   -9.318227e+07\n4        1999  2000     4004001           4              4            304      2078007         9898        -2068109   -9.146429e+07\n5        1999  2000     4001001           1              4             45      2074216         9928        -2064288   -9.209382e+07\n6        1999  2000     4003001           3              4            297      2678015       620406        -2057609   -9.347262e+07\n7        1999  2000     4003001           3              4            331      2363259       321466        -2041793   -9.140894e+07\n8        1999  2000     4002001           2              4            145      2948074       919756        -2028318   -9.141396e+07\n9        1999  2000     4003001           3              4            124      3475682      1503367        -1972315   -9.002480e+07\n10       1999  2000     4004001           4              4            609      1802717         7907        -1794810   -8.028244e+07\n11       1999  2000     4004001           4              4            147      1795873         7214        -1788659   -7.932226e+07\n12       1999  2000     4001001           1              4             10      2078572       310172        -1768400   -7.875290e+07\n13       1999  2000     4001001           1              4            124      2395355       629962        -1765393   -7.827874e+07\n14       1999  2000     4001001           1              4            287      2380774       616691        -1764083   -7.937839e+07\n15       1999  2000     4001001           1              4             48      2675402       915188        -1760214   -7.864067e+07\n16       1999  2000     4002001           2              4            239      2685500       925837        -1759663   -7.984875e+07\n17       1999  2000     4003001           3              4            115      2367440       616400        -1751040   -7.910920e+07\n18       1999  2000     4001001           1              4             46      2362254       628179        -1734075   -7.675331e+07\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY = 'Shoes' ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT , CURR_YR.SALES_CNT - PREV_YR.SALES_CNT AS SALES_CNT_DIFF , CURR_YR.SALES_AMT - PREV_YR.SALES_AMT AS SALES_AMT_DIFF FROM ALL_SALES AS CURR_YR , ALL_SALES AS PREV_YR WHERE CURR_YR.I_BRAND_ID = PREV_YR.I_BRAND_ID AND CURR_YR.I_CLASS_ID = PREV_YR.I_CLASS_ID AND CURR_YR.I_CATEGORY_ID = PREV_YR.I_CATEGORY_ID AND CURR_YR.I_MANUFACT_ID = PREV_YR.I_MANUFACT_ID AND CURR_YR.D_YEAR = 2000 AND PREV_YR.D_YEAR = 2000 - 1 AND CAST ( CURR_YR.SALES_CNT AS DECIMAL ( 17 , 2 ) ) / CAST ( PREV_YR.SALES_CNT AS DECIMAL ( 17 , 2 ) ) < 0.9 ORDER BY SALES_CNT_DIFF NULLS FIRST , SALES_AMT_DIFF NULLS FIRST LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325      2931936        12867        -2919069   -1.316202e+08\n1        1999  2000     4001001           1              4             25      2959994       636361        -2323633   -1.043919e+08\n2        1999  2000     4004001           4              4              1      3222779       923270        -2299509   -1.046268e+08\n3        1999  2000     4003001           3              4            177      2093958         9655        -2084303   -9.318227e+07\n4        1999  2000     4004001           4              4            304      2078007         9898        -2068109   -9.146429e+07\n5        1999  2000     4001001           1              4             45      2074216         9928        -2064288   -9.209382e+07\n6        1999  2000     4003001           3              4            297      2678015       620406        -2057609   -9.347262e+07\n7        1999  2000     4003001           3              4            331      2363259       321466        -2041793   -9.140894e+07\n8        1999  2000     4002001           2              4            145      2948074       919756        -2028318   -9.141396e+07\n9        1999  2000     4003001           3              4            124      3475682      1503367        -1972315   -9.002480e+07\n10       1999  2000     4004001           4              4            609      1802717         7907        -1794810   -8.028244e+07\n11       1999  2000     4004001           4              4            147      1795873         7214        -1788659   -7.932226e+07\n12       1999  2000     4001001           1              4             10      2078572       310172        -1768400   -7.875290e+07\n13       1999  2000     4001001           1              4            124      2395355       629962        -1765393   -7.827874e+07\n14       1999  2000     4001001           1              4            287      2380774       616691        -1764083   -7.937839e+07\n15       1999  2000     4001001           1              4             48      2675402       915188        -1760214   -7.864067e+07\n16       1999  2000     4002001           2              4            239      2685500       925837        -1759663   -7.984875e+07\n17       1999  2000     4003001           3              4            115      2367440       616400        -1751040   -7.910920e+07\n18       1999  2000     4001001           1              4             46      2362254       628179        -1734075   -7.675331e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 37.337782,
                    "execution_time": 36.980892,
                    "compile_time": 0.001786,
                    "planning_time": 0.284644
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 38.448077,
                    "execution_time": 38.091896,
                    "compile_time": 0.001742,
                    "planning_time": 0.283567
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325      2931936        12867        -2919069   -1.316202e+08\n1        1999  2000     4001001           1              4             25      2959994       636361        -2323633   -1.043919e+08\n2        1999  2000     4004001           4              4              1      3222779       923270        -2299509   -1.046268e+08\n3        1999  2000     4003001           3              4            177      2093958         9655        -2084303   -9.318227e+07\n4        1999  2000     4004001           4              4            304      2078007         9898        -2068109   -9.146429e+07\n5        1999  2000     4001001           1              4             45      2074216         9928        -2064288   -9.209382e+07\n6        1999  2000     4003001           3              4            297      2678015       620406        -2057609   -9.347262e+07\n7        1999  2000     4003001           3              4            331      2363259       321466        -2041793   -9.140894e+07\n8        1999  2000     4002001           2              4            145      2948074       919756        -2028318   -9.141396e+07\n9        1999  2000     4003001           3              4            124      3475682      1503367        -1972315   -9.002480e+07\n10       1999  2000     4004001           4              4            609      1802717         7907        -1794810   -8.028244e+07\n11       1999  2000     4004001           4              4            147      1795873         7214        -1788659   -7.932226e+07\n12       1999  2000     4001001           1              4             10      2078572       310172        -1768400   -7.875290e+07\n13       1999  2000     4001001           1              4            124      2395355       629962        -1765393   -7.827874e+07\n14       1999  2000     4001001           1              4            287      2380774       616691        -1764083   -7.937839e+07\n15       1999  2000     4001001           1              4             48      2675402       915188        -1760214   -7.864067e+07\n16       1999  2000     4002001           2              4            239      2685500       925837        -1759663   -7.984875e+07\n17       1999  2000     4003001           3              4            115      2367440       616400        -1751040   -7.910920e+07\n18       1999  2000     4001001           1              4             46      2362254       628179        -1734075   -7.675331e+07\n...*/"
    }
]