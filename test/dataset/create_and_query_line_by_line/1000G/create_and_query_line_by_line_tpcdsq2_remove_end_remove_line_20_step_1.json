[
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from  web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n from wswscs\n where wswscs.d_week_seq in (select distinct d_week_seq from date_dim)) wswscs1\n join \n (select wswscs.d_week_seq d_week_seq2\n        ,sum(sun_sales) sun_sales2\n        ,sum(mon_sales) mon_sales2\n        ,sum(tue_sales) tue_sales2\n        ,sum(wed_sales) wed_sales2\n        ,sum(thu_sales) thu_sales2\n        ,sum(fri_sales) fri_sales2\n        ,sum(sat_sales) sat_sales2\n from wswscs\n group by wswscs.d_week_seq) wswscs2\n on wswscs1.d_week_seq1 = wswscs2.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"WSWSCS2\" AS ( SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\" GROUP BY \"WSWSCS\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS2\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS2\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS2\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS2\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS2\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS2\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS2\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" JOIN \"WSWSCS2\" AS \"WSWSCS2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS2\".\"D_WEEK_SEQ2\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.138581,
                    "execution_time": 3.036481,
                    "compile_time": 0.000378,
                    "planning_time": 0.06875,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 18.554428,
                    "execution_time": 18.458597,
                    "compile_time": 0.005557,
                    "planning_time": 0.054001,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.083411,
                    "execution_time": 0.034055,
                    "compile_time": 0.000289,
                    "planning_time": 0.023282,
                    "create_size": 80
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.289558,
                    "execution_time": 0.033407,
                    "compile_time": 0.14139,
                    "planning_time": 0.087354,
                    "create_size": 80
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089964,
                    "execution_time": 0.057499,
                    "compile_time": 0.000249,
                    "planning_time": 0.005699,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.153433,
                    "execution_time": 0.060785,
                    "compile_time": 0.001472,
                    "planning_time": 0.061082,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ2\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120083,
                    "execution_time": 0.076425,
                    "compile_time": 0.000392,
                    "planning_time": 0.011695,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.336356,
                    "execution_time": 0.075814,
                    "compile_time": 0.153615,
                    "planning_time": 0.07243,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5139     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5297     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5281     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5338     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5183     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5228     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5373     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5302     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5130     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5363     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5285     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5234     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5321     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5358     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5296     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5217     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5144     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5247     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5161     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019072,
                    "execution_time": 0.008527,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00399
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055365,
                    "execution_time": 0.008428,
                    "compile_time": 0.000906,
                    "planning_time": 0.039028
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ2\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" IS NULL",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5139     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5297     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5281     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5338     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5183     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5228     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5373     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5302     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5130     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5363     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5285     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5234     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5321     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5358     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5296     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5217     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5144     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5247     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5161     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n        ,sum(sun_sales) over () sun_sales2\n        ,sum(mon_sales) over () mon_sales2\n        ,sum(tue_sales) over () tue_sales2\n        ,sum(wed_sales) over () wed_sales2\n        ,sum(thu_sales) over () thu_sales2\n        ,sum(fri_sales) over () fri_sales2\n        ,sum(sat_sales) over () sat_sales2\n  from wswscs) sub\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"SUB\" AS ( SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSWSCS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSWSCS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSWSCS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSWSCS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSWSCS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSWSCS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSWSCS\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\" ) SELECT \"SUB\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SUB\".\"SUN_SALES1\" / \"SUB\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SUB\".\"MON_SALES1\" / \"SUB\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SUB\".\"TUE_SALES1\" / \"SUB\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SUB\".\"WED_SALES1\" / \"SUB\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SUB\".\"THU_SALES1\" / \"SUB\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SUB\".\"FRI_SALES1\" / \"SUB\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SUB\".\"SAT_SALES1\" / \"SUB\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SUB\" AS \"SUB\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 35.42889,
                    "execution_time": 35.186613,
                    "compile_time": 0.000264,
                    "planning_time": 0.029111,
                    "create_size": 19969
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 34.340391,
                    "execution_time": 34.013359,
                    "compile_time": 0.001252,
                    "planning_time": 0.09622,
                    "create_size": 19969
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_5\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.917877,
                    "execution_time": 8.852181,
                    "compile_time": 0.000369,
                    "planning_time": 0.032299,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.610991,
                    "execution_time": 12.478494,
                    "compile_time": 0.003613,
                    "planning_time": 0.093015,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080181,
                    "execution_time": 0.041048,
                    "compile_time": 0.00031,
                    "planning_time": 0.006985,
                    "create_size": 54
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.416311,
                    "execution_time": 0.042732,
                    "compile_time": 0.275291,
                    "planning_time": 0.063621,
                    "create_size": 54
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5143    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n1          5361    0.00    0.01    0.01    0.01    0.01    0.01    0.01\n2          5141    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n3          5270    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n4          5316    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n5          5372    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n6          5116    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n7          5142    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n8          5235    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n9          5289    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n10         5236    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n11         5347    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n12         5124    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n13         5154    0.00    0.01    0.01    0.01    0.01    0.01    0.01\n14         5189    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n15         5221    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n16         5332    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n17         5149    0.00    0.01    0.01    0.01    0.01    0.01    0.01\n18         5331    0.00    0.00    0.00    0.00    0.00    0.00     NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020738,
                    "execution_time": 0.007126,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.006009
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.205646,
                    "execution_time": 0.007583,
                    "compile_time": 0.147874,
                    "planning_time": 0.041664
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5143    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n1          5361    0.00    0.01    0.01    0.01    0.01    0.01    0.01\n2          5141    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n3          5270    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n4          5316    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n5          5372    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n6          5116    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n7          5142    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n8          5235    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n9          5289    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n10         5236    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n11         5347    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n12         5124    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n13         5154    0.00    0.01    0.01    0.01    0.01    0.01    0.01\n14         5189    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n15         5221    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n16         5332    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n17         5149    0.00    0.01    0.01    0.01    0.01    0.01    0.01\n18         5331    0.00    0.00    0.00    0.00    0.00    0.00     NaN\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n/*CURSOR_IDENTIFIER*/\n        ,sum(sun_sales) over () sun_sales2\n        ,sum(mon_sales) over () mon_sales2\n        ,sum(tue_sales) over () tue_sales2\n        ,sum(wed_sales) over () wed_sales2\n        ,sum(thu_sales) over () thu_sales2\n        ,sum(fri_sales) over () fri_sales2\n        ,sum(sat_sales) over () sat_sales2\n  from wswscs) sub",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSWSCS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSWSCS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSWSCS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSWSCS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSWSCS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSWSCS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSWSCS\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH WSCS AS ( SELECT SOLD_DATE_SK , SALES_PRICE FROM ( SELECT WS_SOLD_DATE_SK AS SOLD_DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE FROM WEB_SALES UNION ALL SELECT CS_SOLD_DATE_SK AS SOLD_DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE FROM CATALOG_SALES ) ) , WSWSCS AS ( SELECT D_WEEK_SEQ , SUM ( CASE WHEN ( D_DAY_NAME = 'Sunday' ) THEN SALES_PRICE ELSE NULL END ) AS SUN_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Monday' ) THEN SALES_PRICE ELSE NULL END ) AS MON_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Tuesday' ) THEN SALES_PRICE ELSE NULL END ) AS TUE_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Wednesday' ) THEN SALES_PRICE ELSE NULL END ) AS WED_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Thursday' ) THEN SALES_PRICE ELSE NULL END ) AS THU_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Friday' ) THEN SALES_PRICE ELSE NULL END ) AS FRI_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Saturday' ) THEN SALES_PRICE ELSE NULL END ) AS SAT_SALES FROM WSCS , DATE_DIM WHERE D_DATE_SK = SOLD_DATE_SK GROUP BY D_WEEK_SEQ ) SELECT D_WEEK_SEQ1 , ROUND ( SUN_SALES1 / SUN_SALES2 , 2 ) , ROUND ( MON_SALES1 / MON_SALES2 , 2 ) , ROUND ( TUE_SALES1 / TUE_SALES2 , 2 ) , ROUND ( WED_SALES1 / WED_SALES2 , 2 ) , ROUND ( THU_SALES1 / THU_SALES2 , 2 ) , ROUND ( FRI_SALES1 / FRI_SALES2 , 2 ) , ROUND ( SAT_SALES1 / SAT_SALES2 , 2 ) FROM ( SELECT WSWSCS.D_WEEK_SEQ AS D_WEEK_SEQ1 , SUN_SALES AS SUN_SALES1 , MON_SALES AS MON_SALES1 , TUE_SALES AS TUE_SALES1 , WED_SALES AS WED_SALES1 , THU_SALES AS THU_SALES1 , FRI_SALES AS FRI_SALES1 , SAT_SALES AS SAT_SALES1 , SUM ( SUN_SALES ) OVER ( ) AS SUN_SALES2 , SUM ( MON_SALES ) OVER ( ) AS MON_SALES2 , SUM ( TUE_SALES ) OVER ( ) AS TUE_SALES2 , SUM ( WED_SALES ) OVER ( ) AS WED_SALES2 , SUM ( THU_SALES ) OVER ( ) AS THU_SALES2 , SUM ( FRI_SALES ) OVER ( ) AS FRI_SALES2 , SUM ( SAT_SALES ) OVER ( ) AS SAT_SALES2 FROM WSWSCS ) AS SUB LIMIT 21",
                "preview": "\n/*    d_week_seq1  round  round  round  round  round  round  round\n0          5116   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n1          5118   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n2          5128   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n3          5138   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n4          5140   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n5          5142   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n6          5147   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n7          5154   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n8          5156   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n9          5157   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n10         5169   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n11         5174   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n12         5189   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n13         5208   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n14         5214   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n15         5215   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n16         5218   0.00   0.00   0.01   0.01   0.01   0.01   0.00\n17         5220   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n18         5221   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 10.070004,
                    "execution_time": 9.987101,
                    "compile_time": 0.000201,
                    "planning_time": 0.063766
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.960477,
                    "execution_time": 14.38567,
                    "compile_time": 4.419099,
                    "planning_time": 0.131528
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    d_week_seq1  round  round  round  round  round  round  round\n0          5116   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n1          5118   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n2          5128   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n3          5138   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n4          5140   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n5          5142   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n6          5147   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n7          5154   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n8          5156   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n9          5157   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n10         5169   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n11         5174   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n12         5189   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n13         5208   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n14         5214   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n15         5215   0.01   0.01   0.01   0.01   0.01   0.01   0.01\n16         5218   0.00   0.00   0.01   0.01   0.01   0.01   0.00\n17         5220   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n18         5221   0.00   0.00   0.00   0.00   0.00   0.00   0.00\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from  web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select wswscs.d_week_seq d_week_seq1\n       ,round(sun_sales/sun_sales2,2)\n       ,round(mon_sales/mon_sales2,2)\n       ,round(tue_sales/tue_sales2,2)\n       ,round(wed_sales/wed_sales2,2)\n       ,round(thu_sales/thu_sales2,2)\n       ,round(fri_sales/fri_sales2,2)\n       ,round(sat_sales/sat_sales2,2)\n from wswscs\n -- Assuming that sun_sales2, mon_sales2, etc., are supposed to be compared against some other dataset\n join (\n     select d_week_seq as week_seq2,\n            sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales2,\n            sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales2,\n            sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales2,\n            sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales2,\n            sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales2,\n            sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales2,\n            sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales2\n      from wscs\n          ,date_dim\n      where d_date_sk = sold_date_sk\n      group by d_week_seq\n ) as other_aggregates\n on wswscs.d_week_seq = other_aggregates.week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSCS\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WSCS\" AS \"WSCS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WSCS\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"OTHER_AGGREGATES\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"WEEK_SEQ2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES2\" FROM \"WSCS\" AS \"WSCS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WSCS\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"OTHER_AGGREGATES\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"OTHER_AGGREGATES\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"OTHER_AGGREGATES\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"OTHER_AGGREGATES\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"OTHER_AGGREGATES\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"OTHER_AGGREGATES\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"OTHER_AGGREGATES\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"OTHER_AGGREGATES\" AS \"OTHER_AGGREGATES\" ON \"OTHER_AGGREGATES\".\"WEEK_SEQ2\" = \"WSWSCS\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.199055,
                    "execution_time": 8.963343,
                    "compile_time": 0.000258,
                    "planning_time": 0.024551,
                    "create_size": 10240
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.555259,
                    "execution_time": 9.246991,
                    "compile_time": 0.001177,
                    "planning_time": 0.085568,
                    "create_size": 10240
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.131246,
                    "execution_time": 0.043455,
                    "compile_time": 0.000253,
                    "planning_time": 0.026595,
                    "create_size": 576
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.331723,
                    "execution_time": 0.045811,
                    "compile_time": 0.13779,
                    "planning_time": 0.084,
                    "create_size": 576
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.040348,
                    "execution_time": 2.996829,
                    "compile_time": 0.000352,
                    "planning_time": 0.010841,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.117299,
                    "execution_time": 3.007211,
                    "compile_time": 0.003237,
                    "planning_time": 0.07175,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"WEEK_SEQ2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.03408,
                    "execution_time": 2.990668,
                    "compile_time": 0.000371,
                    "planning_time": 0.010823,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.098025,
                    "execution_time": 2.998675,
                    "compile_time": 0.000367,
                    "planning_time": 0.066361,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"WEEK_SEQ2\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101986,
                    "execution_time": 0.065985,
                    "compile_time": 0.000273,
                    "planning_time": 0.008018,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.422467,
                    "execution_time": 0.106969,
                    "compile_time": 0.220563,
                    "planning_time": 0.065871,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5213     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5170     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5120     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5274     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5210     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5324     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5222     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5188     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5137     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018525,
                    "execution_time": 0.008336,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003962
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054326,
                    "execution_time": 0.008972,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038975
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_10\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"WEEK_SEQ2\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5213     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5170     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5120     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5274     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5210     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5324     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5222     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5188     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5137     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2) as ratio_sun_sales\n       ,round(mon_sales1/mon_sales2,2) as ratio_mon_sales\n       ,round(tue_sales1/tue_sales2,2) as ratio_tue_sales\n       ,round(wed_sales1/wed_sales2,2) as ratio_wed_sales\n       ,round(thu_sales1/thu_sales2,2) as ratio_thu_sales\n       ,round(fri_sales1/fri_sales2,2) as ratio_fri_sales\n       ,round(sat_sales1/sat_sales2,2) as ratio_sat_sales\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq\n  ), \n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq\n )\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085683,
                    "execution_time": 0.044196,
                    "compile_time": 0.000247,
                    "planning_time": 0.00292,
                    "create_size": 384
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.145172,
                    "execution_time": 0.044342,
                    "compile_time": 0.000257,
                    "planning_time": 0.06544,
                    "create_size": 384
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.143543,
                    "execution_time": 0.074597,
                    "compile_time": 0.000422,
                    "planning_time": 0.011222,
                    "create_size": 242
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.607904,
                    "execution_time": 0.312731,
                    "compile_time": 0.167635,
                    "planning_time": 0.068319,
                    "create_size": 198
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_SUN_SALES\" AS \"RATIO_SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_MON_SALES\" AS \"RATIO_MON_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_TUE_SALES\" AS \"RATIO_TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_WED_SALES\" AS \"RATIO_WED_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_THU_SALES\" AS \"RATIO_THU_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_FRI_SALES\" AS \"RATIO_FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_SAT_SALES\" AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  ratio_sun_sales  ratio_mon_sales  ratio_tue_sales  ratio_wed_sales  ratio_thu_sales  ratio_fri_sales  ratio_sat_sales\n0          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n1          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n2          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n3          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n4          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n5          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n6          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n7          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n8          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n9          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n10         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n11         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n12         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n13         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n14         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n15         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n16         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n17         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n18         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017545,
                    "execution_time": 0.007177,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.00407
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053498,
                    "execution_time": 0.007347,
                    "compile_time": 5e-05,
                    "planning_time": 0.039185
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_SUN_SALES\" AS \"RATIO_SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_MON_SALES\" AS \"RATIO_MON_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_TUE_SALES\" AS \"RATIO_TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_WED_SALES\" AS \"RATIO_WED_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_THU_SALES\" AS \"RATIO_THU_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_FRI_SALES\" AS \"RATIO_FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"RATIO_SAT_SALES\" AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    d_week_seq1  ratio_sun_sales  ratio_mon_sales  ratio_tue_sales  ratio_wed_sales  ratio_thu_sales  ratio_fri_sales  ratio_sat_sales\n0          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n1          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n2          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n3          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n4          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n5          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n6          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n7          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n8          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n9          5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n10         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n11         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n12         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n13         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n14         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n15         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n16         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n17         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n18         5178              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs\n  where wswscs.d_week_seq IS NOT NULL) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n  where wswscs.d_week_seq IS NOT NULL) x \n where y.d_week_seq1 = x.d_week_seq2\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"WSWSCS\".\"D_WEEK_SEQ\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103239,
                    "execution_time": 0.065645,
                    "compile_time": 0.000284,
                    "planning_time": 0.00965,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.808262,
                    "execution_time": 0.616936,
                    "compile_time": 0.095361,
                    "planning_time": 0.066993,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5120     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5170     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5274     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5213     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5137     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5324     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5188     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5210     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5222     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5323     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5206     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018939,
                    "execution_time": 0.008437,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004077
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054727,
                    "execution_time": 0.009094,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039105
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" IS NULL",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5120     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5170     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5274     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5213     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5137     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5324     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5188     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5210     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5222     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5323     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5206     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs\n  join date_dim on date_dim.d_week_seq = wswscs.d_week_seq and\n  d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n  join date_dim on date_dim.d_week_seq = wswscs.d_week_seq and\n  d_year = 2001) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001 ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH WSCS AS ( SELECT SOLD_DATE_SK , SALES_PRICE FROM ( SELECT WS_SOLD_DATE_SK AS SOLD_DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE FROM WEB_SALES UNION ALL SELECT CS_SOLD_DATE_SK AS SOLD_DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE FROM CATALOG_SALES ) ) , WSWSCS AS ( SELECT D_WEEK_SEQ , SUM ( CASE WHEN ( D_DAY_NAME = 'Sunday' ) THEN SALES_PRICE ELSE NULL END ) AS SUN_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Monday' ) THEN SALES_PRICE ELSE NULL END ) AS MON_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Tuesday' ) THEN SALES_PRICE ELSE NULL END ) AS TUE_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Wednesday' ) THEN SALES_PRICE ELSE NULL END ) AS WED_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Thursday' ) THEN SALES_PRICE ELSE NULL END ) AS THU_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Friday' ) THEN SALES_PRICE ELSE NULL END ) AS FRI_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Saturday' ) THEN SALES_PRICE ELSE NULL END ) AS SAT_SALES FROM WSCS , DATE_DIM WHERE D_DATE_SK = SOLD_DATE_SK GROUP BY D_WEEK_SEQ ) SELECT D_WEEK_SEQ1 , ROUND ( SUN_SALES1 / SUN_SALES2 , 2 ) , ROUND ( MON_SALES1 / MON_SALES2 , 2 ) , ROUND ( TUE_SALES1 / TUE_SALES2 , 2 ) , ROUND ( WED_SALES1 / WED_SALES2 , 2 ) , ROUND ( THU_SALES1 / THU_SALES2 , 2 ) , ROUND ( FRI_SALES1 / FRI_SALES2 , 2 ) , ROUND ( SAT_SALES1 / SAT_SALES2 , 2 ) FROM ( SELECT WSWSCS.D_WEEK_SEQ AS D_WEEK_SEQ1 , SUN_SALES AS SUN_SALES1 , MON_SALES AS MON_SALES1 , TUE_SALES AS TUE_SALES1 , WED_SALES AS WED_SALES1 , THU_SALES AS THU_SALES1 , FRI_SALES AS FRI_SALES1 , SAT_SALES AS SAT_SALES1 FROM WSWSCS JOIN DATE_DIM ON DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ AND D_YEAR = 2001 ) AS Y , ( SELECT WSWSCS.D_WEEK_SEQ AS D_WEEK_SEQ2 , SUN_SALES AS SUN_SALES2 , MON_SALES AS MON_SALES2 , TUE_SALES AS TUE_SALES2 , WED_SALES AS WED_SALES2 , THU_SALES AS THU_SALES2 , FRI_SALES AS FRI_SALES2 , SAT_SALES AS SAT_SALES2 FROM WSWSCS JOIN DATE_DIM ON DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ AND D_YEAR = 2001 ) AS X LIMIT 21",
                "preview": "\n/*    d_week_seq1  round  round  round  round  round  round  round\n0          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n1          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n2          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n3          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n4          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n5          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n6          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n7          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n8          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n9          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n10         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n11         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n12         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n13         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n14         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n15         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n16         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n17         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n18         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 10.381413,
                    "execution_time": 10.089714,
                    "compile_time": 0.108556,
                    "planning_time": 10.246288
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.468563,
                    "execution_time": 10.957172,
                    "compile_time": 7.258605,
                    "planning_time": 11.178359
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    d_week_seq1  round  round  round  round  round  round  round\n0          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n1          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n2          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n3          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n4          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n5          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n6          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n7          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n8          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n9          5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n10         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n11         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n12         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n13         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n14         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n15         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n16         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n17         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n18         5302   0.66   0.66   0.66   0.66   0.66   0.66   0.66\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)), -- Changed 'catalog_sales' to 'web_sales'\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        date_dim.d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        date_dim.d_year = 2002) x  -- Added complete second subquery\n /*CURSOR_IDENTIFIER*/\n where d_week_seq1 = d_week_seq2\n order by d_week_seq1;",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101123,
                    "execution_time": 0.033884,
                    "compile_time": 0.000326,
                    "planning_time": 0.038594,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.186209,
                    "execution_time": 0.049679,
                    "compile_time": 0.005918,
                    "planning_time": 0.102034,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ORDER BY \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020365,
                    "execution_time": 0.008648,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.005365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055957,
                    "execution_time": 0.008191,
                    "compile_time": 0.001902,
                    "planning_time": 0.040074
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.099625,
                    "execution_time": 0.033819,
                    "compile_time": 0.000309,
                    "planning_time": 0.038066,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.165558,
                    "execution_time": 0.032924,
                    "compile_time": 0.000311,
                    "planning_time": 0.104221,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018951,
                    "execution_time": 0.007775,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.005014
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054173,
                    "execution_time": 0.007378,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039988
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim\n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\nwhere d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 53.474947,
                    "execution_time": 53.234834,
                    "compile_time": 0.000261,
                    "planning_time": 0.033818,
                    "create_size": 29570
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 57.517956,
                    "execution_time": 57.182335,
                    "compile_time": 0.00028,
                    "planning_time": 0.112561,
                    "create_size": 29570
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_18\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_18\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 19.144741,
                    "execution_time": 19.080348,
                    "compile_time": 0.00034,
                    "planning_time": 0.032086,
                    "create_size": 1243
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.385618,
                    "execution_time": 19.251988,
                    "compile_time": 0.001452,
                    "planning_time": 0.098054,
                    "create_size": 1243
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101684,
                    "execution_time": 0.034176,
                    "compile_time": 0.000316,
                    "planning_time": 0.038608,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.175968,
                    "execution_time": 0.033786,
                    "compile_time": 0.00032,
                    "planning_time": 0.112781,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018513,
                    "execution_time": 0.007293,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.005075
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053793,
                    "execution_time": 0.007447,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.040015
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018647,
                    "execution_time": 0.007705,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004792
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05469,
                    "execution_time": 0.008439,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039869
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018067,
                    "execution_time": 0.007122,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00488
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018599,
                    "execution_time": 0.007313,
                    "compile_time": 5e-05,
                    "planning_time": 0.005051
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs)\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.472818,
                    "execution_time": 0.078969,
                    "compile_time": 0.000335,
                    "planning_time": 0.037195,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.717996,
                    "execution_time": 0.082625,
                    "compile_time": 0.165703,
                    "planning_time": 0.110696,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296    0.29    0.29    0.28    0.29    0.30    0.29    0.29\n1          5296    0.44    0.44    0.43    0.44    0.44    0.44    0.45\n2          5296    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n3          5296    0.44    0.44    0.43    0.44    0.45    0.44    0.44\n4          5296    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n5          5296    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n6          5296    1.00    1.01    1.00    1.00    1.02    1.01    1.01\n7          5296    1.00    1.00    0.99    0.99    1.02    1.00    1.01\n8          5296    1.00    1.01    0.97    1.00    1.01    1.01    1.01\n9          5296    0.44    0.44    0.43    0.44    0.45    0.45    0.45\n10         5296    1.00    0.99    0.96    1.01    1.00    1.00    1.02\n11         5296    1.01    0.99    0.99    1.01    1.02    1.00    1.01\n12         5296    0.44    0.44    0.44    0.44    0.45    0.44    0.45\n13         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.45\n14         5296    1.00    1.02    0.99    1.00    1.01    1.00    1.02\n15         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.44\n16         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.45\n17         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.44\n18         5296    0.29    0.29    0.29    0.29    0.30    0.29    0.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017703,
                    "execution_time": 0.00732,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00399
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053855,
                    "execution_time": 0.007615,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039132
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296    0.29    0.29    0.28    0.29    0.30    0.29    0.29\n1          5296    0.44    0.44    0.43    0.44    0.44    0.44    0.45\n2          5296    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n3          5296    0.44    0.44    0.43    0.44    0.45    0.44    0.44\n4          5296    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n5          5296    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n6          5296    1.00    1.01    1.00    1.00    1.02    1.01    1.01\n7          5296    1.00    1.00    0.99    0.99    1.02    1.00    1.01\n8          5296    1.00    1.01    0.97    1.00    1.01    1.01    1.01\n9          5296    0.44    0.44    0.43    0.44    0.45    0.45    0.45\n10         5296    1.00    0.99    0.96    1.01    1.00    1.00    1.02\n11         5296    1.01    0.99    0.99    1.01    1.02    1.00    1.01\n12         5296    0.44    0.44    0.44    0.44    0.45    0.44    0.45\n13         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.45\n14         5296    1.00    1.02    0.99    1.00    1.01    1.00    1.02\n15         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.44\n16         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.45\n17         5296    0.44    0.44    0.43    0.44    0.45    0.44    0.44\n18         5296    0.29    0.29    0.29    0.29    0.30    0.29    0.29\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq)/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.508176,
                    "execution_time": 0.207562,
                    "compile_time": 0.000499,
                    "planning_time": 0.03538,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.584702,
                    "execution_time": 0.209708,
                    "compile_time": 0.005651,
                    "planning_time": 0.104973,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n1          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n2          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n3          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n4          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n5          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n6          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n7          5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n8          5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n9          5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n10         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n11         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n12         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n13         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n14         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n15         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n16         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n17         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n18         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017567,
                    "execution_time": 0.007406,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003929
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053659,
                    "execution_time": 0.007635,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039134
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n1          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n2          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n3          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n4          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n5          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n6          5274    1.00    0.99    1.00    1.00    1.00    1.00    1.00\n7          5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n8          5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n9          5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n10         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n11         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n12         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n13         5274    0.54    0.44    1.00    1.00    1.01    1.00    1.00\n14         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n15         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n16         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n17         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n18         5274    0.29    0.29    0.29    0.29    0.29    0.29    0.29\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n    d_year = 2001\n/*CURSOR_IDENTIFIER*/\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001 ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080505,
                    "execution_time": 0.031368,
                    "compile_time": 0.000238,
                    "planning_time": 0.026054,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.142951,
                    "execution_time": 0.03136,
                    "compile_time": 0.001185,
                    "planning_time": 0.085784,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_23\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" JOIN \"SPEQLITE_TEMP_TABLE_23\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.591027,
                    "execution_time": 0.114343,
                    "compile_time": 0.000518,
                    "planning_time": 0.010551,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.787568,
                    "execution_time": 0.12197,
                    "compile_time": 0.128671,
                    "planning_time": 0.068402,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n1          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n2          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n3          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n4          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n5          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n6          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n7          5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n8          5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n9          5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n10         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n11         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n12         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n13         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n14         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n15         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n16         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n17         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n18         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018507,
                    "execution_time": 0.007998,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004042
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053705,
                    "execution_time": 0.007607,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039164
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_23\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" JOIN \"SPEQLITE_TEMP_TABLE_23\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n1          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n2          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n3          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n4          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n5          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n6          5302    1.00    1.00    1.00    1.00    1.00    1.00    1.00\n7          5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n8          5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n9          5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n10         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n11         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n12         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n13         5302    2.27    2.26    2.28    2.27    2.28    2.27    2.26\n14         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n15         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n16         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n17         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n18         5302    2.27    2.27    2.26    2.29    2.26    2.27    2.27\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002 LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.045283,
                    "execution_time": 0.01023,
                    "compile_time": 9e-05,
                    "planning_time": 0.02713
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.229484,
                    "execution_time": 0.010134,
                    "compile_time": 0.1301,
                    "planning_time": 0.082038
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5291     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.135752,
                    "execution_time": 0.06053,
                    "compile_time": 0.000381,
                    "planning_time": 0.038617,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.20553,
                    "execution_time": 0.060521,
                    "compile_time": 0.003541,
                    "planning_time": 0.103013,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n1          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n2          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n3          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n4          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n5          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n6          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n7          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n8          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n9          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n10         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n11         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n12         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n13         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n14         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n15         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n16         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n17         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n18         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017835,
                    "execution_time": 0.007392,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004046
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053841,
                    "execution_time": 0.007902,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039003
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n1          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n2          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n3          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n4          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n5          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n6          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n7          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n8          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n9          5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n10         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n11         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n12         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n13         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n14         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n15         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n16         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n17         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n18         5296     1.0     1.0    0.99     1.0    1.01     1.0    1.01\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n1          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n2          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n3          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n4          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n5          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n6          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n7          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n8          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n9          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n10         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n11         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n12         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n13         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n14         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n15         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n16         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n17         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n18         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018976,
                    "execution_time": 0.008421,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004203
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055299,
                    "execution_time": 0.009088,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.039199
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n1          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n2          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n3          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n4          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n5          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n6          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n7          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n8          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n9          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n10         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n11         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n12         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n13         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n14         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n15         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n16         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n17         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n18         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n1          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n2          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n3          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n4          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n5          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n6          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n7          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n8          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n9          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n10         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n11         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n12         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n13         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n14         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n15         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n16         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n17         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n18         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019239,
                    "execution_time": 0.008913,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019567,
                    "execution_time": 0.008662,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004429
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_19\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n1          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n2          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n3          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n4          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n5          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n6          5270    3.45    1.81    1.89    1.59    3.47    3.46    3.44\n7          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n8          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n9          5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n10         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n11         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n12         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n13         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n14         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n15         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n16         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n17         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n18         5271    0.99    1.00    1.00    1.00    1.00    1.00    1.00\n...*/"
    }
]