[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select NULL as w_warehouse_name\n            ,NULL as i_item_id\n            ,sum(case when INV_DATE_SK < 20000519\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when INV_DATE_SK >= 20000519\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n/*CURSOR_IDENTIFIER*/) as subquery",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT NULL AS \"W_WAREHOUSE_NAME\" , NULL AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" < 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" >= 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" ) SELECT \"SUBQUERY\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SUBQUERY\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SUBQUERY\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SUBQUERY\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT NULL AS \"W_WAREHOUSE_NAME\" , NULL AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" < 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" >= 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.525539,
                    "execution_time": 0.473377,
                    "compile_time": 0.000326,
                    "planning_time": 0.025479,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.559414,
                    "execution_time": 12.504853,
                    "compile_time": 0.003375,
                    "planning_time": 0.022581,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name i_item_id    inv_before  inv_after\n0             None      None  371913888597          0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016567,
                    "execution_time": 0.00727,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003341
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053909,
                    "execution_time": 0.007446,
                    "compile_time": 0.00096,
                    "planning_time": 0.038616
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*  w_warehouse_name i_item_id    inv_before  inv_after\n0             None      None  371913888597          0*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.137841,
                    "execution_time": 1.7556,
                    "compile_time": 0.068799,
                    "planning_time": 0.045209,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.031258,
                    "execution_time": 6.348538,
                    "compile_time": 3.289735,
                    "planning_time": 0.119941,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAPFKBAAAA       58130      64281\n1   Conventional childr  AAAAAAAAIDDDAAAA       57630      14173\n2   Conventional childr  AAAAAAAAMIDDAAAA       61078      13977\n3   Conventional childr  AAAAAAAAAOLEAAAA       57820      16426\n4   Conventional childr  AAAAAAAAOEMEAAAA       52673          0\n5   Conventional childr  AAAAAAAAEIMEAAAA       47523          0\n6   Conventional childr  AAAAAAAAOMNHAAAA       51531          0\n7   Conventional childr  AAAAAAAAMPNHAAAA       58177      16627\n8   Conventional childr  AAAAAAAAGGHJAAAA       46401          0\n9   Conventional childr  AAAAAAAADNBOAAAA       66483      63413\n10  Conventional childr  AAAAAAAACFEBBAAA       50168          0\n11  Conventional childr  AAAAAAAACGPFBAAA       57995      17454\n12  Conventional childr  AAAAAAAAGBKKBAAA       52957          0\n13  Conventional childr  AAAAAAAAPGDMBAAA       57535      65503\n14  Conventional childr  AAAAAAAAMHDMBAAA       57845      15949\n15  Conventional childr  AAAAAAAAIGFPBAAA       62690      13719\n16  Conventional childr  AAAAAAAAGNNACAAA       48002          0\n17  Conventional childr  AAAAAAAABCOACAAA       54269      69417\n18  Conventional childr  AAAAAAAAOCOACAAA       63210      13895\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017567,
                    "execution_time": 0.008207,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003384
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.133751,
                    "execution_time": 0.008047,
                    "compile_time": 0.079872,
                    "planning_time": 0.03836
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAPFKBAAAA       58130      64281\n1   Conventional childr  AAAAAAAAIDDDAAAA       57630      14173\n2   Conventional childr  AAAAAAAAMIDDAAAA       61078      13977\n3   Conventional childr  AAAAAAAAAOLEAAAA       57820      16426\n4   Conventional childr  AAAAAAAAOEMEAAAA       52673          0\n5   Conventional childr  AAAAAAAAEIMEAAAA       47523          0\n6   Conventional childr  AAAAAAAAOMNHAAAA       51531          0\n7   Conventional childr  AAAAAAAAMPNHAAAA       58177      16627\n8   Conventional childr  AAAAAAAAGGHJAAAA       46401          0\n9   Conventional childr  AAAAAAAADNBOAAAA       66483      63413\n10  Conventional childr  AAAAAAAACFEBBAAA       50168          0\n11  Conventional childr  AAAAAAAACGPFBAAA       57995      17454\n12  Conventional childr  AAAAAAAAGBKKBAAA       52957          0\n13  Conventional childr  AAAAAAAAPGDMBAAA       57535      65503\n14  Conventional childr  AAAAAAAAMHDMBAAA       57845      15949\n15  Conventional childr  AAAAAAAAIGFPBAAA       62690      13719\n16  Conventional childr  AAAAAAAAGNNACAAA       48002          0\n17  Conventional childr  AAAAAAAABCOACAAA       54269      69417\n18  Conventional childr  AAAAAAAAOCOACAAA       63210      13895\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date)) and cast ('2000-05-19' as date)\n   group by w_warehouse_name, i_item_id\n/*CURSOR_IDENTIFIER*/\n   )",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-05-19' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND CAST ( '2000-05-19' AS DATE ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0         Important dem  AAAAAAAAELLCDAAA        2106          0\n1         Important dem  AAAAAAAAKEEEDAAA        1905          0\n2         Important dem  AAAAAAAAICNFDAAA        2591          0\n3   Conventional childr  AAAAAAAAPNNCAAAA        2217          0\n4         Important dem  AAAAAAAAPAGHDAAA        3081          0\n5   Conventional childr  AAAAAAAAOJPFAAAA        3327          0\n6   Conventional childr  AAAAAAAALPPFAAAA        1890          0\n7   Conventional childr  AAAAAAAAABAGAAAA        2983          0\n8   Conventional childr  AAAAAAAACFIHAAAA        2285          0\n9   Conventional childr  AAAAAAAANJIHAAAA         987          0\n10  Conventional childr  AAAAAAAAHMIHAAAA        1773          0\n11        Important dem  AAAAAAAAOGIKDAAA         797          0\n12  Conventional childr  AAAAAAAAMGBJAAAA        2680          0\n13        Important dem  AAAAAAAAJKIKDAAA        2722          0\n14        Important dem  AAAAAAAAAABMDAAA        2211          0\n15        Important dem  AAAAAAAALEBMDAAA        2009          0\n16        Important dem  AAAAAAAADEDPDAAA        2566          0\n17        Important dem  AAAAAAAAIHMAEAAA        2855          0\n18        Important dem  AAAAAAAAAGFCEAAA        2617          0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.138011,
                    "execution_time": 0.077306,
                    "compile_time": 0.000249,
                    "planning_time": 0.044631
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.204713,
                    "execution_time": 0.073146,
                    "compile_time": 0.002291,
                    "planning_time": 0.113029
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0         Important dem  AAAAAAAAELLCDAAA        2106          0\n1         Important dem  AAAAAAAAKEEEDAAA        1905          0\n2         Important dem  AAAAAAAAICNFDAAA        2591          0\n3   Conventional childr  AAAAAAAAPNNCAAAA        2217          0\n4         Important dem  AAAAAAAAPAGHDAAA        3081          0\n5   Conventional childr  AAAAAAAAOJPFAAAA        3327          0\n6   Conventional childr  AAAAAAAALPPFAAAA        1890          0\n7   Conventional childr  AAAAAAAAABAGAAAA        2983          0\n8   Conventional childr  AAAAAAAACFIHAAAA        2285          0\n9   Conventional childr  AAAAAAAANJIHAAAA         987          0\n10  Conventional childr  AAAAAAAAHMIHAAAA        1773          0\n11        Important dem  AAAAAAAAOGIKDAAA         797          0\n12  Conventional childr  AAAAAAAAMGBJAAAA        2680          0\n13        Important dem  AAAAAAAAJKIKDAAA        2722          0\n14        Important dem  AAAAAAAAAABMDAAA        2211          0\n15        Important dem  AAAAAAAALEBMDAAA        2009          0\n16        Important dem  AAAAAAAADEDPDAAA        2566          0\n17        Important dem  AAAAAAAAIHMAEAAA        2855          0\n18        Important dem  AAAAAAAAAGFCEAAA        2617          0\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAEKEBAAAA        2406       1895\n1   Conventional childr  AAAAAAAACNEBAAAA        1475       1639\n2         Important dem  AAAAAAAAHDNFDAAA        1835       2118\n3   Conventional childr  AAAAAAAABFGEAAAA        2502       1882\n4   Conventional childr  AAAAAAAAFAHEAAAA        1953       1536\n5   Conventional childr  AAAAAAAABHPFAAAA        2558       1221\n6         Important dem  AAAAAAAAHAIKDAAA        1502       1945\n7         Important dem  AAAAAAAAGEIKDAAA         706       1574\n8         Important dem  AAAAAAAACJIKDAAA        2764       2077\n9   Conventional childr  AAAAAAAACKBJAAAA        2068       2394\n10        Important dem  AAAAAAAAGHBMDAAA        3456       1601\n11  Conventional childr  AAAAAAAACJKKAAAA        2252       1420\n12        Important dem  AAAAAAAAEPJNDAAA        2946       2138\n13  Conventional childr  AAAAAAAAPLKKAAAA        2407       1116\n14        Important dem  AAAAAAAANKKNDAAA        2646       1910\n15  Conventional childr  AAAAAAAAIJDMAAAA        3732       2121\n16        Important dem  AAAAAAAAMKDPDAAA        1456       1315\n17        Important dem  AAAAAAAADDMAEAAA        2950       2678\n18  Conventional childr  AAAAAAAAIHFPAAAA        2285       1606\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.160544,
                    "execution_time": 0.097822,
                    "compile_time": 0.000241,
                    "planning_time": 0.046585
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.234684,
                    "execution_time": 0.103833,
                    "compile_time": 0.000267,
                    "planning_time": 0.113265
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAEKEBAAAA        2406       1895\n1   Conventional childr  AAAAAAAACNEBAAAA        1475       1639\n2         Important dem  AAAAAAAAHDNFDAAA        1835       2118\n3   Conventional childr  AAAAAAAABFGEAAAA        2502       1882\n4   Conventional childr  AAAAAAAAFAHEAAAA        1953       1536\n5   Conventional childr  AAAAAAAABHPFAAAA        2558       1221\n6         Important dem  AAAAAAAAHAIKDAAA        1502       1945\n7         Important dem  AAAAAAAAGEIKDAAA         706       1574\n8         Important dem  AAAAAAAACJIKDAAA        2764       2077\n9   Conventional childr  AAAAAAAACKBJAAAA        2068       2394\n10        Important dem  AAAAAAAAGHBMDAAA        3456       1601\n11  Conventional childr  AAAAAAAACJKKAAAA        2252       1420\n12        Important dem  AAAAAAAAEPJNDAAA        2946       2138\n13  Conventional childr  AAAAAAAAPLKKAAAA        2407       1116\n14        Important dem  AAAAAAAANKKNDAAA        2646       1910\n15  Conventional childr  AAAAAAAAIJDMAAAA        3732       2121\n16        Important dem  AAAAAAAAMKDPDAAA        1456       1315\n17        Important dem  AAAAAAAADDMAEAAA        2950       2678\n18  Conventional childr  AAAAAAAAIHFPAAAA        2285       1606\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAGOIBAAAA        2462       2277\n1   Conventional childr  AAAAAAAAMDKEAAAA        2166       1131\n2   Conventional childr  AAAAAAAAOJKEAAAA        2599       1836\n3   Conventional childr  AAAAAAAAMPMHAAAA        2000       2203\n4   Conventional childr  AAAAAAAAGJFJAAAA        3348       1716\n5         Important dem  AAAAAAAAODFMDAAA        2790       2046\n6   Conventional childr  AAAAAAAAIIOKAAAA        2842       1899\n7   Conventional childr  AAAAAAAAKJOKAAAA        2496       1073\n8   Conventional childr  AAAAAAAAJJHMAAAA        1815       1645\n9         Important dem  AAAAAAAAOCHPDAAA        2402       2683\n10  Conventional childr  AAAAAAAAGNCBBAAA        3453       1827\n11  Conventional childr  AAAAAAAAALLCBAAA        2096       2855\n12  Conventional childr  AAAAAAAAAHNFBAAA        3407       1535\n13        Important dem  AAAAAAAAOPMIEAAA        2132       1787\n14        Important dem  AAAAAAAAPDNIEAAA        3014       2350\n15  Conventional childr  AAAAAAAABEGHBAAA        2121       2500\n16     Please central m  AAAAAAAAOACBAAAA        3118       1836\n17     Please central m  AAAAAAAAFFCBAAAA        3403       1987\n18     Please central m  AAAAAAAAMICBAAAA        3918       1922\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.158786,
                    "execution_time": 0.098156,
                    "compile_time": 0.00025,
                    "planning_time": 0.044363
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.225022,
                    "execution_time": 0.094706,
                    "compile_time": 0.000253,
                    "planning_time": 0.114066
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAGOIBAAAA        2462       2277\n1   Conventional childr  AAAAAAAAMDKEAAAA        2166       1131\n2   Conventional childr  AAAAAAAAOJKEAAAA        2599       1836\n3   Conventional childr  AAAAAAAAMPMHAAAA        2000       2203\n4   Conventional childr  AAAAAAAAGJFJAAAA        3348       1716\n5         Important dem  AAAAAAAAODFMDAAA        2790       2046\n6   Conventional childr  AAAAAAAAIIOKAAAA        2842       1899\n7   Conventional childr  AAAAAAAAKJOKAAAA        2496       1073\n8   Conventional childr  AAAAAAAAJJHMAAAA        1815       1645\n9         Important dem  AAAAAAAAOCHPDAAA        2402       2683\n10  Conventional childr  AAAAAAAAGNCBBAAA        3453       1827\n11  Conventional childr  AAAAAAAAALLCBAAA        2096       2855\n12  Conventional childr  AAAAAAAAAHNFBAAA        3407       1535\n13        Important dem  AAAAAAAAOPMIEAAA        2132       1787\n14        Important dem  AAAAAAAAPDNIEAAA        3014       2350\n15  Conventional childr  AAAAAAAABEGHBAAA        2121       2500\n16     Please central m  AAAAAAAAOACBAAAA        3118       1836\n17     Please central m  AAAAAAAAFFCBAAAA        3403       1987\n18     Please central m  AAAAAAAAMICBAAAA        3918       1922\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 then 1 else 0 end) = 1\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN 1 ELSE 0 END = 1"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN 1 ELSE 0 END ) = 1 LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAGLEBAAAA        3783       2363\n1   Conventional childr  AAAAAAAAEJNCAAAA         927       1058\n2         Important dem  AAAAAAAADBNFDAAA        2189       2351\n3   Conventional childr  AAAAAAAAMHGEAAAA        2419       1826\n4         Important dem  AAAAAAAAEBIKDAAA        2840       2412\n5   Conventional childr  AAAAAAAACGKKAAAA        3415       1790\n6   Conventional childr  AAAAAAAAMHDMAAAA        2550       1700\n7         Important dem  AAAAAAAAGEDPDAAA        1628       2540\n8   Conventional childr  AAAAAAAAIOMNAAAA        2054       1877\n9         Important dem  AAAAAAAACHMAEAAA        2457       1875\n10        Important dem  AAAAAAAAMGFCEAAA        1704       1766\n11        Important dem  AAAAAAAAPIFCEAAA        2208       1673\n12        Important dem  AAAAAAAANGODEAAA        1395       1787\n13        Important dem  AAAAAAAAKAHFEAAA        2825       1702\n14        Important dem  AAAAAAAAGPPGEAAA        2998       1864\n15  Conventional childr  AAAAAAAAKNAEBAAA        2370       1317\n16  Conventional childr  AAAAAAAAOOJFBAAA        2689       1572\n17  Conventional childr  AAAAAAAAKGCHBAAA        2832       2768\n18     Please central m  AAAAAAAAKBHCAAAA        2870        871\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.162001,
                    "execution_time": 0.100165,
                    "compile_time": 0.000248,
                    "planning_time": 0.045277
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.232091,
                    "execution_time": 0.098784,
                    "compile_time": 0.00223,
                    "planning_time": 0.114441
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAGLEBAAAA        3783       2363\n1   Conventional childr  AAAAAAAAEJNCAAAA         927       1058\n2         Important dem  AAAAAAAADBNFDAAA        2189       2351\n3   Conventional childr  AAAAAAAAMHGEAAAA        2419       1826\n4         Important dem  AAAAAAAAEBIKDAAA        2840       2412\n5   Conventional childr  AAAAAAAACGKKAAAA        3415       1790\n6   Conventional childr  AAAAAAAAMHDMAAAA        2550       1700\n7         Important dem  AAAAAAAAGEDPDAAA        1628       2540\n8   Conventional childr  AAAAAAAAIOMNAAAA        2054       1877\n9         Important dem  AAAAAAAACHMAEAAA        2457       1875\n10        Important dem  AAAAAAAAMGFCEAAA        1704       1766\n11        Important dem  AAAAAAAAPIFCEAAA        2208       1673\n12        Important dem  AAAAAAAANGODEAAA        1395       1787\n13        Important dem  AAAAAAAAKAHFEAAA        2825       1702\n14        Important dem  AAAAAAAAGPPGEAAA        2998       1864\n15  Conventional childr  AAAAAAAAKNAEBAAA        2370       1317\n16  Conventional childr  AAAAAAAAOOJFBAAA        2689       1572\n17  Conventional childr  AAAAAAAAKGCHBAAA        2832       2768\n18     Please central m  AAAAAAAAKBHCAAAA        2870        871\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null end) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <> 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAOEJBAAAA        1755       1959\n1          Important dem  AAAAAAAAFBEJDAAA        1771       2147\n2    Conventional childr  AAAAAAAAAAEGAAAA        1628       1715\n3    Conventional childr  AAAAAAAAOBNHAAAA        1628       2311\n4    Conventional childr  AAAAAAAAMAKPAAAA        1558       2279\n5          Important dem  AAAAAAAAEEOIEAAA        1394       1426\n6    Conventional childr  AAAAAAAAJFPDCAAA        2491       2808\n7    Conventional childr  AAAAAAAAMIKICAAA        1164       1505\n8       Please central m  AAAAAAAAEDBHBAAA         915       2275\n9       Please central m  AAAAAAAAAHBHBAAA        1519       1891\n10   Conventional childr  AAAAAAAAAEHADAAA        2371       2567\n11      Please central m  AAAAAAAAOCMLBAAA        1373       1801\n12      Please central m  AAAAAAAAIGNJCAAA         906       1914\n13      Please central m  AAAAAAAALMNHDAAA        1609       1996\n14      Please central m  AAAAAAAAIEHJDAAA        2211       3367\n15  Important issues liv  AAAAAAAAAIJJAAAA        2413       2954\n16  Important issues liv  AAAAAAAANLCLAAAA         618       1902\n17  Important issues liv  AAAAAAAAODLMAAAA        1735       2294\n18      Please central m  AAAAAAAAMGLPDAAA        2093       2351\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.170881,
                    "execution_time": 0.10638,
                    "compile_time": 0.000255,
                    "planning_time": 0.047231
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.237418,
                    "execution_time": 0.102473,
                    "compile_time": 0.002108,
                    "planning_time": 0.115384
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAOEJBAAAA        1755       1959\n1          Important dem  AAAAAAAAFBEJDAAA        1771       2147\n2    Conventional childr  AAAAAAAAAAEGAAAA        1628       1715\n3    Conventional childr  AAAAAAAAOBNHAAAA        1628       2311\n4    Conventional childr  AAAAAAAAMAKPAAAA        1558       2279\n5          Important dem  AAAAAAAAEEOIEAAA        1394       1426\n6    Conventional childr  AAAAAAAAJFPDCAAA        2491       2808\n7    Conventional childr  AAAAAAAAMIKICAAA        1164       1505\n8       Please central m  AAAAAAAAEDBHBAAA         915       2275\n9       Please central m  AAAAAAAAAHBHBAAA        1519       1891\n10   Conventional childr  AAAAAAAAAEHADAAA        2371       2567\n11      Please central m  AAAAAAAAOCMLBAAA        1373       1801\n12      Please central m  AAAAAAAAIGNJCAAA         906       1914\n13      Please central m  AAAAAAAALMNHDAAA        1609       1996\n14      Please central m  AAAAAAAAIEHJDAAA        2211       3367\n15  Important issues liv  AAAAAAAAAIJJAAAA        2413       2954\n16  Important issues liv  AAAAAAAANLCLAAAA         618       1902\n17  Important issues liv  AAAAAAAAODLMAAAA        1735       2294\n18      Please central m  AAAAAAAAMGLPDAAA        2093       2351\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null end) > 0\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END > 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) > 0 LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAABBDAAAA        1132       1271\n1   Conventional childr  AAAAAAAAMNJEAAAA        2007       2430\n2         Important dem  AAAAAAAACKEMDAAA        1163       2411\n3         Important dem  AAAAAAAAJDKFEAAA        2161       2456\n4   Conventional childr  AAAAAAAAEBBMBAAA        1704       1730\n5   Conventional childr  AAAAAAAAOILACAAA        1482       2614\n6      Please central m  AAAAAAAAEOJNAAAA        2005       2190\n7   Conventional childr  AAAAAAAABDAHCAAA        1885       2456\n8      Please central m  AAAAAAAANFECBAAA        1779       2458\n9      Please central m  AAAAAAAAEONDBAAA        1955       2538\n10     Please central m  AAAAAAAAGHGFBAAA        1477       1788\n11     Please central m  AAAAAAAAKKOBCAAA        1872       2689\n12  Conventional childr  AAAAAAAAIKLJDAAA        1450       1527\n13     Please central m  AAAAAAAAEFAFCAAA        1527       2213\n14  Conventional childr  AAAAAAAAFHNMDAAA        2164       2901\n15  Conventional childr  AAAAAAAACKGODAAA         845       1977\n16     Please central m  AAAAAAAAGLCICAAA        1484       1806\n17  Conventional childr  AAAAAAAAGKKEEAAA        2380       2559\n18  Conventional childr  AAAAAAAABODGEAAA        2052       2125\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.166477,
                    "execution_time": 0.102861,
                    "compile_time": 0.000261,
                    "planning_time": 0.046379
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.242103,
                    "execution_time": 0.104322,
                    "compile_time": 0.001248,
                    "planning_time": 0.119251
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAAABBDAAAA        1132       1271\n1   Conventional childr  AAAAAAAAMNJEAAAA        2007       2430\n2         Important dem  AAAAAAAACKEMDAAA        1163       2411\n3         Important dem  AAAAAAAAJDKFEAAA        2161       2456\n4   Conventional childr  AAAAAAAAEBBMBAAA        1704       1730\n5   Conventional childr  AAAAAAAAOILACAAA        1482       2614\n6      Please central m  AAAAAAAAEOJNAAAA        2005       2190\n7   Conventional childr  AAAAAAAABDAHCAAA        1885       2456\n8      Please central m  AAAAAAAANFECBAAA        1779       2458\n9      Please central m  AAAAAAAAEONDBAAA        1955       2538\n10     Please central m  AAAAAAAAGHGFBAAA        1477       1788\n11     Please central m  AAAAAAAAKKOBCAAA        1872       2689\n12  Conventional childr  AAAAAAAAIKLJDAAA        1450       1527\n13     Please central m  AAAAAAAAEFAFCAAA        1527       2213\n14  Conventional childr  AAAAAAAAFHNMDAAA        2164       2901\n15  Conventional childr  AAAAAAAACKGODAAA         845       1977\n16     Please central m  AAAAAAAAGLCICAAA        1484       1806\n17  Conventional childr  AAAAAAAAGKKEEAAA        2380       2559\n18  Conventional childr  AAAAAAAABODGEAAA        2052       2125\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAPGMHAAAA        2181       2882\n1          Important dem  AAAAAAAAIBMKDAAA        1879       1952\n2    Conventional childr  AAAAAAAAANMHAAAA        1741       1933\n3       Please central m  AAAAAAAAPKCBAAAA        1953       2503\n4    Conventional childr  AAAAAAAAKKKNBAAA        1129       1876\n5       Please central m  AAAAAAAAOJPIAAAA        2932       3135\n6    Conventional childr  AAAAAAAAODAHCAAA        1280       2155\n7       Please central m  AAAAAAAAFECKBAAA        1116       1389\n8       Please central m  AAAAAAAAOPOBCAAA        2125       2402\n9       Please central m  AAAAAAAAECIDCAAA        2199       2220\n10   Conventional childr  AAAAAAAAFEFLDAAA        1163       1866\n11   Conventional childr  AAAAAAAAJOJBEAAA        1510       1735\n12   Conventional childr  AAAAAAAAEMCDEAAA        1214       1424\n13  Important issues liv  AAAAAAAAHLEDAAAA        2251       2787\n14      Please central m  AAAAAAAAACNHDAAA        1764       2525\n15      Please central m  AAAAAAAAOIBODAAA        2757       3213\n16      Please central m  AAAAAAAAKGKPDAAA        2298       2699\n17      Please central m  AAAAAAAAALMCEAAA        2212       2501\n18  Important issues liv  AAAAAAAAKIOCBAAA        1465       2139\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.183683,
                    "execution_time": 0.113341,
                    "compile_time": 0.000269,
                    "planning_time": 0.052266
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.250467,
                    "execution_time": 0.114752,
                    "compile_time": 0.002326,
                    "planning_time": 0.115334
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAPGMHAAAA        2181       2882\n1          Important dem  AAAAAAAAIBMKDAAA        1879       1952\n2    Conventional childr  AAAAAAAAANMHAAAA        1741       1933\n3       Please central m  AAAAAAAAPKCBAAAA        1953       2503\n4    Conventional childr  AAAAAAAAKKKNBAAA        1129       1876\n5       Please central m  AAAAAAAAOJPIAAAA        2932       3135\n6    Conventional childr  AAAAAAAAODAHCAAA        1280       2155\n7       Please central m  AAAAAAAAFECKBAAA        1116       1389\n8       Please central m  AAAAAAAAOPOBCAAA        2125       2402\n9       Please central m  AAAAAAAAECIDCAAA        2199       2220\n10   Conventional childr  AAAAAAAAFEFLDAAA        1163       1866\n11   Conventional childr  AAAAAAAAJOJBEAAA        1510       1735\n12   Conventional childr  AAAAAAAAEMCDEAAA        1214       1424\n13  Important issues liv  AAAAAAAAHLEDAAAA        2251       2787\n14      Please central m  AAAAAAAAACNHDAAA        1764       2525\n15      Please central m  AAAAAAAAOIBODAAA        2757       3213\n16      Please central m  AAAAAAAAKGKPDAAA        2298       2699\n17      Please central m  AAAAAAAAALMCEAAA        2212       2501\n18  Important issues liv  AAAAAAAAKIOCBAAA        1465       2139\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAJCENAAAA        2103       2534\n1                    AAAAAAAAMPGDBAAA        2583       3125\n2                    AAAAAAAAKPFJCAAA        2560       3647\n3                    AAAAAAAAKGGABAAA        1456       1858\n4                    AAAAAAAAOFEMCAAA        1801       2369\n5                    AAAAAAAAENCHDAAA        2492       2513\n6                    AAAAAAAAKAMAAAAA        1330       2233\n7                    AAAAAAAADEFABAAA        2564       2660\n8                    AAAAAAAACIHLAAAA        1170       2090\n9                    AAAAAAAAEMIIAAAA        1242       1727\n10                   AAAAAAAAFDLECAAA        1506       1586\n11                   AAAAAAAADMDNAAAA        2199       2281\n12                   AAAAAAAAJPLOAAAA        1448       2396\n13                   AAAAAAAAPFPHBAAA        1976       2140\n14                   AAAAAAAABNLAAAAA        1512       1864\n15                   AAAAAAAAOEAGCAAA        2582       3127\n16                   AAAAAAAADBLDEAAA        2317       2917\n17                   AAAAAAAADLGFAAAA        1804       2086\n18                   AAAAAAAABJLDEAAA        2226       2372\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.198807,
                    "execution_time": 0.13176,
                    "compile_time": 0.000297,
                    "planning_time": 0.04924
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.244324,
                    "execution_time": 0.10879,
                    "compile_time": 0.001957,
                    "planning_time": 0.116164
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAJCENAAAA        2103       2534\n1                    AAAAAAAAMPGDBAAA        2583       3125\n2                    AAAAAAAAKPFJCAAA        2560       3647\n3                    AAAAAAAAKGGABAAA        1456       1858\n4                    AAAAAAAAOFEMCAAA        1801       2369\n5                    AAAAAAAAENCHDAAA        2492       2513\n6                    AAAAAAAAKAMAAAAA        1330       2233\n7                    AAAAAAAADEFABAAA        2564       2660\n8                    AAAAAAAACIHLAAAA        1170       2090\n9                    AAAAAAAAEMIIAAAA        1242       1727\n10                   AAAAAAAAFDLECAAA        1506       1586\n11                   AAAAAAAADMDNAAAA        2199       2281\n12                   AAAAAAAAJPLOAAAA        1448       2396\n13                   AAAAAAAAPFPHBAAA        1976       2140\n14                   AAAAAAAABNLAAAAA        1512       1864\n15                   AAAAAAAAOEAGCAAA        2582       3127\n16                   AAAAAAAADBLDEAAA        2317       2917\n17                   AAAAAAAADLGFAAAA        1804       2086\n18                   AAAAAAAABJLDEAAA        2226       2372\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST , \"X\".\"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAAACAAA        2008       2751\n1                    AAAAAAAAAACGDAAA        2480       3432\n2                    AAAAAAAAAAEKCAAA        1840       1968\n3                    AAAAAAAAAAFGCAAA        1072       1932\n4                    AAAAAAAAAAGHAAAA        1891       2107\n5                    AAAAAAAAAAHDAAAA        1893       1898\n6                    AAAAAAAAAAILDAAA        2211       2837\n7                    AAAAAAAAAAKNCAAA        1103       2099\n8                    AAAAAAAAAALADAAA        1154       2013\n9                    AAAAAAAAAALHBAAA        1416       2549\n10                   AAAAAAAAAANJDAAA        1676       1754\n11                   AAAAAAAAAANKAAAA        2618       2888\n12                   AAAAAAAAABAGAAAA        1685       1977\n13                   AAAAAAAAABBIEAAA        2084       2084\n14                   AAAAAAAAABCBDAAA        1983       2141\n15                   AAAAAAAAABEECAAA        1259       1874\n16                   AAAAAAAAABEJCAAA        1167       1808\n17                   AAAAAAAAABGBCAAA        1373       2567\n18                   AAAAAAAAABGNCAAA        2045       2464\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.189415,
                    "execution_time": 0.122584,
                    "compile_time": 0.000288,
                    "planning_time": 0.04918
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.263679,
                    "execution_time": 0.127174,
                    "compile_time": 0.001317,
                    "planning_time": 0.117137
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAAACAAA        2008       2751\n1                    AAAAAAAAAACGDAAA        2480       3432\n2                    AAAAAAAAAAEKCAAA        1840       1968\n3                    AAAAAAAAAAFGCAAA        1072       1932\n4                    AAAAAAAAAAGHAAAA        1891       2107\n5                    AAAAAAAAAAHDAAAA        1893       1898\n6                    AAAAAAAAAAILDAAA        2211       2837\n7                    AAAAAAAAAAKNCAAA        1103       2099\n8                    AAAAAAAAAALADAAA        1154       2013\n9                    AAAAAAAAAALHBAAA        1416       2549\n10                   AAAAAAAAAANJDAAA        1676       1754\n11                   AAAAAAAAAANKAAAA        2618       2888\n12                   AAAAAAAAABAGAAAA        1685       1977\n13                   AAAAAAAAABBIEAAA        2084       2084\n14                   AAAAAAAAABCBDAAA        1983       2141\n15                   AAAAAAAAABEECAAA        1259       1874\n16                   AAAAAAAAABEJCAAA        1167       1808\n17                   AAAAAAAAABGBCAAA        1373       2567\n18                   AAAAAAAAABGNCAAA        2045       2464\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST , \"X\".\"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAAACAAA        2008       2751\n1                    AAAAAAAAAACGDAAA        2480       3432\n2                    AAAAAAAAAAEKCAAA        1840       1968\n3                    AAAAAAAAAAFGCAAA        1072       1932\n4                    AAAAAAAAAAGHAAAA        1891       2107\n5                    AAAAAAAAAAHDAAAA        1893       1898\n6                    AAAAAAAAAAILDAAA        2211       2837\n7                    AAAAAAAAAAKNCAAA        1103       2099\n8                    AAAAAAAAAALADAAA        1154       2013\n9                    AAAAAAAAAALHBAAA        1416       2549\n10                   AAAAAAAAAANJDAAA        1676       1754\n11                   AAAAAAAAAANKAAAA        2618       2888\n12                   AAAAAAAAABAGAAAA        1685       1977\n13                   AAAAAAAAABBIEAAA        2084       2084\n14                   AAAAAAAAABCBDAAA        1983       2141\n15                   AAAAAAAAABEECAAA        1259       1874\n16                   AAAAAAAAABEJCAAA        1167       1808\n17                   AAAAAAAAABGBCAAA        1373       2567\n18                   AAAAAAAAABGNCAAA        2045       2464\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.202487,
                    "execution_time": 0.133986,
                    "compile_time": 0.00029,
                    "planning_time": 0.050583
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.195818,
                    "execution_time": 0.130878,
                    "compile_time": 0.000286,
                    "planning_time": 0.047354
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAAACAAA        2008       2751\n1                    AAAAAAAAAACGDAAA        2480       3432\n2                    AAAAAAAAAAEKCAAA        1840       1968\n3                    AAAAAAAAAAFGCAAA        1072       1932\n4                    AAAAAAAAAAGHAAAA        1891       2107\n5                    AAAAAAAAAAHDAAAA        1893       1898\n6                    AAAAAAAAAAILDAAA        2211       2837\n7                    AAAAAAAAAAKNCAAA        1103       2099\n8                    AAAAAAAAAALADAAA        1154       2013\n9                    AAAAAAAAAALHBAAA        1416       2549\n10                   AAAAAAAAAANJDAAA        1676       1754\n11                   AAAAAAAAAANKAAAA        2618       2888\n12                   AAAAAAAAABAGAAAA        1685       1977\n13                   AAAAAAAAABBIEAAA        2084       2084\n14                   AAAAAAAAABCBDAAA        1983       2141\n15                   AAAAAAAAABEECAAA        1259       1874\n16                   AAAAAAAAABEJCAAA        1167       1808\n17                   AAAAAAAAABGBCAAA        1373       2567\n18                   AAAAAAAAABGNCAAA        2045       2464\n...*/"
    }
]