[
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id, i_item_desc, i_category, i_class, i_current_price, sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere 1=1  \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 12.395711,
                    "execution_time": 12.086613,
                    "compile_time": 0.000688,
                    "planning_time": 0.045773,
                    "create_size": 680
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.276236,
                    "execution_time": 11.748656,
                    "compile_time": 0.1249,
                    "planning_time": 0.1303,
                    "create_size": 680
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANBFAAAA                                                                                                             Amounts should not understand councils. Upper, likely minerals see already really interior  Electronics  portable             1.85   4611720.94        0.0423\n1   AAAAAAAADBMMAAAA    More present years support realistically grateful versions. Entire stairs watch widely powers. At length general friends will not go years. Criminal sales can help roles. Large, independent weeks  Electronics  portable             8.88  12287854.12        0.1129\n2   AAAAAAAAFDOECAAA                                  Possible members would accept under a paintings; indeed sole friends look operations. Exciting girls will allow. Voters relate for instance interesting, good speaker  Electronics  portable             0.49  12547116.45        0.1153\n3   AAAAAAAAEFJPCAAA                                                              Possible, similar weeks will not bear arms. At all improved designers attempt about the areas. Heavy awards finish all central conservati  Electronics  portable             0.85   7001845.87        0.0643\n4   AAAAAAAAMOFFEAAA                                     Men would risk competitive, independent industries. Economic societies hold foreign, worthy structures. Thousands must produce once great artists; red, nuclear tr  Electronics  portable             1.62   5075205.16        0.0466\n5   AAAAAAAABEPBBAAA                                   Markets talk never warm, long readers. Other provisions shall complete again towards a responses; consistent fears used to allow now; due employers let new bits. Sh  Electronics  portable             7.81  12446712.11        0.1144\n6   AAAAAAAAABJBCAAA                                                                 Strongly brown employers expect since a men. Departments should come once responsibilities. Completely italian decisions care on a col  Electronics  portable            67.03   4918183.11        0.0452\n7   AAAAAAAAOCMJBAAA                                                       Top, different terms will receive both more than good areas; brightly local parents find lost, pleasant industries. Earlier female times stand a  Electronics  portable             9.85   7285936.43        0.0669\n8   AAAAAAAAKGJMAAAA                                                                                                           Once italian visitors respect best in a members; voices differ far signs. Women cannot measu  Electronics  portable             0.10   4815740.81        0.0442\n9   AAAAAAAAAEBFDAAA                                                                Vague, large missiles might continue enough through the teachers. Services touch accordingly definitely local aspects. Over unknown day  Electronics  portable             4.26   4837832.24        0.0444\n10  AAAAAAAADFMIAAAA                                                                                                                                                                                               Never mi  Electronics  portable             1.12  12745680.33        0.1171\n11  AAAAAAAAAKCHBAAA                                                                                                                                                                                                   Minu  Electronics  portable             0.53   7582410.55        0.0697\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019646,
                    "execution_time": 0.007589,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055648,
                    "execution_time": 0.007709,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.040511
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANBFAAAA                                                                                                             Amounts should not understand councils. Upper, likely minerals see already really interior  Electronics  portable             1.85   4611720.94        0.0423\n1   AAAAAAAADBMMAAAA    More present years support realistically grateful versions. Entire stairs watch widely powers. At length general friends will not go years. Criminal sales can help roles. Large, independent weeks  Electronics  portable             8.88  12287854.12        0.1129\n2   AAAAAAAAFDOECAAA                                  Possible members would accept under a paintings; indeed sole friends look operations. Exciting girls will allow. Voters relate for instance interesting, good speaker  Electronics  portable             0.49  12547116.45        0.1153\n3   AAAAAAAAEFJPCAAA                                                              Possible, similar weeks will not bear arms. At all improved designers attempt about the areas. Heavy awards finish all central conservati  Electronics  portable             0.85   7001845.87        0.0643\n4   AAAAAAAAMOFFEAAA                                     Men would risk competitive, independent industries. Economic societies hold foreign, worthy structures. Thousands must produce once great artists; red, nuclear tr  Electronics  portable             1.62   5075205.16        0.0466\n5   AAAAAAAABEPBBAAA                                   Markets talk never warm, long readers. Other provisions shall complete again towards a responses; consistent fears used to allow now; due employers let new bits. Sh  Electronics  portable             7.81  12446712.11        0.1144\n6   AAAAAAAAABJBCAAA                                                                 Strongly brown employers expect since a men. Departments should come once responsibilities. Completely italian decisions care on a col  Electronics  portable            67.03   4918183.11        0.0452\n7   AAAAAAAAOCMJBAAA                                                       Top, different terms will receive both more than good areas; brightly local parents find lost, pleasant industries. Earlier female times stand a  Electronics  portable             9.85   7285936.43        0.0669\n8   AAAAAAAAKGJMAAAA                                                                                                           Once italian visitors respect best in a members; voices differ far signs. Women cannot measu  Electronics  portable             0.10   4815740.81        0.0442\n9   AAAAAAAAAEBFDAAA                                                                Vague, large missiles might continue enough through the teachers. Services touch accordingly definitely local aspects. Over unknown day  Electronics  portable             4.26   4837832.24        0.0444\n10  AAAAAAAADFMIAAAA                                                                                                                                                                                               Never mi  Electronics  portable             1.12  12745680.33        0.1171\n11  AAAAAAAAAKCHBAAA                                                                                                                                                                                                   Minu  Electronics  portable             0.53   7582410.55        0.0697\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) and cast('2001-07-29' as date) \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-07-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-07-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.443451,
                    "execution_time": 0.253108,
                    "compile_time": 0.000714,
                    "planning_time": 0.046567,
                    "create_size": 680
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.534616,
                    "execution_time": 0.270433,
                    "compile_time": 0.000685,
                    "planning_time": 0.123501,
                    "create_size": 680
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACLDHAAAA                                                                                                                                                                                                 Possi  Electronics  portable             2.33    102599.86        0.0949\n1   AAAAAAAAAGNJAAAA                                                                                                                                                                             Clear bands should mean l  Electronics  portable             8.90    115201.64        0.1066\n2   AAAAAAAAAAOEBAAA  Long-term studies may think most. Other areas must work perhaps days. International provisions used to need also local men; accused stories may break particularly resulting, small matches; formal,  Electronics  portable             4.40    147877.25        0.1368\n3   AAAAAAAAMOHBAAAA                                                                                                                                                                              Really warm achievements  Electronics  portable             4.30    135028.08        0.1249\n4   AAAAAAAALKKECAAA                                                                                                                                                                                                   Rea  Electronics  portable             2.66    149398.67        0.1382\n5   AAAAAAAAKFIHBAAA                                                                                                                                                        Again evil males would not seem again. So othe  Electronics  portable             1.37    193704.28        0.1792\n6   AAAAAAAAAMGLCAAA                                                                                                                                                                                                Beauti  Electronics  portable             5.83    160406.10        0.1484\n7   AAAAAAAAKJADAAAA                                           Soviet communications think hence mechanical years. Facts colour also up a efforts. Immediate, brown rules stay also. Implications shall not understand at   Electronics  portable             1.38    127851.41        0.1183\n8   AAAAAAAAGDBCCAAA                                                                                                                                                 Very easy claims understand great bits. Colleges shou  Electronics  portable            64.82     90424.30        0.0836\n9   AAAAAAAAMLMFBAAA                                                                                                                                                                Strong, particular prices should drink  Electronics  portable            35.50     86092.53        0.0796\n10  AAAAAAAAABDJDAAA                                                                          Central hours would not afford users. Together good courses will not hear arab, main powers. Woods would appear at all as a   Electronics  portable             2.16    118475.02        0.1096\n11  AAAAAAAAJNPBCAAA                                                              Aware, other details will sit pictures. Most independent institutions might pack also remarkable provisions. Here stable officials might  Electronics  portable             6.42    155512.59        0.1439\n12  AAAAAAAAJDNJDAAA                                                                                                                             Possibly real materials would bother desperately under a environments; op  Electronics  portable             3.48    129584.01        0.1199\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019466,
                    "execution_time": 0.007406,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.00531
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056474,
                    "execution_time": 0.007967,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.04047
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2001-07-29' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACLDHAAAA                                                                                                                                                                                                 Possi  Electronics  portable             2.33    102599.86        0.0949\n1   AAAAAAAAAGNJAAAA                                                                                                                                                                             Clear bands should mean l  Electronics  portable             8.90    115201.64        0.1066\n2   AAAAAAAAAAOEBAAA  Long-term studies may think most. Other areas must work perhaps days. International provisions used to need also local men; accused stories may break particularly resulting, small matches; formal,  Electronics  portable             4.40    147877.25        0.1368\n3   AAAAAAAAMOHBAAAA                                                                                                                                                                              Really warm achievements  Electronics  portable             4.30    135028.08        0.1249\n4   AAAAAAAALKKECAAA                                                                                                                                                                                                   Rea  Electronics  portable             2.66    149398.67        0.1382\n5   AAAAAAAAKFIHBAAA                                                                                                                                                        Again evil males would not seem again. So othe  Electronics  portable             1.37    193704.28        0.1792\n6   AAAAAAAAAMGLCAAA                                                                                                                                                                                                Beauti  Electronics  portable             5.83    160406.10        0.1484\n7   AAAAAAAAKJADAAAA                                           Soviet communications think hence mechanical years. Facts colour also up a efforts. Immediate, brown rules stay also. Implications shall not understand at   Electronics  portable             1.38    127851.41        0.1183\n8   AAAAAAAAGDBCCAAA                                                                                                                                                 Very easy claims understand great bits. Colleges shou  Electronics  portable            64.82     90424.30        0.0836\n9   AAAAAAAAMLMFBAAA                                                                                                                                                                Strong, particular prices should drink  Electronics  portable            35.50     86092.53        0.0796\n10  AAAAAAAAABDJDAAA                                                                          Central hours would not afford users. Together good courses will not hear arab, main powers. Woods would appear at all as a   Electronics  portable             2.16    118475.02        0.1096\n11  AAAAAAAAJNPBCAAA                                                              Aware, other details will sit pictures. Most independent institutions might pack also remarkable provisions. Here stable officials might  Electronics  portable             6.42    155512.59        0.1439\n12  AAAAAAAAJDNJDAAA                                                                                                                             Possibly real materials would bother desperately under a environments; op  Electronics  portable             3.48    129584.01        0.1199\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPNJGAAAA                                                                                                                                          Difficult, expensive conditions used to launch today over a se  Electronics  cameras             2.90    169785.56        0.1590\n1   AAAAAAAACHDHDAAA                                                               New centuries give recent rebels. New, associated pounds should refrain sure with the rights. Sometimes recent clothes might fall moreove  Electronics  cameras             6.16    120218.79        0.1126\n2   AAAAAAAANLDEDAAA                                                                                           Days would not hope variously sure windows. Just difficult calls show now primary, fatal girls. Grey grounds   Electronics  cameras             7.95    104834.80        0.0982\n3   AAAAAAAAGFNCDAAA      Horribly full others should not open other decisions. Days must play also aside civil years. Only good eyes remind then significant procedures. Officers make all to the officials. At least consi  Electronics  cameras             4.89     88585.59        0.0830\n4   AAAAAAAADADGEAAA                                                                                                     Problems harbour possibly seats. Soft days will make following reasons. Sad nerves go so even other  Electronics  cameras             2.13    166956.15        0.1564\n5   AAAAAAAAJJFFAAAA            Social sums could not see more local, new weeks. Statistically main cities used to get fair; categories focus operations. Permanently proper points bring. Formal bottles attribute physical  Electronics  cameras             1.17    104024.48        0.0974\n6   AAAAAAAAPGEDDAAA                                                                                                    True, colonial pages could mean. Far strange effects negotiate free children. Charges used to find.   Electronics  cameras             4.52    129164.50        0.1210\n7   AAAAAAAAJDJCCAAA                                          Past, select wheels appoint cold, direct fortunes; mistakes prove real feet. Dry windows will wear weeks. New varieties mean then by the rights. Almost milita  Electronics  cameras             2.06    118974.91        0.1114\n8   AAAAAAAAODCOCAAA                                                                                                                                                                                                      Fr  Electronics  cameras             7.74     96767.94        0.0906\n9   AAAAAAAAAJLFAAAA  Personal, other laws rank there so new beings. Active sections estimate widely perfect police. Managers would take please bad friends. Reasonable, recent charts sacrifice either. Current items ought  Electronics  cameras             1.05    120617.42        0.1130\n10  AAAAAAAAJAKOBAAA                                                                                                                                     European feet could use technically for the patients. Temporary way  Electronics  cameras             5.47    124535.30        0.1166\n11  AAAAAAAAMGKDBAAA                                                                                                   Now good men may not tell traditional assumptions; never poor opportunities ought to set even. Studen  Electronics  cameras             9.97    126354.99        0.1184\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.259185,
                    "execution_time": 0.198672,
                    "compile_time": 0.000307,
                    "planning_time": 0.042833
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.315879,
                    "execution_time": 0.185604,
                    "compile_time": 0.000317,
                    "planning_time": 0.110487
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPNJGAAAA                                                                                                                                          Difficult, expensive conditions used to launch today over a se  Electronics  cameras             2.90    169785.56        0.1590\n1   AAAAAAAACHDHDAAA                                                               New centuries give recent rebels. New, associated pounds should refrain sure with the rights. Sometimes recent clothes might fall moreove  Electronics  cameras             6.16    120218.79        0.1126\n2   AAAAAAAANLDEDAAA                                                                                           Days would not hope variously sure windows. Just difficult calls show now primary, fatal girls. Grey grounds   Electronics  cameras             7.95    104834.80        0.0982\n3   AAAAAAAAGFNCDAAA      Horribly full others should not open other decisions. Days must play also aside civil years. Only good eyes remind then significant procedures. Officers make all to the officials. At least consi  Electronics  cameras             4.89     88585.59        0.0830\n4   AAAAAAAADADGEAAA                                                                                                     Problems harbour possibly seats. Soft days will make following reasons. Sad nerves go so even other  Electronics  cameras             2.13    166956.15        0.1564\n5   AAAAAAAAJJFFAAAA            Social sums could not see more local, new weeks. Statistically main cities used to get fair; categories focus operations. Permanently proper points bring. Formal bottles attribute physical  Electronics  cameras             1.17    104024.48        0.0974\n6   AAAAAAAAPGEDDAAA                                                                                                    True, colonial pages could mean. Far strange effects negotiate free children. Charges used to find.   Electronics  cameras             4.52    129164.50        0.1210\n7   AAAAAAAAJDJCCAAA                                          Past, select wheels appoint cold, direct fortunes; mistakes prove real feet. Dry windows will wear weeks. New varieties mean then by the rights. Almost milita  Electronics  cameras             2.06    118974.91        0.1114\n8   AAAAAAAAODCOCAAA                                                                                                                                                                                                      Fr  Electronics  cameras             7.74     96767.94        0.0906\n9   AAAAAAAAAJLFAAAA  Personal, other laws rank there so new beings. Active sections estimate widely perfect police. Managers would take please bad friends. Reasonable, recent charts sacrifice either. Current items ought  Electronics  cameras             1.05    120617.42        0.1130\n10  AAAAAAAAJAKOBAAA                                                                                                                                     European feet could use technically for the patients. Temporary way  Electronics  cameras             5.47    124535.30        0.1166\n11  AAAAAAAAMGKDBAAA                                                                                                   Now good men may not tell traditional assumptions; never poor opportunities ought to set even. Studen  Electronics  cameras             9.97    126354.99        0.1184\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \ni_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will         Shoes                     1.56    135694.72        2.4529\n1   AAAAAAAAMKAADAAA                                                                                                                                                                                                         Jewelry                      NaN    144050.63        2.6039\n2   AAAAAAAALGHOCAAA                                                                                                                                                                                                         Jewelry                      NaN    100409.24        1.8150\n3   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura        Shoes                     7.02     90171.61        1.6300\n4   AAAAAAAACMDPDAAA                                                               Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n5   AAAAAAAAAGOEEAAA                                                                                                                                                                                                           Shoes                      NaN     88424.06        1.5984\n6   AAAAAAAAKCBOCAAA                                                                                                                                                                                                         Jewelry                     0.82    103534.34        1.8715\n7   AAAAAAAABEIDDAAA                                                                                                                                                                             Quite international po      Jewelry                      NaN    132093.35        2.3878\n8   AAAAAAAAOKPICAAA                                                                                                                                                                                               Chur      Jewelry                     4.06    132704.14        2.3988\n9   AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09    107972.61        1.9518\n10  AAAAAAAAIJBLDAAA                                                                                                                                                                          Things think so. Then gro        Shoes                      NaN    118492.82        2.1419\n11  AAAAAAAAEBJFEAAA                    Direct waters may bet molecular instructions. Outside ancient meals can ask about right, difficult institutions. Good others ask downwards bitter sizes. Conditions may carry q        Shoes                     3.05     91945.41        1.6620\n12  AAAAAAAAOAEABAAA                                                                                                                                                                                                           Shoes                    60.87    103305.94        1.8674\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.25321,
                    "execution_time": 0.193616,
                    "compile_time": 0.000304,
                    "planning_time": 0.04229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.251776,
                    "execution_time": 0.189323,
                    "compile_time": 0.000302,
                    "planning_time": 0.044982
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will         Shoes                     1.56    135694.72        2.4529\n1   AAAAAAAAMKAADAAA                                                                                                                                                                                                         Jewelry                      NaN    144050.63        2.6039\n2   AAAAAAAALGHOCAAA                                                                                                                                                                                                         Jewelry                      NaN    100409.24        1.8150\n3   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura        Shoes                     7.02     90171.61        1.6300\n4   AAAAAAAACMDPDAAA                                                               Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n5   AAAAAAAAAGOEEAAA                                                                                                                                                                                                           Shoes                      NaN     88424.06        1.5984\n6   AAAAAAAAKCBOCAAA                                                                                                                                                                                                         Jewelry                     0.82    103534.34        1.8715\n7   AAAAAAAABEIDDAAA                                                                                                                                                                             Quite international po      Jewelry                      NaN    132093.35        2.3878\n8   AAAAAAAAOKPICAAA                                                                                                                                                                                               Chur      Jewelry                     4.06    132704.14        2.3988\n9   AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09    107972.61        1.9518\n10  AAAAAAAAIJBLDAAA                                                                                                                                                                          Things think so. Then gro        Shoes                      NaN    118492.82        2.1419\n11  AAAAAAAAEBJFEAAA                    Direct waters may bet molecular instructions. Outside ancient meals can ask about right, difficult institutions. Good others ask downwards bitter sizes. Conditions may carry q        Shoes                     3.05     91945.41        1.6620\n12  AAAAAAAAOAEABAAA                                                                                                                                                                                                           Shoes                    60.87    103305.94        1.8674\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALNNDDAAA                                                                                           Cells shall promise all. Well strong sections will share valid leaders. So detailed products take ever ch  Electronics  cameras             3.66    118387.42        0.1109\n1   AAAAAAAAINHJDAAA                                                                                                    Close american posts can worry from a rights; managers control new years. Objective, specific ot  Electronics  cameras             6.39    170277.83        0.1595\n2   AAAAAAAAMGAKBAAA                                                                                          Romantic shares could buy loose elections. Light weeks would know in a arrangements. As perfect days lay a  Electronics  cameras             1.81    107447.38        0.1006\n3   AAAAAAAAIGMCDAAA                                                                Institutions shall not agree only individual officials. Times should not play police. Unique levels can regard thankfully. Wages mea  Electronics  cameras             3.89     80311.92        0.0752\n4   AAAAAAAAOIECDAAA                           Windows come intimately long pounds. Reasonable things must not take often regular, public points. Most remaining decisions solve in general big faces. Perhaps unnecessa  Electronics  cameras             5.90    110877.02        0.1038\n5   AAAAAAAAINGGEAAA                                                                                                                                                                             Recent, certain compani  Electronics  cameras             5.60    160911.44        0.1507\n6   AAAAAAAALAENDAAA                                                                            Direct speakers make there so silly processes. Lakes follow on a policies. Major goods end likely, silent spirits. Compa  Electronics  cameras             3.03     99772.87        0.0934\n7   AAAAAAAAEHFGBAAA                                                                                                                                                                                          Directly d  Electronics  cameras             6.11    101048.03        0.0946\n8   AAAAAAAALOCMBAAA                           Goods come black plants; possible, small effects will give well. Purposes want intact, diplomatic facilities; usually swiss services get fairly dry borders. Standards le  Electronics  cameras             3.75    106459.03        0.0997\n9   AAAAAAAABCBAAAAA                                                                                                                                             Briefly foreign issues could play. Periods question fin  Electronics  cameras             0.40     97281.19        0.0911\n10  AAAAAAAAKBCHDAAA                                                                                                                                                                 Enough dull cities open as with the  Electronics  cameras             0.10     96495.69        0.0904\n11  AAAAAAAAAAKKCAAA                  Organisers force free points. Used, significant comments supply cattle; both heavy horses go then often upper goals. Unusual groups should help personal materials. Policies start  Electronics  cameras            94.73     67108.74        0.0628\n12  AAAAAAAAGPMOAAAA                                                                                                                                  Masses burn to the waters. Various, bare requests could participat  Electronics  cameras             3.49    108306.21        0.1014\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.254171,
                    "execution_time": 0.191012,
                    "compile_time": 0.000309,
                    "planning_time": 0.045177
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.252899,
                    "execution_time": 0.19135,
                    "compile_time": 0.000293,
                    "planning_time": 0.044378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALNNDDAAA                                                                                           Cells shall promise all. Well strong sections will share valid leaders. So detailed products take ever ch  Electronics  cameras             3.66    118387.42        0.1109\n1   AAAAAAAAINHJDAAA                                                                                                    Close american posts can worry from a rights; managers control new years. Objective, specific ot  Electronics  cameras             6.39    170277.83        0.1595\n2   AAAAAAAAMGAKBAAA                                                                                          Romantic shares could buy loose elections. Light weeks would know in a arrangements. As perfect days lay a  Electronics  cameras             1.81    107447.38        0.1006\n3   AAAAAAAAIGMCDAAA                                                                Institutions shall not agree only individual officials. Times should not play police. Unique levels can regard thankfully. Wages mea  Electronics  cameras             3.89     80311.92        0.0752\n4   AAAAAAAAOIECDAAA                           Windows come intimately long pounds. Reasonable things must not take often regular, public points. Most remaining decisions solve in general big faces. Perhaps unnecessa  Electronics  cameras             5.90    110877.02        0.1038\n5   AAAAAAAAINGGEAAA                                                                                                                                                                             Recent, certain compani  Electronics  cameras             5.60    160911.44        0.1507\n6   AAAAAAAALAENDAAA                                                                            Direct speakers make there so silly processes. Lakes follow on a policies. Major goods end likely, silent spirits. Compa  Electronics  cameras             3.03     99772.87        0.0934\n7   AAAAAAAAEHFGBAAA                                                                                                                                                                                          Directly d  Electronics  cameras             6.11    101048.03        0.0946\n8   AAAAAAAALOCMBAAA                           Goods come black plants; possible, small effects will give well. Purposes want intact, diplomatic facilities; usually swiss services get fairly dry borders. Standards le  Electronics  cameras             3.75    106459.03        0.0997\n9   AAAAAAAABCBAAAAA                                                                                                                                             Briefly foreign issues could play. Periods question fin  Electronics  cameras             0.40     97281.19        0.0911\n10  AAAAAAAAKBCHDAAA                                                                                                                                                                 Enough dull cities open as with the  Electronics  cameras             0.10     96495.69        0.0904\n11  AAAAAAAAAAKKCAAA                  Organisers force free points. Used, significant comments supply cattle; both heavy horses go then often upper goals. Unusual groups should help personal materials. Policies start  Electronics  cameras            94.73     67108.74        0.0628\n12  AAAAAAAAGPMOAAAA                                                                                                                                  Masses burn to the waters. Various, bare requests could participat  Electronics  cameras             3.49    108306.21        0.1014\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEIIGAAAA                                                                                                                                                                        Never necessary reports ask so  Electronics  cameras             5.79    202786.53        0.1900\n1   AAAAAAAAECKPDAAA                                                                                       Competitive, special parties launch thus difficulties. Now artistic members shall not choose less components; s  Electronics  cameras             4.66    108203.94        0.1013\n2   AAAAAAAACICDBAAA  As alternative times supply also free, competitive systems. Other rats would take then old heads. Armed hotels must enjoy almost in the concerns. Consistent services can play. Grateful, regional y  Electronics  cameras             2.93    103361.41        0.0968\n3   AAAAAAAAFBJKDAAA  Always possible delegates get; social problems must not defend. Present men could supervise to a goals. Dependent directors put alternately in a sales. Yet various days would walk of course other   Electronics  cameras             2.59    118406.01        0.1109\n4   AAAAAAAAKMPCBAAA                                                                                                                             Soviet, relative facilities should not let. Consultants would disappear i  Electronics  cameras             2.59     94132.41        0.0882\n5   AAAAAAAACBHCBAAA                                                                                                                                               Carefully clear regulations must imagine soon banks. Hi  Electronics  cameras             9.76    138598.10        0.1298\n6   AAAAAAAAPGBAAAAA                                                                             Excellent, real advantages would exist posts. Activities shall continue in a feet. Effects think only confidently local c  Electronics  cameras             2.41     89420.23        0.0837\n7   AAAAAAAAEBFPDAAA                                                                                            Financial duties need far inner plates; beds celebrate in order over a lights. Soon neighbouring compariso  Electronics  cameras             5.08    176661.70        0.1655\n8   AAAAAAAAJLCBCAAA                                                                                                                            Seemingly long remarks can like immediately cold services. In order good s  Electronics  cameras             1.30     75395.13        0.0706\n9   AAAAAAAAANBEBAAA                                       Really full seeds should work. National activities must not turn for a poems. Now possible ideas might not begin new, democratic resources. Remote, modern clas  Electronics  cameras             0.96    117855.67        0.1104\n10  AAAAAAAAHOLHEAAA                                 Active, proud grants drain. Remarkable farmers might not play almost direct, regional patterns; exactly accurate changes ought to know concepts. Other, ordinary play  Electronics  cameras             1.22    110012.79        0.1030\n11  AAAAAAAAIGLJAAAA                                                                                                                                                Powerful, close chemicals stretch. Above level hours c  Electronics  cameras             4.59    132838.10        0.1244\n12  AAAAAAAALEBJAAAA                                                                                                 Men must not bring; depths could help perhaps. Eyes will remain irish banks. Low achievements drive j  Electronics  cameras            60.83    106622.09        0.0999\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.247941,
                    "execution_time": 0.187887,
                    "compile_time": 0.000297,
                    "planning_time": 0.043144
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.248447,
                    "execution_time": 0.18817,
                    "compile_time": 0.000312,
                    "planning_time": 0.042677
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEIIGAAAA                                                                                                                                                                        Never necessary reports ask so  Electronics  cameras             5.79    202786.53        0.1900\n1   AAAAAAAAECKPDAAA                                                                                       Competitive, special parties launch thus difficulties. Now artistic members shall not choose less components; s  Electronics  cameras             4.66    108203.94        0.1013\n2   AAAAAAAACICDBAAA  As alternative times supply also free, competitive systems. Other rats would take then old heads. Armed hotels must enjoy almost in the concerns. Consistent services can play. Grateful, regional y  Electronics  cameras             2.93    103361.41        0.0968\n3   AAAAAAAAFBJKDAAA  Always possible delegates get; social problems must not defend. Present men could supervise to a goals. Dependent directors put alternately in a sales. Yet various days would walk of course other   Electronics  cameras             2.59    118406.01        0.1109\n4   AAAAAAAAKMPCBAAA                                                                                                                             Soviet, relative facilities should not let. Consultants would disappear i  Electronics  cameras             2.59     94132.41        0.0882\n5   AAAAAAAACBHCBAAA                                                                                                                                               Carefully clear regulations must imagine soon banks. Hi  Electronics  cameras             9.76    138598.10        0.1298\n6   AAAAAAAAPGBAAAAA                                                                             Excellent, real advantages would exist posts. Activities shall continue in a feet. Effects think only confidently local c  Electronics  cameras             2.41     89420.23        0.0837\n7   AAAAAAAAEBFPDAAA                                                                                            Financial duties need far inner plates; beds celebrate in order over a lights. Soon neighbouring compariso  Electronics  cameras             5.08    176661.70        0.1655\n8   AAAAAAAAJLCBCAAA                                                                                                                            Seemingly long remarks can like immediately cold services. In order good s  Electronics  cameras             1.30     75395.13        0.0706\n9   AAAAAAAAANBEBAAA                                       Really full seeds should work. National activities must not turn for a poems. Now possible ideas might not begin new, democratic resources. Remote, modern clas  Electronics  cameras             0.96    117855.67        0.1104\n10  AAAAAAAAHOLHEAAA                                 Active, proud grants drain. Remarkable farmers might not play almost direct, regional patterns; exactly accurate changes ought to know concepts. Other, ordinary play  Electronics  cameras             1.22    110012.79        0.1030\n11  AAAAAAAAIGLJAAAA                                                                                                                                                Powerful, close chemicals stretch. Above level hours c  Electronics  cameras             4.59    132838.10        0.1244\n12  AAAAAAAALEBJAAAA                                                                                                 Men must not bring; depths could help perhaps. Eyes will remain irish banks. Low achievements drive j  Electronics  cameras            60.83    106622.09        0.0999\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category,\n        i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu        Shoes                      NaN    124147.19        2.2441\n1   AAAAAAAAHPDFBAAA                                                                                                                                                                                                     Electronics                     1.24    114226.46        2.0648\n2   AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09    107972.61        1.9518\n3   AAAAAAAANAHDCAAA                                                                                                                                                           Even organic circumstances see together   Electronics                     1.44     60108.08        1.0865\n4   AAAAAAAAKCBOCAAA                                                                                                                                                                                                         Jewelry                     0.82    103534.34        1.8715\n5   AAAAAAAAAJAFDAAA                                                                                                                                                                                                         Jewelry                      NaN    151793.16        2.7439\n6   AAAAAAAAGPHKDAAA                                                                                                                                     Likely, short members could break for a hands. Possible, usefu      Jewelry                      NaN     60296.16        1.0899\n7   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura        Shoes                     7.02     90171.61        1.6300\n8   AAAAAAAALGHOCAAA                                                                                                                                                                                                         Jewelry                      NaN    100409.24        1.8150\n9   AAAAAAAAHGCFCAAA                                                                                                                                                                                                     Electronics                     3.56    142754.89        2.5805\n10  AAAAAAAAAGOEEAAA                                                                                                                                                                                                           Shoes                      NaN     88424.06        1.5984\n11  AAAAAAAAIPNDEAAA                                                                                                                                                                                             Long-t      Jewelry                      NaN    125816.89        2.2743\n12  AAAAAAAAKCMLDAAA                                                                  Just long reasons dismiss so later physical children. Thousands could indicate really different applications. Rights make so perh      Jewelry                     0.33     87662.53        1.5846\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.250756,
                    "execution_time": 0.191851,
                    "compile_time": 0.000295,
                    "planning_time": 0.041671
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.252596,
                    "execution_time": 0.192246,
                    "compile_time": 0.000315,
                    "planning_time": 0.042343
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu        Shoes                      NaN    124147.19        2.2441\n1   AAAAAAAAHPDFBAAA                                                                                                                                                                                                     Electronics                     1.24    114226.46        2.0648\n2   AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09    107972.61        1.9518\n3   AAAAAAAANAHDCAAA                                                                                                                                                           Even organic circumstances see together   Electronics                     1.44     60108.08        1.0865\n4   AAAAAAAAKCBOCAAA                                                                                                                                                                                                         Jewelry                     0.82    103534.34        1.8715\n5   AAAAAAAAAJAFDAAA                                                                                                                                                                                                         Jewelry                      NaN    151793.16        2.7439\n6   AAAAAAAAGPHKDAAA                                                                                                                                     Likely, short members could break for a hands. Possible, usefu      Jewelry                      NaN     60296.16        1.0899\n7   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura        Shoes                     7.02     90171.61        1.6300\n8   AAAAAAAALGHOCAAA                                                                                                                                                                                                         Jewelry                      NaN    100409.24        1.8150\n9   AAAAAAAAHGCFCAAA                                                                                                                                                                                                     Electronics                     3.56    142754.89        2.5805\n10  AAAAAAAAAGOEEAAA                                                                                                                                                                                                           Shoes                      NaN     88424.06        1.5984\n11  AAAAAAAAIPNDEAAA                                                                                                                                                                                             Long-t      Jewelry                      NaN    125816.89        2.2743\n12  AAAAAAAAKCMLDAAA                                                                  Just long reasons dismiss so later physical children. Thousands could indicate really different applications. Rights make so perh      Jewelry                     0.33     87662.53        1.5846\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price \n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMHFPBAAA                                                                                           Underlying, abstract methods play in addition available agencies; european, invisible sports will not defend as  Electronics  cameras             1.08    161772.48        0.1515\n1   AAAAAAAAMPMHDAAA                                                                                                                                      Psychiatric expenses should not draw gradually within a workshops. M  Electronics  cameras             1.12    124282.76        0.1164\n2   AAAAAAAAKPEDCAAA                                                                                                                   Disputes measure never subjective citizens. Great, small questions contact almost out o  Electronics  cameras             4.08    160913.05        0.1507\n3   AAAAAAAAGFNCDAAA        Horribly full others should not open other decisions. Days must play also aside civil years. Only good eyes remind then significant procedures. Officers make all to the officials. At least consi  Electronics  cameras             4.89     88585.59        0.0830\n4   AAAAAAAAIDBDBAAA                                                                     Parents complain usually other horses; good, subsequent conditions harm never environmental things. Bags shall fit as usual between a  Electronics  cameras             2.37    169617.19        0.1589\n5   AAAAAAAAIADMAAAA                                        Naval, international waves state about musical, chief committees. Different lights establish then beautiful visitors. Just judicial arrangements may forget in a r  Electronics  cameras             0.31    103856.48        0.0973\n6   AAAAAAAAGGICEAAA                                                                                                                                                                                     Near educational need  Electronics  cameras             3.91    140322.99        0.1314\n7   AAAAAAAAJILKCAAA                                                                                                                                                 Now other acts enable quite simple, relevant girls. Other  Electronics  cameras             2.31    154809.94        0.1450\n8   AAAAAAAAMNGPBAAA                                                                                                                                  Numbers render excellent, regular schemes. Only, subsequent features wou  Electronics  cameras             4.08    160069.49        0.1499\n9   AAAAAAAAOINBEAAA  Desperate, effective laws flourish all in a children. Approximately hostile songs may think there great services. Specific teams used to come indeed public flights. Open words may like large partners.  Electronics  cameras            82.72    137161.43        0.1285\n10  AAAAAAAACAJFDAAA                                                                    Global days shall make home international goods. Asian, clear qualifications may not start men; individuals might not fill improvement  Electronics  cameras             8.72    153093.56        0.1434\n11  AAAAAAAAMGKDBAAA                                                                                                     Now good men may not tell traditional assumptions; never poor opportunities ought to set even. Studen  Electronics  cameras             9.97    126354.99        0.1184\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.25736,
                    "execution_time": 0.183399,
                    "compile_time": 0.000319,
                    "planning_time": 0.056441
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.250043,
                    "execution_time": 0.189902,
                    "compile_time": 0.000302,
                    "planning_time": 0.042378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMHFPBAAA                                                                                           Underlying, abstract methods play in addition available agencies; european, invisible sports will not defend as  Electronics  cameras             1.08    161772.48        0.1515\n1   AAAAAAAAMPMHDAAA                                                                                                                                      Psychiatric expenses should not draw gradually within a workshops. M  Electronics  cameras             1.12    124282.76        0.1164\n2   AAAAAAAAKPEDCAAA                                                                                                                   Disputes measure never subjective citizens. Great, small questions contact almost out o  Electronics  cameras             4.08    160913.05        0.1507\n3   AAAAAAAAGFNCDAAA        Horribly full others should not open other decisions. Days must play also aside civil years. Only good eyes remind then significant procedures. Officers make all to the officials. At least consi  Electronics  cameras             4.89     88585.59        0.0830\n4   AAAAAAAAIDBDBAAA                                                                     Parents complain usually other horses; good, subsequent conditions harm never environmental things. Bags shall fit as usual between a  Electronics  cameras             2.37    169617.19        0.1589\n5   AAAAAAAAIADMAAAA                                        Naval, international waves state about musical, chief committees. Different lights establish then beautiful visitors. Just judicial arrangements may forget in a r  Electronics  cameras             0.31    103856.48        0.0973\n6   AAAAAAAAGGICEAAA                                                                                                                                                                                     Near educational need  Electronics  cameras             3.91    140322.99        0.1314\n7   AAAAAAAAJILKCAAA                                                                                                                                                 Now other acts enable quite simple, relevant girls. Other  Electronics  cameras             2.31    154809.94        0.1450\n8   AAAAAAAAMNGPBAAA                                                                                                                                  Numbers render excellent, regular schemes. Only, subsequent features wou  Electronics  cameras             4.08    160069.49        0.1499\n9   AAAAAAAAOINBEAAA  Desperate, effective laws flourish all in a children. Approximately hostile songs may think there great services. Specific teams used to come indeed public flights. Open words may like large partners.  Electronics  cameras            82.72    137161.43        0.1285\n10  AAAAAAAACAJFDAAA                                                                    Global days shall make home international goods. Asian, clear qualifications may not start men; individuals might not fill improvement  Electronics  cameras             8.72    153093.56        0.1434\n11  AAAAAAAAMGKDBAAA                                                                                                     Now good men may not tell traditional assumptions; never poor opportunities ought to set even. Studen  Electronics  cameras             9.97    126354.99        0.1184\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAABEIDDAAA                                                                                                                                                                             Quite international po      Jewelry                      NaN    132093.35        2.3878\n1   AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09    107972.61        1.9518\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                                     Electronics                     3.18    107642.58        1.9458\n3   AAAAAAAACEPEEAAA                                                                                                                  Distinguished feet shall assemble as criticisms. Colleagues should disappear. Exp        Shoes                     0.60     98409.16        1.7789\n4   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu        Shoes                      NaN    124147.19        2.2441\n5   AAAAAAAABHHGBAAA                                                                                                                                                                                                           Shoes                    25.29    123388.54        2.2304\n6   AAAAAAAAAGAABAAA                                                                                                                                     Services might not think. Fast, low years give in addition. Qu      Jewelry                     7.47    153852.23        2.7811\n7   AAAAAAAADBFLCAAA                                                                                                                                                                                                           Shoes                      NaN    147151.95        2.6600\n8   AAAAAAAAGDGLDAAA                                                                          More hostile actors question in a teeth. Truly deep supporters know diplomatic books; relative, common funds free solely         Shoes                     5.60    141840.65        2.5640\n9   AAAAAAAAGCPCEAAA                                                                                                                                                                                                     Electronics                     4.62     76881.89        1.3897\n10  AAAAAAAACDKEDAAA                                                                                                                                                                                                     Electronics                      NaN     88454.43        1.5989\n11  AAAAAAAAHPDFBAAA                                                                                                                                                                                                     Electronics                     1.24    114226.46        2.0648\n12  AAAAAAAACKKAAAAA                                                               Ago proposed hours accelerate. Urban stones used to find recent, interested delegates. Eyes rise. Always red leaders shall not put.       Jewelry                     0.46     82923.45        1.4989\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.245268,
                    "execution_time": 0.185599,
                    "compile_time": 0.000315,
                    "planning_time": 0.042164
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.253305,
                    "execution_time": 0.194268,
                    "compile_time": 0.000298,
                    "planning_time": 0.04192
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAABEIDDAAA                                                                                                                                                                             Quite international po      Jewelry                      NaN    132093.35        2.3878\n1   AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09    107972.61        1.9518\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                                     Electronics                     3.18    107642.58        1.9458\n3   AAAAAAAACEPEEAAA                                                                                                                  Distinguished feet shall assemble as criticisms. Colleagues should disappear. Exp        Shoes                     0.60     98409.16        1.7789\n4   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu        Shoes                      NaN    124147.19        2.2441\n5   AAAAAAAABHHGBAAA                                                                                                                                                                                                           Shoes                    25.29    123388.54        2.2304\n6   AAAAAAAAAGAABAAA                                                                                                                                     Services might not think. Fast, low years give in addition. Qu      Jewelry                     7.47    153852.23        2.7811\n7   AAAAAAAADBFLCAAA                                                                                                                                                                                                           Shoes                      NaN    147151.95        2.6600\n8   AAAAAAAAGDGLDAAA                                                                          More hostile actors question in a teeth. Truly deep supporters know diplomatic books; relative, common funds free solely         Shoes                     5.60    141840.65        2.5640\n9   AAAAAAAAGCPCEAAA                                                                                                                                                                                                     Electronics                     4.62     76881.89        1.3897\n10  AAAAAAAACDKEDAAA                                                                                                                                                                                                     Electronics                      NaN     88454.43        1.5989\n11  AAAAAAAAHPDFBAAA                                                                                                                                                                                                     Electronics                     1.24    114226.46        2.0648\n12  AAAAAAAACKKAAAAA                                                               Ago proposed hours accelerate. Urban stones used to find recent, interested delegates. Eyes rise. Always red leaders shall not put.       Jewelry                     0.46     82923.45        1.4989\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \nrevenueratio /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                   i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKBIFBAAA                                                                                                            Far alive animals claim hard. Positive boards may not pump copies. Heroes report t      Shoes      kids             2.20     38738.49        0.0085\n1   AAAAAAAAACDACAAA                                                                                                        Even aware things undertake most other, false remains. Old initiatives replace. Standa      Shoes  athletic             9.36     38475.95        0.0085\n2   AAAAAAAADIGBEAAA                                                                               Political pounds might reduce so useful papers. Posts throw mostly for the programmes. Criminal rebels suggest       Shoes  athletic             4.85     39315.28        0.0087\n3   AAAAAAAACKOGAAAA                                                                                                                                                                                            Le      Shoes    womens             7.12     42219.63        0.0092\n4   AAAAAAAAOFANAAAA                              Technologies read almost points. Accurate, mental cases may not get also actual, systematic lips. Large doors arrange both then english adults. Even previous ca      Shoes      kids             4.24     42264.58        0.0093\n5   AAAAAAAAFBHAAAAA                                                                                                                                                                                    Free stati      Shoes    womens             4.69     43100.22        0.0094\n6   AAAAAAAAODJBEAAA                                                     Of course particular cells start open actual years. Further pink arms could seek only. There wrong gardens determine however like an rela      Shoes      kids             4.78     43833.22        0.0096\n7   AAAAAAAANCKIBAAA                      Hopefully angry cases might step purely obvious holders. Cases could finance measures; stars can meet still far technical databases. As certain magistrates shall justif      Shoes      kids             9.11     43983.97        0.0097\n8   AAAAAAAAJKOAEAAA                                                                                                                                                            Political contents could vary appa      Shoes    womens             8.10     45593.19        0.0099\n9   AAAAAAAAGEAKDAAA                                                                                                                                                         Bonds use for the changes. Good diffe      Shoes    womens             2.64     46030.25        0.0100\n10  AAAAAAAACDGDDAAA                                                                        Old, mass observers might not receive somehow. Ago ethnic methods issue to a aspects. Environmental, large ideas used       Shoes  athletic             9.12     45711.46        0.0101\n11  AAAAAAAALNIODAAA                                                                                                         Hands play retail, new dollars. Girls extract purely joint towns; measures shoot abou      Shoes    womens             3.17     47153.17        0.0102\n12  AAAAAAAAHGHFAAAA                                                                                                                      So right managers generate organs. Essential, clean parts used to turn e      Shoes  athletic             8.78     45962.68        0.0102\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.251121,
                    "execution_time": 0.189288,
                    "compile_time": 0.000356,
                    "planning_time": 0.043419
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.325007,
                    "execution_time": 0.196612,
                    "compile_time": 0.000352,
                    "planning_time": 0.110186
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                   i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKBIFBAAA                                                                                                            Far alive animals claim hard. Positive boards may not pump copies. Heroes report t      Shoes      kids             2.20     38738.49        0.0085\n1   AAAAAAAAACDACAAA                                                                                                        Even aware things undertake most other, false remains. Old initiatives replace. Standa      Shoes  athletic             9.36     38475.95        0.0085\n2   AAAAAAAADIGBEAAA                                                                               Political pounds might reduce so useful papers. Posts throw mostly for the programmes. Criminal rebels suggest       Shoes  athletic             4.85     39315.28        0.0087\n3   AAAAAAAACKOGAAAA                                                                                                                                                                                            Le      Shoes    womens             7.12     42219.63        0.0092\n4   AAAAAAAAOFANAAAA                              Technologies read almost points. Accurate, mental cases may not get also actual, systematic lips. Large doors arrange both then english adults. Even previous ca      Shoes      kids             4.24     42264.58        0.0093\n5   AAAAAAAAFBHAAAAA                                                                                                                                                                                    Free stati      Shoes    womens             4.69     43100.22        0.0094\n6   AAAAAAAAODJBEAAA                                                     Of course particular cells start open actual years. Further pink arms could seek only. There wrong gardens determine however like an rela      Shoes      kids             4.78     43833.22        0.0096\n7   AAAAAAAANCKIBAAA                      Hopefully angry cases might step purely obvious holders. Cases could finance measures; stars can meet still far technical databases. As certain magistrates shall justif      Shoes      kids             9.11     43983.97        0.0097\n8   AAAAAAAAJKOAEAAA                                                                                                                                                            Political contents could vary appa      Shoes    womens             8.10     45593.19        0.0099\n9   AAAAAAAAGEAKDAAA                                                                                                                                                         Bonds use for the changes. Good diffe      Shoes    womens             2.64     46030.25        0.0100\n10  AAAAAAAACDGDDAAA                                                                        Old, mass observers might not receive somehow. Ago ethnic methods issue to a aspects. Environmental, large ideas used       Shoes  athletic             9.12     45711.46        0.0101\n11  AAAAAAAALNIODAAA                                                                                                         Hands play retail, new dollars. Girls extract purely joint towns; measures shoot abou      Shoes    womens             3.17     47153.17        0.0102\n12  AAAAAAAAHGHFAAAA                                                                                                                      So right managers generate organs. Essential, clean parts used to turn e      Shoes  athletic             8.78     45962.68        0.0102\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALGHJBAAA                                                                                                                                                                                           Original offici  Electronics     cameras             9.33    165371.01        0.1549\n1   AAAAAAAAACHKBAAA                                                                                                Large systems used to lessen however at a miles. Easy usual symptoms will not define too fairly alive prem  Electronics  automotive             4.53     99531.82        0.0921\n2   AAAAAAAAIDMOAAAA                                         Images put much normally political children. Technical procedures might not estimate patterns. Famous, universal levels would tolerate objects. General condition  Electronics      karoke             2.97     84980.77        0.0747\n3   AAAAAAAAHEJOAAAA                                                                                                                                                                                                  Limited   Electronics     cameras            50.24     83765.61        0.0784\n4   AAAAAAAAILNADAAA                                                                                                                                                                                                     Angle  Electronics  automotive             5.99     72752.18        0.0673\n5   AAAAAAAAFIECDAAA                                                                                                                                                             Desperate times can allow. Other, happy arms   Electronics      karoke             5.98    105499.71        0.0927\n6   AAAAAAAALCCKAAAA                                                                                                                                                                 Historical, human systems can respond too  Electronics     cameras            87.46    124787.69        0.1169\n7   AAAAAAAAMBBEBAAA                                                                                                                                                                         Personal, new actions should not   Electronics  automotive             6.03    137300.08        0.1270\n8   AAAAAAAAGNGAEAAA                                                                                                                             Asleep, good bonds can provide nevertheless physical workshops. Places apply   Electronics      karoke             6.34    130051.28        0.1143\n9   AAAAAAAAPAJLCAAA                                               Current, expert years grow eyes; personal, successful powers would look. Waters would minimise usually eventually protective values; easy lines could make   Electronics     cameras             4.87    135343.80        0.1268\n10  AAAAAAAAEFKGAAAA                                                                                                                                    Unions would proceed systems. Large figures publish corporate windows.  Electronics  automotive             6.02    133369.69        0.1234\n11  AAAAAAAAOONFBAAA                                                                                  Variations cannot describe presumably private, different differences. American, open states negotiate almost sophisticat  Electronics      karoke             2.91    129302.44        0.1137\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.248595,
                    "execution_time": 0.187987,
                    "compile_time": 0.00035,
                    "planning_time": 0.04303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.32269,
                    "execution_time": 0.196976,
                    "compile_time": 0.000374,
                    "planning_time": 0.108168
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALGHJBAAA                                                                                                                                                                                           Original offici  Electronics     cameras             9.33    165371.01        0.1549\n1   AAAAAAAAACHKBAAA                                                                                                Large systems used to lessen however at a miles. Easy usual symptoms will not define too fairly alive prem  Electronics  automotive             4.53     99531.82        0.0921\n2   AAAAAAAAIDMOAAAA                                         Images put much normally political children. Technical procedures might not estimate patterns. Famous, universal levels would tolerate objects. General condition  Electronics      karoke             2.97     84980.77        0.0747\n3   AAAAAAAAHEJOAAAA                                                                                                                                                                                                  Limited   Electronics     cameras            50.24     83765.61        0.0784\n4   AAAAAAAAILNADAAA                                                                                                                                                                                                     Angle  Electronics  automotive             5.99     72752.18        0.0673\n5   AAAAAAAAFIECDAAA                                                                                                                                                             Desperate times can allow. Other, happy arms   Electronics      karoke             5.98    105499.71        0.0927\n6   AAAAAAAALCCKAAAA                                                                                                                                                                 Historical, human systems can respond too  Electronics     cameras            87.46    124787.69        0.1169\n7   AAAAAAAAMBBEBAAA                                                                                                                                                                         Personal, new actions should not   Electronics  automotive             6.03    137300.08        0.1270\n8   AAAAAAAAGNGAEAAA                                                                                                                             Asleep, good bonds can provide nevertheless physical workshops. Places apply   Electronics      karoke             6.34    130051.28        0.1143\n9   AAAAAAAAPAJLCAAA                                               Current, expert years grow eyes; personal, successful powers would look. Waters would minimise usually eventually protective values; easy lines could make   Electronics     cameras             4.87    135343.80        0.1268\n10  AAAAAAAAEFKGAAAA                                                                                                                                    Unions would proceed systems. Large figures publish corporate windows.  Electronics  automotive             6.02    133369.69        0.1234\n11  AAAAAAAAOONFBAAA                                                                                  Variations cannot describe presumably private, different differences. American, open states negotiate almost sophisticat  Electronics      karoke             2.91    129302.44        0.1137\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHGCFCAAA                                                                                                                                                                                                         Electronics                     3.56    142754.89        2.5805\n1   AAAAAAAAEJOHEAAA                                                                                                                                                                                                         Electronics                      NaN    115191.39        2.0822\n2   AAAAAAAAIDMKBAAA                                                                              Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                                         Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAACMDPDAAA                                                                   Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n5   AAAAAAAAPCDJCAAA                                                                                                                                                                                                         Electronics                     9.97     99280.41        1.7946\n6   AAAAAAAAILMADAAA                                                                                                                                                                                                         Electronics                     2.37    132761.85        2.3999\n7   AAAAAAAACDKEDAAA                                                                                                                                                                                                         Electronics                      NaN     88454.43        1.5989\n8   AAAAAAAAGOOOCAAA                                                                                                                                                                                                         Electronics                     3.18    107642.58        1.9458\n9   AAAAAAAAGHJJAAAA                                                                                                                                                                                                         Electronics                      NaN    124312.61        2.2471\n10  AAAAAAAAHPDFBAAA                                                                                                                                                                                                         Electronics                     1.24    114226.46        2.0648\n11  AAAAAAAANAHDCAAA                                                                                                                                                               Even organic circumstances see together   Electronics                     1.44     60108.08        1.0865\n12  AAAAAAAAGGJFAAAA                                                                    Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.255743,
                    "execution_time": 0.194608,
                    "compile_time": 0.000345,
                    "planning_time": 0.042959
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.32819,
                    "execution_time": 0.199483,
                    "compile_time": 0.000346,
                    "planning_time": 0.111013
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHGCFCAAA                                                                                                                                                                                                         Electronics                     3.56    142754.89        2.5805\n1   AAAAAAAAEJOHEAAA                                                                                                                                                                                                         Electronics                      NaN    115191.39        2.0822\n2   AAAAAAAAIDMKBAAA                                                                              Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                                         Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAACMDPDAAA                                                                   Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n5   AAAAAAAAPCDJCAAA                                                                                                                                                                                                         Electronics                     9.97     99280.41        1.7946\n6   AAAAAAAAILMADAAA                                                                                                                                                                                                         Electronics                     2.37    132761.85        2.3999\n7   AAAAAAAACDKEDAAA                                                                                                                                                                                                         Electronics                      NaN     88454.43        1.5989\n8   AAAAAAAAGOOOCAAA                                                                                                                                                                                                         Electronics                     3.18    107642.58        1.9458\n9   AAAAAAAAGHJJAAAA                                                                                                                                                                                                         Electronics                      NaN    124312.61        2.2471\n10  AAAAAAAAHPDFBAAA                                                                                                                                                                                                         Electronics                     1.24    114226.46        2.0648\n11  AAAAAAAANAHDCAAA                                                                                                                                                               Even organic circumstances see together   Electronics                     1.44     60108.08        1.0865\n12  AAAAAAAAGGJFAAAA                                                                    Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.255729,
                    "execution_time": 0.193638,
                    "compile_time": 0.000363,
                    "planning_time": 0.044473
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.315854,
                    "execution_time": 0.18737,
                    "compile_time": 0.00035,
                    "planning_time": 0.110202
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.251463,
                    "execution_time": 0.1922,
                    "compile_time": 0.000344,
                    "planning_time": 0.041778
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.314084,
                    "execution_time": 0.188609,
                    "compile_time": 0.000357,
                    "planning_time": 0.107528
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.24342,
                    "execution_time": 0.183738,
                    "compile_time": 0.000379,
                    "planning_time": 0.042191
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.321049,
                    "execution_time": 0.193836,
                    "compile_time": 0.00035,
                    "planning_time": 0.109499
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.250331,
                    "execution_time": 0.187912,
                    "compile_time": 0.000351,
                    "planning_time": 0.044586
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.256587,
                    "execution_time": 0.194198,
                    "compile_time": 0.000393,
                    "planning_time": 0.043761
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACDKEDAAA                                                                                                                                                                                           Electronics                      NaN     88454.43        1.5989\n1   AAAAAAAACMDPDAAA                                                     Both important plants create pounds; much national nations restore other pictures. Direct ties avoid consistent, basic cells. Econom  Electronics                     1.69    100564.25        1.8178\n2   AAAAAAAAEJOHEAAA                                                                                                                                                                                           Electronics                      NaN    115191.39        2.0822\n3   AAAAAAAAGCPCEAAA                                                                                                                                                                                           Electronics                     4.62     76881.89        1.3897\n4   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85    125706.58        2.2723\n5   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN    124312.61        2.2471\n6   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18    107642.58        1.9458\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56    142754.89        2.5805\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24    114226.46        2.0648\n9   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     80976.78        1.4638\n10  AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37    132761.85        2.3999\n11  AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     69926.08        1.2640\n12  AAAAAAAALPNDEAAA                                                                                                                                                                                           Electronics                    57.92     95940.91        1.7343\n...*/"
    }
]