[
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n/*CURSOR_IDENTIFIER*/\n                ) AS sales_data\nGROUP BY channel, id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , SUM ( \"SSR\".\"SALES\" ) AS \"SALES\" , SUM ( \"SSR\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SSR\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" GROUP BY 'store channel' , 'store' || \"SSR\".\"STORE_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.07821,
                    "execution_time": 0.030956,
                    "compile_time": 0.000222,
                    "planning_time": 0.02375,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.248695,
                    "execution_time": 0.033191,
                    "compile_time": 0.102063,
                    "planning_time": 0.08663,
                    "create_size": 5
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.099173,
                    "execution_time": 0.042201,
                    "compile_time": 0.000228,
                    "planning_time": 0.02388,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.501148,
                    "execution_time": 0.058405,
                    "compile_time": 0.322567,
                    "planning_time": 0.08291,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.078448,
                    "execution_time": 0.031871,
                    "compile_time": 0.000233,
                    "planning_time": 0.022265,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.39891,
                    "execution_time": 0.034021,
                    "compile_time": 0.254291,
                    "planning_time": 0.082767,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.984821,
                    "execution_time": 0.892778,
                    "compile_time": 0.000543,
                    "planning_time": 0.053241,
                    "create_size": 882
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.622267,
                    "execution_time": 3.448433,
                    "compile_time": 0.004323,
                    "planning_time": 0.126908,
                    "create_size": 882
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR ) AS SALES_DATA GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*          channel                     id        sales   returns1      profit\n0   store channel  storeAAAAAAAAGNDAAAAA  12430180.98  627578.07 -5812755.35\n1   store channel  storeAAAAAAAANHCAAAAA  11886783.99  626488.52 -5446839.08\n2   store channel  storeAAAAAAAABFBAAAAA  12278664.20  631687.35 -5696759.98\n3   store channel  storeAAAAAAAAGNAAAAAA  12063860.51  594378.64 -5394287.33\n4   store channel  storeAAAAAAAAEICAAAAA  12480399.49  636066.69 -5858950.64\n5   store channel  storeAAAAAAAADBAAAAAA  12159558.64  611625.29 -5588235.38\n6   store channel  storeAAAAAAAAFGCAAAAA  11991800.62  564822.89 -5463977.62\n7   store channel  storeAAAAAAAANLBAAAAA  12572744.18  618831.14 -5816889.91\n8   store channel  storeAAAAAAAACLDAAAAA  12088460.79  640527.88 -5803880.32\n9   store channel  storeAAAAAAAAMHAAAAAA  11907738.07  557976.07 -5539671.83\n10  store channel  storeAAAAAAAAGKAAAAAA  12030993.65  525727.94 -5628734.72\n11  store channel  storeAAAAAAAAKKAAAAAA  11640434.86  618717.15 -5760599.22\n12  store channel  storeAAAAAAAABBCAAAAA  12338172.96  631351.65 -5552637.42\n13  store channel  storeAAAAAAAADFCAAAAA  12110967.85  591243.84 -5652326.52\n14  store channel  storeAAAAAAAAHMAAAAAA  12373862.41  532735.80 -5603430.42\n15  store channel  storeAAAAAAAAKAAAAAAA  12128362.87  552581.16 -5706593.07\n16  store channel  storeAAAAAAAALJCAAAAA  11863740.85  542577.59 -5384138.10\n17  store channel  storeAAAAAAAAPLCAAAAA  12751924.85  607701.53 -5625556.36\n18  store channel  storeAAAAAAAAKLCAAAAA  11854063.91  605361.45 -5701770.71\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.745413,
                    "execution_time": 0.643414,
                    "compile_time": 0.000392,
                    "planning_time": 0.078163
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.756528,
                    "execution_time": 0.655553,
                    "compile_time": 0.005119,
                    "planning_time": 0.071355
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY 'store channel' , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*          channel                     id        sales   returns1      profit\n0   store channel  storeAAAAAAAAGNDAAAAA  12430180.98  627578.07 -5812755.35\n1   store channel  storeAAAAAAAANHCAAAAA  11886783.99  626488.52 -5446839.08\n2   store channel  storeAAAAAAAABFBAAAAA  12278664.20  631687.35 -5696759.98\n3   store channel  storeAAAAAAAAGNAAAAAA  12063860.51  594378.64 -5394287.33\n4   store channel  storeAAAAAAAAEICAAAAA  12480399.49  636066.69 -5858950.64\n5   store channel  storeAAAAAAAADBAAAAAA  12159558.64  611625.29 -5588235.38\n6   store channel  storeAAAAAAAAFGCAAAAA  11991800.62  564822.89 -5463977.62\n7   store channel  storeAAAAAAAANLBAAAAA  12572744.18  618831.14 -5816889.91\n8   store channel  storeAAAAAAAACLDAAAAA  12088460.79  640527.88 -5803880.32\n9   store channel  storeAAAAAAAAMHAAAAAA  11907738.07  557976.07 -5539671.83\n10  store channel  storeAAAAAAAAGKAAAAAA  12030993.65  525727.94 -5628734.72\n11  store channel  storeAAAAAAAAKKAAAAAA  11640434.86  618717.15 -5760599.22\n12  store channel  storeAAAAAAAABBCAAAAA  12338172.96  631351.65 -5552637.42\n13  store channel  storeAAAAAAAADFCAAAAA  12110967.85  591243.84 -5652326.52\n14  store channel  storeAAAAAAAAHMAAAAAA  12373862.41  532735.80 -5603430.42\n15  store channel  storeAAAAAAAAKAAAAAAA  12128362.87  552581.16 -5706593.07\n16  store channel  storeAAAAAAAALJCAAAAA  11863740.85  542577.59 -5384138.10\n17  store channel  storeAAAAAAAAPLCAAAAA  12751924.85  607701.53 -5625556.36\n18  store channel  storeAAAAAAAAKLCAAAAA  11854063.91  605361.45 -5701770.71\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s.s_store_sk                                  AS store_id, \n                                Sum(ss.ss_ext_sales_price)                    AS sales, \n                                Sum(COALESCE(sr.sr_return_amt, 0))            AS returns1, \n                                Sum(ss.ss_net_profit - COALESCE(sr.sr_net_loss, 0)) AS profit \n                FROM            store_sales ss \n                LEFT OUTER JOIN store_returns sr \n                ON              ( \n                                                ss.ss_item_sk = sr.sr_item_sk \n                                AND             ss.ss_ticket_number = sr.sr_ticket_number)\n                JOIN            date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n                JOIN            store s ON ss.ss_store_sk = s.s_store_sk\n                JOIN            item i ON ss.ss_item_sk = i.i_item_sk\n                JOIN            promotion p ON ss.ss_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN Cast('2000-08-26' AS DATE) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE))\n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        s.s_store_sk) , csr AS \n( \n                SELECT          cp.cp_catalog_page_id                         AS catalog_page_id, \n                                sum(cs.cs_ext_sales_price)                    AS sales, \n                                sum(COALESCE(cr.cr_return_amount, 0))         AS returns1, \n                                sum(cs.cs_net_profit - COALESCE(cr.cr_net_loss, 0)) AS profit \n                FROM            catalog_sales cs \n                LEFT OUTER JOIN catalog_returns cr \n                ON              ( \n                                                cs.cs_item_sk = cr.cr_item_sk \n                                AND             cs.cs_order_number = cr.cr_order_number)\n                JOIN            date_dim d ON cs.cs_sold_date_sk = d.d_date_sk\n                JOIN            catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk\n                JOIN            item i ON cs.cs_item_sk = i.i_item_sk\n                JOIN            promotion p ON cs.cs_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        cp.cp_catalog_page_id) , wsr AS \n( \n                SELECT          ws1.web_site_sk AS web_site_id, \n                                sum(ws.ws_ext_sales_price)                    AS sales, \n                                sum(COALESCE(wr.wr_return_amt, 0))            AS returns1, \n                                sum(ws.ws_net_profit - COALESCE(wr.wr_net_loss, 0)) AS profit \n                FROM            web_sales ws \n                LEFT OUTER JOIN web_returns wr \n                ON              ( \n                                                ws.ws_item_sk = wr.wr_item_sk \n                                AND             ws.ws_order_number = wr.wr_order_number)\n                JOIN            date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n                JOIN            web_site ws1 ON ws.ws_web_site_sk = ws1.web_site_sk\n                JOIN            item i ON ws.ws_item_sk = i.i_item_sk\n                JOIN            promotion p ON ws.ws_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        ws1.web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel,\n                       'catalog' || catalog_page_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   csr \n                UNION ALL\n                SELECT 'web channel' AS channel,\n                       'web' || web_site_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   wsr \n         ) AS combined_results\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"D\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"I\" AS ( SELECT \"I\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"I\" WHERE \"I\".\"I_CURRENT_PRICE\" > 50 ) , \"P\" AS ( SELECT \"P\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"P\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"P\" WHERE \"P\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"S\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"SS\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"SS\".\"SS_NET_PROFIT\" - COALESCE ( \"SR\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" JOIN \"I\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SS\".\"SS_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"P\".\"P_PROMO_SK\" = \"SS\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"S\" ON \"S\".\"S_STORE_SK\" = \"SS\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"SS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"SS\".\"SS_TICKET_NUMBER\" GROUP BY \"S\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CP\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CS\".\"CS_NET_PROFIT\" - COALESCE ( \"CR\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"CATALOG_PAGE\" AS \"CP\" ON \"CP\".\"CP_CATALOG_PAGE_SK\" = \"CS\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" JOIN \"I\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"CS\".\"CS_PROMO_SK\" = \"P\".\"P_PROMO_SK\" GROUP BY \"CP\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WS1\".\"WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WS\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WS\".\"WS_NET_PROFIT\" - COALESCE ( \"WR\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" JOIN \"I\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"P\".\"P_PROMO_SK\" = \"WS\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WS1\" ON \"WS\".\"WS_WEB_SITE_SK\" = \"WS1\".\"WEB_SITE_SK\" GROUP BY \"WS1\".\"WEB_SITE_SK\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S.S_STORE_SK AS STORE_ID , SUM ( SS.SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS.SS_NET_PROFIT - COALESCE ( SR.SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES AS SS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( SS.SS_ITEM_SK = SR.SR_ITEM_SK AND SS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER ) JOIN DATE_DIM AS D ON SS.SS_SOLD_DATE_SK = D.D_DATE_SK JOIN STORE AS S ON SS.SS_STORE_SK = S.S_STORE_SK JOIN ITEM AS I ON SS.SS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON SS.SS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY S.S_STORE_SK ) , CSR AS ( SELECT CP.CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS.CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS.CS_NET_PROFIT - COALESCE ( CR.CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ITEM_SK = CR.CR_ITEM_SK AND CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER ) JOIN DATE_DIM AS D ON CS.CS_SOLD_DATE_SK = D.D_DATE_SK JOIN CATALOG_PAGE AS CP ON CS.CS_CATALOG_PAGE_SK = CP.CP_CATALOG_PAGE_SK JOIN ITEM AS I ON CS.CS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON CS.CS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY CP.CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WS1.WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS.WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS.WS_NET_PROFIT - COALESCE ( WR.WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ITEM_SK = WR.WR_ITEM_SK AND WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER ) JOIN DATE_DIM AS D ON WS.WS_SOLD_DATE_SK = D.D_DATE_SK JOIN WEB_SITE AS WS1 ON WS.WS_WEB_SITE_SK = WS1.WEB_SITE_SK JOIN ITEM AS I ON WS.WS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON WS.WS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY WS1.WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                       id        sales   returns1      profit\n0     store channel                 store592  11783948.67  606724.79 -5548740.29\n1     store channel                 store433  12173813.01  581374.52 -5827703.75\n2   catalog channel  catalogAAAAAAAAPMOCAAAA   1323097.69   96379.32  -251633.81\n3   catalog channel  catalogAAAAAAAALBPCAAAA   1512073.63   71445.61  -113285.06\n4   catalog channel  catalogAAAAAAAADEADAAAA   2539653.49   80770.03  -288300.99\n5   catalog channel  catalogAAAAAAAAMLOCAAAA   1252025.96   26917.26  -192904.77\n6   catalog channel  catalogAAAAAAAANPJCAAAA   3732779.44  151207.94  -480066.95\n7   catalog channel  catalogAAAAAAAAJAJCAAAA   7891147.79  516801.91  -892889.08\n8   catalog channel  catalogAAAAAAAAIIJCAAAA   3771967.86  188860.31  -558050.23\n9   catalog channel  catalogAAAAAAAALKJCAAAA   3645277.48  206692.64  -631604.13\n10  catalog channel  catalogAAAAAAAALLOCAAAA   1452897.44   67470.59  -210543.93\n11  catalog channel  catalogAAAAAAAALAADAAAA   2481852.28   92415.29  -323547.04\n12  catalog channel  catalogAAAAAAAACEICAAAA   7594704.35  341518.77  -979334.42\n13  catalog channel  catalogAAAAAAAADDKCAAAA   3896238.84  158803.61  -519578.00\n14  catalog channel  catalogAAAAAAAABHADAAAA   2717466.66  155386.99  -296721.28\n15  catalog channel  catalogAAAAAAAADLOCAAAA   1335741.38   62721.63  -150036.82\n16  catalog channel  catalogAAAAAAAAIHADAAAA   2893529.50  131192.68  -309144.25\n17  catalog channel  catalogAAAAAAAAMGADAAAA   2313206.87  137837.82  -408307.45\n18  catalog channel  catalogAAAAAAAAGKOCAAAA   1439443.35   95694.24  -194403.15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.328036,
                    "execution_time": 1.066185,
                    "compile_time": 0.001173,
                    "planning_time": 0.210697
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.439484,
                    "execution_time": 9.236543,
                    "compile_time": 8.802247,
                    "planning_time": 0.339142
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                       id        sales   returns1      profit\n0     store channel                 store592  11783948.67  606724.79 -5548740.29\n1     store channel                 store433  12173813.01  581374.52 -5827703.75\n2   catalog channel  catalogAAAAAAAAPMOCAAAA   1323097.69   96379.32  -251633.81\n3   catalog channel  catalogAAAAAAAALBPCAAAA   1512073.63   71445.61  -113285.06\n4   catalog channel  catalogAAAAAAAADEADAAAA   2539653.49   80770.03  -288300.99\n5   catalog channel  catalogAAAAAAAAMLOCAAAA   1252025.96   26917.26  -192904.77\n6   catalog channel  catalogAAAAAAAANPJCAAAA   3732779.44  151207.94  -480066.95\n7   catalog channel  catalogAAAAAAAAJAJCAAAA   7891147.79  516801.91  -892889.08\n8   catalog channel  catalogAAAAAAAAIIJCAAAA   3771967.86  188860.31  -558050.23\n9   catalog channel  catalogAAAAAAAALKJCAAAA   3645277.48  206692.64  -631604.13\n10  catalog channel  catalogAAAAAAAALLOCAAAA   1452897.44   67470.59  -210543.93\n11  catalog channel  catalogAAAAAAAALAADAAAA   2481852.28   92415.29  -323547.04\n12  catalog channel  catalogAAAAAAAACEICAAAA   7594704.35  341518.77  -979334.42\n13  catalog channel  catalogAAAAAAAADDKCAAAA   3896238.84  158803.61  -519578.00\n14  catalog channel  catalogAAAAAAAABHADAAAA   2717466.66  155386.99  -296721.28\n15  catalog channel  catalogAAAAAAAADLOCAAAA   1335741.38   62721.63  -150036.82\n16  catalog channel  catalogAAAAAAAAIHADAAAA   2893529.50  131192.68  -309144.25\n17  catalog channel  catalogAAAAAAAAMGADAAAA   2313206.87  137837.82  -408307.45\n18  catalog channel  catalogAAAAAAAAGKOCAAAA   1439443.35   95694.24  -194403.15\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(SS_EXT_SALES_PRICE)                       AS sales, \n                                Sum(COALESCE(SR_RETURN_AMT, 0))               AS returns1, \n                                Sum(SS_NET_PROFIT - COALESCE(SR_NET_LOSS, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(CS_EXT_SALES_PRICE)                       AS sales, \n                                sum(COALESCE(CR_RETURN_AMOUNT, 0))            AS returns1, \n                                sum(CS_NET_PROFIT - COALESCE(CR_NET_LOSS, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(WS_EXT_SALES_PRICE)                       AS sales, \n                                sum(COALESCE(WR_RETURN_AMT, 0))               AS returns1, \n                                sum(WS_NET_PROFIT - COALESCE(WR_NET_LOSS, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                'catalog' || catalog_page_id AS id , \n                sales , \n                returns1 , \n                profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                'web' || web_site_id AS id , \n                sales , \n                returns1 , \n                profit \n                FROM   wsr \n) AS data\nGROUP BY channel, id\nORDER BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"DATA\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"DATA\".\"CHANNEL\" AS \"CHANNEL\" , \"DATA\".\"ID\" AS \"ID\" , SUM ( \"DATA\".\"SALES\" ) AS \"SALES\" , SUM ( \"DATA\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"DATA\".\"PROFIT\" ) AS \"PROFIT\" FROM \"DATA\" AS \"DATA\" GROUP BY \"DATA\".\"CHANNEL\" , \"DATA\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS DATA GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel            id      sales  returns1    profit\n0   catalog channel  catalog10250  232964.99  16065.91 -35560.12\n1   catalog channel  catalog10251  306136.07   9499.35 -26421.83\n2   catalog channel  catalog10252  213619.43  11009.45 -47006.19\n3   catalog channel  catalog10253  268049.95   6645.32 -15556.39\n4   catalog channel  catalog10254  238678.06  13930.34 -22600.46\n5   catalog channel  catalog10255  259244.91  14265.98 -27683.00\n6   catalog channel  catalog10256  233797.40  12188.86 -11040.69\n7   catalog channel  catalog10257  299963.40  32339.84 -11406.91\n8   catalog channel  catalog10258  244751.67  19502.34 -27888.78\n9   catalog channel  catalog10259  213804.05   4436.69 -36888.77\n10  catalog channel  catalog10260  282346.82   7440.45 -17895.90\n11  catalog channel  catalog10261  298749.54  19225.32 -12515.18\n12  catalog channel  catalog10262  269706.94  12376.47  -9464.87\n13  catalog channel  catalog10263  293507.84  22383.77 -51320.82\n14  catalog channel  catalog10264  236698.53   8681.69 -28865.75\n15  catalog channel  catalog10265  294258.81  17230.20 -26566.76\n16  catalog channel  catalog10266  273594.43   8127.83 -25239.51\n17  catalog channel  catalog10267  285883.25  14635.38 -27329.47\n18  catalog channel  catalog10268  225080.21   5646.11 -54633.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.821707,
                    "execution_time": 0.603806,
                    "compile_time": 0.001127,
                    "planning_time": 0.168407
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 12.483186,
                    "execution_time": 0.594813,
                    "compile_time": 11.534702,
                    "planning_time": 0.297449
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel            id      sales  returns1    profit\n0   catalog channel  catalog10250  232964.99  16065.91 -35560.12\n1   catalog channel  catalog10251  306136.07   9499.35 -26421.83\n2   catalog channel  catalog10252  213619.43  11009.45 -47006.19\n3   catalog channel  catalog10253  268049.95   6645.32 -15556.39\n4   catalog channel  catalog10254  238678.06  13930.34 -22600.46\n5   catalog channel  catalog10255  259244.91  14265.98 -27683.00\n6   catalog channel  catalog10256  233797.40  12188.86 -11040.69\n7   catalog channel  catalog10257  299963.40  32339.84 -11406.91\n8   catalog channel  catalog10258  244751.67  19502.34 -27888.78\n9   catalog channel  catalog10259  213804.05   4436.69 -36888.77\n10  catalog channel  catalog10260  282346.82   7440.45 -17895.90\n11  catalog channel  catalog10261  298749.54  19225.32 -12515.18\n12  catalog channel  catalog10262  269706.94  12376.47  -9464.87\n13  catalog channel  catalog10263  293507.84  22383.77 -51320.82\n14  catalog channel  catalog10264  236698.53   8681.69 -28865.75\n15  catalog channel  catalog10265  294258.81  17230.20 -26566.76\n16  catalog channel  catalog10266  273594.43   8127.83 -25239.51\n17  catalog channel  catalog10267  285883.25  14635.38 -27329.47\n18  catalog channel  catalog10268  225080.21   5646.11 -54633.24\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                       || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n) AS combined_results\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1     profit\n0     store channel         storeAAAAAAAAMHBAAAAA  350545.98  25786.81 -206203.01\n1     store channel         storeAAAAAAAAGDCAAAAA  410104.20  19376.12 -193098.08\n2     store channel         storeAAAAAAAAHKCAAAAA  447663.23  34468.09 -220059.03\n3     store channel         storeAAAAAAAAPKDAAAAA  438342.34  17488.27 -217201.66\n4     store channel         storeAAAAAAAADMBAAAAA  408290.41  12371.55 -211429.31\n5   catalog channel  catalog_pageAAAAAAAAMIPCAAAA  155510.20   3400.71    -935.34\n6   catalog channel  catalog_pageAAAAAAAAJLOCAAAA  133203.39   7446.46    8357.27\n7   catalog channel  catalog_pageAAAAAAAANHICAAAA  224379.65  20690.18  -43466.89\n8   catalog channel  catalog_pageAAAAAAAAIHICAAAA  310992.07  30761.32  -33498.40\n9   catalog channel  catalog_pageAAAAAAAAMEPCAAAA   93050.51   3553.78  -32544.68\n10  catalog channel  catalog_pageAAAAAAAAHLJCAAAA  137398.98   1443.95  -11615.59\n11  catalog channel  catalog_pageAAAAAAAAFGJCAAAA  102728.76   2775.71   -8176.20\n12  catalog channel  catalog_pageAAAAAAAABNJCAAAA  146536.29   3791.84  -12858.76\n13  catalog channel  catalog_pageAAAAAAAADKOCAAAA  142559.08   3757.36  -39126.24\n14  catalog channel  catalog_pageAAAAAAAAEKJCAAAA   84287.80   8968.78  -22472.40\n15  catalog channel  catalog_pageAAAAAAAABDKCAAAA  128048.72   6055.41   -6245.27\n16  catalog channel  catalog_pageAAAAAAAAHBJCAAAA  259517.48   7136.13   15076.99\n17  catalog channel  catalog_pageAAAAAAAANPJCAAAA  140342.50   2615.52   -3839.64\n18  catalog channel  catalog_pageAAAAAAAAADPCAAAA   79259.06   1190.18  -23085.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.657433,
                    "execution_time": 0.501468,
                    "compile_time": 0.000715,
                    "planning_time": 0.120285
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 13.096669,
                    "execution_time": 0.501051,
                    "compile_time": 12.301633,
                    "planning_time": 0.250822
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1     profit\n0     store channel         storeAAAAAAAAMHBAAAAA  350545.98  25786.81 -206203.01\n1     store channel         storeAAAAAAAAGDCAAAAA  410104.20  19376.12 -193098.08\n2     store channel         storeAAAAAAAAHKCAAAAA  447663.23  34468.09 -220059.03\n3     store channel         storeAAAAAAAAPKDAAAAA  438342.34  17488.27 -217201.66\n4     store channel         storeAAAAAAAADMBAAAAA  408290.41  12371.55 -211429.31\n5   catalog channel  catalog_pageAAAAAAAAMIPCAAAA  155510.20   3400.71    -935.34\n6   catalog channel  catalog_pageAAAAAAAAJLOCAAAA  133203.39   7446.46    8357.27\n7   catalog channel  catalog_pageAAAAAAAANHICAAAA  224379.65  20690.18  -43466.89\n8   catalog channel  catalog_pageAAAAAAAAIHICAAAA  310992.07  30761.32  -33498.40\n9   catalog channel  catalog_pageAAAAAAAAMEPCAAAA   93050.51   3553.78  -32544.68\n10  catalog channel  catalog_pageAAAAAAAAHLJCAAAA  137398.98   1443.95  -11615.59\n11  catalog channel  catalog_pageAAAAAAAAFGJCAAAA  102728.76   2775.71   -8176.20\n12  catalog channel  catalog_pageAAAAAAAABNJCAAAA  146536.29   3791.84  -12858.76\n13  catalog channel  catalog_pageAAAAAAAADKOCAAAA  142559.08   3757.36  -39126.24\n14  catalog channel  catalog_pageAAAAAAAAEKJCAAAA   84287.80   8968.78  -22472.40\n15  catalog channel  catalog_pageAAAAAAAABDKCAAAA  128048.72   6055.41   -6245.27\n16  catalog channel  catalog_pageAAAAAAAAHBJCAAAA  259517.48   7136.13   15076.99\n17  catalog channel  catalog_pageAAAAAAAANPJCAAAA  140342.50   2615.52   -3839.64\n18  catalog channel  catalog_pageAAAAAAAAADPCAAAA   79259.06   1190.18  -23085.37\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr\n                UNION ALL\n                SELECT 'web channel' AS channel,\n                       'web_site' \n                              || web_site_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   wsr\n) AS combined\nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                 id      sales  returns1     profit\n0     store channel           store884  449146.38  18905.74 -204324.24\n1     store channel           store710  558449.59  21236.71 -224740.04\n2     store channel           store589  481789.68   8006.23 -210435.73\n3     store channel           store487  371999.78  26550.03 -224369.78\n4     store channel           store814  413597.53  24913.19 -146231.03\n5     store channel           store616  481013.18  18033.96 -203507.44\n6     store channel           store812  368186.24  11960.05 -151396.65\n7   catalog channel  catalog_page10785  129004.50  12315.76  -43811.72\n8   catalog channel  catalog_page12174  112294.03   6562.20  -15803.59\n9   catalog channel  catalog_page12114  113486.90   5187.75  -25750.57\n10  catalog channel  catalog_page11968  179370.40   4541.17   -3355.16\n11  catalog channel  catalog_page10383  175128.41   2970.79  -34315.05\n12  catalog channel  catalog_page12134   85033.03   9955.51  -15861.51\n13  catalog channel  catalog_page10619  113474.97   2320.64    6865.70\n14  catalog channel  catalog_page10656   95826.83   3533.06  -30128.37\n15  catalog channel  catalog_page10540  121092.52   4011.50  -37462.81\n16    store channel           store212  330066.30  13829.64 -161320.58\n17    store channel            store37  395830.37  12193.79 -158839.62\n18    store channel            store73  412670.44  33579.44 -240777.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.810481,
                    "execution_time": 0.594888,
                    "compile_time": 0.001048,
                    "planning_time": 0.167284
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.938927,
                    "execution_time": 0.587065,
                    "compile_time": 0.002852,
                    "planning_time": 0.299108
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                 id      sales  returns1     profit\n0     store channel           store884  449146.38  18905.74 -204324.24\n1     store channel           store710  558449.59  21236.71 -224740.04\n2     store channel           store589  481789.68   8006.23 -210435.73\n3     store channel           store487  371999.78  26550.03 -224369.78\n4     store channel           store814  413597.53  24913.19 -146231.03\n5     store channel           store616  481013.18  18033.96 -203507.44\n6     store channel           store812  368186.24  11960.05 -151396.65\n7   catalog channel  catalog_page10785  129004.50  12315.76  -43811.72\n8   catalog channel  catalog_page12174  112294.03   6562.20  -15803.59\n9   catalog channel  catalog_page12114  113486.90   5187.75  -25750.57\n10  catalog channel  catalog_page11968  179370.40   4541.17   -3355.16\n11  catalog channel  catalog_page10383  175128.41   2970.79  -34315.05\n12  catalog channel  catalog_page12134   85033.03   9955.51  -15861.51\n13  catalog channel  catalog_page10619  113474.97   2320.64    6865.70\n14  catalog channel  catalog_page10656   95826.83   3533.06  -30128.37\n15  catalog channel  catalog_page10540  121092.52   4011.50  -37462.81\n16    store channel           store212  330066.30  13829.64 -161320.58\n17    store channel            store37  395830.37  12193.79 -158839.62\n18    store channel            store73  412670.44  33579.44 -240777.04\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined_results \nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1     profit\n0     store channel         storeAAAAAAAAHGAAAAAA  360230.86  14282.26 -199661.65\n1     store channel         storeAAAAAAAAEGBAAAAA  361589.01  28763.94 -163202.17\n2     store channel         storeAAAAAAAAOKBAAAAA  458026.66  14954.09 -200067.22\n3     store channel         storeAAAAAAAAALDAAAAA  380314.94  14152.85 -230710.77\n4     store channel         storeAAAAAAAAIGAAAAAA  457543.46  22988.25 -201891.80\n5     store channel         storeAAAAAAAADEDAAAAA  283048.03  16413.52 -132684.21\n6     store channel         storeAAAAAAAAJLCAAAAA  478959.90  25585.12 -231695.16\n7     store channel         storeAAAAAAAABDDAAAAA  500230.22  28754.23 -194580.38\n8     store channel         storeAAAAAAAAOJCAAAAA  448591.80  22412.21 -198719.33\n9     store channel         storeAAAAAAAABPAAAAAA  432202.54  18717.57 -218022.76\n10    store channel         storeAAAAAAAAKFCAAAAA  379529.26  20288.47 -162568.41\n11  catalog channel  catalog_pageAAAAAAAAKMICAAAA  317653.51  18297.60   -9645.54\n12  catalog channel  catalog_pageAAAAAAAAMDICAAAA  312201.31   9358.64  -24243.10\n13  catalog channel  catalog_pageAAAAAAAAMJJCAAAA  128207.75   9204.85  -21975.88\n14  catalog channel  catalog_pageAAAAAAAABCICAAAA  350520.28  17390.11  -19158.20\n15  catalog channel  catalog_pageAAAAAAAAKJJCAAAA  176713.75   8844.27    1946.23\n16  catalog channel  catalog_pageAAAAAAAAHCKCAAAA  164620.86   6448.67  -13622.96\n17    store channel         storeAAAAAAAAJEDAAAAA  455226.44  16338.15 -135228.54\n18    store channel         storeAAAAAAAAENCAAAAA  393255.21  15871.52 -154627.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.812373,
                    "execution_time": 0.597701,
                    "compile_time": 0.001093,
                    "planning_time": 0.165312
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.099373,
                    "execution_time": 0.755127,
                    "compile_time": 0.004161,
                    "planning_time": 0.289858
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1     profit\n0     store channel         storeAAAAAAAAHGAAAAAA  360230.86  14282.26 -199661.65\n1     store channel         storeAAAAAAAAEGBAAAAA  361589.01  28763.94 -163202.17\n2     store channel         storeAAAAAAAAOKBAAAAA  458026.66  14954.09 -200067.22\n3     store channel         storeAAAAAAAAALDAAAAA  380314.94  14152.85 -230710.77\n4     store channel         storeAAAAAAAAIGAAAAAA  457543.46  22988.25 -201891.80\n5     store channel         storeAAAAAAAADEDAAAAA  283048.03  16413.52 -132684.21\n6     store channel         storeAAAAAAAAJLCAAAAA  478959.90  25585.12 -231695.16\n7     store channel         storeAAAAAAAABDDAAAAA  500230.22  28754.23 -194580.38\n8     store channel         storeAAAAAAAAOJCAAAAA  448591.80  22412.21 -198719.33\n9     store channel         storeAAAAAAAABPAAAAAA  432202.54  18717.57 -218022.76\n10    store channel         storeAAAAAAAAKFCAAAAA  379529.26  20288.47 -162568.41\n11  catalog channel  catalog_pageAAAAAAAAKMICAAAA  317653.51  18297.60   -9645.54\n12  catalog channel  catalog_pageAAAAAAAAMDICAAAA  312201.31   9358.64  -24243.10\n13  catalog channel  catalog_pageAAAAAAAAMJJCAAAA  128207.75   9204.85  -21975.88\n14  catalog channel  catalog_pageAAAAAAAABCICAAAA  350520.28  17390.11  -19158.20\n15  catalog channel  catalog_pageAAAAAAAAKJJCAAAA  176713.75   8844.27    1946.23\n16  catalog channel  catalog_pageAAAAAAAAHCKCAAAA  164620.86   6448.67  -13622.96\n17    store channel         storeAAAAAAAAJEDAAAAA  455226.44  16338.15 -135228.54\n18    store channel         storeAAAAAAAAENCAAAAA  393255.21  15871.52 -154627.72\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS final_summary \nGROUP BY channel, id \nORDER BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"FINAL_SUMMARY\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"FINAL_SUMMARY\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_SUMMARY\".\"ID\" AS \"ID\" , SUM ( \"FINAL_SUMMARY\".\"SALES\" ) AS \"SALES\" , SUM ( \"FINAL_SUMMARY\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"FINAL_SUMMARY\".\"PROFIT\" ) AS \"PROFIT\" FROM \"FINAL_SUMMARY\" AS \"FINAL_SUMMARY\" GROUP BY \"FINAL_SUMMARY\".\"CHANNEL\" , \"FINAL_SUMMARY\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS FINAL_SUMMARY GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAAJCAAAA  267641.14   6274.01 -45291.49\n1   catalog channel  catalog_pageAAAAAAAAAAKCAAAA   94661.22   7342.05 -24503.57\n2   catalog channel  catalog_pageAAAAAAAAAAPCAAAA   74869.03    695.37 -13406.43\n3   catalog channel  catalog_pageAAAAAAAAABICAAAA  233797.40  12188.86 -11040.69\n4   catalog channel  catalog_pageAAAAAAAAABJCAAAA  192435.98  16133.71 -55474.80\n5   catalog channel  catalog_pageAAAAAAAAABKCAAAA  141215.95   1927.16 -20438.34\n6   catalog channel  catalog_pageAAAAAAAAABPCAAAA   96431.28   2326.97 -54242.37\n7   catalog channel  catalog_pageAAAAAAAAACICAAAA  243078.73   4186.16 -29723.26\n8   catalog channel  catalog_pageAAAAAAAAACJCAAAA  126169.14   1374.76  -4413.42\n9   catalog channel  catalog_pageAAAAAAAAACKCAAAA  157242.09  15852.24  13502.34\n10  catalog channel  catalog_pageAAAAAAAAACPCAAAA  170161.46  14334.33  16650.47\n11  catalog channel  catalog_pageAAAAAAAAADICAAAA  259131.74  10155.33 -15875.81\n12  catalog channel  catalog_pageAAAAAAAAADJCAAAA  118423.40   6680.69 -12947.77\n13  catalog channel  catalog_pageAAAAAAAAADKCAAAA  100508.52   6469.21 -24418.39\n14  catalog channel  catalog_pageAAAAAAAAADPCAAAA   79259.06   1190.18 -23085.37\n15  catalog channel  catalog_pageAAAAAAAAAEICAAAA  217247.04   3674.57 -52031.86\n16  catalog channel  catalog_pageAAAAAAAAAEJCAAAA  118123.70   7910.32  -2666.30\n17  catalog channel  catalog_pageAAAAAAAAAEPCAAAA  132621.46  11335.16   6407.39\n18  catalog channel  catalog_pageAAAAAAAAAFICAAAA  216484.63  19886.77 -15332.26\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.816086,
                    "execution_time": 0.599713,
                    "compile_time": 0.001185,
                    "planning_time": 0.166684
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.947996,
                    "execution_time": 0.59967,
                    "compile_time": 0.003048,
                    "planning_time": 0.295302
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAAJCAAAA  267641.14   6274.01 -45291.49\n1   catalog channel  catalog_pageAAAAAAAAAAKCAAAA   94661.22   7342.05 -24503.57\n2   catalog channel  catalog_pageAAAAAAAAAAPCAAAA   74869.03    695.37 -13406.43\n3   catalog channel  catalog_pageAAAAAAAAABICAAAA  233797.40  12188.86 -11040.69\n4   catalog channel  catalog_pageAAAAAAAAABJCAAAA  192435.98  16133.71 -55474.80\n5   catalog channel  catalog_pageAAAAAAAAABKCAAAA  141215.95   1927.16 -20438.34\n6   catalog channel  catalog_pageAAAAAAAAABPCAAAA   96431.28   2326.97 -54242.37\n7   catalog channel  catalog_pageAAAAAAAAACICAAAA  243078.73   4186.16 -29723.26\n8   catalog channel  catalog_pageAAAAAAAAACJCAAAA  126169.14   1374.76  -4413.42\n9   catalog channel  catalog_pageAAAAAAAAACKCAAAA  157242.09  15852.24  13502.34\n10  catalog channel  catalog_pageAAAAAAAAACPCAAAA  170161.46  14334.33  16650.47\n11  catalog channel  catalog_pageAAAAAAAAADICAAAA  259131.74  10155.33 -15875.81\n12  catalog channel  catalog_pageAAAAAAAAADJCAAAA  118423.40   6680.69 -12947.77\n13  catalog channel  catalog_pageAAAAAAAAADKCAAAA  100508.52   6469.21 -24418.39\n14  catalog channel  catalog_pageAAAAAAAAADPCAAAA   79259.06   1190.18 -23085.37\n15  catalog channel  catalog_pageAAAAAAAAAEICAAAA  217247.04   3674.57 -52031.86\n16  catalog channel  catalog_pageAAAAAAAAAEJCAAAA  118123.70   7910.32  -2666.30\n17  catalog channel  catalog_pageAAAAAAAAAEPCAAAA  132621.46  11335.16   6407.39\n18  catalog channel  catalog_pageAAAAAAAAAFICAAAA  216484.63  19886.77 -15332.26\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n    SELECT          ss_store_sk AS store_id, \n                    Sum(ss_ext_sales_price) AS sales, \n                    Sum(COALESCE(sr_return_amt, 0)) AS returns1, \n                    Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n    FROM            store_sales \n    LEFT OUTER JOIN store_returns \n    ON              ( \n                         ss_item_sk = sr_item_sk \n                AND     ss_ticket_number = sr_ticket_number), \n                    date_dim, \n                    store, \n                    item, \n                    promotion \n    WHERE           ss_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n    AND             ss_store_sk = s_store_sk \n    AND             ss_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             ss_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        ss_store_sk) , csr AS \n( \n    SELECT          cs_catalog_page_sk AS catalog_page_id, \n                    sum(cs_ext_sales_price) AS sales, \n                    sum(COALESCE(cr_return_amount, 0)) AS returns1, \n                    sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n    FROM            catalog_sales \n    LEFT OUTER JOIN catalog_returns \n    ON              ( \n                         cs_item_sk = cr_item_sk \n                AND     cs_order_number = cr_order_number), \n                    date_dim, \n                    catalog_page, \n                    item, \n                    promotion \n    WHERE           cs_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, cast('2000-08-26' AS date)) \n    AND             cs_catalog_page_sk = cp_catalog_page_sk \n    AND             cs_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             cs_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        cs_catalog_page_sk) , wsr AS \n( \n    SELECT          ws_web_site_sk AS web_site_id, \n                    sum(ws_ext_sales_price) AS sales, \n                    sum(COALESCE(wr_return_amt, 0)) AS returns1, \n                    sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n    FROM            web_sales \n    LEFT OUTER JOIN web_returns \n    ON              ( \n                         ws_item_sk = wr_item_sk \n                AND     ws_order_number = wr_order_number), \n                    date_dim, \n                    web_site, \n                    item, \n                    promotion \n    WHERE           ws_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, cast('2000-08-26' AS date)) \n    AND             ws_web_site_sk = web_site_sk \n    AND             ws_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             ws_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        ws_web_site_sk) \nSELECT\n     channel , \n     id , \n     sum(sales) AS sales , \n     sum(returns1) AS returns1 , \n     sum(profit) AS profit \nFROM     ( \n            SELECT 'store channel' AS channel , \n                   'store' || store_id AS id , \n                   sales , \n                   returns1 , \n                   profit \n            FROM   ssr \n            UNION ALL \n            SELECT 'catalog channel' AS channel , \n                   'catalog_page' || catalog_page_id AS id , \n                   sales , \n                   returns1 , \n                   profit \n            FROM   csr \n            UNION ALL\n            SELECT 'web channel' AS channel,\n                   'web' || web_site_id AS id,\n                   sales,\n                   returns1,\n                   profit\n            FROM   wsr\n         ) sub\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"SUB\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"SUB\".\"CHANNEL\" AS \"CHANNEL\" , \"SUB\".\"ID\" AS \"ID\" , SUM ( \"SUB\".\"SALES\" ) AS \"SALES\" , SUM ( \"SUB\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SUB\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SUB\" AS \"SUB\" GROUP BY \"SUB\".\"CHANNEL\" , \"SUB\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CS_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CS_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS SUB GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                 id        sales   returns1      profit\n0     store channel           store436  12039417.36  639863.91 -5600283.65\n1     store channel           store835  11673003.58  621875.61 -5664988.08\n2     store channel           store608  12175553.51  566570.19 -5735628.41\n3     store channel           store668  12122392.42  598425.85 -5202355.49\n4     store channel           store400  12167760.01  629125.81 -5428267.95\n5     store channel           store374  12170039.17  586888.23 -5494817.09\n6     store channel           store133  12154489.03  582706.22 -5450257.03\n7     store channel           store932  12143610.16  625015.85 -5875856.42\n8     store channel           store350  12077871.76  658122.69 -5743413.58\n9     store channel           store218  12127442.54  611421.96 -5392293.08\n10    store channel           store127  12058502.81  572517.31 -5772761.47\n11  catalog channel  catalog_page10427   7879247.85  341913.73 -1006231.02\n12  catalog channel  catalog_page10794   3838225.28  200607.67  -539184.54\n13  catalog channel  catalog_page10600   3878888.40  177681.10  -553414.98\n14  catalog channel  catalog_page10622   3883042.08  202170.69  -697710.63\n15  catalog channel  catalog_page12282   2392554.69  128648.85  -348661.44\n16  catalog channel  catalog_page10503   8008654.00  397626.44  -880492.37\n17  catalog channel  catalog_page10378   7795882.05  314742.02 -1018554.00\n18  catalog channel  catalog_page10652   3751496.04  209056.30  -456092.55\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.324219,
                    "execution_time": 1.104848,
                    "compile_time": 0.001109,
                    "planning_time": 0.16839
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 11.967017,
                    "execution_time": 1.051605,
                    "compile_time": 10.561342,
                    "planning_time": 0.29584
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                 id        sales   returns1      profit\n0     store channel           store436  12039417.36  639863.91 -5600283.65\n1     store channel           store835  11673003.58  621875.61 -5664988.08\n2     store channel           store608  12175553.51  566570.19 -5735628.41\n3     store channel           store668  12122392.42  598425.85 -5202355.49\n4     store channel           store400  12167760.01  629125.81 -5428267.95\n5     store channel           store374  12170039.17  586888.23 -5494817.09\n6     store channel           store133  12154489.03  582706.22 -5450257.03\n7     store channel           store932  12143610.16  625015.85 -5875856.42\n8     store channel           store350  12077871.76  658122.69 -5743413.58\n9     store channel           store218  12127442.54  611421.96 -5392293.08\n10    store channel           store127  12058502.81  572517.31 -5772761.47\n11  catalog channel  catalog_page10427   7879247.85  341913.73 -1006231.02\n12  catalog channel  catalog_page10794   3838225.28  200607.67  -539184.54\n13  catalog channel  catalog_page10600   3878888.40  177681.10  -553414.98\n14  catalog channel  catalog_page10622   3883042.08  202170.69  -697710.63\n15  catalog channel  catalog_page12282   2392554.69  128648.85  -348661.44\n16  catalog channel  catalog_page10503   8008654.00  397626.44  -880492.37\n17  catalog channel  catalog_page10378   7795882.05  314742.02 -1018554.00\n18  catalog channel  catalog_page10652   3751496.04  209056.30  -456092.55\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          ss_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ss_store_sk) , csr AS \n( \n                SELECT          cs_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cs_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = ws_web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || ws_web_site_sk AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr) AS combined\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WS_WEB_SITE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" WHERE \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SALES\".\"WS_WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WS_WEB_SITE_SK\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CS_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CS_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WS_WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WS_WEB_SITE_SK AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                 id      sales  returns1     profit\n0     store channel           store433  342999.71  24678.79 -174756.54\n1     store channel           store592  387290.77  38935.71 -128465.86\n2   catalog channel  catalog_page12043  153104.63   3038.39    1832.33\n3   catalog channel  catalog_page10309  168505.14   4683.57  -14422.65\n4   catalog channel  catalog_page10711   86995.25   2087.96  -34736.84\n5   catalog channel  catalog_page10506  261190.99   8173.55  -16108.30\n6   catalog channel  catalog_page12058  140045.24   8444.61  -19542.46\n7   catalog channel  catalog_page10704  145211.31   1561.70  -32419.60\n8   catalog channel  catalog_page10651  173882.02   3013.62   -8963.28\n9   catalog channel  catalog_page10666  116887.51   6579.15    -938.24\n10  catalog channel  catalog_page12131  122049.29   5423.38  -12712.67\n11  catalog channel  catalog_page11989   86659.09   9257.92  -22419.18\n12    store channel           store668  373410.70  24462.87 -211395.28\n13    store channel           store218  448805.79  12753.33 -212260.74\n14    store channel           store374  379406.36  27510.12 -125454.91\n15    store channel           store127  295841.50  22327.66 -166933.99\n16    store channel           store350  435679.40  44973.29 -196260.06\n17    store channel           store133  404113.79  13785.06 -126821.23\n18    store channel           store608  482473.05  26119.16 -235265.50\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.814995,
                    "execution_time": 0.596763,
                    "compile_time": 0.001044,
                    "planning_time": 0.169533
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 12.101986,
                    "execution_time": 0.595639,
                    "compile_time": 11.15149,
                    "planning_time": 0.298734
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                 id      sales  returns1     profit\n0     store channel           store433  342999.71  24678.79 -174756.54\n1     store channel           store592  387290.77  38935.71 -128465.86\n2   catalog channel  catalog_page12043  153104.63   3038.39    1832.33\n3   catalog channel  catalog_page10309  168505.14   4683.57  -14422.65\n4   catalog channel  catalog_page10711   86995.25   2087.96  -34736.84\n5   catalog channel  catalog_page10506  261190.99   8173.55  -16108.30\n6   catalog channel  catalog_page12058  140045.24   8444.61  -19542.46\n7   catalog channel  catalog_page10704  145211.31   1561.70  -32419.60\n8   catalog channel  catalog_page10651  173882.02   3013.62   -8963.28\n9   catalog channel  catalog_page10666  116887.51   6579.15    -938.24\n10  catalog channel  catalog_page12131  122049.29   5423.38  -12712.67\n11  catalog channel  catalog_page11989   86659.09   9257.92  -22419.18\n12    store channel           store668  373410.70  24462.87 -211395.28\n13    store channel           store218  448805.79  12753.33 -212260.74\n14    store channel           store374  379406.36  27510.12 -125454.91\n15    store channel           store127  295841.50  22327.66 -166933.99\n16    store channel           store350  435679.40  44973.29 -196260.06\n17    store channel           store133  404113.79  13785.06 -126821.23\n18    store channel           store608  482473.05  26119.16 -235265.50\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n/*CURSOR_IDENTIFIER*/ SELECT 'web channel' AS channel , 'web' || web_site_id AS id , sales , returns1 , profit FROM wsr) GROUP BY channel, id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.535069,
                    "execution_time": 0.438991,
                    "compile_time": 0.000576,
                    "planning_time": 0.056597,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.62914,
                    "execution_time": 0.447006,
                    "compile_time": 0.001523,
                    "planning_time": 0.139782,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.636648,
                    "execution_time": 0.542552,
                    "compile_time": 0.000518,
                    "planning_time": 0.057169,
                    "create_size": 182
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.294743,
                    "execution_time": 0.544795,
                    "compile_time": 4.579859,
                    "planning_time": 0.129385,
                    "create_size": 182
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"SPEQLITE_TEMP_TABLE_5\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"SPEQLITE_TEMP_TABLE_6\".\"WEB_SITE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089893,
                    "execution_time": 0.048891,
                    "compile_time": 0.000262,
                    "planning_time": 0.009588,
                    "create_size": 32
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.140504,
                    "execution_time": 0.049203,
                    "compile_time": 0.003434,
                    "planning_time": 0.051937,
                    "create_size": 32
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.07564,
                    "execution_time": 0.040554,
                    "compile_time": 0.000289,
                    "planning_time": 0.004537,
                    "create_size": 32
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.43429,
                    "execution_time": 0.039342,
                    "compile_time": 0.301946,
                    "planning_time": 0.058922,
                    "create_size": 32
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales   returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAFJADAAAA  2638043.40   76269.54 -357581.93\n1   catalog channel  catalog_pageAAAAAAAAGFPCAAAA  1619203.11   76524.16  -23596.02\n2   catalog channel  catalog_pageAAAAAAAANKJCAAAA  4056634.07  196081.11 -598075.71\n3   catalog channel  catalog_pageAAAAAAAACPPCAAAA  2698028.38  128247.31 -296693.86\n4   catalog channel  catalog_pageAAAAAAAAGEICAAAA  8234785.91  441450.73 -726265.01\n5   catalog channel  catalog_pageAAAAAAAAJOJCAAAA  3833295.45  179088.86 -441797.73\n6   catalog channel  catalog_pageAAAAAAAAAOJCAAAA  4083437.73  205456.01 -542922.32\n7   catalog channel  catalog_pageAAAAAAAAPIPCAAAA  1420503.91   90402.43 -225511.83\n8   catalog channel  catalog_pageAAAAAAAACDPCAAAA  1291318.30   54630.23 -228396.80\n9   catalog channel  catalog_pageAAAAAAAAKEJCAAAA  4268528.16  213021.61 -288072.23\n10  catalog channel  catalog_pageAAAAAAAAAKOCAAAA  1477284.36  119544.66 -276094.66\n11  catalog channel  catalog_pageAAAAAAAAMPPCAAAA  2586704.17  128853.88 -377656.34\n12  catalog channel  catalog_pageAAAAAAAAAOPCAAAA  2588118.86  127297.83 -343900.96\n13  catalog channel  catalog_pageAAAAAAAABPICAAAA  8021307.36  388695.24 -953663.83\n14  catalog channel  catalog_pageAAAAAAAAALPCAAAA  2504519.98  175185.65 -400729.28\n15  catalog channel  catalog_pageAAAAAAAAMPOCAAAA  1306423.75   67277.72 -307016.51\n16  catalog channel  catalog_pageAAAAAAAAGBADAAAA  2728231.83  147706.37 -238428.07\n17  catalog channel  catalog_pageAAAAAAAAKGPCAAAA  1523502.85   61161.57 -124221.87\n18  catalog channel  catalog_pageAAAAAAAAEOOCAAAA  1287433.04   59917.44 -295197.35\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017126,
                    "execution_time": 0.0073,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003713
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056729,
                    "execution_time": 0.007307,
                    "compile_time": 0.000998,
                    "planning_time": 0.039468
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*            channel                            id       sales   returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAFJADAAAA  2638043.40   76269.54 -357581.93\n1   catalog channel  catalog_pageAAAAAAAAGFPCAAAA  1619203.11   76524.16  -23596.02\n2   catalog channel  catalog_pageAAAAAAAANKJCAAAA  4056634.07  196081.11 -598075.71\n3   catalog channel  catalog_pageAAAAAAAACPPCAAAA  2698028.38  128247.31 -296693.86\n4   catalog channel  catalog_pageAAAAAAAAGEICAAAA  8234785.91  441450.73 -726265.01\n5   catalog channel  catalog_pageAAAAAAAAJOJCAAAA  3833295.45  179088.86 -441797.73\n6   catalog channel  catalog_pageAAAAAAAAAOJCAAAA  4083437.73  205456.01 -542922.32\n7   catalog channel  catalog_pageAAAAAAAAPIPCAAAA  1420503.91   90402.43 -225511.83\n8   catalog channel  catalog_pageAAAAAAAACDPCAAAA  1291318.30   54630.23 -228396.80\n9   catalog channel  catalog_pageAAAAAAAAKEJCAAAA  4268528.16  213021.61 -288072.23\n10  catalog channel  catalog_pageAAAAAAAAAKOCAAAA  1477284.36  119544.66 -276094.66\n11  catalog channel  catalog_pageAAAAAAAAMPPCAAAA  2586704.17  128853.88 -377656.34\n12  catalog channel  catalog_pageAAAAAAAAAOPCAAAA  2588118.86  127297.83 -343900.96\n13  catalog channel  catalog_pageAAAAAAAABPICAAAA  8021307.36  388695.24 -953663.83\n14  catalog channel  catalog_pageAAAAAAAAALPCAAAA  2504519.98  175185.65 -400729.28\n15  catalog channel  catalog_pageAAAAAAAAMPOCAAAA  1306423.75   67277.72 -307016.51\n16  catalog channel  catalog_pageAAAAAAAAGBADAAAA  2728231.83  147706.37 -238428.07\n17  catalog channel  catalog_pageAAAAAAAAKGPCAAAA  1523502.85   61161.57 -124221.87\n18  catalog channel  catalog_pageAAAAAAAAEOOCAAAA  1287433.04   59917.44 -295197.35\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          ss_store_sk                                    AS store_id, \n                                SUM(SS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(SR_RETURN_AMT, 0))               AS returns1, \n                                SUM(SS_NET_PROFIT - COALESCE(SR_NET_LOSS, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ss_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                SUM(CS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(CR_RETURN_AMOUNT, 0))            AS returns1, \n                                SUM(CS_NET_PROFIT - COALESCE(CR_NET_LOSS, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                SUM(WS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(WR_RETURN_AMT, 0))               AS returns1, \n                                SUM(WS_NET_PROFIT - COALESCE(WR_NET_LOSS, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         SUM(sales)   AS sales , \n         SUM(returns1) AS returns1 , \n         SUM(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site'\n                              || web_site_id AS id ,\n                       sales ,\n                       returns1 ,\n                       profit \n                FROM   wsr \n/*CURSOR_IDENTIFIER*/ ) \nGROUP BY channel , id \nORDER BY channel , id;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" FROM \"ITEM\" AS \"ITEM\" ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                 id         sales    returns1       profit\n0   catalog channel  catalog_page10250  1.434052e+08  7218789.99 -18587220.00\n1   catalog channel  catalog_page10251  1.443608e+08  7060030.34 -18409269.23\n2   catalog channel  catalog_page10252  1.441899e+08  6980167.37 -18436052.28\n3   catalog channel  catalog_page10253  1.455002e+08  7043502.76 -18479390.71\n4   catalog channel  catalog_page10254  1.452300e+08  7241834.16 -19117761.05\n5   catalog channel  catalog_page10255  1.441336e+08  7180008.30 -19582005.15\n6   catalog channel  catalog_page10256  1.452396e+08  7377084.38 -18251626.67\n7   catalog channel  catalog_page10257  1.462106e+08  7187119.46 -18936133.16\n8   catalog channel  catalog_page10258  1.452091e+08  7391930.61 -18236250.98\n9   catalog channel  catalog_page10259  1.437517e+08  7186926.88 -18340175.32\n10  catalog channel  catalog_page10260  1.445777e+08  7099185.83 -18338385.75\n11  catalog channel  catalog_page10261  1.448611e+08  7119869.07 -18191734.37\n12  catalog channel  catalog_page10262  1.437403e+08  7088210.43 -19124444.13\n13  catalog channel  catalog_page10263  1.437623e+08  7222837.81 -18623507.68\n14  catalog channel  catalog_page10264  1.428681e+08  7255098.11 -19654535.98\n15  catalog channel  catalog_page10265  1.456820e+08  7041384.33 -17992530.00\n16  catalog channel  catalog_page10266  1.439652e+08  7405325.51 -17886018.51\n17  catalog channel  catalog_page10267  1.446310e+08  7023804.40 -19080436.73\n18  catalog channel  catalog_page10268  1.427248e+08  7102264.63 -18772277.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.296614,
                    "execution_time": 5.074655,
                    "compile_time": 0.001172,
                    "planning_time": 0.168558
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 19.684358,
                    "execution_time": 5.190207,
                    "compile_time": 14.141622,
                    "planning_time": 0.291467
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                 id         sales    returns1       profit\n0   catalog channel  catalog_page10250  1.434052e+08  7218789.99 -18587220.00\n1   catalog channel  catalog_page10251  1.443608e+08  7060030.34 -18409269.23\n2   catalog channel  catalog_page10252  1.441899e+08  6980167.37 -18436052.28\n3   catalog channel  catalog_page10253  1.455002e+08  7043502.76 -18479390.71\n4   catalog channel  catalog_page10254  1.452300e+08  7241834.16 -19117761.05\n5   catalog channel  catalog_page10255  1.441336e+08  7180008.30 -19582005.15\n6   catalog channel  catalog_page10256  1.452396e+08  7377084.38 -18251626.67\n7   catalog channel  catalog_page10257  1.462106e+08  7187119.46 -18936133.16\n8   catalog channel  catalog_page10258  1.452091e+08  7391930.61 -18236250.98\n9   catalog channel  catalog_page10259  1.437517e+08  7186926.88 -18340175.32\n10  catalog channel  catalog_page10260  1.445777e+08  7099185.83 -18338385.75\n11  catalog channel  catalog_page10261  1.448611e+08  7119869.07 -18191734.37\n12  catalog channel  catalog_page10262  1.437403e+08  7088210.43 -19124444.13\n13  catalog channel  catalog_page10263  1.437623e+08  7222837.81 -18623507.68\n14  catalog channel  catalog_page10264  1.428681e+08  7255098.11 -19654535.98\n15  catalog channel  catalog_page10265  1.456820e+08  7041384.33 -17992530.00\n16  catalog channel  catalog_page10266  1.439652e+08  7405325.51 -17886018.51\n17  catalog channel  catalog_page10267  1.446310e+08  7023804.40 -19080436.73\n18  catalog channel  catalog_page10268  1.427248e+08  7102264.63 -18772277.29\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined \nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1     profit\n0     store channel         storeAAAAAAAAJNAAAAAA  386535.84  27947.10 -189129.21\n1     store channel         storeAAAAAAAACCDAAAAA  365879.14   9247.77 -167504.92\n2     store channel         storeAAAAAAAAIOBAAAAA  388789.20  22058.00 -116344.88\n3     store channel         storeAAAAAAAAMKBAAAAA  368931.51  14415.28 -171224.27\n4     store channel         storeAAAAAAAAEMDAAAAA  392096.73  24099.67 -169071.26\n5     store channel         storeAAAAAAAACLBAAAAA  358676.94  18465.53 -159037.78\n6     store channel         storeAAAAAAAAGABAAAAA  373901.52  14322.53 -166222.99\n7     store channel         storeAAAAAAAAMBDAAAAA  391577.31  18132.06 -184999.59\n8     store channel         storeAAAAAAAAAMCAAAAA  350704.02  13771.21 -158861.75\n9     store channel         storeAAAAAAAAIFAAAAAA  310264.21  10712.10 -167625.20\n10  catalog channel  catalog_pageAAAAAAAAIJICAAAA  283960.12  18058.85  -37759.82\n11  catalog channel  catalog_pageAAAAAAAANMJCAAAA  129142.40  21085.18  -25758.70\n12  catalog channel  catalog_pageAAAAAAAALAPCAAAA  153104.63   3038.39    1832.33\n13  catalog channel  catalog_pageAAAAAAAALJPCAAAA   92631.38  12135.19  -27306.94\n14  catalog channel  catalog_pageAAAAAAAALHICAAAA  245786.81   5197.91  -25721.87\n15  catalog channel  catalog_pageAAAAAAAAOPICAAAA  261644.53  15704.18   19594.12\n16  catalog channel  catalog_pageAAAAAAAABKOCAAAA  102774.97   4707.06   -8688.13\n17  catalog channel  catalog_pageAAAAAAAACEICAAAA  309965.86   7900.14  -22665.54\n18  catalog channel  catalog_pageAAAAAAAABKJCAAAA  114384.28    404.88  -29007.80\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.739602,
                    "execution_time": 2.361887,
                    "compile_time": 0.162788,
                    "planning_time": 0.166477
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 23.262205,
                    "execution_time": 12.946245,
                    "compile_time": 9.967013,
                    "planning_time": 0.295013
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1     profit\n0     store channel         storeAAAAAAAAJNAAAAAA  386535.84  27947.10 -189129.21\n1     store channel         storeAAAAAAAACCDAAAAA  365879.14   9247.77 -167504.92\n2     store channel         storeAAAAAAAAIOBAAAAA  388789.20  22058.00 -116344.88\n3     store channel         storeAAAAAAAAMKBAAAAA  368931.51  14415.28 -171224.27\n4     store channel         storeAAAAAAAAEMDAAAAA  392096.73  24099.67 -169071.26\n5     store channel         storeAAAAAAAACLBAAAAA  358676.94  18465.53 -159037.78\n6     store channel         storeAAAAAAAAGABAAAAA  373901.52  14322.53 -166222.99\n7     store channel         storeAAAAAAAAMBDAAAAA  391577.31  18132.06 -184999.59\n8     store channel         storeAAAAAAAAAMCAAAAA  350704.02  13771.21 -158861.75\n9     store channel         storeAAAAAAAAIFAAAAAA  310264.21  10712.10 -167625.20\n10  catalog channel  catalog_pageAAAAAAAAIJICAAAA  283960.12  18058.85  -37759.82\n11  catalog channel  catalog_pageAAAAAAAANMJCAAAA  129142.40  21085.18  -25758.70\n12  catalog channel  catalog_pageAAAAAAAALAPCAAAA  153104.63   3038.39    1832.33\n13  catalog channel  catalog_pageAAAAAAAALJPCAAAA   92631.38  12135.19  -27306.94\n14  catalog channel  catalog_pageAAAAAAAALHICAAAA  245786.81   5197.91  -25721.87\n15  catalog channel  catalog_pageAAAAAAAAOPICAAAA  261644.53  15704.18   19594.12\n16  catalog channel  catalog_pageAAAAAAAABKOCAAAA  102774.97   4707.06   -8688.13\n17  catalog channel  catalog_pageAAAAAAAACEICAAAA  309965.86   7900.14  -22665.54\n18  catalog channel  catalog_pageAAAAAAAABKJCAAAA  114384.28    404.88  -29007.80\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined_results \nGROUP BY channel, id \nORDER BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                 id      sales  returns1    profit\n0   catalog channel  catalog_page10250  232964.99  16065.91 -35560.12\n1   catalog channel  catalog_page10251  306136.07   9499.35 -26421.83\n2   catalog channel  catalog_page10252  213619.43  11009.45 -47006.19\n3   catalog channel  catalog_page10253  268049.95   6645.32 -15556.39\n4   catalog channel  catalog_page10254  238678.06  13930.34 -22600.46\n5   catalog channel  catalog_page10255  259244.91  14265.98 -27683.00\n6   catalog channel  catalog_page10256  233797.40  12188.86 -11040.69\n7   catalog channel  catalog_page10257  299963.40  32339.84 -11406.91\n8   catalog channel  catalog_page10258  244751.67  19502.34 -27888.78\n9   catalog channel  catalog_page10259  213804.05   4436.69 -36888.77\n10  catalog channel  catalog_page10260  282346.82   7440.45 -17895.90\n11  catalog channel  catalog_page10261  298749.54  19225.32 -12515.18\n12  catalog channel  catalog_page10262  269706.94  12376.47  -9464.87\n13  catalog channel  catalog_page10263  293507.84  22383.77 -51320.82\n14  catalog channel  catalog_page10264  236698.53   8681.69 -28865.75\n15  catalog channel  catalog_page10265  294258.81  17230.20 -26566.76\n16  catalog channel  catalog_page10266  273594.43   8127.83 -25239.51\n17  catalog channel  catalog_page10267  285883.25  14635.38 -27329.47\n18  catalog channel  catalog_page10268  225080.21   5646.11 -54633.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.654677,
                    "execution_time": 2.318839,
                    "compile_time": 0.115943,
                    "planning_time": 0.170937
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 22.983351,
                    "execution_time": 12.937136,
                    "compile_time": 9.694371,
                    "planning_time": 0.300396
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                 id      sales  returns1    profit\n0   catalog channel  catalog_page10250  232964.99  16065.91 -35560.12\n1   catalog channel  catalog_page10251  306136.07   9499.35 -26421.83\n2   catalog channel  catalog_page10252  213619.43  11009.45 -47006.19\n3   catalog channel  catalog_page10253  268049.95   6645.32 -15556.39\n4   catalog channel  catalog_page10254  238678.06  13930.34 -22600.46\n5   catalog channel  catalog_page10255  259244.91  14265.98 -27683.00\n6   catalog channel  catalog_page10256  233797.40  12188.86 -11040.69\n7   catalog channel  catalog_page10257  299963.40  32339.84 -11406.91\n8   catalog channel  catalog_page10258  244751.67  19502.34 -27888.78\n9   catalog channel  catalog_page10259  213804.05   4436.69 -36888.77\n10  catalog channel  catalog_page10260  282346.82   7440.45 -17895.90\n11  catalog channel  catalog_page10261  298749.54  19225.32 -12515.18\n12  catalog channel  catalog_page10262  269706.94  12376.47  -9464.87\n13  catalog channel  catalog_page10263  293507.84  22383.77 -51320.82\n14  catalog channel  catalog_page10264  236698.53   8681.69 -28865.75\n15  catalog channel  catalog_page10265  294258.81  17230.20 -26566.76\n16  catalog channel  catalog_page10266  273594.43   8127.83 -25239.51\n17  catalog channel  catalog_page10267  285883.25  14635.38 -27329.47\n18  catalog channel  catalog_page10268  225080.21   5646.11 -54633.24\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                 id      sales  returns1     profit\n0     store channel           store781  370421.59  23602.54 -174314.51\n1     store channel           store890  356138.00  26634.60 -226088.17\n2     store channel           store562  397824.66  24928.74 -181530.29\n3     store channel           store740  451229.15  21183.09 -161484.33\n4     store channel           store811  335917.69  34900.52 -127933.66\n5     store channel           store847  429925.01  14922.60 -236060.97\n6   catalog channel  catalog_page12161  110990.03   4487.88  -42477.26\n7   catalog channel  catalog_page10489  249773.31   4304.63  -28724.11\n8   catalog channel  catalog_page12091  160325.48   5962.57  -26808.33\n9   catalog channel  catalog_page12061   99739.41   1344.78    5926.30\n10  catalog channel  catalog_page10753  130731.26  11827.09  -34856.13\n11  catalog channel  catalog_page10688  142018.17   5648.83  -18474.38\n12  catalog channel  catalog_page10486  237611.58  22353.26  -23734.12\n13  catalog channel  catalog_page12126  145431.92    566.00   -5657.29\n14  catalog channel  catalog_page11946  176066.94   9572.47  -19944.19\n15  catalog channel  catalog_page10502  243489.90   3886.18  -36697.86\n16  catalog channel  catalog_page10692   89169.22   2805.06  -39745.39\n17  catalog channel  catalog_page10636  142615.16  22601.68    8565.42\n18  catalog channel  catalog_page11984   79668.12   8269.88  -45200.58\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.811029,
                    "execution_time": 0.592465,
                    "compile_time": 0.001077,
                    "planning_time": 0.169876
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.974588,
                    "execution_time": 0.584315,
                    "compile_time": 0.043929,
                    "planning_time": 0.298028
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                 id      sales  returns1     profit\n0     store channel           store781  370421.59  23602.54 -174314.51\n1     store channel           store890  356138.00  26634.60 -226088.17\n2     store channel           store562  397824.66  24928.74 -181530.29\n3     store channel           store740  451229.15  21183.09 -161484.33\n4     store channel           store811  335917.69  34900.52 -127933.66\n5     store channel           store847  429925.01  14922.60 -236060.97\n6   catalog channel  catalog_page12161  110990.03   4487.88  -42477.26\n7   catalog channel  catalog_page10489  249773.31   4304.63  -28724.11\n8   catalog channel  catalog_page12091  160325.48   5962.57  -26808.33\n9   catalog channel  catalog_page12061   99739.41   1344.78    5926.30\n10  catalog channel  catalog_page10753  130731.26  11827.09  -34856.13\n11  catalog channel  catalog_page10688  142018.17   5648.83  -18474.38\n12  catalog channel  catalog_page10486  237611.58  22353.26  -23734.12\n13  catalog channel  catalog_page12126  145431.92    566.00   -5657.29\n14  catalog channel  catalog_page11946  176066.94   9572.47  -19944.19\n15  catalog channel  catalog_page10502  243489.90   3886.18  -36697.86\n16  catalog channel  catalog_page10692   89169.22   2805.06  -39745.39\n17  catalog channel  catalog_page10636  142615.16  22601.68    8565.42\n18  catalog channel  catalog_page11984   79668.12   8269.88  -45200.58\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"SPEQLITE_TEMP_TABLE_5\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"SPEQLITE_TEMP_TABLE_6\".\"WEB_SITE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090274,
                    "execution_time": 0.048127,
                    "compile_time": 0.000268,
                    "planning_time": 0.009913,
                    "create_size": 32
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.272875,
                    "execution_time": 0.048888,
                    "compile_time": 0.126936,
                    "planning_time": 0.051766,
                    "create_size": 32
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.077094,
                    "execution_time": 0.039602,
                    "compile_time": 0.0003,
                    "planning_time": 0.005712,
                    "create_size": 32
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.402648,
                    "execution_time": 0.040193,
                    "compile_time": 0.26746,
                    "planning_time": 0.06018,
                    "create_size": 32
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*            channel                            id        sales    returns1       profit\n0   catalog channel  catalog_pageAAAAAAAAALPCAAAA   2504519.98   175185.65   -400729.28\n1   catalog channel  catalog_pageAAAAAAAAIGADAAAA   2539556.72   133702.65   -301083.63\n2   catalog channel  catalog_pageAAAAAAAANOJCAAAA   3855233.56   206859.23   -633153.97\n3   catalog channel  catalog_pageAAAAAAAAHDPCAAAA   1386657.68    80544.87   -174270.66\n4   catalog channel  catalog_pageAAAAAAAANDADAAAA   2675474.38   118014.00   -337095.59\n5   catalog channel  catalog_pageAAAAAAAAPIOCAAAA   1517386.47    57211.58   -185546.84\n6   catalog channel  catalog_pageAAAAAAAAIPOCAAAA   1317247.73    95128.73   -280241.12\n7   catalog channel  catalog_pageAAAAAAAAMPOCAAAA   1306423.75    67277.72   -307016.51\n8   catalog channel  catalog_pageAAAAAAAAGBADAAAA   2728231.83   147706.37   -238428.07\n9   catalog channel  catalog_pageAAAAAAAAKGPCAAAA   1523502.85    61161.57   -124221.87\n10  catalog channel  catalog_pageAAAAAAAADIPCAAAA   1461692.79    56951.25    -90723.66\n11      web channel      web_siteAAAAAAAAGCAAAAAA  80886378.45  4330600.57 -10664547.39\n12      web channel      web_siteAAAAAAAABDAAAAAA  82167808.56  3855239.63 -10580950.49\n13  catalog channel  catalog_pageAAAAAAAAIEICAAAA   7936736.60   478446.95  -1031998.55\n14  catalog channel  catalog_pageAAAAAAAACEADAAAA   2582276.43   127284.10   -210410.02\n15  catalog channel  catalog_pageAAAAAAAALIJCAAAA   4032170.39   174959.09   -462520.51\n16  catalog channel  catalog_pageAAAAAAAAOHJCAAAA   3883042.08   202170.69   -697710.63\n17  catalog channel  catalog_pageAAAAAAAABLICAAAA   7795907.00   357169.86   -838595.29\n18  catalog channel  catalog_pageAAAAAAAAJIICAAAA   8072375.71   484333.32   -686425.34\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016735,
                    "execution_time": 0.00692,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003743
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057934,
                    "execution_time": 0.011242,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038792
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*            channel                            id        sales    returns1       profit\n0   catalog channel  catalog_pageAAAAAAAAALPCAAAA   2504519.98   175185.65   -400729.28\n1   catalog channel  catalog_pageAAAAAAAAIGADAAAA   2539556.72   133702.65   -301083.63\n2   catalog channel  catalog_pageAAAAAAAANOJCAAAA   3855233.56   206859.23   -633153.97\n3   catalog channel  catalog_pageAAAAAAAAHDPCAAAA   1386657.68    80544.87   -174270.66\n4   catalog channel  catalog_pageAAAAAAAANDADAAAA   2675474.38   118014.00   -337095.59\n5   catalog channel  catalog_pageAAAAAAAAPIOCAAAA   1517386.47    57211.58   -185546.84\n6   catalog channel  catalog_pageAAAAAAAAIPOCAAAA   1317247.73    95128.73   -280241.12\n7   catalog channel  catalog_pageAAAAAAAAMPOCAAAA   1306423.75    67277.72   -307016.51\n8   catalog channel  catalog_pageAAAAAAAAGBADAAAA   2728231.83   147706.37   -238428.07\n9   catalog channel  catalog_pageAAAAAAAAKGPCAAAA   1523502.85    61161.57   -124221.87\n10  catalog channel  catalog_pageAAAAAAAADIPCAAAA   1461692.79    56951.25    -90723.66\n11      web channel      web_siteAAAAAAAAGCAAAAAA  80886378.45  4330600.57 -10664547.39\n12      web channel      web_siteAAAAAAAABDAAAAAA  82167808.56  3855239.63 -10580950.49\n13  catalog channel  catalog_pageAAAAAAAAIEICAAAA   7936736.60   478446.95  -1031998.55\n14  catalog channel  catalog_pageAAAAAAAACEADAAAA   2582276.43   127284.10   -210410.02\n15  catalog channel  catalog_pageAAAAAAAALIJCAAAA   4032170.39   174959.09   -462520.51\n16  catalog channel  catalog_pageAAAAAAAAOHJCAAAA   3883042.08   202170.69   -697710.63\n17  catalog channel  catalog_pageAAAAAAAABLICAAAA   7795907.00   357169.86   -838595.29\n18  catalog channel  catalog_pageAAAAAAAAJIICAAAA   8072375.71   484333.32   -686425.34\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" , \"ID\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales   returns1      profit\n0   catalog channel  catalog_pageAAAAAAAAAAADAAAA  2542581.30  119157.53  -318380.37\n1   catalog channel  catalog_pageAAAAAAAAAAJCAAAA  7965705.24  465168.61 -1007829.24\n2   catalog channel  catalog_pageAAAAAAAAAAKCAAAA  4009558.15  179965.73  -461107.93\n3   catalog channel  catalog_pageAAAAAAAAAAPCAAAA  1163871.51   61480.49  -185382.43\n4   catalog channel  catalog_pageAAAAAAAAABADAAAA  2458615.70  117045.73  -305075.02\n5   catalog channel  catalog_pageAAAAAAAAABICAAAA  7992816.76  459800.45  -998847.94\n6   catalog channel  catalog_pageAAAAAAAAABJCAAAA  8193721.48  391697.71 -1015304.07\n7   catalog channel  catalog_pageAAAAAAAAABKCAAAA  4281292.99  244164.70  -549747.88\n8   catalog channel  catalog_pageAAAAAAAAABPCAAAA  1446072.72   55657.33  -174114.96\n9   catalog channel  catalog_pageAAAAAAAAACADAAAA  2835774.19  118623.90  -269060.99\n10  catalog channel  catalog_pageAAAAAAAAACICAAAA  8102828.95  362149.12 -1105881.46\n11  catalog channel  catalog_pageAAAAAAAAACJCAAAA  3885135.76  276494.75  -717302.23\n12  catalog channel  catalog_pageAAAAAAAAACKCAAAA  3913169.92  237872.24  -483644.05\n13  catalog channel  catalog_pageAAAAAAAAACPCAAAA  1593251.61   77579.94  -153459.69\n14  catalog channel  catalog_pageAAAAAAAAADADAAAA  2455635.48  143048.10  -420966.25\n15  catalog channel  catalog_pageAAAAAAAAADICAAAA  7879348.49  373583.86 -1113563.83\n16  catalog channel  catalog_pageAAAAAAAAADJCAAAA  3968111.00  172468.11  -491194.19\n17  catalog channel  catalog_pageAAAAAAAAADKCAAAA  3946856.26  173517.73  -528857.65\n18  catalog channel  catalog_pageAAAAAAAAADPCAAAA  1409504.36   85944.68  -226841.69\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017712,
                    "execution_time": 0.007863,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003858
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.159496,
                    "execution_time": 0.00872,
                    "compile_time": 0.103748,
                    "planning_time": 0.039236
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*            channel                            id       sales   returns1      profit\n0   catalog channel  catalog_pageAAAAAAAAAAADAAAA  2542581.30  119157.53  -318380.37\n1   catalog channel  catalog_pageAAAAAAAAAAJCAAAA  7965705.24  465168.61 -1007829.24\n2   catalog channel  catalog_pageAAAAAAAAAAKCAAAA  4009558.15  179965.73  -461107.93\n3   catalog channel  catalog_pageAAAAAAAAAAPCAAAA  1163871.51   61480.49  -185382.43\n4   catalog channel  catalog_pageAAAAAAAAABADAAAA  2458615.70  117045.73  -305075.02\n5   catalog channel  catalog_pageAAAAAAAAABICAAAA  7992816.76  459800.45  -998847.94\n6   catalog channel  catalog_pageAAAAAAAAABJCAAAA  8193721.48  391697.71 -1015304.07\n7   catalog channel  catalog_pageAAAAAAAAABKCAAAA  4281292.99  244164.70  -549747.88\n8   catalog channel  catalog_pageAAAAAAAAABPCAAAA  1446072.72   55657.33  -174114.96\n9   catalog channel  catalog_pageAAAAAAAAACADAAAA  2835774.19  118623.90  -269060.99\n10  catalog channel  catalog_pageAAAAAAAAACICAAAA  8102828.95  362149.12 -1105881.46\n11  catalog channel  catalog_pageAAAAAAAAACJCAAAA  3885135.76  276494.75  -717302.23\n12  catalog channel  catalog_pageAAAAAAAAACKCAAAA  3913169.92  237872.24  -483644.05\n13  catalog channel  catalog_pageAAAAAAAAACPCAAAA  1593251.61   77579.94  -153459.69\n14  catalog channel  catalog_pageAAAAAAAAADADAAAA  2455635.48  143048.10  -420966.25\n15  catalog channel  catalog_pageAAAAAAAAADICAAAA  7879348.49  373583.86 -1113563.83\n16  catalog channel  catalog_pageAAAAAAAAADJCAAAA  3968111.00  172468.11  -491194.19\n17  catalog channel  catalog_pageAAAAAAAAADKCAAAA  3946856.26  173517.73  -528857.65\n18  catalog channel  catalog_pageAAAAAAAAADPCAAAA  1409504.36   85944.68  -226841.69\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \nLIMIT 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" , \"ID\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales   returns1      profit\n0   catalog channel  catalog_pageAAAAAAAAAAADAAAA  2542581.30  119157.53  -318380.37\n1   catalog channel  catalog_pageAAAAAAAAAAJCAAAA  7965705.24  465168.61 -1007829.24\n2   catalog channel  catalog_pageAAAAAAAAAAKCAAAA  4009558.15  179965.73  -461107.93\n3   catalog channel  catalog_pageAAAAAAAAAAPCAAAA  1163871.51   61480.49  -185382.43\n4   catalog channel  catalog_pageAAAAAAAAABADAAAA  2458615.70  117045.73  -305075.02\n5   catalog channel  catalog_pageAAAAAAAAABICAAAA  7992816.76  459800.45  -998847.94\n6   catalog channel  catalog_pageAAAAAAAAABJCAAAA  8193721.48  391697.71 -1015304.07\n7   catalog channel  catalog_pageAAAAAAAAABKCAAAA  4281292.99  244164.70  -549747.88\n8   catalog channel  catalog_pageAAAAAAAAABPCAAAA  1446072.72   55657.33  -174114.96\n9   catalog channel  catalog_pageAAAAAAAAACADAAAA  2835774.19  118623.90  -269060.99\n10  catalog channel  catalog_pageAAAAAAAAACICAAAA  8102828.95  362149.12 -1105881.46\n11  catalog channel  catalog_pageAAAAAAAAACJCAAAA  3885135.76  276494.75  -717302.23\n12  catalog channel  catalog_pageAAAAAAAAACKCAAAA  3913169.92  237872.24  -483644.05\n13  catalog channel  catalog_pageAAAAAAAAACPCAAAA  1593251.61   77579.94  -153459.69\n14  catalog channel  catalog_pageAAAAAAAAADADAAAA  2455635.48  143048.10  -420966.25\n15  catalog channel  catalog_pageAAAAAAAAADICAAAA  7879348.49  373583.86 -1113563.83\n16  catalog channel  catalog_pageAAAAAAAAADJCAAAA  3968111.00  172468.11  -491194.19\n17  catalog channel  catalog_pageAAAAAAAAADKCAAAA  3946856.26  173517.73  -528857.65\n18  catalog channel  catalog_pageAAAAAAAAADPCAAAA  1409504.36   85944.68  -226841.69\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017725,
                    "execution_time": 0.007868,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003844
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018423,
                    "execution_time": 0.008017,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004128
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*            channel                            id       sales   returns1      profit\n0   catalog channel  catalog_pageAAAAAAAAAAADAAAA  2542581.30  119157.53  -318380.37\n1   catalog channel  catalog_pageAAAAAAAAAAJCAAAA  7965705.24  465168.61 -1007829.24\n2   catalog channel  catalog_pageAAAAAAAAAAKCAAAA  4009558.15  179965.73  -461107.93\n3   catalog channel  catalog_pageAAAAAAAAAAPCAAAA  1163871.51   61480.49  -185382.43\n4   catalog channel  catalog_pageAAAAAAAAABADAAAA  2458615.70  117045.73  -305075.02\n5   catalog channel  catalog_pageAAAAAAAAABICAAAA  7992816.76  459800.45  -998847.94\n6   catalog channel  catalog_pageAAAAAAAAABJCAAAA  8193721.48  391697.71 -1015304.07\n7   catalog channel  catalog_pageAAAAAAAAABKCAAAA  4281292.99  244164.70  -549747.88\n8   catalog channel  catalog_pageAAAAAAAAABPCAAAA  1446072.72   55657.33  -174114.96\n9   catalog channel  catalog_pageAAAAAAAAACADAAAA  2835774.19  118623.90  -269060.99\n10  catalog channel  catalog_pageAAAAAAAAACICAAAA  8102828.95  362149.12 -1105881.46\n11  catalog channel  catalog_pageAAAAAAAAACJCAAAA  3885135.76  276494.75  -717302.23\n12  catalog channel  catalog_pageAAAAAAAAACKCAAAA  3913169.92  237872.24  -483644.05\n13  catalog channel  catalog_pageAAAAAAAAACPCAAAA  1593251.61   77579.94  -153459.69\n14  catalog channel  catalog_pageAAAAAAAAADADAAAA  2455635.48  143048.10  -420966.25\n15  catalog channel  catalog_pageAAAAAAAAADICAAAA  7879348.49  373583.86 -1113563.83\n16  catalog channel  catalog_pageAAAAAAAAADJCAAAA  3968111.00  172468.11  -491194.19\n17  catalog channel  catalog_pageAAAAAAAAADKCAAAA  3946856.26  173517.73  -528857.65\n18  catalog channel  catalog_pageAAAAAAAAADPCAAAA  1409504.36   85944.68  -226841.69\n...*/"
    }
]