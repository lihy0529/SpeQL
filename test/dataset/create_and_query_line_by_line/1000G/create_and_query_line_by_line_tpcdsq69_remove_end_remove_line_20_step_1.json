[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,\n  customer_address ca,\n  customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca.ca_state in ('CO','SD','TX') and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim dd\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = dd.d_date_sk and\n                dd.d_year = 2002 and\n                dd.d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales ws, date_dim dd\n            where c.c_customer_sk = ws.ws_bill_customer_sk and\n                  ws.ws_sold_date_sk = dd.d_date_sk and\n                  dd.d_year = 2002 and\n                  dd.d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales cs, date_dim dd\n            where c.c_customer_sk = cs.cs_ship_customer_sk and\n                  cs.cs_sold_date_sk = dd.d_date_sk))\ngroup by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DD\" AS ( SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 3 AND \"DD\".\"D_MOY\" >= 1 AND \"DD\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DATE_DIM\" AS \"DD\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DD\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 3 AND \"DD\".\"D_MOY\" >= 1 AND \"DD\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101435,
                    "execution_time": 0.037341,
                    "compile_time": 0.000325,
                    "planning_time": 0.031871,
                    "create_size": 31
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.478239,
                    "execution_time": 3.347155,
                    "compile_time": 0.001472,
                    "planning_time": 0.09431,
                    "create_size": 31
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.855637,
                    "execution_time": 0.7503,
                    "compile_time": 0.000391,
                    "planning_time": 0.03063,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.988494,
                    "execution_time": 0.813028,
                    "compile_time": 0.000363,
                    "planning_time": 0.097077,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.462609,
                    "execution_time": 0.357016,
                    "compile_time": 0.000354,
                    "planning_time": 0.030851,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.074154,
                    "execution_time": 1.901588,
                    "compile_time": 0.000358,
                    "planning_time": 0.094047,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.403563,
                    "execution_time": 7.288596,
                    "compile_time": 0.000349,
                    "planning_time": 0.040171,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30.567332,
                    "execution_time": 29.821947,
                    "compile_time": 0.001484,
                    "planning_time": 0.665981,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.553041,
                    "execution_time": 0.461389,
                    "compile_time": 0.000679,
                    "planning_time": 0.049723,
                    "create_size": 11
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.057042,
                    "execution_time": 2.877714,
                    "compile_time": 0.00727,
                    "planning_time": 0.12428,
                    "create_size": 11
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*  cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0         M                 S             Unknown     1                  8000     1         Low Risk     1*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018756,
                    "execution_time": 0.007712,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004435
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057957,
                    "execution_time": 0.007964,
                    "compile_time": 0.001147,
                    "planning_time": 0.039941
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*  cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0         M                 S             Unknown     1                  8000     1         Low Risk     1*/"
    },
    {
        "input": "select /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c\n join customer_address ca on c.c_current_addr_sk = ca.ca_address_sk\n join customer_demographics cd on cd.cd_demo_sk = c.c_current_cdemo_sk\n where\n  ca_state in ('CO','SD','TX') and\n  exists (select *\n          from store_sales ss\n          join date_dim d on ss.ss_sold_date_sk = d.d_date_sk\n          where c.c_customer_sk = ss.ss_customer_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n                from web_sales ws\n                join date_dim d on ws.ws_sold_date_sk = d.d_date_sk\n                where c.c_customer_sk = ws.ws_bill_customer_sk and\n                      d_year = 2002 and\n                      d_moy between 1 and 1+2) and\n    not exists (select * \n                from catalog_sales cs\n                join date_dim d on cs.cs_sold_date_sk = d.d_date_sk\n                where c.c_customer_sk = cs.cs_ship_customer_sk and\n                      d_year = 2002 and\n                      d_moy between 1 and 1+2))\n group by\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 3 AND \"D\".\"D_MOY\" >= 1 AND \"D\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 3 AND \"D\".\"D_MOY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.200798,
                    "execution_time": 0.064049,
                    "compile_time": 0.000336,
                    "planning_time": 0.030347,
                    "create_size": 868
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.259437,
                    "execution_time": 0.058557,
                    "compile_time": 0.000345,
                    "planning_time": 0.092806,
                    "create_size": 868
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.08628,
                    "execution_time": 13.983041,
                    "compile_time": 0.000364,
                    "planning_time": 0.027949,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.704993,
                    "execution_time": 14.533836,
                    "compile_time": 0.000373,
                    "planning_time": 0.0914,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.472671,
                    "execution_time": 1.367908,
                    "compile_time": 0.000342,
                    "planning_time": 0.029991,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.908177,
                    "execution_time": 7.734546,
                    "compile_time": 0.00037,
                    "planning_time": 0.09407,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.909234,
                    "execution_time": 2.79993,
                    "compile_time": 0.000366,
                    "planning_time": 0.034244,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.904416,
                    "execution_time": 6.724524,
                    "compile_time": 0.000359,
                    "planning_time": 0.096183,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.566996,
                    "execution_time": 0.466507,
                    "compile_time": 0.000684,
                    "planning_time": 0.049416,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.310809,
                    "execution_time": 2.139175,
                    "compile_time": 0.00067,
                    "planning_time": 0.11747,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 U             Primary    25                  6500    25        High Risk    25\n1          M                 D           Secondary    16                  9000    16          Unknown    16\n2          F                 U     Advanced Degree    18                  8000    18        High Risk    18\n3          M                 S     Advanced Degree    17                  1000    17          Unknown    17\n4          M                 D     Advanced Degree    30                   500    30        High Risk    30\n5          F                 W             College    13                  7500    13         Low Risk    13\n6          F                 W             Unknown    18                  9000    18          Unknown    18\n7          F                 S             College    15                  7000    15         Low Risk    15\n8          F                 S     Advanced Degree    22                  5000    22          Unknown    22\n9          M                 D             College    15                 10000    15          Unknown    15\n10         M                 D         2 yr Degree    13                  2500    13             Good    13\n11         M                 M             Unknown    18                  5500    18             Good    18\n12         M                 S             Unknown    19                  4000    19         Low Risk    19\n13         F                 M             Primary    12                  2000    12             Good    12\n14         M                 U         2 yr Degree    17                  1500    17        High Risk    17\n15         M                 M     Advanced Degree    19                  8000    19             Good    19\n16         M                 W             College    15                  5500    15         Low Risk    15\n17         M                 M           Secondary    20                  1500    20          Unknown    20\n18         M                 M             Unknown    14                  2000    14          Unknown    14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018334,
                    "execution_time": 0.007218,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004544
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056024,
                    "execution_time": 0.008085,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040037
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 U             Primary    25                  6500    25        High Risk    25\n1          M                 D           Secondary    16                  9000    16          Unknown    16\n2          F                 U     Advanced Degree    18                  8000    18        High Risk    18\n3          M                 S     Advanced Degree    17                  1000    17          Unknown    17\n4          M                 D     Advanced Degree    30                   500    30        High Risk    30\n5          F                 W             College    13                  7500    13         Low Risk    13\n6          F                 W             Unknown    18                  9000    18          Unknown    18\n7          F                 S             College    15                  7000    15         Low Risk    15\n8          F                 S     Advanced Degree    22                  5000    22          Unknown    22\n9          M                 D             College    15                 10000    15          Unknown    15\n10         M                 D         2 yr Degree    13                  2500    13             Good    13\n11         M                 M             Unknown    18                  5500    18             Good    18\n12         M                 S             Unknown    19                  4000    19         Low Risk    19\n13         F                 M             Primary    12                  2000    12             Good    12\n14         M                 U         2 yr Degree    17                  1500    17        High Risk    17\n15         M                 M     Advanced Degree    19                  8000    19             Good    19\n16         M                 W             College    15                  5500    15         Low Risk    15\n17         M                 M           Secondary    20                  1500    20          Unknown    20\n18         M                 M             Unknown    14                  2000    14          Unknown    14\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status, cd_purchase_estimate, cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.194997,
                    "execution_time": 0.056077,
                    "compile_time": 0.000339,
                    "planning_time": 0.031506,
                    "create_size": 868
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.279163,
                    "execution_time": 0.077176,
                    "compile_time": 0.00033,
                    "planning_time": 0.095254,
                    "create_size": 868
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.244029,
                    "execution_time": 14.139934,
                    "compile_time": 0.000391,
                    "planning_time": 0.028636,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.923913,
                    "execution_time": 13.75815,
                    "compile_time": 0.000365,
                    "planning_time": 0.090001,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.473762,
                    "execution_time": 1.368358,
                    "compile_time": 0.000362,
                    "planning_time": 0.030508,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.344835,
                    "execution_time": 3.172529,
                    "compile_time": 0.000378,
                    "planning_time": 0.097558,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.918372,
                    "execution_time": 2.813226,
                    "compile_time": 0.000364,
                    "planning_time": 0.030466,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.278122,
                    "execution_time": 7.100224,
                    "compile_time": 0.000364,
                    "planning_time": 0.10149,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.555698,
                    "execution_time": 0.45771,
                    "compile_time": 0.000628,
                    "planning_time": 0.048494,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.653564,
                    "execution_time": 0.483275,
                    "compile_time": 0.000649,
                    "planning_time": 0.119859,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          M                 D     Advanced Degree    21                   500    21             Good    21\n1          F                 D         2 yr Degree    22                  9000    22             Good    22\n2          M                 M     Advanced Degree    16                   500    16        High Risk    16\n3          M                 U             Unknown    25                  4000    25         Low Risk    25\n4          F                 S     Advanced Degree    20                  4500    20        High Risk    20\n5          F                 M             Unknown    20                  5000    20        High Risk    20\n6          M                 S         2 yr Degree    19                   500    19          Unknown    19\n7          F                 S     Advanced Degree    12                  4500    12             Good    12\n8          F                 S         4 yr Degree    10                  9000    10             Good    10\n9          M                 D         4 yr Degree    19                  2500    19         Low Risk    19\n10         M                 U     Advanced Degree    11                 10000    11          Unknown    11\n11         F                 W             College    12                  7000    12         Low Risk    12\n12         M                 D           Secondary    13                  5500    13         Low Risk    13\n13         F                 M             Primary    22                   500    22             Good    22\n14         F                 S         4 yr Degree     9                  8000     9          Unknown     9\n15         F                 S         2 yr Degree    24                  3000    24             Good    24\n16         F                 M         2 yr Degree    23                  9500    23             Good    23\n17         M                 M           Secondary    12                  1000    12         Low Risk    12\n18         M                 S           Secondary    13                  3000    13         Low Risk    13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018383,
                    "execution_time": 0.007443,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004431
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054407,
                    "execution_time": 0.007808,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039864
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          M                 D     Advanced Degree    21                   500    21             Good    21\n1          F                 D         2 yr Degree    22                  9000    22             Good    22\n2          M                 M     Advanced Degree    16                   500    16        High Risk    16\n3          M                 U             Unknown    25                  4000    25         Low Risk    25\n4          F                 S     Advanced Degree    20                  4500    20        High Risk    20\n5          F                 M             Unknown    20                  5000    20        High Risk    20\n6          M                 S         2 yr Degree    19                   500    19          Unknown    19\n7          F                 S     Advanced Degree    12                  4500    12             Good    12\n8          F                 S         4 yr Degree    10                  9000    10             Good    10\n9          M                 D         4 yr Degree    19                  2500    19         Low Risk    19\n10         M                 U     Advanced Degree    11                 10000    11          Unknown    11\n11         F                 W             College    12                  7000    12         Low Risk    12\n12         M                 D           Secondary    13                  5500    13         Low Risk    13\n13         F                 M             Primary    22                   500    22             Good    22\n14         F                 S         4 yr Degree     9                  8000     9          Unknown     9\n15         F                 S         2 yr Degree    24                  3000    24             Good    24\n16         F                 M         2 yr Degree    23                  9500    23             Good    23\n17         M                 M           Secondary    12                  1000    12         Low Risk    12\n18         M                 S           Secondary    13                  3000    13         Low Risk    13\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DATE\" AS \"D_DATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DOW\" AS \"D_DOW\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DOM\" AS \"D_DOM\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.184887,
                    "execution_time": 0.067599,
                    "compile_time": 0.000349,
                    "planning_time": 0.008277,
                    "create_size": 744
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.436033,
                    "execution_time": 0.258706,
                    "compile_time": 0.000366,
                    "planning_time": 0.065571,
                    "create_size": 744
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.294138,
                    "execution_time": 14.189626,
                    "compile_time": 0.000375,
                    "planning_time": 0.02873,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.971392,
                    "execution_time": 13.797772,
                    "compile_time": 0.000374,
                    "planning_time": 0.097596,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.371739,
                    "execution_time": 1.267205,
                    "compile_time": 0.000363,
                    "planning_time": 0.029808,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.280248,
                    "execution_time": 3.109579,
                    "compile_time": 0.00037,
                    "planning_time": 0.095243,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.738168,
                    "execution_time": 3.632732,
                    "compile_time": 0.000368,
                    "planning_time": 0.030077,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.184701,
                    "execution_time": 7.016,
                    "compile_time": 0.000366,
                    "planning_time": 0.092787,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.568394,
                    "execution_time": 0.46452,
                    "compile_time": 0.000685,
                    "planning_time": 0.052847,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.632862,
                    "execution_time": 0.461586,
                    "compile_time": 0.000641,
                    "planning_time": 0.121043,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          M                 U         2 yr Degree    14                  9500    14         Low Risk    14\n1          M                 U             Unknown    17                  1500    17          Unknown    17\n2          M                 S             College    12                  1500    12         Low Risk    12\n3          M                 W             College    14                  5000    14             Good    14\n4          F                 D         4 yr Degree    16                  3000    16        High Risk    16\n5          F                 U             Unknown    19                 10000    19        High Risk    19\n6          F                 U           Secondary    23                  8500    23         Low Risk    23\n7          F                 D             Unknown    18                  7500    18        High Risk    18\n8          M                 U     Advanced Degree    11                 10000    11          Unknown    11\n9          F                 W     Advanced Degree    19                   500    19        High Risk    19\n10         F                 W             Primary    15                  7500    15             Good    15\n11         M                 U             College    17                  5000    17          Unknown    17\n12         M                 W             Unknown    18                  9500    18        High Risk    18\n13         M                 D           Secondary    14                  1500    14          Unknown    14\n14         M                 S         2 yr Degree    30                  4000    30             Good    30\n15         M                 S             College    15                  1500    15          Unknown    15\n16         F                 D             Unknown    22                  3000    22        High Risk    22\n17         F                 W         4 yr Degree    15                   500    15          Unknown    15\n18         M                 S         2 yr Degree    20                  7500    20             Good    20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018364,
                    "execution_time": 0.007213,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004552
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054972,
                    "execution_time": 0.008003,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.0401
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          M                 U         2 yr Degree    14                  9500    14         Low Risk    14\n1          M                 U             Unknown    17                  1500    17          Unknown    17\n2          M                 S             College    12                  1500    12         Low Risk    12\n3          M                 W             College    14                  5000    14             Good    14\n4          F                 D         4 yr Degree    16                  3000    16        High Risk    16\n5          F                 U             Unknown    19                 10000    19        High Risk    19\n6          F                 U           Secondary    23                  8500    23         Low Risk    23\n7          F                 D             Unknown    18                  7500    18        High Risk    18\n8          M                 U     Advanced Degree    11                 10000    11          Unknown    11\n9          F                 W     Advanced Degree    19                   500    19        High Risk    19\n10         F                 W             Primary    15                  7500    15             Good    15\n11         M                 U             College    17                  5000    17          Unknown    17\n12         M                 W             Unknown    18                  9500    18        High Risk    18\n13         M                 D           Secondary    14                  1500    14          Unknown    14\n14         M                 S         2 yr Degree    30                  4000    30             Good    30\n15         M                 S             College    15                  1500    15          Unknown    15\n16         F                 D             Unknown    22                  3000    22        High Risk    22\n17         F                 W         4 yr Degree    15                   500    15          Unknown    15\n18         M                 S         2 yr Degree    20                  7500    20             Good    20\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          M                 U         2 yr Degree    14                  9500    14         Low Risk    14\n1          M                 U             Unknown    17                  1500    17          Unknown    17\n2          M                 S             College    12                  1500    12         Low Risk    12\n3          M                 W             College    14                  5000    14             Good    14\n4          F                 D         4 yr Degree    16                  3000    16        High Risk    16\n5          F                 U             Unknown    19                 10000    19        High Risk    19\n6          F                 U           Secondary    23                  8500    23         Low Risk    23\n7          F                 D             Unknown    18                  7500    18        High Risk    18\n8          M                 U     Advanced Degree    11                 10000    11          Unknown    11\n9          F                 W     Advanced Degree    19                   500    19        High Risk    19\n10         F                 W             Primary    15                  7500    15             Good    15\n11         M                 U             College    17                  5000    17          Unknown    17\n12         M                 W             Unknown    18                  9500    18        High Risk    18\n13         M                 D           Secondary    14                  1500    14          Unknown    14\n14         M                 S         2 yr Degree    30                  4000    30             Good    30\n15         M                 S             College    15                  1500    15          Unknown    15\n16         F                 D             Unknown    22                  3000    22        High Risk    22\n17         F                 W         4 yr Degree    15                   500    15          Unknown    15\n18         M                 S         2 yr Degree    20                  7500    20             Good    20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01784,
                    "execution_time": 0.007257,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00422
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054091,
                    "execution_time": 0.008217,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039264
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          M                 U         2 yr Degree    14                  9500    14         Low Risk    14\n1          M                 U             Unknown    17                  1500    17          Unknown    17\n2          M                 S             College    12                  1500    12         Low Risk    12\n3          M                 W             College    14                  5000    14             Good    14\n4          F                 D         4 yr Degree    16                  3000    16        High Risk    16\n5          F                 U             Unknown    19                 10000    19        High Risk    19\n6          F                 U           Secondary    23                  8500    23         Low Risk    23\n7          F                 D             Unknown    18                  7500    18        High Risk    18\n8          M                 U     Advanced Degree    11                 10000    11          Unknown    11\n9          F                 W     Advanced Degree    19                   500    19        High Risk    19\n10         F                 W             Primary    15                  7500    15             Good    15\n11         M                 U             College    17                  5000    17          Unknown    17\n12         M                 W             Unknown    18                  9500    18        High Risk    18\n13         M                 D           Secondary    14                  1500    14          Unknown    14\n14         M                 S         2 yr Degree    30                  4000    30             Good    30\n15         M                 S             College    15                  1500    15          Unknown    15\n16         F                 D             Unknown    22                  3000    22        High Risk    22\n17         F                 W         4 yr Degree    15                   500    15          Unknown    15\n18         M                 S         2 yr Degree    20                  7500    20             Good    20\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 S             Primary    16                 10000    16        High Risk    16\n1          F                 W           Secondary    15                  4000    15         Low Risk    15\n2          F                 M             College    15                  9000    15         Low Risk    15\n3          M                 S     Advanced Degree    14                  8000    14         Low Risk    14\n4          M                 U         2 yr Degree    13                  6500    13          Unknown    13\n5          M                 U     Advanced Degree    17                  4500    17             Good    17\n6          F                 D     Advanced Degree    26                  1500    26        High Risk    26\n7          F                 D             College    18                  7500    18        High Risk    18\n8          M                 W         4 yr Degree    13                   500    13          Unknown    13\n9          M                 M             College    15                  3500    15             Good    15\n10         M                 W           Secondary    15                  4000    15          Unknown    15\n11         M                 S     Advanced Degree    22                  5500    22         Low Risk    22\n12         M                 M             College    21                  4500    21         Low Risk    21\n13         M                 U         2 yr Degree    14                  7500    14         Low Risk    14\n14         M                 W             College    16                  5500    16          Unknown    16\n15         F                 W             Unknown    16                  9500    16         Low Risk    16\n16         F                 D           Secondary    22                  5000    22         Low Risk    22\n17         M                 W     Advanced Degree    30                  3000    30        High Risk    30\n18         M                 S         4 yr Degree    16                  5000    16             Good    16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018448,
                    "execution_time": 0.007905,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004102
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01825,
                    "execution_time": 0.007559,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004255
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 S             Primary    16                 10000    16        High Risk    16\n1          F                 W           Secondary    15                  4000    15         Low Risk    15\n2          F                 M             College    15                  9000    15         Low Risk    15\n3          M                 S     Advanced Degree    14                  8000    14         Low Risk    14\n4          M                 U         2 yr Degree    13                  6500    13          Unknown    13\n5          M                 U     Advanced Degree    17                  4500    17             Good    17\n6          F                 D     Advanced Degree    26                  1500    26        High Risk    26\n7          F                 D             College    18                  7500    18        High Risk    18\n8          M                 W         4 yr Degree    13                   500    13          Unknown    13\n9          M                 M             College    15                  3500    15             Good    15\n10         M                 W           Secondary    15                  4000    15          Unknown    15\n11         M                 S     Advanced Degree    22                  5500    22         Low Risk    22\n12         M                 M             College    21                  4500    21         Low Risk    21\n13         M                 U         2 yr Degree    14                  7500    14         Low Risk    14\n14         M                 W             College    16                  5500    16          Unknown    16\n15         F                 W             Unknown    16                  9500    16         Low Risk    16\n16         F                 D           Secondary    22                  5000    22         Low Risk    22\n17         M                 W     Advanced Degree    30                  3000    30        High Risk    30\n18         M                 S         4 yr Degree    16                  5000    16             Good    16\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             Primary    19                  1000    19             Good    19\n1          F                 D             Unknown    16                  5000    16             Good    16\n2          F                 S             College    16                  2000    16          Unknown    16\n3          F                 W             Primary    16                  3000    16        High Risk    16\n4          F                 D             College    21                  6000    21          Unknown    21\n5          F                 W     Advanced Degree    21                  8500    21             Good    21\n6          F                 U           Secondary    23                  5500    23        High Risk    23\n7          F                 M             Primary    16                  7000    16        High Risk    16\n8          F                 W             Unknown    18                  9000    18          Unknown    18\n9          F                 U     Advanced Degree    13                  5000    13          Unknown    13\n10         F                 M             Unknown    16                  6000    16        High Risk    16\n11         F                 S         4 yr Degree    18                  1000    18             Good    18\n12         F                 U     Advanced Degree    26                  2000    26          Unknown    26\n13         F                 U     Advanced Degree    16                  4000    16          Unknown    16\n14         F                 S             Unknown    19                  4500    19          Unknown    19\n15         F                 W         2 yr Degree    23                  9000    23        High Risk    23\n16         F                 D         4 yr Degree    16                  3000    16        High Risk    16\n17         F                 D             Primary    14                 10000    14        High Risk    14\n18         F                 W             Primary    15                  7500    15             Good    15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019358,
                    "execution_time": 0.008384,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004454
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.258902,
                    "execution_time": 0.009075,
                    "compile_time": 0.202234,
                    "planning_time": 0.040188
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             Primary    19                  1000    19             Good    19\n1          F                 D             Unknown    16                  5000    16             Good    16\n2          F                 S             College    16                  2000    16          Unknown    16\n3          F                 W             Primary    16                  3000    16        High Risk    16\n4          F                 D             College    21                  6000    21          Unknown    21\n5          F                 W     Advanced Degree    21                  8500    21             Good    21\n6          F                 U           Secondary    23                  5500    23        High Risk    23\n7          F                 M             Primary    16                  7000    16        High Risk    16\n8          F                 W             Unknown    18                  9000    18          Unknown    18\n9          F                 U     Advanced Degree    13                  5000    13          Unknown    13\n10         F                 M             Unknown    16                  6000    16        High Risk    16\n11         F                 S         4 yr Degree    18                  1000    18             Good    18\n12         F                 U     Advanced Degree    26                  2000    26          Unknown    26\n13         F                 U     Advanced Degree    16                  4000    16          Unknown    16\n14         F                 S             Unknown    19                  4500    19          Unknown    19\n15         F                 W         2 yr Degree    23                  9000    23        High Risk    23\n16         F                 D         4 yr Degree    16                  3000    16        High Risk    16\n17         F                 D             Primary    14                 10000    14        High Risk    14\n18         F                 W             Primary    15                  7500    15             Good    15\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D             College    18                  6500    18         Low Risk    18\n1          F                 D         4 yr Degree    15                  7500    15             Good    15\n2          F                 D             Primary    16                  6000    16         Low Risk    16\n3          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n4          F                 D     Advanced Degree    14                  1000    14          Unknown    14\n5          F                 D     Advanced Degree    17                  6500    17        High Risk    17\n6          F                 D             Primary    21                  9000    21          Unknown    21\n7          F                 D             Unknown    15                  7500    15          Unknown    15\n8          F                 D         2 yr Degree    17                  8000    17             Good    17\n9          F                 D         4 yr Degree    19                  4000    19             Good    19\n10         F                 D             Primary    27                  3000    27        High Risk    27\n11         F                 D         4 yr Degree    15                  2500    15         Low Risk    15\n12         F                 D           Secondary    14                  9500    14        High Risk    14\n13         F                 D         2 yr Degree    15                  9500    15         Low Risk    15\n14         F                 D           Secondary    20                  2000    20        High Risk    20\n15         F                 D           Secondary    20                  7500    20         Low Risk    20\n16         F                 D         4 yr Degree    18                  8500    18          Unknown    18\n17         F                 D             College    14                  8500    14        High Risk    14\n18         F                 D             College    19                  4500    19             Good    19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020198,
                    "execution_time": 0.009091,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004556
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.123734,
                    "execution_time": 0.009203,
                    "compile_time": 0.067663,
                    "planning_time": 0.040096
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D             College    18                  6500    18         Low Risk    18\n1          F                 D         4 yr Degree    15                  7500    15             Good    15\n2          F                 D             Primary    16                  6000    16         Low Risk    16\n3          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n4          F                 D     Advanced Degree    14                  1000    14          Unknown    14\n5          F                 D     Advanced Degree    17                  6500    17        High Risk    17\n6          F                 D             Primary    21                  9000    21          Unknown    21\n7          F                 D             Unknown    15                  7500    15          Unknown    15\n8          F                 D         2 yr Degree    17                  8000    17             Good    17\n9          F                 D         4 yr Degree    19                  4000    19             Good    19\n10         F                 D             Primary    27                  3000    27        High Risk    27\n11         F                 D         4 yr Degree    15                  2500    15         Low Risk    15\n12         F                 D           Secondary    14                  9500    14        High Risk    14\n13         F                 D         2 yr Degree    15                  9500    15         Low Risk    15\n14         F                 D           Secondary    20                  2000    20        High Risk    20\n15         F                 D           Secondary    20                  7500    20         Low Risk    20\n16         F                 D         4 yr Degree    18                  8500    18          Unknown    18\n17         F                 D             College    14                  8500    14        High Risk    14\n18         F                 D             College    19                  4500    19             Good    19\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    16                  5000    16         Low Risk    16\n1          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n2          F                 D         2 yr Degree    21                  9000    21        High Risk    21\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    22                  4000    22        High Risk    22\n5          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n6          F                 D         2 yr Degree    17                  4500    17             Good    17\n7          F                 D         2 yr Degree    18                  9500    18        High Risk    18\n8          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n9          F                 D         2 yr Degree    15                  9500    15         Low Risk    15\n10         F                 D         2 yr Degree    18                  7500    18         Low Risk    18\n11         F                 D         2 yr Degree    18                 10000    18          Unknown    18\n12         F                 D         2 yr Degree    18                  3500    18         Low Risk    18\n13         F                 D         2 yr Degree    17                  5500    17          Unknown    17\n14         F                 D         2 yr Degree    14                 10000    14             Good    14\n15         F                 D         2 yr Degree    15                   500    15         Low Risk    15\n16         F                 D         2 yr Degree    24                  6000    24         Low Risk    24\n17         F                 D         2 yr Degree    13                  6000    13          Unknown    13\n18         F                 D         2 yr Degree    20                  8000    20          Unknown    20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020235,
                    "execution_time": 0.009026,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004643
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.217107,
                    "execution_time": 0.008468,
                    "compile_time": 0.161803,
                    "planning_time": 0.040019
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    16                  5000    16         Low Risk    16\n1          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n2          F                 D         2 yr Degree    21                  9000    21        High Risk    21\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    22                  4000    22        High Risk    22\n5          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n6          F                 D         2 yr Degree    17                  4500    17             Good    17\n7          F                 D         2 yr Degree    18                  9500    18        High Risk    18\n8          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n9          F                 D         2 yr Degree    15                  9500    15         Low Risk    15\n10         F                 D         2 yr Degree    18                  7500    18         Low Risk    18\n11         F                 D         2 yr Degree    18                 10000    18          Unknown    18\n12         F                 D         2 yr Degree    18                  3500    18         Low Risk    18\n13         F                 D         2 yr Degree    17                  5500    17          Unknown    17\n14         F                 D         2 yr Degree    14                 10000    14             Good    14\n15         F                 D         2 yr Degree    15                   500    15         Low Risk    15\n16         F                 D         2 yr Degree    24                  6000    24         Low Risk    24\n17         F                 D         2 yr Degree    13                  6000    13          Unknown    13\n18         F                 D         2 yr Degree    20                  8000    20          Unknown    20\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\ncd_credit_rating\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    12                   500    12             Good    12\n1          F                 D         2 yr Degree    11                   500    11        High Risk    11\n2          F                 D         2 yr Degree    15                   500    15         Low Risk    15\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    17                  1000    17             Good    17\n5          F                 D         2 yr Degree    15                  1000    15        High Risk    15\n6          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n7          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n8          F                 D         2 yr Degree    11                  1500    11             Good    11\n9          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n10         F                 D         2 yr Degree    20                  1500    20         Low Risk    20\n11         F                 D         2 yr Degree    16                  1500    16          Unknown    16\n12         F                 D         2 yr Degree    11                  2000    11             Good    11\n13         F                 D         2 yr Degree    22                  2000    22        High Risk    22\n14         F                 D         2 yr Degree    16                  2000    16         Low Risk    16\n15         F                 D         2 yr Degree    19                  2000    19          Unknown    19\n16         F                 D         2 yr Degree    26                  2500    26             Good    26\n17         F                 D         2 yr Degree    19                  2500    19        High Risk    19\n18         F                 D         2 yr Degree    17                  2500    17         Low Risk    17\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019951,
                    "execution_time": 0.00839,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004943
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057374,
                    "execution_time": 0.009019,
                    "compile_time": 0.001247,
                    "planning_time": 0.040215
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    12                   500    12             Good    12\n1          F                 D         2 yr Degree    11                   500    11        High Risk    11\n2          F                 D         2 yr Degree    15                   500    15         Low Risk    15\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    17                  1000    17             Good    17\n5          F                 D         2 yr Degree    15                  1000    15        High Risk    15\n6          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n7          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n8          F                 D         2 yr Degree    11                  1500    11             Good    11\n9          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n10         F                 D         2 yr Degree    20                  1500    20         Low Risk    20\n11         F                 D         2 yr Degree    16                  1500    16          Unknown    16\n12         F                 D         2 yr Degree    11                  2000    11             Good    11\n13         F                 D         2 yr Degree    22                  2000    22        High Risk    22\n14         F                 D         2 yr Degree    16                  2000    16         Low Risk    16\n15         F                 D         2 yr Degree    19                  2000    19          Unknown    19\n16         F                 D         2 yr Degree    26                  2500    26             Good    26\n17         F                 D         2 yr Degree    19                  2500    19        High Risk    19\n18         F                 D         2 yr Degree    17                  2500    17         Low Risk    17\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    12                   500    12             Good    12\n1          F                 D         2 yr Degree    11                   500    11        High Risk    11\n2          F                 D         2 yr Degree    15                   500    15         Low Risk    15\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    17                  1000    17             Good    17\n5          F                 D         2 yr Degree    15                  1000    15        High Risk    15\n6          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n7          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n8          F                 D         2 yr Degree    11                  1500    11             Good    11\n9          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n10         F                 D         2 yr Degree    20                  1500    20         Low Risk    20\n11         F                 D         2 yr Degree    16                  1500    16          Unknown    16\n12         F                 D         2 yr Degree    11                  2000    11             Good    11\n13         F                 D         2 yr Degree    22                  2000    22        High Risk    22\n14         F                 D         2 yr Degree    16                  2000    16         Low Risk    16\n15         F                 D         2 yr Degree    19                  2000    19          Unknown    19\n16         F                 D         2 yr Degree    26                  2500    26             Good    26\n17         F                 D         2 yr Degree    19                  2500    19        High Risk    19\n18         F                 D         2 yr Degree    17                  2500    17         Low Risk    17\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019902,
                    "execution_time": 0.008328,
                    "compile_time": 8e-05,
                    "planning_time": 0.004875
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020488,
                    "execution_time": 0.008573,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004985
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    12                   500    12             Good    12\n1          F                 D         2 yr Degree    11                   500    11        High Risk    11\n2          F                 D         2 yr Degree    15                   500    15         Low Risk    15\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    17                  1000    17             Good    17\n5          F                 D         2 yr Degree    15                  1000    15        High Risk    15\n6          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n7          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n8          F                 D         2 yr Degree    11                  1500    11             Good    11\n9          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n10         F                 D         2 yr Degree    20                  1500    20         Low Risk    20\n11         F                 D         2 yr Degree    16                  1500    16          Unknown    16\n12         F                 D         2 yr Degree    11                  2000    11             Good    11\n13         F                 D         2 yr Degree    22                  2000    22        High Risk    22\n14         F                 D         2 yr Degree    16                  2000    16         Low Risk    16\n15         F                 D         2 yr Degree    19                  2000    19          Unknown    19\n16         F                 D         2 yr Degree    26                  2500    26             Good    26\n17         F                 D         2 yr Degree    19                  2500    19        High Risk    19\n18         F                 D         2 yr Degree    17                  2500    17         Low Risk    17\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    12                   500    12             Good    12\n1          F                 D         2 yr Degree    11                   500    11        High Risk    11\n2          F                 D         2 yr Degree    15                   500    15         Low Risk    15\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    17                  1000    17             Good    17\n5          F                 D         2 yr Degree    15                  1000    15        High Risk    15\n6          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n7          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n8          F                 D         2 yr Degree    11                  1500    11             Good    11\n9          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n10         F                 D         2 yr Degree    20                  1500    20         Low Risk    20\n11         F                 D         2 yr Degree    16                  1500    16          Unknown    16\n12         F                 D         2 yr Degree    11                  2000    11             Good    11\n13         F                 D         2 yr Degree    22                  2000    22        High Risk    22\n14         F                 D         2 yr Degree    16                  2000    16         Low Risk    16\n15         F                 D         2 yr Degree    19                  2000    19          Unknown    19\n16         F                 D         2 yr Degree    26                  2500    26             Good    26\n17         F                 D         2 yr Degree    19                  2500    19        High Risk    19\n18         F                 D         2 yr Degree    17                  2500    17         Low Risk    17\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020241,
                    "execution_time": 0.008701,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.00476
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020935,
                    "execution_time": 0.008741,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.004949
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    12                   500    12             Good    12\n1          F                 D         2 yr Degree    11                   500    11        High Risk    11\n2          F                 D         2 yr Degree    15                   500    15         Low Risk    15\n3          F                 D         2 yr Degree    22                   500    22          Unknown    22\n4          F                 D         2 yr Degree    17                  1000    17             Good    17\n5          F                 D         2 yr Degree    15                  1000    15        High Risk    15\n6          F                 D         2 yr Degree    13                  1000    13         Low Risk    13\n7          F                 D         2 yr Degree    16                  1000    16          Unknown    16\n8          F                 D         2 yr Degree    11                  1500    11             Good    11\n9          F                 D         2 yr Degree    15                  1500    15        High Risk    15\n10         F                 D         2 yr Degree    20                  1500    20         Low Risk    20\n11         F                 D         2 yr Degree    16                  1500    16          Unknown    16\n12         F                 D         2 yr Degree    11                  2000    11             Good    11\n13         F                 D         2 yr Degree    22                  2000    22        High Risk    22\n14         F                 D         2 yr Degree    16                  2000    16         Low Risk    16\n15         F                 D         2 yr Degree    19                  2000    19          Unknown    19\n16         F                 D         2 yr Degree    26                  2500    26             Good    26\n17         F                 D         2 yr Degree    19                  2500    19        High Risk    19\n18         F                 D         2 yr Degree    17                  2500    17         Low Risk    17\n...*/"
    }
]