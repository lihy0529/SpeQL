[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inventory.inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      \n      \n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > dateadd(day, 5, d1.d_date)\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > TS_OR_DS_ADD ( 'DAY' , 5 , D_DATE , TIMESTAMP ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ , SUM ( CASE WHEN P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS NO_PROMO , SUM ( CASE WHEN NOT P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS PROMO , COUNT ( * ) AS TOTAL_CNT FROM CATALOG_SALES JOIN INVENTORY ON ( CS_ITEM_SK = INV_ITEM_SK ) JOIN WAREHOUSE ON ( W_WAREHOUSE_SK = INV_WAREHOUSE_SK ) JOIN ITEM ON ( I_ITEM_SK = CS_ITEM_SK ) JOIN CUSTOMER_DEMOGRAPHICS ON ( CS_BILL_CDEMO_SK = CD_DEMO_SK ) JOIN HOUSEHOLD_DEMOGRAPHICS ON ( CS_BILL_HDEMO_SK = HD_DEMO_SK ) JOIN DATE_DIM AS D1 ON ( CS_SOLD_DATE_SK = D1.D_DATE_SK ) JOIN DATE_DIM AS D2 ON ( INV_DATE_SK = D2.D_DATE_SK ) JOIN DATE_DIM AS D3 ON ( CS_SHIP_DATE_SK = D3.D_DATE_SK ) LEFT OUTER JOIN PROMOTION ON ( CS_PROMO_SK = P_PROMO_SK ) LEFT OUTER JOIN CATALOG_RETURNS ON ( CR_ITEM_SK = CS_ITEM_SK AND CR_ORDER_NUMBER = CS_ORDER_NUMBER ) WHERE D1.D_WEEK_SEQ = D2.D_WEEK_SEQ AND INV_QUANTITY_ON_HAND < CS_QUANTITY AND D3.D_DATE > DATEADD ( DAY , 5 , D1.D_DATE ) AND HD_BUY_POTENTIAL = '1001-5000' AND D1.D_YEAR = 2000 GROUP BY I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                        i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                            Alone, legal eyes should not offer during a affairs. Long, free parents may develop separate, general          Therefore urg        5257         0      5          5\n1                                                                                                                Local things follow male sums. Benefits might play in the children. Effective, inc  Empty, middle women         5249         0      9          9\n2                                                                                                                                Fine children would not comply in public along a patients. Good of   Conventional childr        5225         0      2          2\n3                                                                                                                                                                        Finally open expenses addr       Surprising emot        5264         0      8          8\n4                                                                                                                                                                    Keen, social years would make       Please central m        5260         0      2          2\n5                                                 A bit good children used to support upper, agricultural properties. Late, arab variations may draw magistrates; very newspapers kill here in a be  Local, mass universi        5255         0      3          3\n6                                                                                                   Happy, permanent men might bring environmental courses. Limited fingers require always still pa       Surprising emot        5268         0      1          1\n7                                                                              Subjects want swiftly fine, old days. Strange cars fall rich, local considerations. Too commercial officers provide   Local, mass universi        5238         0      7          7\n8                                                                                                                                                 Future years succeed here top needs. Gently likel           Rooms cook         5227         0      4          4\n9                                                                                                                                                                   Useless, new gardens read in a            Months woul        5269         0     15         15\n10                                                                                                Simply good conditions should work later women; impossible affairs shall require still together a      National, comple        5241         0      1          1\n11                                                                                                                                                 Councils use ago. Even fair minutes roam poor me         Therefore urg        5259         0      2          2\n12                                                                                                                             About dry members cannot match meanwhile; frequently new families ca           Rooms cook         5235         0      3          3\n13                                                                                                               Parts stay only most social countries. Nearly alone systems would run however vehi                              5262         0     11         11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 43.874243,
                    "execution_time": 43.672613,
                    "compile_time": 0.000651,
                    "planning_time": 0.165078
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 56.405464,
                    "execution_time": 44.130196,
                    "compile_time": 11.967457,
                    "planning_time": 0.267426
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > TS_OR_DS_ADD('DAY', 5, D_DATE, TIMESTAMP) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*                                                                                                                                                                                        i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                            Alone, legal eyes should not offer during a affairs. Long, free parents may develop separate, general          Therefore urg        5257         0      5          5\n1                                                                                                                Local things follow male sums. Benefits might play in the children. Effective, inc  Empty, middle women         5249         0      9          9\n2                                                                                                                                Fine children would not comply in public along a patients. Good of   Conventional childr        5225         0      2          2\n3                                                                                                                                                                        Finally open expenses addr       Surprising emot        5264         0      8          8\n4                                                                                                                                                                    Keen, social years would make       Please central m        5260         0      2          2\n5                                                 A bit good children used to support upper, agricultural properties. Late, arab variations may draw magistrates; very newspapers kill here in a be  Local, mass universi        5255         0      3          3\n6                                                                                                   Happy, permanent men might bring environmental courses. Limited fingers require always still pa       Surprising emot        5268         0      1          1\n7                                                                              Subjects want swiftly fine, old days. Strange cars fall rich, local considerations. Too commercial officers provide   Local, mass universi        5238         0      7          7\n8                                                                                                                                                 Future years succeed here top needs. Gently likel           Rooms cook         5227         0      4          4\n9                                                                                                                                                                   Useless, new gardens read in a            Months woul        5269         0     15         15\n10                                                                                                Simply good conditions should work later women; impossible affairs shall require still together a      National, comple        5241         0      1          1\n11                                                                                                                                                 Councils use ago. Even fair minutes roam poor me         Therefore urg        5259         0      2          2\n12                                                                                                                             About dry members cannot match meanwhile; frequently new families ca           Rooms cook         5235         0      3          3\n13                                                                                                               Parts stay only most social countries. Nearly alone systems would run however vehi                              5262         0     11         11\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk = inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk = p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC , \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST, \"I_ITEM_DESC\" NULLS LAST, \"W_WAREHOUSE_NAME\" NULLS LAST, \"D_WEEK_SEQ\" NULLS LAST",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC , \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST, \"I_ITEM_DESC\" NULLS LAST, \"W_WAREHOUSE_NAME\" NULLS LAST, \"D_WEEK_SEQ\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": null
    }
]