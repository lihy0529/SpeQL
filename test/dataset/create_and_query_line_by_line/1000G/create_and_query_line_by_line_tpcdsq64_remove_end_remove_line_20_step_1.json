[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.487474,
                    "execution_time": 14.349694,
                    "compile_time": 0.000377,
                    "planning_time": 0.048815,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 52.778077,
                    "execution_time": 47.87047,
                    "compile_time": 4.629983,
                    "planning_time": 0.194893,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\"",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\ncs1.store_zip = cs2.store_zip\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\"",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" , \"CS2\".\"CNT\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" , \"CS2\".\"CNT\" , \"CS1\".\"S1\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" , \"CS2\".\"CNT\" , \"CS1\".\"S1\" , \"CS2\".\"S1\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" , \"CS2\".\"CNT\" , \"CS1\".\"S1\" , \"CS2\".\"S1\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": null
    }
]