[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name, c_first_name, substring(s_city, 1, 30), ss_ticket_number, amt, profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n          ,customer.c_last_name\n          ,customer.c_first_name\n    from store_sales, date_dim, store, household_demographics, customer\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_customer_sk = customer.c_customer_sk\n    group by ss_ticket_number, ss_customer_sk, store.s_city, customer.c_last_name, customer.c_first_name\n   ) as derived_table\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_TABLE\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_TABLE\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH DERIVED_TABLE AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_TABLE\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_TABLE\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name        _col_2  ss_ticket_number       amt    profit\n0        Ellis      Michael       Oakdale         173096670     31.37  -8338.82\n1          Ely       Edward    Georgetown         126876969   3095.74  -2442.46\n2      Hayward      Kristal   Springfield         156001336    123.38 -10457.91\n3      Hawkins      Antonio        Shiloh          13082317   3841.11 -22630.31\n4        Smith        Vince   Cedar Grove         216520583    752.78 -11080.44\n5       Thomas        Julie  Walnut Grove         159113946      0.00 -11938.05\n6       Hunter        Jason     Greenwood          35566967   5824.56 -21622.64\n7        Smith        Peggy    Pine Grove          22312922     32.93 -11831.42\n8       Abbott         Alan         Union         112225707   1661.59  -7975.14\n9     Castillo                  Riverside          18980291    384.12  -7032.92\n10       Davis       Damion      Lakeview          16093375   3544.44  -9556.78\n11    Marshall        David   Springfield          26290653   5657.89 -14891.34\n12       Ellis       Nathan       Oakland          14241567    901.92  -8729.86\n13       Brock           Jo     Hillcrest          99022783    209.90  -5074.21\n14  Mccullough        Quyen     Fairfield          74746520   3165.89  -8031.90\n15    Santiago         Erik        Midway         195099395   2966.28 -12362.03\n16    Coronado        James         Salem         103943982     25.33  -4036.78\n17     Gregory        James  Walnut Grove          92010337   2692.33 -14441.71\n18     Prather      Barbara    Greenville          93643385  11468.06  -6280.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 52.38505,
                    "execution_time": 52.297324,
                    "compile_time": 0.000265,
                    "planning_time": 0.06841
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 58.332799,
                    "execution_time": 52.2214,
                    "compile_time": 5.946246,
                    "planning_time": 0.14036
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH DERIVED_TABLE AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_TABLE\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_TABLE\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\"",
                "rewrite": "WITH DERIVED_TABLE AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_TABLE\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_TABLE\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name        _col_2  ss_ticket_number       amt    profit\n0        Ellis      Michael       Oakdale         173096670     31.37  -8338.82\n1          Ely       Edward    Georgetown         126876969   3095.74  -2442.46\n2      Hayward      Kristal   Springfield         156001336    123.38 -10457.91\n3      Hawkins      Antonio        Shiloh          13082317   3841.11 -22630.31\n4        Smith        Vince   Cedar Grove         216520583    752.78 -11080.44\n5       Thomas        Julie  Walnut Grove         159113946      0.00 -11938.05\n6       Hunter        Jason     Greenwood          35566967   5824.56 -21622.64\n7        Smith        Peggy    Pine Grove          22312922     32.93 -11831.42\n8       Abbott         Alan         Union         112225707   1661.59  -7975.14\n9     Castillo                  Riverside          18980291    384.12  -7032.92\n10       Davis       Damion      Lakeview          16093375   3544.44  -9556.78\n11    Marshall        David   Springfield          26290653   5657.89 -14891.34\n12       Ellis       Nathan       Oakland          14241567    901.92  -8729.86\n13       Brock           Jo     Hillcrest          99022783    209.90  -5074.21\n14  Mccullough        Quyen     Fairfield          74746520   3165.89  -8031.90\n15    Santiago         Erik        Midway         195099395   2966.28 -12362.03\n16    Coronado        James         Salem         103943982     25.33  -4036.78\n17     Gregory        James  Walnut Grove          92010337   2692.33 -14441.71\n18     Prather      Barbara    Greenville          93643385  11468.06  -6280.79\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city\n   ) as derived_table",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 47.025196,
                    "execution_time": 46.537878,
                    "compile_time": 0.000401,
                    "planning_time": 0.052567,
                    "create_size": 5888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 51.905056,
                    "execution_time": 46.301802,
                    "compile_time": 5.029602,
                    "planning_time": 0.132886,
                    "create_size": 5888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*         _col_0  ss_ticket_number      amt    profit\n0     Hillcrest          25699504   104.82  -4531.45\n1      Glendale          36507717  2437.84  -9662.10\n2      Glenwood          27768673  9690.94  -9967.77\n3        Shiloh          94359380  3791.05 -15286.03\n4      New Hope         239977338     0.00  -8583.61\n5       Liberty          13831377  2103.18  -9321.78\n6    Georgetown          94538876   993.17 -13075.71\n7       Concord         153881282  2028.90 -15582.92\n8    Friendship         171624463   922.99  -9855.00\n9     Hillcrest          74210039   444.15 -11429.44\n10   Pine Grove          66593350  2874.35 -10570.06\n11  Cedar Grove          55871685     0.00  -4254.30\n12   Greenville          92455866   235.17  -6249.88\n13    Riverside         114150204  5621.60 -20298.19\n14      Concord           4108153  3834.73 -10059.21\n15       Midway          27512401  3516.83  -8785.59\n16   Georgetown          22993140  1526.52  -6382.46\n17       Shiloh          23184299   272.86  -2890.58\n18   Greenville          57941424   469.55  -5016.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018751,
                    "execution_time": 0.008416,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003973
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057667,
                    "execution_time": 0.008464,
                    "compile_time": 0.001002,
                    "planning_time": 0.039418
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*         _col_0  ss_ticket_number      amt    profit\n0     Hillcrest          25699504   104.82  -4531.45\n1      Glendale          36507717  2437.84  -9662.10\n2      Glenwood          27768673  9690.94  -9967.77\n3        Shiloh          94359380  3791.05 -15286.03\n4      New Hope         239977338     0.00  -8583.61\n5       Liberty          13831377  2103.18  -9321.78\n6    Georgetown          94538876   993.17 -13075.71\n7       Concord         153881282  2028.90 -15582.92\n8    Friendship         171624463   922.99  -9855.00\n9     Hillcrest          74210039   444.15 -11429.44\n10   Pine Grove          66593350  2874.35 -10570.06\n11  Cedar Grove          55871685     0.00  -4254.30\n12   Greenville          92455866   235.17  -6249.88\n13    Riverside         114150204  5621.60 -20298.19\n14      Concord           4108153  3834.73 -10059.21\n15       Midway          27512401  3516.83  -8785.59\n16   Georgetown          22993140  1526.52  -6382.46\n17       Shiloh          23184299   272.86  -2890.58\n18   Greenville          57941424   469.55  -5016.33\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city\n   ) as derived_table",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 42.933867,
                    "execution_time": 42.450193,
                    "compile_time": 0.000416,
                    "planning_time": 0.051797,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 48.956474,
                    "execution_time": 43.715234,
                    "compile_time": 4.624477,
                    "planning_time": 0.180072,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*             _col_0  ss_ticket_number      amt    profit\n0            Midway         206828214  3210.50  -8952.22\n1          Lakewood         183745692   419.60  -5935.14\n2             Union          63741066   311.11  -1689.49\n3         Riverview         206383086   681.90 -10921.34\n4         Hillcrest         131283653  4902.27 -20799.12\n5            Midway          11203084  2667.28 -11579.20\n6           Harmony          41436432  3350.99  -6072.20\n7   Pleasant Valley          26819837     0.00  -6560.81\n8          Woodlawn         108707167     0.00  -8655.16\n9          Lakewood         176263008  1510.00  -9695.87\n10      Five Points         206869065  2297.67  -7583.64\n11          Harmony         191363668   139.14  -8810.52\n12      Spring Hill         169193805     0.00  -3483.84\n13         Glenwood         109134144  1534.04 -12404.71\n14        Greenwood         176273846  2677.01  -6207.56\n15           Shiloh          79148709  1672.65  -3394.68\n16       Providence         221272098  4482.82    306.45\n17       Providence         221272098     0.00       NaN\n18    Pleasant Hill         124411972   535.18 -18353.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018519,
                    "execution_time": 0.00816,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003979
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056226,
                    "execution_time": 0.007776,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039436
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*             _col_0  ss_ticket_number      amt    profit\n0            Midway         206828214  3210.50  -8952.22\n1          Lakewood         183745692   419.60  -5935.14\n2             Union          63741066   311.11  -1689.49\n3         Riverview         206383086   681.90 -10921.34\n4         Hillcrest         131283653  4902.27 -20799.12\n5            Midway          11203084  2667.28 -11579.20\n6           Harmony          41436432  3350.99  -6072.20\n7   Pleasant Valley          26819837     0.00  -6560.81\n8          Woodlawn         108707167     0.00  -8655.16\n9          Lakewood         176263008  1510.00  -9695.87\n10      Five Points         206869065  2297.67  -7583.64\n11          Harmony         191363668   139.14  -8810.52\n12      Spring Hill         169193805     0.00  -3483.84\n13         Glenwood         109134144  1534.04 -12404.71\n14        Greenwood         176273846  2677.01  -6207.56\n15           Shiloh          79148709  1672.65  -3394.68\n16       Providence         221272098  4482.82    306.45\n17       Providence         221272098     0.00       NaN\n18    Pleasant Hill         124411972   535.18 -18353.12\n...*/"
    },
    {
        "input": "select /* TPC-DS query79.tpl 0.89 */ \n  c_last_name, c_first_name, substring(s_city,1,30), ss_ticket_number, amt, profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n          ,customer.c_last_name\n          ,customer.c_first_name\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    join customer on store_sales.ss_customer_sk = customer.c_customer_sk\n    where (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999, 1999+1, 1999+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city, customer.c_last_name, customer.c_first_name\n   ) derived_alias",
        "optimize": [
            "WITH \"DERIVED_ALIAS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_ALIAS\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_ALIAS\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_ALIAS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_ALIAS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_ALIAS\".\"AMT\" AS \"AMT\" , \"DERIVED_ALIAS\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_ALIAS\" AS \"DERIVED_ALIAS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 25.130671,
                    "execution_time": 24.429591,
                    "compile_time": 0.000612,
                    "planning_time": 0.061469,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.325594,
                    "execution_time": 23.212348,
                    "compile_time": 5.301954,
                    "planning_time": 0.141401,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name           _col_2  ss_ticket_number      amt    profit\n0    Fernandez        Dixie          Oakland         202494856   151.03  -9621.57\n1      Headley      Michael       Friendship          74841227  1327.85  -9335.88\n2                   Kenneth       Providence         113128646     0.00 -10745.44\n3        Lewis       Robert         Wildwood          74897442  3543.46  -8142.28\n4        Scott        Ervin         Fairview         217427599   674.65  -6181.01\n5       Patton       Joseph            Salem         165623090   237.35  -4203.96\n6          Lee      Douglas        Greenwood          74902915  2197.02 -22728.45\n7      Cordell         Dana         Hopewell         224787721     8.57  -5748.36\n8       Parker        Janis          Harmony         158135786   434.75  -6185.16\n9     Everhart      Gregory    Highland Park         217446287   703.93 -15032.20\n10        Mock      Pauline           Midway         172317505  1642.60  -3824.60\n11     Perkins         Ruth      Centerville         172319625   455.31 -11271.51\n12      Torres        Ralph         Franklin         218144517   389.88  -6299.92\n13    Phillips       Manuel          Concord         224803597  6478.05  -7769.12\n14      Snyder       Ronald   Pleasant Grove         172338760  2011.86  -6498.87\n15        Lyle       Justin        Hillcrest         120681865  2194.50 -28939.73\n16        Vela        Brain  Pleasant Valley         224826489  3701.78 -14144.66\n17     Feldman      William       Georgetown         173172293  1817.69 -16155.48\n18       Murry     Dominica       Providence          98543470   331.83  -1783.35\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018297,
                    "execution_time": 0.00733,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004322
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057646,
                    "execution_time": 0.007604,
                    "compile_time": 0.001161,
                    "planning_time": 0.039808
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name           _col_2  ss_ticket_number      amt    profit\n0    Fernandez        Dixie          Oakland         202494856   151.03  -9621.57\n1      Headley      Michael       Friendship          74841227  1327.85  -9335.88\n2                   Kenneth       Providence         113128646     0.00 -10745.44\n3        Lewis       Robert         Wildwood          74897442  3543.46  -8142.28\n4        Scott        Ervin         Fairview         217427599   674.65  -6181.01\n5       Patton       Joseph            Salem         165623090   237.35  -4203.96\n6          Lee      Douglas        Greenwood          74902915  2197.02 -22728.45\n7      Cordell         Dana         Hopewell         224787721     8.57  -5748.36\n8       Parker        Janis          Harmony         158135786   434.75  -6185.16\n9     Everhart      Gregory    Highland Park         217446287   703.93 -15032.20\n10        Mock      Pauline           Midway         172317505  1642.60  -3824.60\n11     Perkins         Ruth      Centerville         172319625   455.31 -11271.51\n12      Torres        Ralph         Franklin         218144517   389.88  -6299.92\n13    Phillips       Manuel          Concord         224803597  6478.05  -7769.12\n14      Snyder       Ronald   Pleasant Grove         172338760  2011.86  -6498.87\n15        Lyle       Justin        Hillcrest         120681865  2194.50 -28939.73\n16        Vela        Brain  Pleasant Valley         224826489  3701.78 -14144.66\n17     Feldman      William       Georgetown         173172293  1817.69 -16155.48\n18       Murry     Dominica       Providence          98543470   331.83  -1783.35\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    where (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number, ss_customer_sk, store.s_city /* Ensure non-aggregated columns are included here */\n/*CURSOR_IDENTIFIER*/) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n;",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SALES_SUMMARY\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"AMT\" AS \"AMT\" , \"SALES_SUMMARY\".\"PROFIT\" AS \"PROFIT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.334022,
                    "execution_time": 23.798114,
                    "compile_time": 0.000548,
                    "planning_time": 0.052918,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.4254,
                    "execution_time": 24.193777,
                    "compile_time": 4.606748,
                    "planning_time": 0.140538,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.980668,
                    "execution_time": 1.325019,
                    "compile_time": 0.000464,
                    "planning_time": 0.025363,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.649384,
                    "execution_time": 1.280243,
                    "compile_time": 2.634249,
                    "planning_time": 0.08691,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name          _col_2  ss_ticket_number      amt    profit\n0         Hill         Jane       Oak Grove          56866287   390.84 -13184.02\n1        Leary      Kathryn          Shiloh          34376712   751.07 -11776.65\n2        Martz       Thomas       Fairfield           4388559     0.00  -6034.13\n3                  Clifford       Hillcrest          64429599   555.66  -7482.70\n4       Carden       Brenda        Lakeside         206980834  1301.24  -9265.13\n5     Morrison      Kenneth        Lakeview         228017197  5581.30 -13721.96\n6       Nelson       Angelo        Oak Hill          64901192  4525.87 -13797.47\n7         Long    Christina     Cedar Grove           4336888   409.44  -9816.98\n8         Hall     Margaret           Union         124555681  1648.83 -11602.10\n9       Devine       Estela       Sunnyside         222397937  3352.12 -14404.76\n10       Smith      Marilyn     Springfield         146160197  8377.91 -10309.65\n11    Paterson      Dorothy         Harmony          25797908  1582.86  -9501.84\n12        Hurd      Richard  Mount Pleasant         206322049   107.82  -5908.48\n13      Haddad      Patrick        Franklin         185000513   514.76  -1247.31\n14                   Dennis       Fairfield         235750426  1751.67 -12496.79\n15        Cote       Trisha         Oakdale         183145837  2069.69  -9520.40\n16       Betts       Brandy        Lakeview         162877174  2355.45  -8173.33\n17        Vick      Matthew          Midway         206327621    53.49 -19885.35\n18       Trejo      Michael         Oakland         201684923  4446.36  -9019.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018588,
                    "execution_time": 0.008249,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003935
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056469,
                    "execution_time": 0.008322,
                    "compile_time": 0.001191,
                    "planning_time": 0.039002
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name          _col_2  ss_ticket_number      amt    profit\n0         Hill         Jane       Oak Grove          56866287   390.84 -13184.02\n1        Leary      Kathryn          Shiloh          34376712   751.07 -11776.65\n2        Martz       Thomas       Fairfield           4388559     0.00  -6034.13\n3                  Clifford       Hillcrest          64429599   555.66  -7482.70\n4       Carden       Brenda        Lakeside         206980834  1301.24  -9265.13\n5     Morrison      Kenneth        Lakeview         228017197  5581.30 -13721.96\n6       Nelson       Angelo        Oak Hill          64901192  4525.87 -13797.47\n7         Long    Christina     Cedar Grove           4336888   409.44  -9816.98\n8         Hall     Margaret           Union         124555681  1648.83 -11602.10\n9       Devine       Estela       Sunnyside         222397937  3352.12 -14404.76\n10       Smith      Marilyn     Springfield         146160197  8377.91 -10309.65\n11    Paterson      Dorothy         Harmony          25797908  1582.86  -9501.84\n12        Hurd      Richard  Mount Pleasant         206322049   107.82  -5908.48\n13      Haddad      Patrick        Franklin         185000513   514.76  -1247.31\n14                   Dennis       Fairfield         235750426  1751.67 -12496.79\n15        Cote       Trisha         Oakdale         183145837  2069.69  -9520.40\n16       Betts       Brandy        Lakeview         162877174  2355.45  -8173.33\n17        Vick      Matthew          Midway         206327621    53.49 -19885.35\n18       Trejo      Michael         Oakland         201684923  4446.36  -9019.72\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 27.920191,
                    "execution_time": 27.433095,
                    "compile_time": 0.000407,
                    "planning_time": 0.053527,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 33.053194,
                    "execution_time": 28.053334,
                    "compile_time": 4.443506,
                    "planning_time": 0.130013,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_6\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_6\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name        _col_2  ss_ticket_number      amt    profit\n0        Grant        Trena   Spring Hill         223335722   953.16  -5957.60\n1        Grant        Trena        Midway         193276823     0.00  -2801.94\n2        Grant        Trena       Oakdale          81061795   714.70 -20109.62\n3        Grant        Trena      Lakeview          13056379     0.00  -5996.36\n4        Grant        Trena    Friendship          21277405     0.00  -7089.07\n5        Grant        Trena        Bethel          13065063   169.26  -9036.48\n6        Grant        Trena      Hopewell         230740797  5689.27 -10207.12\n7        Grant        Trena      Hopewell          81098204  1676.91 -18593.82\n8        Grant        Trena   Spring Hill          35730587  5873.15 -18143.63\n9        Grant        Trena       Antioch          80607642     0.00    890.02\n10       Grant        Trena   Buena Vista         238612873   984.93 -10779.03\n11       Grant        Trena   Buena Vista         238612873      NaN   -260.20\n12       Grant        Trena     Hillcrest         238250641  2146.98 -17560.44\n13       Grant        Trena     Riverside          36269546  2548.57  -8999.72\n14       Grant        Trena       Oakdale         163638291  2179.71  -9940.44\n15       Grant        Trena     Oak Grove          59262610  1120.24  -2686.32\n16       Grant        Trena     Oak Grove          59262610     0.00       NaN\n17       Grant        Trena  Walnut Grove         127798077  1633.50 -10416.22\n18       Grant        Trena     Greenwood          59265817  2491.64 -14525.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.653675,
                    "execution_time": 0.621714,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.023862
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.684223,
                    "execution_time": 0.595975,
                    "compile_time": 0.218537,
                    "planning_time": 0.07835
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_6\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_6\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name        _col_2  ss_ticket_number      amt    profit\n0        Grant        Trena   Spring Hill         223335722   953.16  -5957.60\n1        Grant        Trena        Midway         193276823     0.00  -2801.94\n2        Grant        Trena       Oakdale          81061795   714.70 -20109.62\n3        Grant        Trena      Lakeview          13056379     0.00  -5996.36\n4        Grant        Trena    Friendship          21277405     0.00  -7089.07\n5        Grant        Trena        Bethel          13065063   169.26  -9036.48\n6        Grant        Trena      Hopewell         230740797  5689.27 -10207.12\n7        Grant        Trena      Hopewell          81098204  1676.91 -18593.82\n8        Grant        Trena   Spring Hill          35730587  5873.15 -18143.63\n9        Grant        Trena       Antioch          80607642     0.00    890.02\n10       Grant        Trena   Buena Vista         238612873   984.93 -10779.03\n11       Grant        Trena   Buena Vista         238612873      NaN   -260.20\n12       Grant        Trena     Hillcrest         238250641  2146.98 -17560.44\n13       Grant        Trena     Riverside          36269546  2548.57  -8999.72\n14       Grant        Trena       Oakdale         163638291  2179.71  -9940.44\n15       Grant        Trena     Oak Grove          59262610  1120.24  -2686.32\n16       Grant        Trena     Oak Grove          59262610     0.00       NaN\n17       Grant        Trena  Walnut Grove         127798077  1633.50 -10416.22\n18       Grant        Trena     Greenwood          59265817  2491.64 -14525.43\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 28.049386,
                    "execution_time": 27.520447,
                    "compile_time": 0.00053,
                    "planning_time": 0.053817,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 32.536983,
                    "execution_time": 27.550629,
                    "compile_time": 4.364641,
                    "planning_time": 0.139177,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.97074,
                    "execution_time": 1.332742,
                    "compile_time": 0.000453,
                    "planning_time": 0.024835,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.01247,
                    "execution_time": 1.317641,
                    "compile_time": 0.000454,
                    "planning_time": 0.086384,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number       amt    profit\n0       Butler      Jessica    Cedar Grove          72729644      3.16  -9822.03\n1      Sanchez        Edith         Shiloh          95261596   6105.35 -18566.94\n2      Kennedy      Deborah     Georgetown         215140066    810.57  -5584.39\n3       Holmes      Michael       Glenwood            621633   6409.95  -9538.34\n4      Herrera      William    Springfield          65157126   1704.29 -20037.50\n5       Cooney        David          Salem         165709838   3181.40   -107.61\n6    Covington      Krystal    Shady Grove          67789200   6277.42 -11117.29\n7       Valdez       Shauna     Pine Grove          21262142   2016.36    -83.32\n8        Black       Joanne      Riverside          58350378   2087.49 -11581.87\n9        Sharp       Michel       Wildwood         201138139      0.00  -8694.54\n10       Cross       Daniel    Five Points          89891451  12466.61 -13455.87\n11       Jones        Enoch         Shiloh          82394003   5311.81 -20036.50\n12     Padilla        Jason       Oak Hill          11507657   3252.60  -9686.27\n13      Turner       Carson     Friendship          60730467    712.45 -11225.74\n14       Salas                     Concord         224954176   3547.22 -13778.37\n15     Bassett      Enrique     Stringtown         118346941     37.58  -8348.14\n16       James        David       Lakewood         100674844    156.50  -4842.61\n17       Towle      Leonard  Spring Valley          65877556    359.00 -14768.03\n18     Elliott        Ralph       Woodlawn         232969203      0.00  -8987.99\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017578,
                    "execution_time": 0.007458,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003907
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055757,
                    "execution_time": 0.007904,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039157
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number       amt    profit\n0       Butler      Jessica    Cedar Grove          72729644      3.16  -9822.03\n1      Sanchez        Edith         Shiloh          95261596   6105.35 -18566.94\n2      Kennedy      Deborah     Georgetown         215140066    810.57  -5584.39\n3       Holmes      Michael       Glenwood            621633   6409.95  -9538.34\n4      Herrera      William    Springfield          65157126   1704.29 -20037.50\n5       Cooney        David          Salem         165709838   3181.40   -107.61\n6    Covington      Krystal    Shady Grove          67789200   6277.42 -11117.29\n7       Valdez       Shauna     Pine Grove          21262142   2016.36    -83.32\n8        Black       Joanne      Riverside          58350378   2087.49 -11581.87\n9        Sharp       Michel       Wildwood         201138139      0.00  -8694.54\n10       Cross       Daniel    Five Points          89891451  12466.61 -13455.87\n11       Jones        Enoch         Shiloh          82394003   5311.81 -20036.50\n12     Padilla        Jason       Oak Hill          11507657   3252.60  -9686.27\n13      Turner       Carson     Friendship          60730467    712.45 -11225.74\n14       Salas                     Concord         224954176   3547.22 -13778.37\n15     Bassett      Enrique     Stringtown         118346941     37.58  -8348.14\n16       James        David       Lakewood         100674844    156.50  -4842.61\n17       Towle      Leonard  Spring Valley          65877556    359.00 -14768.03\n18     Elliott        Ralph       Woodlawn         232969203      0.00  -8987.99\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" FROM 1 FOR 30 ) , \"PROFIT\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number       amt    profit\n0                                           39663291   7068.02 -28591.02\n1                                          136605989   4731.18 -28508.03\n2                                           25385243   1929.07 -27588.45\n3                                          114394124   2608.14 -25578.21\n4                                          177736898   3253.67 -24706.84\n5                                          121868125   3830.21 -24571.51\n6                                          186062232   8494.63 -23432.76\n7                                          167117853   4418.60 -22753.57\n8                                          205293111   6269.98 -21322.39\n9                                           53721879     72.23 -21224.00\n10                                         166878408    759.18 -21074.39\n11                                          12937931   2798.27 -21012.09\n12                                          59804875      0.00 -20487.05\n13                                         234538097   8463.48 -20419.21\n14                                         154382989   1165.27 -20109.83\n15                                          27500198  10296.67 -20108.97\n16                                          75661575   6601.32 -19675.99\n17                                          76427194   3828.34 -19566.76\n18                                          99332371   6913.29 -19392.19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.700314,
                    "execution_time": 0.664469,
                    "compile_time": 0.000148,
                    "planning_time": 0.02572
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.537965,
                    "execution_time": 0.719932,
                    "compile_time": 3.724507,
                    "planning_time": 0.080452
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number       amt    profit\n0                                           39663291   7068.02 -28591.02\n1                                          136605989   4731.18 -28508.03\n2                                           25385243   1929.07 -27588.45\n3                                          114394124   2608.14 -25578.21\n4                                          177736898   3253.67 -24706.84\n5                                          121868125   3830.21 -24571.51\n6                                          186062232   8494.63 -23432.76\n7                                          167117853   4418.60 -22753.57\n8                                          205293111   6269.98 -21322.39\n9                                           53721879     72.23 -21224.00\n10                                         166878408    759.18 -21074.39\n11                                          12937931   2798.27 -21012.09\n12                                          59804875      0.00 -20487.05\n13                                         234538097   8463.48 -20419.21\n14                                         154382989   1165.27 -20109.83\n15                                          27500198  10296.67 -20108.97\n16                                          75661575   6601.32 -19675.99\n17                                          76427194   3828.34 -19566.76\n18                                          99332371   6913.29 -19392.19\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" FROM 1 FOR 30 ) , \"PROFIT\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number       amt    profit\n0                                           39663291   7068.02 -28591.02\n1                                          136605989   4731.18 -28508.03\n2                                           25385243   1929.07 -27588.45\n3                                          114394124   2608.14 -25578.21\n4                                          177736898   3253.67 -24706.84\n5                                          121868125   3830.21 -24571.51\n6                                          186062232   8494.63 -23432.76\n7                                          167117853   4418.60 -22753.57\n8                                          205293111   6269.98 -21322.39\n9                                           53721879     72.23 -21224.00\n10                                         166878408    759.18 -21074.39\n11                                          12937931   2798.27 -21012.09\n12                                          59804875      0.00 -20487.05\n13                                         234538097   8463.48 -20419.21\n14                                         154382989   1165.27 -20109.83\n15                                          27500198  10296.67 -20108.97\n16                                          75661575   6601.32 -19675.99\n17                                          76427194   3828.34 -19566.76\n18                                          99332371   6913.29 -19392.19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.711369,
                    "execution_time": 0.675881,
                    "compile_time": 0.000159,
                    "planning_time": 0.025119
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.696976,
                    "execution_time": 0.656472,
                    "compile_time": 0.000157,
                    "planning_time": 0.030251
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number       amt    profit\n0                                           39663291   7068.02 -28591.02\n1                                          136605989   4731.18 -28508.03\n2                                           25385243   1929.07 -27588.45\n3                                          114394124   2608.14 -25578.21\n4                                          177736898   3253.67 -24706.84\n5                                          121868125   3830.21 -24571.51\n6                                          186062232   8494.63 -23432.76\n7                                          167117853   4418.60 -22753.57\n8                                          205293111   6269.98 -21322.39\n9                                           53721879     72.23 -21224.00\n10                                         166878408    759.18 -21074.39\n11                                          12937931   2798.27 -21012.09\n12                                          59804875      0.00 -20487.05\n13                                         234538097   8463.48 -20419.21\n14                                         154382989   1165.27 -20109.83\n15                                          27500198  10296.67 -20108.97\n16                                          75661575   6601.32 -19675.99\n17                                          76427194   3828.34 -19566.76\n18                                          99332371   6913.29 -19392.19\n...*/"
    }
]