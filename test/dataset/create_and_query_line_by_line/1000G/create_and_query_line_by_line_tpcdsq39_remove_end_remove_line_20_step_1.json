[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select null as w_warehouse_name, inv_warehouse_sk, inv_item_sk, null as d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from (select inv_warehouse_sk, inv_item_sk, null as d_moy\n             ,stddev_samp(INV_QUANTITY_ON_HAND) stdev, avg(INV_QUANTITY_ON_HAND) mean\n       from inventory\n       group by inv_warehouse_sk, inv_item_sk\n      ) subquery\n)\nselect * from inv\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" ) SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SUBQUERY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SUBQUERY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SUBQUERY\".\"STDEV\" AS \"STDEV\" , \"SUBQUERY\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SUBQUERY\".\"MEAN\" = 0 THEN NULL ELSE \"SUBQUERY\".\"STDEV\" / \"SUBQUERY\".\"MEAN\" END AS \"COV\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.42306,
                    "execution_time": 4.190349,
                    "compile_time": 0.000338,
                    "planning_time": 0.022903,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.806411,
                    "execution_time": 4.387461,
                    "compile_time": 3.120959,
                    "planning_time": 0.082747,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   w_warehouse_name  inv_warehouse_sk  inv_item_sk d_moy       stdev  mean       cov\n0              None                15       176861  None  304.575477   490  0.621583\n1              None                15       176899  None  288.797540   476  0.606718\n2              None                15       176903  None  294.489414   468  0.629251\n3              None                15       176924  None  300.678733   507  0.593055\n4              None                15       176960  None  281.920550   493  0.571847\n5              None                15       176963  None  287.477904   530  0.542411\n6              None                15       176981  None  283.008732   562  0.503574\n7              None                15       176996  None  274.000128   523  0.523901\n8              None                15       183203  None  300.879050   490  0.614039\n9              None                15       183217  None  284.673557   520  0.547449\n10             None                15       183227  None  300.937833   452  0.665792\n11             None                15       183230  None  273.017098   530  0.515127\n12             None                15       183253  None  290.135346   503  0.576810\n13             None                15       183293  None  282.928679   464  0.609760\n14             None                15       183341  None  281.551544   431  0.653252\n15             None                15       183374  None  279.691371   488  0.573138\n16             None                15       183377  None  300.847042   497  0.605326\n17             None                15       189605  None  303.880770   530  0.573360\n18             None                15       189607  None  284.770041   480  0.593271\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019046,
                    "execution_time": 0.00769,
                    "compile_time": 5e-05,
                    "planning_time": 0.004586
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.278528,
                    "execution_time": 0.00793,
                    "compile_time": 0.221006,
                    "planning_time": 0.040904
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   w_warehouse_name  inv_warehouse_sk  inv_item_sk d_moy       stdev  mean       cov\n0              None                15       176861  None  304.575477   490  0.621583\n1              None                15       176899  None  288.797540   476  0.606718\n2              None                15       176903  None  294.489414   468  0.629251\n3              None                15       176924  None  300.678733   507  0.593055\n4              None                15       176960  None  281.920550   493  0.571847\n5              None                15       176963  None  287.477904   530  0.542411\n6              None                15       176981  None  283.008732   562  0.503574\n7              None                15       176996  None  274.000128   523  0.523901\n8              None                15       183203  None  300.879050   490  0.614039\n9              None                15       183217  None  284.673557   520  0.547449\n10             None                15       183227  None  300.937833   452  0.665792\n11             None                15       183230  None  273.017098   530  0.515127\n12             None                15       183253  None  290.135346   503  0.576810\n13             None                15       183293  None  282.928679   464  0.609760\n14             None                15       183341  None  281.551544   431  0.653252\n15             None                15       183374  None  279.691371   488  0.573138\n16             None                15       183377  None  300.847042   497  0.605326\n17             None                15       189605  None  303.880770   530  0.573360\n18             None                15       189607  None  284.770041   480  0.593271\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select inv_warehouse_sk, inv_item_sk\n       ,stddev_samp(INV_QUANTITY_ON_HAND) as stdev, avg(INV_QUANTITY_ON_HAND) as mean, case avg(INV_QUANTITY_ON_HAND) when 0 then null else stddev_samp(INV_QUANTITY_ON_HAND)/avg(INV_QUANTITY_ON_HAND) end as cov\n from inventory\n where inv_date_sk IS NOT NULL -- Assuming we filter out rows without a date\n group by inv_warehouse_sk, inv_item_sk)\nselect *\nfrom inv\nwhere case mean when 0 then 0 else stdev/mean end > 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"INV\" AS ( SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" , CASE WHEN AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) = 0 THEN NULL ELSE STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) / AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) END AS \"COV\" FROM \"INVENTORY\" AS \"INVENTORY\" WHERE NOT \"INVENTORY\".\"INV_DATE_SK\" IS NULL GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" ) SELECT \"INV\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INV\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"INV\".\"STDEV\" AS \"STDEV\" , \"INV\".\"MEAN\" AS \"MEAN\" , \"INV\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV\" WHERE CASE WHEN \"INV\".\"MEAN\" = 0 THEN 0 ELSE \"INV\".\"STDEV\" / \"INV\".\"MEAN\" END > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" , CASE WHEN AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) = 0 THEN NULL ELSE STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) / AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) END AS \"COV\" FROM \"INVENTORY\" AS \"INVENTORY\" WHERE NOT \"INVENTORY\".\"INV_DATE_SK\" IS NULL GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.390742,
                    "execution_time": 8.094367,
                    "compile_time": 0.000466,
                    "planning_time": 0.022676,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.432569,
                    "execution_time": 8.956456,
                    "compile_time": 0.000489,
                    "planning_time": 0.083107,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" END > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.068579,
                    "execution_time": 0.039264,
                    "compile_time": 0.000223,
                    "planning_time": 0.005263,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.271154,
                    "execution_time": 0.041833,
                    "compile_time": 0.139874,
                    "planning_time": 0.06272,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_3\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_3\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [inv_warehouse_sk, inv_item_sk, stdev, mean, cov]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018217,
                    "execution_time": 0.007086,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004883
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055869,
                    "execution_time": 0.008141,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.040353
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" END > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_3\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_3\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [inv_warehouse_sk, inv_item_sk, stdev, mean, cov]\nIndex: []*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv.w_warehouse_sk,inv.i_item_sk,inv.d_moy,inv.mean, inv.cov from inv \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.772103,
                    "execution_time": 5.466236,
                    "compile_time": 0.000614,
                    "planning_time": 0.044218,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.629199,
                    "execution_time": 5.722925,
                    "compile_time": 3.520492,
                    "planning_time": 0.122188,
                    "create_size": 1920
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.684714,
                    "execution_time": 0.427483,
                    "compile_time": 0.00039,
                    "planning_time": 0.005792,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.803038,
                    "execution_time": 0.485793,
                    "compile_time": 0.000399,
                    "planning_time": 0.06311,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_5\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                7     294709      1   349  1.016480\n1                8       1153      1   215  1.202107\n2                8       7681      1   299  1.441082\n3                8      20309      1   347  1.032891\n4                8      26893      1   346  1.023385\n5                8      33253      1   437  1.065785\n6                4     221741      1   219  1.473351\n7                4     234591      1   224  1.066571\n8               11     137935      1   385  1.013236\n9               16     129013      1   314  1.079232\n10              16     129019      1   272  1.128609\n11              16     135381      1   160  1.026720\n12              16     135385      1   383  1.127432\n13              16     141787      1   283  1.279108\n14              16     148191      1   359  1.053258\n15              16     154557      1   236  1.284548\n16              12      87155      1   391  1.083991\n17              12      93557      1   413  1.066374\n18               7     131621      1   405  1.046757\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018045,
                    "execution_time": 0.00775,
                    "compile_time": 5e-05,
                    "planning_time": 0.003885
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055991,
                    "execution_time": 0.00831,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039469
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_5\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                7     294709      1   349  1.016480\n1                8       1153      1   215  1.202107\n2                8       7681      1   299  1.441082\n3                8      20309      1   347  1.032891\n4                8      26893      1   346  1.023385\n5                8      33253      1   437  1.065785\n6                4     221741      1   219  1.473351\n7                4     234591      1   224  1.066571\n8               11     137935      1   385  1.013236\n9               16     129013      1   314  1.079232\n10              16     129019      1   272  1.128609\n11              16     135381      1   160  1.026720\n12              16     135385      1   383  1.127432\n13              16     141787      1   283  1.279108\n14              16     148191      1   359  1.053258\n15              16     154557      1   236  1.284548\n16              12      87155      1   391  1.083991\n17              12      93557      1   413  1.066374\n18               7     131621      1   405  1.046757\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy\n       ,stdev, mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy\n            ,stddev_samp(INV_QUANTITY_ON_HAND) stdev, avg(INV_QUANTITY_ON_HAND) mean\n      from inventory \n      join warehouse on inv_warehouse_sk = w_warehouse_sk\n      join item on inv_item_sk = i_item_sk\n      join date_dim on inv_date_sk = d_date_sk\n      where d_year = 2001\n      group by w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov\n      ,inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov\nfrom inv inv1, inv inv2\nwhere inv1.w_warehouse_sk = inv2.w_warehouse_sk\n  and inv1.i_item_sk = inv2.i_item_sk\n  and inv1.d_moy < inv2.d_moy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"D_MOY\" < \"INV2\".\"D_MOY\" AND \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"D_MOY\" < \"INV2\".\"D_MOY\" AND \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.308753,
                    "execution_time": 0.762726,
                    "compile_time": 0.063433,
                    "planning_time": 0.006662,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.18952,
                    "execution_time": 0.825914,
                    "compile_time": 6.813742,
                    "planning_time": 0.064137,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               11     154059      1   298  1.014606                    11           154059            6         165   1.098474\n1                3      57263      4   248  1.030303                     3            57263            6         365   1.123842\n2                3      57263      4   248  1.030303                     3            57263            9         261   1.406753\n3                2     139375      5   322  1.225680                     2           139375            6         172   1.287274\n4                2     139375      5   322  1.225680                     2           139375           11         369   1.072419\n5               15      85879      1   382  1.044142                    15            85879            4         253   1.136857\n6                2      22311      4   379  1.101161                     2            22311           12         335   1.081863\n7                8     250423      4   430  1.030997                     8           250423            8         331   1.058761\n8               18     281627      4   164  1.093969                    18           281627           12         118   1.389787\n9               15      10513      4   401  1.003691                    15            10513           12         424   1.143745\n10              10       4131      2   139  1.618503                    10             4131           10         208   1.368822\n11              10       4131      2   139  1.618503                    10             4131            7         404   1.160432\n12               7      64269      9   260  1.077547                     7            64269           10         261   1.388470\n13              20     101207      9   359  1.148113                    20           101207           12         153   1.129205\n14              14     141127      2   327  1.289791                    14           141127            9         367   1.090988\n15               7     237715      2   358  1.105142                     7           237715           10         311   1.285408\n16               4     173213      5   336  1.223887                     4           173213           10         338   1.134659\n17              11     136537      8   211  1.726841                    11           136537           11         389   1.129621\n18               3     179129      8   281  1.418793                     3           179129           12         409   1.013394\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019702,
                    "execution_time": 0.008462,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004571
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057604,
                    "execution_time": 0.008545,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040355
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"D_MOY\" < \"INV2\".\"D_MOY\" AND \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               11     154059      1   298  1.014606                    11           154059            6         165   1.098474\n1                3      57263      4   248  1.030303                     3            57263            6         365   1.123842\n2                3      57263      4   248  1.030303                     3            57263            9         261   1.406753\n3                2     139375      5   322  1.225680                     2           139375            6         172   1.287274\n4                2     139375      5   322  1.225680                     2           139375           11         369   1.072419\n5               15      85879      1   382  1.044142                    15            85879            4         253   1.136857\n6                2      22311      4   379  1.101161                     2            22311           12         335   1.081863\n7                8     250423      4   430  1.030997                     8           250423            8         331   1.058761\n8               18     281627      4   164  1.093969                    18           281627           12         118   1.389787\n9               15      10513      4   401  1.003691                    15            10513           12         424   1.143745\n10              10       4131      2   139  1.618503                    10             4131           10         208   1.368822\n11              10       4131      2   139  1.618503                    10             4131            7         404   1.160432\n12               7      64269      9   260  1.077547                     7            64269           10         261   1.388470\n13              20     101207      9   359  1.148113                    20           101207           12         153   1.129205\n14              14     141127      2   327  1.289791                    14           141127            9         367   1.090988\n15               7     237715      2   358  1.105142                     7           237715           10         311   1.285408\n16               4     173213      5   336  1.223887                     4           173213           10         338   1.134659\n17              11     136537      8   211  1.726841                    11           136537           11         389   1.129621\n18               3     179129      8   281  1.418793                     3           179129           12         409   1.013394\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" CROSS JOIN \"INV\" AS \"INV2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               11      13487      1   357  1.228029                    13           296465            1         370   1.005699\n1               11      13487      1   357  1.228029                    13           296485            1         329   1.231283\n2               11      13487      1   357  1.228029                    14             2749            1         218   1.434983\n3               11      13487      1   357  1.228029                    14             9193            1         394   1.229535\n4               11      13487      1   357  1.228029                    14             9209            1         257   1.452043\n5               11      13487      1   357  1.228029                    14           137147            1         407   1.014825\n6               11      13487      1   357  1.228029                    14           149999            1         321   1.189234\n7               11      13487      1   357  1.228029                     6           296729            1         385   1.370691\n8               11      13487      1   357  1.228029                     7             9643            1         251   1.036390\n9               11      13487      1   357  1.228029                     7           105627            1         338   1.330911\n10              11      13487      1   357  1.228029                     7           105655            1         381   1.051065\n11              11      13487      1   357  1.228029                     7           118483            1         397   1.071511\n12              11      13487      1   357  1.228029                     7           124745            1         367   1.042282\n13              11      13487      1   357  1.228029                     7           124799            1         354   1.227269\n14              11      13487      1   357  1.228029                     7           124881            1         249   1.018379\n15              11      13487      1   357  1.228029                     7           131127            1         412   1.000030\n16              11      13487      1   357  1.228029                     7           131211            1         300   1.155242\n17              11      13487      1   357  1.228029                     7           143991            1         295   1.508045\n18              11      13487      1   357  1.228029                     7           144041            1         292   1.026647\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.098686,
                    "execution_time": 0.085074,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.005661
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.153283,
                    "execution_time": 0.091607,
                    "compile_time": 0.0001,
                    "planning_time": 0.041369
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\"",
                "rewrite": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               11      13487      1   357  1.228029                    13           296465            1         370   1.005699\n1               11      13487      1   357  1.228029                    13           296485            1         329   1.231283\n2               11      13487      1   357  1.228029                    14             2749            1         218   1.434983\n3               11      13487      1   357  1.228029                    14             9193            1         394   1.229535\n4               11      13487      1   357  1.228029                    14             9209            1         257   1.452043\n5               11      13487      1   357  1.228029                    14           137147            1         407   1.014825\n6               11      13487      1   357  1.228029                    14           149999            1         321   1.189234\n7               11      13487      1   357  1.228029                     6           296729            1         385   1.370691\n8               11      13487      1   357  1.228029                     7             9643            1         251   1.036390\n9               11      13487      1   357  1.228029                     7           105627            1         338   1.330911\n10              11      13487      1   357  1.228029                     7           105655            1         381   1.051065\n11              11      13487      1   357  1.228029                     7           118483            1         397   1.071511\n12              11      13487      1   357  1.228029                     7           124745            1         367   1.042282\n13              11      13487      1   357  1.228029                     7           124799            1         354   1.227269\n14              11      13487      1   357  1.228029                     7           124881            1         249   1.018379\n15              11      13487      1   357  1.228029                     7           131127            1         412   1.000030\n16              11      13487      1   357  1.228029                     7           131211            1         300   1.155242\n17              11      13487      1   357  1.228029                     7           143991            1         295   1.508045\n18              11      13487      1   357  1.228029                     7           144041            1         292   1.026647\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.931719,
                    "execution_time": 2.382227,
                    "compile_time": 0.064911,
                    "planning_time": 0.00594,
                    "create_size": 3456
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.117135,
                    "execution_time": 5.218176,
                    "compile_time": 3.34398,
                    "planning_time": 0.070849,
                    "create_size": 3456
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                4      97595      1   308  1.049002                     5            97595            9         312   1.424187\n1                4      97595      1   308  1.049002                     2            97595            1         296   1.012313\n2                4      97595      1   308  1.049002                     9            97595           11         187   1.380218\n3                4      97595      1   308  1.049002                     8            97595            4         378   1.200538\n4                4      97595      1   308  1.049002                    10            97595            7         380   1.006592\n5                4      97595      1   308  1.049002                     8            97595            3         360   1.003148\n6                4      97595      1   308  1.049002                    18            97595           12         402   1.202680\n7                4      97595      1   308  1.049002                     9            97595            1         433   1.004194\n8                4      97595      1   308  1.049002                     9            97595            5         274   1.101013\n9                4      97595      1   308  1.049002                    19            97595           10         350   1.051686\n10               4      97595      1   308  1.049002                    10            97595           11         360   1.095075\n11               4      97595      1   308  1.049002                    18            97595            7         382   1.044879\n12               4      97595      1   308  1.049002                    11            97595            2         252   1.109837\n13               4      97595      1   308  1.049002                     7            97595           11         234   1.096541\n14               4      97595      1   308  1.049002                    19            97595            6         209   1.178504\n15               4      97595      1   308  1.049002                     9            97595           10         414   1.006079\n16               4      97595      1   308  1.049002                     1            97595            9         309   1.003666\n17               4      97595      1   308  1.049002                     4            97595            1         308   1.049002\n18               4      97595      1   308  1.049002                     3            97595            8         288   1.037356\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019172,
                    "execution_time": 0.008014,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004572
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05736,
                    "execution_time": 0.008785,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.04068
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                4      97595      1   308  1.049002                     5            97595            9         312   1.424187\n1                4      97595      1   308  1.049002                     2            97595            1         296   1.012313\n2                4      97595      1   308  1.049002                     9            97595           11         187   1.380218\n3                4      97595      1   308  1.049002                     8            97595            4         378   1.200538\n4                4      97595      1   308  1.049002                    10            97595            7         380   1.006592\n5                4      97595      1   308  1.049002                     8            97595            3         360   1.003148\n6                4      97595      1   308  1.049002                    18            97595           12         402   1.202680\n7                4      97595      1   308  1.049002                     9            97595            1         433   1.004194\n8                4      97595      1   308  1.049002                     9            97595            5         274   1.101013\n9                4      97595      1   308  1.049002                    19            97595           10         350   1.051686\n10               4      97595      1   308  1.049002                    10            97595           11         360   1.095075\n11               4      97595      1   308  1.049002                    18            97595            7         382   1.044879\n12               4      97595      1   308  1.049002                    11            97595            2         252   1.109837\n13               4      97595      1   308  1.049002                     7            97595           11         234   1.096541\n14               4      97595      1   308  1.049002                    19            97595            6         209   1.178504\n15               4      97595      1   308  1.049002                     9            97595           10         414   1.006079\n16               4      97595      1   308  1.049002                     1            97595            9         309   1.003666\n17               4      97595      1   308  1.049002                     4            97595            1         308   1.049002\n18               4      97595      1   308  1.049002                     3            97595            8         288   1.037356\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n1                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n2                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n3                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n4                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n5                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n6                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n7                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n8                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n9                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n10               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n11               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n12               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n13               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n14               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n15               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n16               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n17               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n18               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.775737,
                    "execution_time": 0.759012,
                    "compile_time": 0.000136,
                    "planning_time": 0.006657
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.388055,
                    "execution_time": 1.327164,
                    "compile_time": 0.000142,
                    "planning_time": 0.043372
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n1                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n2                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n3                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n4                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n5                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n6                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n7                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n8                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n9                5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n10               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n11               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n12               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n13               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n14               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n15               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n16               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n17               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n18               5     248539      2   396  1.058431                    11           248539           10         412   1.081256\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"INV1\".\"D_MOY\" = 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean      cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n1               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n2               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n3               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n4               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n5               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n6               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n7               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n8               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n9               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n10              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n11              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n12              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n13              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n14              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n15              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n16              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n17              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n18              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.124806,
                    "execution_time": 0.106949,
                    "compile_time": 0.000133,
                    "planning_time": 0.00752
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.260031,
                    "execution_time": 0.199122,
                    "compile_time": 0.000149,
                    "planning_time": 0.0456
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"INV1\".\"D_MOY\" = 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean      cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n1               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n2               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n3               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n4               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n5               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n6               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n7               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n8               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n9               10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n10              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n11              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n12              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n13              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n14              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n15              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n16              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n17              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n18              10     156587      1   451  1.05126                    10           156587            4         369   1.150671\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n1               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n2               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n3               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n4               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n5               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n6               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n7               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n8               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n9               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n10              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n11              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n12              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n13              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n14              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n15              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n16              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n17              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n18              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.152083,
                    "execution_time": 0.131873,
                    "compile_time": 0.000206,
                    "planning_time": 0.008067
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.264493,
                    "execution_time": 0.192774,
                    "compile_time": 0.000256,
                    "planning_time": 0.044938
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n1               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n2               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n3               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n4               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n5               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n6               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n7               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n8               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n9               10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n10              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n11              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n12              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n13              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n14              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n15              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n16              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n17              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n18              10     162949      1   248  1.800888                     3           162949            2         294   1.048925\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": null
    }
]