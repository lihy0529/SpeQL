[
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(SS_EXT_SALES_PRICE) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(CS_EXT_SALES_PRICE) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(WS_EXT_SALES_PRICE) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\nselect * from ss_items  -- Added main SELECT statement\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103094,
                    "execution_time": 0.039125,
                    "compile_time": 0.000229,
                    "planning_time": 0.02404,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.169991,
                    "execution_time": 0.040922,
                    "compile_time": 0.000223,
                    "planning_time": 0.088548,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.285599,
                    "execution_time": 0.116811,
                    "compile_time": 0.000247,
                    "planning_time": 0.026028,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.341999,
                    "execution_time": 0.115804,
                    "compile_time": 0.000248,
                    "planning_time": 0.084939,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.078105,
                    "execution_time": 0.030311,
                    "compile_time": 0.000229,
                    "planning_time": 0.025363,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.297013,
                    "execution_time": 0.032543,
                    "compile_time": 0.154155,
                    "planning_time": 0.086081,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093274,
                    "execution_time": 0.040673,
                    "compile_time": 0.000285,
                    "planning_time": 0.026772,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154785,
                    "execution_time": 0.038941,
                    "compile_time": 0.002186,
                    "planning_time": 0.085856,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.394885,
                    "execution_time": 0.164274,
                    "compile_time": 0.000483,
                    "planning_time": 0.033981,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.079593,
                    "execution_time": 0.206476,
                    "compile_time": 4.577423,
                    "planning_time": 0.097514,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev\n0   AAAAAAAAIMIDEAAA     68933.77\n1   AAAAAAAAMIGODAAA     93565.77\n2   AAAAAAAACGOKAAAA     99880.63\n3   AAAAAAAAEFLDDAAA     60905.57\n4   AAAAAAAANFMGBAAA     77158.63\n5   AAAAAAAALEFEEAAA     49036.46\n6   AAAAAAAAEBCBAAAA     64153.89\n7   AAAAAAAAKMHFBAAA     94274.06\n8   AAAAAAAAJMECEAAA     85146.35\n9   AAAAAAAAPFJACAAA     51157.75\n10  AAAAAAAALBIEBAAA    100997.25\n11  AAAAAAAAHFDGBAAA    100163.76\n12  AAAAAAAAINAEEAAA     75784.00\n13  AAAAAAAAEFBCCAAA     86256.82\n14  AAAAAAAAABMABAAA     83792.44\n15  AAAAAAAAMKHCAAAA     72902.83\n16  AAAAAAAAABKFBAAA    106606.86\n17  AAAAAAAACNKOCAAA     39189.17\n18  AAAAAAAAKCALCAAA     82274.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026887,
                    "execution_time": 0.007169,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.002999
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052099,
                    "execution_time": 0.007338,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038856
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev\n0   AAAAAAAAIMIDEAAA     68933.77\n1   AAAAAAAAMIGODAAA     93565.77\n2   AAAAAAAACGOKAAAA     99880.63\n3   AAAAAAAAEFLDDAAA     60905.57\n4   AAAAAAAANFMGBAAA     77158.63\n5   AAAAAAAALEFEEAAA     49036.46\n6   AAAAAAAAEBCBAAAA     64153.89\n7   AAAAAAAAKMHFBAAA     94274.06\n8   AAAAAAAAJMECEAAA     85146.35\n9   AAAAAAAAPFJACAAA     51157.75\n10  AAAAAAAALBIEBAAA    100997.25\n11  AAAAAAAAHFDGBAAA    100163.76\n12  AAAAAAAAINAEEAAA     75784.00\n13  AAAAAAAAEFBCCAAA     86256.82\n14  AAAAAAAAABMABAAA     83792.44\n15  AAAAAAAAMKHCAAAA     72902.83\n16  AAAAAAAAABKFBAAA    106606.86\n17  AAAAAAAACNKOCAAA     39189.17\n18  AAAAAAAAKCALCAAA     82274.48\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select ss_item_sk item_id\n        ,sum(SS_EXT_SALES_PRICE) ss_item_rev \n from store_sales\n     ,date_dim\n where ss_sold_date_sk   = d_date_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n group by ss_item_sk),\n cs_items as\n (select cs_item_sk item_id\n        ,sum(CS_EXT_SALES_PRICE) cs_item_rev\n  from catalog_sales\n      ,date_dim\n where cs_sold_date_sk = d_date_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n group by cs_item_sk),\n ws_items as\n (select ws_item_sk item_id\n        ,sum(WS_EXT_SALES_PRICE) ws_item_rev\n  from web_sales\n      ,date_dim\n where ws_sold_date_sk   = d_date_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n group by ws_item_sk)\nselect ss_items.item_id\nfrom ss_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.182125,
                    "execution_time": 0.086258,
                    "compile_time": 0.000406,
                    "planning_time": 0.031888,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.189781,
                    "execution_time": 0.087993,
                    "compile_time": 2.940771,
                    "planning_time": 0.092922,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    item_id\n0     79448\n1     60328\n2    263236\n3    180631\n4    224029\n5     29824\n6    224413\n7    158317\n8     79453\n9    102310\n10    59395\n11   256015\n12   275029\n13   282004\n14    81001\n15   146594\n16   258104\n17   149377\n18   186859\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015557,
                    "execution_time": 0.006894,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003003
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05347,
                    "execution_time": 0.007338,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.038225
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    item_id\n0     79448\n1     60328\n2    263236\n3    180631\n4    224029\n5     29824\n6    224413\n7    158317\n8     79453\n9    102310\n10    59395\n11   256015\n12   275029\n13   282004\n14    81001\n15   146594\n16   258104\n17   149377\n18   186859\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n, cs_item_rev, ws_item_rev from ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.091424,
                    "execution_time": 0.039053,
                    "compile_time": 0.000298,
                    "planning_time": 0.02631,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154045,
                    "execution_time": 0.039247,
                    "compile_time": 0.000306,
                    "planning_time": 0.088245,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.405134,
                    "execution_time": 0.147936,
                    "compile_time": 0.000503,
                    "planning_time": 0.042355,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.02103,
                    "execution_time": 0.167099,
                    "compile_time": 4.551027,
                    "planning_time": 0.100845,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.09183,
                    "execution_time": 0.039394,
                    "compile_time": 0.0003,
                    "planning_time": 0.026659,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.157905,
                    "execution_time": 0.039943,
                    "compile_time": 0.000317,
                    "planning_time": 0.090778,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.716885,
                    "execution_time": 0.413617,
                    "compile_time": 0.063401,
                    "planning_time": 0.045105,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.990852,
                    "execution_time": 0.408441,
                    "compile_time": 3.278834,
                    "planning_time": 0.103751,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.491546,
                    "execution_time": 0.083723,
                    "compile_time": 0.000309,
                    "planning_time": 0.007335,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.567792,
                    "execution_time": 0.086695,
                    "compile_time": 0.003594,
                    "planning_time": 0.064175,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  cs_item_rev  ws_item_rev\n0   AAAAAAAAALJIDAAA     68478.73     65670.46     26350.84\n1   AAAAAAAAIAGHCAAA     97940.92     20937.96     11905.86\n2   AAAAAAAANDKACAAA     70497.45     56318.21     16411.53\n3   AAAAAAAAPJNADAAA     71810.54     60907.30     39816.22\n4   AAAAAAAAAHDBCAAA     55368.68     30878.59     49388.11\n5   AAAAAAAAOPEIDAAA     62043.76     55695.96     20618.79\n6   AAAAAAAAEJLLAAAA     71858.62     55790.96     19834.32\n7   AAAAAAAAFNNDDAAA     64010.48     62564.45      5691.00\n8   AAAAAAAAAOFPBAAA     69883.55     77347.15     27576.29\n9   AAAAAAAAOGCNAAAA     76302.74     91059.37     27956.25\n10  AAAAAAAAMPOMAAAA     87720.53     16163.98     15954.70\n11  AAAAAAAAGONGBAAA     52063.01     25473.58      8060.76\n12  AAAAAAAAILDJBAAA     60018.67     59012.00     29096.90\n13  AAAAAAAAMFLMAAAA     78359.16     52174.62     45249.90\n14  AAAAAAAAHGONAAAA     84001.17     71769.41     25345.20\n15  AAAAAAAABAFPBAAA     80474.47     19740.32     37019.79\n16  AAAAAAAAEAEEBAAA     90898.32     89002.55     21875.15\n17  AAAAAAAANMOAEAAA     42537.21     44523.63     32316.22\n18  AAAAAAAAGEKBEAAA     79810.50     77732.93     12717.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016526,
                    "execution_time": 0.007196,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003387
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.400286,
                    "execution_time": 0.00774,
                    "compile_time": 0.345624,
                    "planning_time": 0.038562
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  cs_item_rev  ws_item_rev\n0   AAAAAAAAALJIDAAA     68478.73     65670.46     26350.84\n1   AAAAAAAAIAGHCAAA     97940.92     20937.96     11905.86\n2   AAAAAAAANDKACAAA     70497.45     56318.21     16411.53\n3   AAAAAAAAPJNADAAA     71810.54     60907.30     39816.22\n4   AAAAAAAAAHDBCAAA     55368.68     30878.59     49388.11\n5   AAAAAAAAOPEIDAAA     62043.76     55695.96     20618.79\n6   AAAAAAAAEJLLAAAA     71858.62     55790.96     19834.32\n7   AAAAAAAAFNNDDAAA     64010.48     62564.45      5691.00\n8   AAAAAAAAAOFPBAAA     69883.55     77347.15     27576.29\n9   AAAAAAAAOGCNAAAA     76302.74     91059.37     27956.25\n10  AAAAAAAAMPOMAAAA     87720.53     16163.98     15954.70\n11  AAAAAAAAGONGBAAA     52063.01     25473.58      8060.76\n12  AAAAAAAAILDJBAAA     60018.67     59012.00     29096.90\n13  AAAAAAAAMFLMAAAA     78359.16     52174.62     45249.90\n14  AAAAAAAAHGONAAAA     84001.17     71769.41     25345.20\n15  AAAAAAAABAFPBAAA     80474.47     19740.32     37019.79\n16  AAAAAAAAEAEEBAAA     90898.32     89002.55     21875.15\n17  AAAAAAAANMOAEAAA     42537.21     44523.63     32316.22\n18  AAAAAAAAGEKBEAAA     79810.50     77732.93     12717.12\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\nfrom ss_items\nleft join cs_items on ss_items.item_id = cs_items.item_id\nleft join ws_items on ss_items.item_id = ws_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.378746,
                    "execution_time": 0.079837,
                    "compile_time": 0.000289,
                    "planning_time": 0.007482,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.594117,
                    "execution_time": 0.080552,
                    "compile_time": 0.146681,
                    "planning_time": 0.065627,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_DEV\" AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev\n0   AAAAAAAAGKAHCAAA     95181.44  143.25\n1   AAAAAAAAGOLDBAAA    105544.46  224.27\n2   AAAAAAAAJPDBAAAA     71261.12  124.66\n3   AAAAAAAAKCOIEAAA     99390.67  141.54\n4   AAAAAAAABFCACAAA     74651.49  197.37\n5   AAAAAAAAADEKAAAA     83230.65  166.22\n6   AAAAAAAAAODJCAAA    107711.25  217.85\n7   AAAAAAAAEKDIEAAA     98566.66  150.44\n8   AAAAAAAAJGKIBAAA     66761.27  116.69\n9   AAAAAAAAGGLIEAAA     74844.79  136.41\n10  AAAAAAAACECPDAAA     55959.52  177.02\n11  AAAAAAAAIPMBEAAA     95325.69  178.26\n12  AAAAAAAANJCHAAAA     63694.21   95.15\n13  AAAAAAAAKGBIEAAA    100835.29  162.88\n14  AAAAAAAAKLBKCAAA     67189.14  152.53\n15  AAAAAAAAGDHJDAAA     65204.34  129.15\n16  AAAAAAAAJCGKBAAA     87305.30  188.61\n17  AAAAAAAAFOOJBAAA     50547.39  146.18\n18  AAAAAAAAKEDGCAAA     95539.55  179.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017302,
                    "execution_time": 0.00779,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003378
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.154578,
                    "execution_time": 0.007567,
                    "compile_time": 0.100066,
                    "planning_time": 0.038695
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_DEV\" AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev\n0   AAAAAAAAGKAHCAAA     95181.44  143.25\n1   AAAAAAAAGOLDBAAA    105544.46  224.27\n2   AAAAAAAAJPDBAAAA     71261.12  124.66\n3   AAAAAAAAKCOIEAAA     99390.67  141.54\n4   AAAAAAAABFCACAAA     74651.49  197.37\n5   AAAAAAAAADEKAAAA     83230.65  166.22\n6   AAAAAAAAAODJCAAA    107711.25  217.85\n7   AAAAAAAAEKDIEAAA     98566.66  150.44\n8   AAAAAAAAJGKIBAAA     66761.27  116.69\n9   AAAAAAAAGGLIEAAA     74844.79  136.41\n10  AAAAAAAACECPDAAA     55959.52  177.02\n11  AAAAAAAAIPMBEAAA     95325.69  178.26\n12  AAAAAAAANJCHAAAA     63694.21   95.15\n13  AAAAAAAAKGBIEAAA    100835.29  162.88\n14  AAAAAAAAKLBKCAAA     67189.14  152.53\n15  AAAAAAAAGDHJDAAA     65204.34  129.15\n16  AAAAAAAAJCGKBAAA     87305.30  188.61\n17  AAAAAAAAFOOJBAAA     50547.39  146.18\n18  AAAAAAAAKEDGCAAA     95539.55  179.51\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.506535,
                    "execution_time": 0.088333,
                    "compile_time": 0.000314,
                    "planning_time": 0.007949,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.685647,
                    "execution_time": 0.087576,
                    "compile_time": 0.115334,
                    "planning_time": 0.066251,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_13\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev\n0   AAAAAAAAHECCBAAA     84323.62  159.56     33798.62\n1   AAAAAAAAKNANBAAA     65379.28  134.96     55782.63\n2   AAAAAAAALFEKBAAA     69019.16  103.50     83870.83\n3   AAAAAAAAKCOJDAAA    102512.42  147.94     81614.36\n4   AAAAAAAAOBJKAAAA     70952.05  142.61     55506.98\n5   AAAAAAAAPLNCCAAA     82437.53  129.05     55187.80\n6   AAAAAAAAGDDNBAAA     77185.19  111.73    102527.76\n7   AAAAAAAAAHJNAAAA    101686.34  223.96     26684.47\n8   AAAAAAAAJOFDDAAA     48920.41  135.10     52045.22\n9   AAAAAAAAMAFJCAAA     54212.26  101.68     87162.49\n10  AAAAAAAALLNGCAAA     66343.73  135.26     37620.04\n11  AAAAAAAACFHMCAAA     57483.13  132.28     44570.35\n12  AAAAAAAADNIJBAAA     95813.44  197.37     35111.57\n13  AAAAAAAAIFEBCAAA     68862.43  169.62     36770.81\n14  AAAAAAAAANKNBAAA     75470.97  135.01     58795.69\n15  AAAAAAAAMJDFCAAA     56584.65  125.35     54186.36\n16  AAAAAAAAPBHBBAAA     50659.01  116.47     65770.05\n17  AAAAAAAAACFKCAAA     99197.98  148.91     79802.50\n18  AAAAAAAANEHKAAAA    123127.45  164.74     33591.02\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017597,
                    "execution_time": 0.00759,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003716
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.41918,
                    "execution_time": 0.008122,
                    "compile_time": 0.365512,
                    "planning_time": 0.039143
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_13\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev\n0   AAAAAAAAHECCBAAA     84323.62  159.56     33798.62\n1   AAAAAAAAKNANBAAA     65379.28  134.96     55782.63\n2   AAAAAAAALFEKBAAA     69019.16  103.50     83870.83\n3   AAAAAAAAKCOJDAAA    102512.42  147.94     81614.36\n4   AAAAAAAAOBJKAAAA     70952.05  142.61     55506.98\n5   AAAAAAAAPLNCCAAA     82437.53  129.05     55187.80\n6   AAAAAAAAGDDNBAAA     77185.19  111.73    102527.76\n7   AAAAAAAAAHJNAAAA    101686.34  223.96     26684.47\n8   AAAAAAAAJOFDDAAA     48920.41  135.10     52045.22\n9   AAAAAAAAMAFJCAAA     54212.26  101.68     87162.49\n10  AAAAAAAALLNGCAAA     66343.73  135.26     37620.04\n11  AAAAAAAACFHMCAAA     57483.13  132.28     44570.35\n12  AAAAAAAADNIJBAAA     95813.44  197.37     35111.57\n13  AAAAAAAAIFEBCAAA     68862.43  169.62     36770.81\n14  AAAAAAAAANKNBAAA     75470.97  135.01     58795.69\n15  AAAAAAAAMJDFCAAA     56584.65  125.35     54186.36\n16  AAAAAAAAPBHBBAAA     50659.01  116.47     65770.05\n17  AAAAAAAAACFKCAAA     99197.98  148.91     79802.50\n18  AAAAAAAANEHKAAAA    123127.45  164.74     33591.02\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+coalesce(cs_item_rev, 0)+coalesce(ws_item_rev, 0))/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+coalesce(cs_item_rev, 0)+coalesce(ws_item_rev, 0))/3) * 100 cs_dev\nfrom ss_items\nleft join cs_items on ss_items.item_id = cs_items.item_id\nleft join ws_items on ss_items.item_id = ws_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + COALESCE ( \"CS_ITEMS\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"WS_ITEMS\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + COALESCE ( \"CS_ITEMS\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"WS_ITEMS\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.616734,
                    "execution_time": 0.089565,
                    "compile_time": 0.000312,
                    "planning_time": 0.009191,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.794751,
                    "execution_time": 0.092786,
                    "compile_time": 0.124877,
                    "planning_time": 0.066851,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_DEV\" AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev\n0   AAAAAAAAGPOBCAAA     75461.18  129.85     62368.60  107.32\n1   AAAAAAAAADNBDAAA    111518.14  161.42     71681.29  103.75\n2   AAAAAAAAJGDGEAAA     94388.55  188.16     46654.40   93.00\n3   AAAAAAAAOKEMBAAA     27667.76   91.65     32020.47  106.07\n4   AAAAAAAACAADDAAA     73286.58  182.75     28415.02   70.85\n5   AAAAAAAAJIIJAAAA     85771.65  128.61     74064.28  111.06\n6   AAAAAAAACHOFEAAA     59747.23  139.06     27758.65   64.61\n7   AAAAAAAAIACNAAAA     47372.09  129.07     36969.48  100.73\n8   AAAAAAAAIEJGBAAA     44433.53  124.36     51158.89  143.18\n9   AAAAAAAACGDNCAAA     78139.02  166.45     24951.97   53.15\n10  AAAAAAAABLDMBAAA     80149.59  205.61     14943.74   38.33\n11  AAAAAAAALKJNDAAA     87094.82  149.86     68581.84  118.00\n12  AAAAAAAAKNCOBAAA     76278.07  163.91     33963.51   72.98\n13  AAAAAAAACLAAEAAA     77774.45  180.66     39981.04   92.87\n14  AAAAAAAACPBAEAAA     96104.48  168.42     44434.88   77.87\n15  AAAAAAAAMGEOCAAA     62604.15  138.82     60385.74  133.90\n16  AAAAAAAAKFBJBAAA     78832.70  132.33     75449.53  126.66\n17  AAAAAAAAJLELCAAA    108337.89  191.67     39268.24   69.47\n18  AAAAAAAAGPKNAAAA     95088.09  184.67     35746.34   69.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017285,
                    "execution_time": 0.007463,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003674
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.3305,
                    "execution_time": 0.00845,
                    "compile_time": 0.274331,
                    "planning_time": 0.039266
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_DEV\" AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev\n0   AAAAAAAAGPOBCAAA     75461.18  129.85     62368.60  107.32\n1   AAAAAAAAADNBDAAA    111518.14  161.42     71681.29  103.75\n2   AAAAAAAAJGDGEAAA     94388.55  188.16     46654.40   93.00\n3   AAAAAAAAOKEMBAAA     27667.76   91.65     32020.47  106.07\n4   AAAAAAAACAADDAAA     73286.58  182.75     28415.02   70.85\n5   AAAAAAAAJIIJAAAA     85771.65  128.61     74064.28  111.06\n6   AAAAAAAACHOFEAAA     59747.23  139.06     27758.65   64.61\n7   AAAAAAAAIACNAAAA     47372.09  129.07     36969.48  100.73\n8   AAAAAAAAIEJGBAAA     44433.53  124.36     51158.89  143.18\n9   AAAAAAAACGDNCAAA     78139.02  166.45     24951.97   53.15\n10  AAAAAAAABLDMBAAA     80149.59  205.61     14943.74   38.33\n11  AAAAAAAALKJNDAAA     87094.82  149.86     68581.84  118.00\n12  AAAAAAAAKNCOBAAA     76278.07  163.91     33963.51   72.98\n13  AAAAAAAACLAAEAAA     77774.45  180.66     39981.04   92.87\n14  AAAAAAAACPBAEAAA     96104.48  168.42     44434.88   77.87\n15  AAAAAAAAMGEOCAAA     62604.15  138.82     60385.74  133.90\n16  AAAAAAAAKFBJBAAA     78832.70  132.33     75449.53  126.66\n17  AAAAAAAAJLELCAAA    108337.89  191.67     39268.24   69.47\n18  AAAAAAAAGPKNAAAA     95088.09  184.67     35746.34   69.42\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.731,
                    "execution_time": 0.108612,
                    "compile_time": 0.000425,
                    "planning_time": 0.008705,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.831329,
                    "execution_time": 0.114519,
                    "compile_time": 0.001557,
                    "planning_time": 0.066301,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84\n1   AAAAAAAAIAGHCAAA     97940.92  224.66     20937.96   48.02     11905.86\n2   AAAAAAAANDKACAAA     70497.45  147.66     56318.21  117.96     16411.53\n3   AAAAAAAAPJNADAAA     71810.54  124.86     60907.30  105.90     39816.22\n4   AAAAAAAAAHDBCAAA     55368.68  122.46     30878.59   68.29     49388.11\n5   AAAAAAAAOPEIDAAA     62043.76  134.52     55695.96  120.76     20618.79\n6   AAAAAAAAEJLLAAAA     71858.62  146.16     55790.96  113.48     19834.32\n7   AAAAAAAAFNNDDAAA     64010.48  145.18     62564.45  141.90      5691.00\n8   AAAAAAAAAOFPBAAA     69883.55  119.93     77347.15  132.74     27576.29\n9   AAAAAAAAOGCNAAAA     76302.74  117.19     91059.37  139.86     27956.25\n10  AAAAAAAAMPOMAAAA     87720.53  219.59     16163.98   40.46     15954.70\n11  AAAAAAAAGONGBAAA     52063.01  182.46     25473.58   89.27      8060.76\n12  AAAAAAAAILDJBAAA     60018.67  121.55     59012.00  119.51     29096.90\n13  AAAAAAAAMFLMAAAA     78359.16  133.73     52174.62   89.04     45249.90\n14  AAAAAAAAHGONAAAA     84001.17  139.13     71769.41  118.87     25345.20\n15  AAAAAAAABAFPBAAA     80474.47  175.92     19740.32   43.15     37019.79\n16  AAAAAAAAEAEEBAAA     90898.32  135.14     89002.55  132.32     21875.15\n17  AAAAAAAANMOAEAAA     42537.21  106.89     44523.63  111.88     32316.22\n18  AAAAAAAAGEKBEAAA     79810.50  140.62     77732.93  136.96     12717.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01819,
                    "execution_time": 0.008016,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003858
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.289198,
                    "execution_time": 0.007983,
                    "compile_time": 0.232497,
                    "planning_time": 0.039783
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84\n1   AAAAAAAAIAGHCAAA     97940.92  224.66     20937.96   48.02     11905.86\n2   AAAAAAAANDKACAAA     70497.45  147.66     56318.21  117.96     16411.53\n3   AAAAAAAAPJNADAAA     71810.54  124.86     60907.30  105.90     39816.22\n4   AAAAAAAAAHDBCAAA     55368.68  122.46     30878.59   68.29     49388.11\n5   AAAAAAAAOPEIDAAA     62043.76  134.52     55695.96  120.76     20618.79\n6   AAAAAAAAEJLLAAAA     71858.62  146.16     55790.96  113.48     19834.32\n7   AAAAAAAAFNNDDAAA     64010.48  145.18     62564.45  141.90      5691.00\n8   AAAAAAAAAOFPBAAA     69883.55  119.93     77347.15  132.74     27576.29\n9   AAAAAAAAOGCNAAAA     76302.74  117.19     91059.37  139.86     27956.25\n10  AAAAAAAAMPOMAAAA     87720.53  219.59     16163.98   40.46     15954.70\n11  AAAAAAAAGONGBAAA     52063.01  182.46     25473.58   89.27      8060.76\n12  AAAAAAAAILDJBAAA     60018.67  121.55     59012.00  119.51     29096.90\n13  AAAAAAAAMFLMAAAA     78359.16  133.73     52174.62   89.04     45249.90\n14  AAAAAAAAHGONAAAA     84001.17  139.13     71769.41  118.87     25345.20\n15  AAAAAAAABAFPBAAA     80474.47  175.92     19740.32   43.15     37019.79\n16  AAAAAAAAEAEEBAAA     90898.32  135.14     89002.55  132.32     21875.15\n17  AAAAAAAANMOAEAAA     42537.21  106.89     44523.63  111.88     32316.22\n18  AAAAAAAAGEKBEAAA     79810.50  140.62     77732.93  136.96     12717.12\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.829969,
                    "execution_time": 0.11554,
                    "compile_time": 0.000419,
                    "planning_time": 0.00918,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.17538,
                    "execution_time": 0.276282,
                    "compile_time": 0.113548,
                    "planning_time": 0.066354,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25\n1   AAAAAAAAIAGHCAAA     97940.92  224.66     20937.96   48.02     11905.86   27.31\n2   AAAAAAAANDKACAAA     70497.45  147.66     56318.21  117.96     16411.53   34.37\n3   AAAAAAAAPJNADAAA     71810.54  124.86     60907.30  105.90     39816.22   69.23\n4   AAAAAAAAAHDBCAAA     55368.68  122.46     30878.59   68.29     49388.11  109.23\n5   AAAAAAAAOPEIDAAA     62043.76  134.52     55695.96  120.76     20618.79   44.70\n6   AAAAAAAAEJLLAAAA     71858.62  146.16     55790.96  113.48     19834.32   40.34\n7   AAAAAAAAFNNDDAAA     64010.48  145.18     62564.45  141.90      5691.00   12.90\n8   AAAAAAAAAOFPBAAA     69883.55  119.93     77347.15  132.74     27576.29   47.32\n9   AAAAAAAAOGCNAAAA     76302.74  117.19     91059.37  139.86     27956.25   42.93\n10  AAAAAAAAMPOMAAAA     87720.53  219.59     16163.98   40.46     15954.70   39.94\n11  AAAAAAAAGONGBAAA     52063.01  182.46     25473.58   89.27      8060.76   28.25\n12  AAAAAAAAILDJBAAA     60018.67  121.55     59012.00  119.51     29096.90   58.92\n13  AAAAAAAAMFLMAAAA     78359.16  133.73     52174.62   89.04     45249.90   77.22\n14  AAAAAAAAHGONAAAA     84001.17  139.13     71769.41  118.87     25345.20   41.98\n15  AAAAAAAABAFPBAAA     80474.47  175.92     19740.32   43.15     37019.79   80.92\n16  AAAAAAAAEAEEBAAA     90898.32  135.14     89002.55  132.32     21875.15   32.52\n17  AAAAAAAANMOAEAAA     42537.21  106.89     44523.63  111.88     32316.22   81.21\n18  AAAAAAAAGEKBEAAA     79810.50  140.62     77732.93  136.96     12717.12   22.40\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018628,
                    "execution_time": 0.008203,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.00408
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.303426,
                    "execution_time": 0.008358,
                    "compile_time": 0.246477,
                    "planning_time": 0.039881
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25\n1   AAAAAAAAIAGHCAAA     97940.92  224.66     20937.96   48.02     11905.86   27.31\n2   AAAAAAAANDKACAAA     70497.45  147.66     56318.21  117.96     16411.53   34.37\n3   AAAAAAAAPJNADAAA     71810.54  124.86     60907.30  105.90     39816.22   69.23\n4   AAAAAAAAAHDBCAAA     55368.68  122.46     30878.59   68.29     49388.11  109.23\n5   AAAAAAAAOPEIDAAA     62043.76  134.52     55695.96  120.76     20618.79   44.70\n6   AAAAAAAAEJLLAAAA     71858.62  146.16     55790.96  113.48     19834.32   40.34\n7   AAAAAAAAFNNDDAAA     64010.48  145.18     62564.45  141.90      5691.00   12.90\n8   AAAAAAAAAOFPBAAA     69883.55  119.93     77347.15  132.74     27576.29   47.32\n9   AAAAAAAAOGCNAAAA     76302.74  117.19     91059.37  139.86     27956.25   42.93\n10  AAAAAAAAMPOMAAAA     87720.53  219.59     16163.98   40.46     15954.70   39.94\n11  AAAAAAAAGONGBAAA     52063.01  182.46     25473.58   89.27      8060.76   28.25\n12  AAAAAAAAILDJBAAA     60018.67  121.55     59012.00  119.51     29096.90   58.92\n13  AAAAAAAAMFLMAAAA     78359.16  133.73     52174.62   89.04     45249.90   77.22\n14  AAAAAAAAHGONAAAA     84001.17  139.13     71769.41  118.87     25345.20   41.98\n15  AAAAAAAABAFPBAAA     80474.47  175.92     19740.32   43.15     37019.79   80.92\n16  AAAAAAAAEAEEBAAA     90898.32  135.14     89002.55  132.32     21875.15   32.52\n17  AAAAAAAANMOAEAAA     42537.21  106.89     44523.63  111.88     32316.22   81.21\n18  AAAAAAAAGEKBEAAA     79810.50  140.62     77732.93  136.96     12717.12   22.40\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.967515,
                    "execution_time": 0.118999,
                    "compile_time": 0.000454,
                    "planning_time": 0.009848,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.286523,
                    "execution_time": 0.292063,
                    "compile_time": 0.096801,
                    "planning_time": 0.067647,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAGPOBCAAA     75461.18  129.85     62368.60  107.32     36500.23   62.81  58110.0033\n1   AAAAAAAAADNBDAAA    111518.14  161.42     71681.29  103.75     24056.98   34.82  69085.4700\n2   AAAAAAAAJGDGEAAA     94388.55  188.16     46654.40   93.00      9442.84   18.82  50161.9300\n3   AAAAAAAAOKEMBAAA     27667.76   91.65     32020.47  106.07     30872.94  102.27  30187.0566\n4   AAAAAAAACAADDAAA     73286.58  182.75     28415.02   70.85     18604.28   46.39  40101.9600\n5   AAAAAAAAJIIJAAAA     85771.65  128.61     74064.28  111.06     40227.28   60.32  66687.7366\n6   AAAAAAAACHOFEAAA     59747.23  139.06     27758.65   64.61     41382.10   96.32  42962.6600\n7   AAAAAAAAIACNAAAA     47372.09  129.07     36969.48  100.73     25759.01   70.18  36700.1933\n8   AAAAAAAAIEJGBAAA     44433.53  124.36     51158.89  143.18     11595.42   32.45  35729.2800\n9   AAAAAAAACGDNCAAA     78139.02  166.45     24951.97   53.15     37740.37   80.39  46943.7866\n10  AAAAAAAABLDMBAAA     80149.59  205.61     14943.74   38.33     21848.62   56.04  38980.6500\n11  AAAAAAAALKJNDAAA     87094.82  149.86     68581.84  118.00     18669.71   32.12  58115.4566\n12  AAAAAAAAKNCOBAAA     76278.07  163.91     33963.51   72.98     29362.47   63.09  46534.6833\n13  AAAAAAAACLAAEAAA     77774.45  180.66     39981.04   92.87     11394.13   26.46  43049.8733\n14  AAAAAAAACPBAEAAA     96104.48  168.42     44434.88   77.87     30640.38   53.69  57059.9133\n15  AAAAAAAAMGEOCAAA     62604.15  138.82     60385.74  133.90     12293.07   27.26  45094.3200\n16  AAAAAAAAKFBJBAAA     78832.70  132.33     75449.53  126.66     24423.31   41.00  59568.5133\n17  AAAAAAAAJLELCAAA    108337.89  191.67     39268.24   69.47     21961.19   38.85  56522.4400\n18  AAAAAAAAGPKNAAAA     95088.09  184.67     35746.34   69.42     23629.86   45.89  51488.0966\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018617,
                    "execution_time": 0.007733,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.0043
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057321,
                    "execution_time": 0.008258,
                    "compile_time": 0.001016,
                    "planning_time": 0.040085
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAGPOBCAAA     75461.18  129.85     62368.60  107.32     36500.23   62.81  58110.0033\n1   AAAAAAAAADNBDAAA    111518.14  161.42     71681.29  103.75     24056.98   34.82  69085.4700\n2   AAAAAAAAJGDGEAAA     94388.55  188.16     46654.40   93.00      9442.84   18.82  50161.9300\n3   AAAAAAAAOKEMBAAA     27667.76   91.65     32020.47  106.07     30872.94  102.27  30187.0566\n4   AAAAAAAACAADDAAA     73286.58  182.75     28415.02   70.85     18604.28   46.39  40101.9600\n5   AAAAAAAAJIIJAAAA     85771.65  128.61     74064.28  111.06     40227.28   60.32  66687.7366\n6   AAAAAAAACHOFEAAA     59747.23  139.06     27758.65   64.61     41382.10   96.32  42962.6600\n7   AAAAAAAAIACNAAAA     47372.09  129.07     36969.48  100.73     25759.01   70.18  36700.1933\n8   AAAAAAAAIEJGBAAA     44433.53  124.36     51158.89  143.18     11595.42   32.45  35729.2800\n9   AAAAAAAACGDNCAAA     78139.02  166.45     24951.97   53.15     37740.37   80.39  46943.7866\n10  AAAAAAAABLDMBAAA     80149.59  205.61     14943.74   38.33     21848.62   56.04  38980.6500\n11  AAAAAAAALKJNDAAA     87094.82  149.86     68581.84  118.00     18669.71   32.12  58115.4566\n12  AAAAAAAAKNCOBAAA     76278.07  163.91     33963.51   72.98     29362.47   63.09  46534.6833\n13  AAAAAAAACLAAEAAA     77774.45  180.66     39981.04   92.87     11394.13   26.46  43049.8733\n14  AAAAAAAACPBAEAAA     96104.48  168.42     44434.88   77.87     30640.38   53.69  57059.9133\n15  AAAAAAAAMGEOCAAA     62604.15  138.82     60385.74  133.90     12293.07   27.26  45094.3200\n16  AAAAAAAAKFBJBAAA     78832.70  132.33     75449.53  126.66     24423.31   41.00  59568.5133\n17  AAAAAAAAJLELCAAA    108337.89  191.67     39268.24   69.47     21961.19   38.85  56522.4400\n18  AAAAAAAAGPKNAAAA     95088.09  184.67     35746.34   69.42     23629.86   45.89  51488.0966\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" CROSS JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" CROSS JOIN \"WS_ITEMS\" AS \"WS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.18183,
                    "execution_time": 0.050301,
                    "compile_time": 0.000252,
                    "planning_time": 0.003015,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.281797,
                    "execution_time": 0.086031,
                    "compile_time": 0.000262,
                    "planning_time": 0.060254,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.187655,
                    "execution_time": 0.052326,
                    "compile_time": 0.000256,
                    "planning_time": 0.003031,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.291889,
                    "execution_time": 0.09985,
                    "compile_time": 0.000241,
                    "planning_time": 0.058305,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAGPOBCAAA     75461.18  165.56     30393.59   66.68     30876.26   67.74  45577.0100\n1   AAAAAAAAGPOBCAAA     75461.18  189.42     30393.59   76.29     13654.12   34.27  39836.2966\n2   AAAAAAAAGPOBCAAA     75461.18  159.50     30393.59   64.24     36077.60   76.25  47310.7900\n3   AAAAAAAAGPOBCAAA     75461.18  164.90     30393.59   66.41     31427.79   68.67  45760.8533\n4   AAAAAAAAGPOBCAAA     75461.18  163.86     30393.59   66.00     32296.82   70.13  46050.5300\n5   AAAAAAAAGPOBCAAA     75461.18  198.39     30393.59   79.90      8250.89   21.69  38035.2200\n6   AAAAAAAAGPOBCAAA     75461.18  180.77     30393.59   72.81     19371.28   46.40  41742.0166\n7   AAAAAAAAGPOBCAAA     75461.18  201.90     30393.59   81.31      6271.17   16.77  37375.3133\n8   AAAAAAAAGPOBCAAA     75461.18  174.36     30393.59   70.22     23977.75   55.40  43277.5066\n9   AAAAAAAAGPOBCAAA     75461.18  184.03     30393.59   74.12     17155.24   41.83  41003.3366\n10  AAAAAAAAGPOBCAAA     75461.18  138.37     30393.59   55.73     57748.18  105.89  54534.3166\n11  AAAAAAAAGPOBCAAA     75461.18  148.18     30393.59   59.68     46912.27   92.12  50922.3466\n12  AAAAAAAAGPOBCAAA     75461.18  164.91     30393.59   66.42     31422.11   68.66  45758.9600\n13  AAAAAAAAGPOBCAAA     75461.18  181.65     30393.59   73.16     18771.38   45.18  41542.0500\n14  AAAAAAAAGPOBCAAA     75461.18  170.19     30393.59   68.55     27158.12   61.25  44337.6300\n15  AAAAAAAAGPOBCAAA     75461.18  150.38     30393.59   60.56     44685.77   89.05  50180.1800\n16  AAAAAAAAGPOBCAAA     75461.18  145.70     30393.59   58.68     49511.30   95.60  51788.6900\n17  AAAAAAAAGPOBCAAA     75461.18  172.44     30393.59   69.45     25420.41   58.09  43758.3933\n18  AAAAAAAAGPOBCAAA     75461.18  181.70     30393.59   73.18     18730.31   45.10  41528.3600\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.076452,
                    "execution_time": 0.029095,
                    "compile_time": 0.039508,
                    "planning_time": 0.008323
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.229238,
                    "execution_time": 0.091103,
                    "compile_time": 3.118702,
                    "planning_time": 0.045263
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAGPOBCAAA     75461.18  165.56     30393.59   66.68     30876.26   67.74  45577.0100\n1   AAAAAAAAGPOBCAAA     75461.18  189.42     30393.59   76.29     13654.12   34.27  39836.2966\n2   AAAAAAAAGPOBCAAA     75461.18  159.50     30393.59   64.24     36077.60   76.25  47310.7900\n3   AAAAAAAAGPOBCAAA     75461.18  164.90     30393.59   66.41     31427.79   68.67  45760.8533\n4   AAAAAAAAGPOBCAAA     75461.18  163.86     30393.59   66.00     32296.82   70.13  46050.5300\n5   AAAAAAAAGPOBCAAA     75461.18  198.39     30393.59   79.90      8250.89   21.69  38035.2200\n6   AAAAAAAAGPOBCAAA     75461.18  180.77     30393.59   72.81     19371.28   46.40  41742.0166\n7   AAAAAAAAGPOBCAAA     75461.18  201.90     30393.59   81.31      6271.17   16.77  37375.3133\n8   AAAAAAAAGPOBCAAA     75461.18  174.36     30393.59   70.22     23977.75   55.40  43277.5066\n9   AAAAAAAAGPOBCAAA     75461.18  184.03     30393.59   74.12     17155.24   41.83  41003.3366\n10  AAAAAAAAGPOBCAAA     75461.18  138.37     30393.59   55.73     57748.18  105.89  54534.3166\n11  AAAAAAAAGPOBCAAA     75461.18  148.18     30393.59   59.68     46912.27   92.12  50922.3466\n12  AAAAAAAAGPOBCAAA     75461.18  164.91     30393.59   66.42     31422.11   68.66  45758.9600\n13  AAAAAAAAGPOBCAAA     75461.18  181.65     30393.59   73.16     18771.38   45.18  41542.0500\n14  AAAAAAAAGPOBCAAA     75461.18  170.19     30393.59   68.55     27158.12   61.25  44337.6300\n15  AAAAAAAAGPOBCAAA     75461.18  150.38     30393.59   60.56     44685.77   89.05  50180.1800\n16  AAAAAAAAGPOBCAAA     75461.18  145.70     30393.59   58.68     49511.30   95.60  51788.6900\n17  AAAAAAAAGPOBCAAA     75461.18  172.44     30393.59   69.45     25420.41   58.09  43758.3933\n18  AAAAAAAAGPOBCAAA     75461.18  181.70     30393.59   73.18     18730.31   45.10  41528.3600\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" CROSS JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAEHKGCAAA     89332.21  149.19     72761.82  121.52     17529.98   29.27  59874.6700\n1   AAAAAAAAEHKGCAAA     89332.21  151.10     72761.82  123.07     15265.61   25.82  59119.8800\n2   AAAAAAAAEHKGCAAA     89332.21  131.84     72761.82  107.38     41172.66   60.76  67755.5633\n3   AAAAAAAAEHKGCAAA     89332.21  138.51     72761.82  112.82     31385.05   48.66  64493.0266\n4   AAAAAAAAEHKGCAAA     89332.21  145.70     72761.82  118.67     21838.87   35.61  61310.9666\n5   AAAAAAAAEHKGCAAA     89332.21  137.75     72761.82  112.20     32453.73   50.04  64849.2533\n6   AAAAAAAAEHKGCAAA     89332.21  129.87     72761.82  105.78     44259.50   64.34  68784.5100\n7   AAAAAAAAEHKGCAAA     89332.21  145.01     72761.82  118.11     22709.76   36.86  61601.2633\n8   AAAAAAAAEHKGCAAA     89332.21  131.54     72761.82  107.14     41628.73   61.30  67907.5866\n9   AAAAAAAAEHKGCAAA     89332.21  120.14     72761.82   97.85     60966.95   81.99  74353.6600\n10  AAAAAAAAEHKGCAAA     89332.21  128.88     72761.82  104.97     45842.38   66.13  69312.1366\n11  AAAAAAAAEHKGCAAA     89332.21  133.96     72761.82  109.11     37953.86   56.91  66682.6300\n12  AAAAAAAAEHKGCAAA     89332.21  153.63     72761.82  125.13     12341.78   21.22  58145.2700\n13  AAAAAAAAEHKGCAAA     89332.21  138.73     72761.82  112.99     31082.30   48.27  64392.1100\n14  AAAAAAAAEHKGCAAA     89332.21  155.77     72761.82  126.87      9951.04   17.35  57348.3566\n15  AAAAAAAAEHKGCAAA     89332.21  156.16     72761.82  127.19      9517.48   16.63  57203.8366\n16  AAAAAAAAEHKGCAAA     89332.21  115.32     72761.82   93.93     70284.75   90.73  77459.5933\n17  AAAAAAAAEHKGCAAA     89332.21  141.86     72761.82  115.54     26818.18   42.58  62970.7366\n18  AAAAAAAAEHKGCAAA     89332.21  131.48     72761.82  107.09     41736.35   61.42  67943.4600\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.045834,
                    "execution_time": 0.026744,
                    "compile_time": 0.000138,
                    "planning_time": 0.008623
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.253232,
                    "execution_time": 0.026443,
                    "compile_time": 4.15307,
                    "planning_time": 0.046773
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAEHKGCAAA     89332.21  149.19     72761.82  121.52     17529.98   29.27  59874.6700\n1   AAAAAAAAEHKGCAAA     89332.21  151.10     72761.82  123.07     15265.61   25.82  59119.8800\n2   AAAAAAAAEHKGCAAA     89332.21  131.84     72761.82  107.38     41172.66   60.76  67755.5633\n3   AAAAAAAAEHKGCAAA     89332.21  138.51     72761.82  112.82     31385.05   48.66  64493.0266\n4   AAAAAAAAEHKGCAAA     89332.21  145.70     72761.82  118.67     21838.87   35.61  61310.9666\n5   AAAAAAAAEHKGCAAA     89332.21  137.75     72761.82  112.20     32453.73   50.04  64849.2533\n6   AAAAAAAAEHKGCAAA     89332.21  129.87     72761.82  105.78     44259.50   64.34  68784.5100\n7   AAAAAAAAEHKGCAAA     89332.21  145.01     72761.82  118.11     22709.76   36.86  61601.2633\n8   AAAAAAAAEHKGCAAA     89332.21  131.54     72761.82  107.14     41628.73   61.30  67907.5866\n9   AAAAAAAAEHKGCAAA     89332.21  120.14     72761.82   97.85     60966.95   81.99  74353.6600\n10  AAAAAAAAEHKGCAAA     89332.21  128.88     72761.82  104.97     45842.38   66.13  69312.1366\n11  AAAAAAAAEHKGCAAA     89332.21  133.96     72761.82  109.11     37953.86   56.91  66682.6300\n12  AAAAAAAAEHKGCAAA     89332.21  153.63     72761.82  125.13     12341.78   21.22  58145.2700\n13  AAAAAAAAEHKGCAAA     89332.21  138.73     72761.82  112.99     31082.30   48.27  64392.1100\n14  AAAAAAAAEHKGCAAA     89332.21  155.77     72761.82  126.87      9951.04   17.35  57348.3566\n15  AAAAAAAAEHKGCAAA     89332.21  156.16     72761.82  127.19      9517.48   16.63  57203.8366\n16  AAAAAAAAEHKGCAAA     89332.21  115.32     72761.82   93.93     70284.75   90.73  77459.5933\n17  AAAAAAAAEHKGCAAA     89332.21  141.86     72761.82  115.54     26818.18   42.58  62970.7366\n18  AAAAAAAAEHKGCAAA     89332.21  131.48     72761.82  107.09     41736.35   61.42  67943.4600\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.938047,
                    "execution_time": 0.099026,
                    "compile_time": 0.000367,
                    "planning_time": 0.0042,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.370727,
                    "execution_time": 0.283177,
                    "compile_time": 0.203251,
                    "planning_time": 0.060423,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.0100\n1   AAAAAAAAIAGHCAAA     97940.92  224.66     20937.96   48.02     11905.86   27.31  43594.9133\n2   AAAAAAAANDKACAAA     70497.45  147.66     56318.21  117.96     16411.53   34.37  47742.3966\n3   AAAAAAAAPJNADAAA     71810.54  124.86     60907.30  105.90     39816.22   69.23  57511.3533\n4   AAAAAAAAAHDBCAAA     55368.68  122.46     30878.59   68.29     49388.11  109.23  45211.7933\n5   AAAAAAAAOPEIDAAA     62043.76  134.52     55695.96  120.76     20618.79   44.70  46119.5033\n6   AAAAAAAAEJLLAAAA     71858.62  146.16     55790.96  113.48     19834.32   40.34  49161.3000\n7   AAAAAAAAFNNDDAAA     64010.48  145.18     62564.45  141.90      5691.00   12.90  44088.6433\n8   AAAAAAAAAOFPBAAA     69883.55  119.93     77347.15  132.74     27576.29   47.32  58268.9966\n9   AAAAAAAAOGCNAAAA     76302.74  117.19     91059.37  139.86     27956.25   42.93  65106.1200\n10  AAAAAAAAMPOMAAAA     87720.53  219.59     16163.98   40.46     15954.70   39.94  39946.4033\n11  AAAAAAAAGONGBAAA     52063.01  182.46     25473.58   89.27      8060.76   28.25  28532.4500\n12  AAAAAAAAILDJBAAA     60018.67  121.55     59012.00  119.51     29096.90   58.92  49375.8566\n13  AAAAAAAAMFLMAAAA     78359.16  133.73     52174.62   89.04     45249.90   77.22  58594.5600\n14  AAAAAAAAHGONAAAA     84001.17  139.13     71769.41  118.87     25345.20   41.98  60371.9266\n15  AAAAAAAABAFPBAAA     80474.47  175.92     19740.32   43.15     37019.79   80.92  45744.8600\n16  AAAAAAAAEAEEBAAA     90898.32  135.14     89002.55  132.32     21875.15   32.52  67258.6733\n17  AAAAAAAANMOAEAAA     42537.21  106.89     44523.63  111.88     32316.22   81.21  39792.3533\n18  AAAAAAAAGEKBEAAA     79810.50  140.62     77732.93  136.96     12717.12   22.40  56753.5166\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01907,
                    "execution_time": 0.00822,
                    "compile_time": 5e-05,
                    "planning_time": 0.004303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054753,
                    "execution_time": 0.008123,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039959
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.0100\n1   AAAAAAAAIAGHCAAA     97940.92  224.66     20937.96   48.02     11905.86   27.31  43594.9133\n2   AAAAAAAANDKACAAA     70497.45  147.66     56318.21  117.96     16411.53   34.37  47742.3966\n3   AAAAAAAAPJNADAAA     71810.54  124.86     60907.30  105.90     39816.22   69.23  57511.3533\n4   AAAAAAAAAHDBCAAA     55368.68  122.46     30878.59   68.29     49388.11  109.23  45211.7933\n5   AAAAAAAAOPEIDAAA     62043.76  134.52     55695.96  120.76     20618.79   44.70  46119.5033\n6   AAAAAAAAEJLLAAAA     71858.62  146.16     55790.96  113.48     19834.32   40.34  49161.3000\n7   AAAAAAAAFNNDDAAA     64010.48  145.18     62564.45  141.90      5691.00   12.90  44088.6433\n8   AAAAAAAAAOFPBAAA     69883.55  119.93     77347.15  132.74     27576.29   47.32  58268.9966\n9   AAAAAAAAOGCNAAAA     76302.74  117.19     91059.37  139.86     27956.25   42.93  65106.1200\n10  AAAAAAAAMPOMAAAA     87720.53  219.59     16163.98   40.46     15954.70   39.94  39946.4033\n11  AAAAAAAAGONGBAAA     52063.01  182.46     25473.58   89.27      8060.76   28.25  28532.4500\n12  AAAAAAAAILDJBAAA     60018.67  121.55     59012.00  119.51     29096.90   58.92  49375.8566\n13  AAAAAAAAMFLMAAAA     78359.16  133.73     52174.62   89.04     45249.90   77.22  58594.5600\n14  AAAAAAAAHGONAAAA     84001.17  139.13     71769.41  118.87     25345.20   41.98  60371.9266\n15  AAAAAAAABAFPBAAA     80474.47  175.92     19740.32   43.15     37019.79   80.92  45744.8600\n16  AAAAAAAAEAEEBAAA     90898.32  135.14     89002.55  132.32     21875.15   32.52  67258.6733\n17  AAAAAAAANMOAEAAA     42537.21  106.89     44523.63  111.88     32316.22   81.21  39792.3533\n18  AAAAAAAAGEKBEAAA     79810.50  140.62     77732.93  136.96     12717.12   22.40  56753.5166\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev   average\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n1   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n2   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n3   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n4   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n5   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n6   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n7   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n8   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n9   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n10  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n11  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n12  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n13  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n14  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n15  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n16  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n17  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n18  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032288,
                    "execution_time": 0.017957,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.006713
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.087854,
                    "execution_time": 0.023219,
                    "compile_time": 0.001275,
                    "planning_time": 0.0427
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev   average\n0   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n1   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n2   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n3   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n4   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n5   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n6   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n7   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n8   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n9   AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n10  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n11  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n12  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n13  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n14  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n15  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n16  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n17  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n18  AAAAAAAAALJIDAAA     68478.73  127.99     65670.46  122.74     26350.84   49.25  53500.01\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n1   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n2   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n3   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n4   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n5   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n6   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n7   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n8   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n9   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n10  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n11  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n12  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n13  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n14  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n15  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n16  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n17  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n18  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046491,
                    "execution_time": 0.028612,
                    "compile_time": 0.000153,
                    "planning_time": 0.008525
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.326716,
                    "execution_time": 0.056714,
                    "compile_time": 0.210462,
                    "planning_time": 0.044717
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n1   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n2   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n3   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n4   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n5   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n6   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n7   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n8   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n9   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n10  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n11  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n12  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n13  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n14  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n15  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n16  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n17  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n18  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n1   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n2   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n3   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n4   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n5   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n6   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n7   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n8   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n9   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n10  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n11  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n12  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n13  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n14  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n15  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n16  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n17  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n18  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.061082,
                    "execution_time": 0.042175,
                    "compile_time": 0.000137,
                    "planning_time": 0.009561
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.220837,
                    "execution_time": 0.030289,
                    "compile_time": 0.130649,
                    "planning_time": 0.045596
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n1   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n2   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n3   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n4   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n5   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n6   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n7   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n8   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n9   AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n10  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n11  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n12  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n13  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n14  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n15  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n16  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n17  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n18  AAAAAAAAIMIDEAAA     68933.77  145.66     36828.33   77.82      36204.0    76.5  47322.0333\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.122431,
                    "execution_time": 0.077976,
                    "compile_time": 0.000341,
                    "planning_time": 0.013151,
                    "create_size": 1397
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.458248,
                    "execution_time": 0.176159,
                    "compile_time": 0.17599,
                    "planning_time": 0.070858,
                    "create_size": 1397
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAHIBBCAAA     52381.96  102.31     49867.69   97.40     51345.47  100.28  51198.3733\n1   AAAAAAAABPFAEAAA     48025.39  100.44     49487.81  103.50     45921.42   96.04  47811.5400\n2   AAAAAAAAEMHPDAAA     56838.72   99.51     57774.59  101.15     56735.53   99.33  57116.2800\n3   AAAAAAAAMGJEEAAA     40241.33  103.06     38467.07   98.52     38422.74   98.40  39043.7133\n4   AAAAAAAAGNKBCAAA     53620.37   96.43     57494.46  103.40     55690.51  100.15  55601.7800\n5   AAAAAAAAIPCCEAAA     65408.36  102.06     66080.33  103.10     60773.09   94.82  64087.2600\n6   AAAAAAAAKIBIEAAA     66833.14  100.76     63046.26   95.05     69106.25  104.18  66328.5500\n7   AAAAAAAAECLGAAAA     55509.46  101.63     52355.46   95.86     55978.58  102.49  54614.5000\n8   AAAAAAAAIDCPAAAA     56577.62   96.79     60139.35  102.88     58640.43  100.32  58452.4666\n9   AAAAAAAAIEDKBAAA     61817.58  104.64     57344.36   97.06     58065.73   98.29  59075.8900\n10  AAAAAAAAKKMCDAAA     68328.98  103.35     67363.13  101.89     62635.14   94.74  66109.0833\n11  AAAAAAAABBJBBAAA     65241.42  103.75     60494.40   96.20     62900.02  100.03  62878.6133\n12  AAAAAAAAGIFBCAAA     37945.36   95.64     41105.31  103.60     39971.17  100.74  39673.9466\n13  AAAAAAAANHFFEAAA     56976.78  104.85     53981.32   99.33     52064.03   95.81  54340.7100\n14  AAAAAAAAHKJACAAA     55104.93  101.33     51184.76   94.12     56848.49  104.54  54379.3933\n15  AAAAAAAAMBFDBAAA     50910.46   98.06     52010.12  100.18     52823.77  101.75  51914.7833\n16  AAAAAAAAJOPOAAAA     52253.04  101.35     50038.30   97.05     52376.44  101.59  51555.9266\n17  AAAAAAAAOIMAEAAA     56154.68  103.28     55007.71  101.17     51936.86   95.53  54366.4166\n18  AAAAAAAAPABGDAAA     52927.19  103.29     50844.44   99.22     49945.39   97.47  51239.0066\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018491,
                    "execution_time": 0.008074,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.004129
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058049,
                    "execution_time": 0.008885,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.041063
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAHIBBCAAA     52381.96  102.31     49867.69   97.40     51345.47  100.28  51198.3733\n1   AAAAAAAABPFAEAAA     48025.39  100.44     49487.81  103.50     45921.42   96.04  47811.5400\n2   AAAAAAAAEMHPDAAA     56838.72   99.51     57774.59  101.15     56735.53   99.33  57116.2800\n3   AAAAAAAAMGJEEAAA     40241.33  103.06     38467.07   98.52     38422.74   98.40  39043.7133\n4   AAAAAAAAGNKBCAAA     53620.37   96.43     57494.46  103.40     55690.51  100.15  55601.7800\n5   AAAAAAAAIPCCEAAA     65408.36  102.06     66080.33  103.10     60773.09   94.82  64087.2600\n6   AAAAAAAAKIBIEAAA     66833.14  100.76     63046.26   95.05     69106.25  104.18  66328.5500\n7   AAAAAAAAECLGAAAA     55509.46  101.63     52355.46   95.86     55978.58  102.49  54614.5000\n8   AAAAAAAAIDCPAAAA     56577.62   96.79     60139.35  102.88     58640.43  100.32  58452.4666\n9   AAAAAAAAIEDKBAAA     61817.58  104.64     57344.36   97.06     58065.73   98.29  59075.8900\n10  AAAAAAAAKKMCDAAA     68328.98  103.35     67363.13  101.89     62635.14   94.74  66109.0833\n11  AAAAAAAABBJBBAAA     65241.42  103.75     60494.40   96.20     62900.02  100.03  62878.6133\n12  AAAAAAAAGIFBCAAA     37945.36   95.64     41105.31  103.60     39971.17  100.74  39673.9466\n13  AAAAAAAANHFFEAAA     56976.78  104.85     53981.32   99.33     52064.03   95.81  54340.7100\n14  AAAAAAAAHKJACAAA     55104.93  101.33     51184.76   94.12     56848.49  104.54  54379.3933\n15  AAAAAAAAMBFDBAAA     50910.46   98.06     52010.12  100.18     52823.77  101.75  51914.7833\n16  AAAAAAAAJOPOAAAA     52253.04  101.35     50038.30   97.05     52376.44  101.59  51555.9266\n17  AAAAAAAAOIMAEAAA     56154.68  103.28     55007.71  101.17     51936.86   95.53  54366.4166\n18  AAAAAAAAPABGDAAA     52927.19  103.29     50844.44   99.22     49945.39   97.47  51239.0066\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.826346,
                    "execution_time": 0.707619,
                    "compile_time": 0.000439,
                    "planning_time": 0.006726,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.912143,
                    "execution_time": 0.674485,
                    "compile_time": 0.074529,
                    "planning_time": 0.064988,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIDCPAAAA     56577.62   96.79     60139.35  102.88     58640.43  100.32  58452.4666\n1   AAAAAAAANHFFEAAA     56976.78  104.85     53981.32   99.33     52064.03   95.81  54340.7100\n2   AAAAAAAAGMOBBAAA     58311.42  100.15     60677.30  104.22     55670.53   95.62  58219.7500\n3   AAAAAAAALNLNBAAA     52766.15   97.61     55841.84  103.30     53556.92   99.07  54054.9700\n4   AAAAAAAACBBDEAAA     57234.67   99.74     58917.33  102.67     55994.68   97.58  57382.2266\n5   AAAAAAAAECLGAAAA     55509.46  101.63     52355.46   95.86     55978.58  102.49  54614.5000\n6   AAAAAAAADJMCCAAA     49332.77  103.53     47249.66   99.16     46355.97   97.29  47646.1333\n7   AAAAAAAAHKJACAAA     55104.93  101.33     51184.76   94.12     56848.49  104.54  54379.3933\n8   AAAAAAAAMBFDBAAA     50910.46   98.06     52010.12  100.18     52823.77  101.75  51914.7833\n9   AAAAAAAAJOPOAAAA     52253.04  101.35     50038.30   97.05     52376.44  101.59  51555.9266\n10  AAAAAAAAOIMAEAAA     56154.68  103.28     55007.71  101.17     51936.86   95.53  54366.4166\n11  AAAAAAAADHFBDAAA     55204.19   99.24     52991.16   95.26     58673.28  105.48  55622.8766\n12  AAAAAAAAPLPOAAAA     53434.33  100.82     51379.42   96.94     54182.61  102.23  52998.7866\n13  AAAAAAAAPABGDAAA     52927.19  103.29     50844.44   99.22     49945.39   97.47  51239.0066\n14  AAAAAAAAOBJKBAAA     49447.39  104.50     45599.53   96.36     46906.15   99.13  47317.6900\n15  AAAAAAAAOGOCEAAA     52467.41  102.09     48327.46   94.04     53372.31  103.85  51389.0600\n16  AAAAAAAADIEHAAAA     57033.44  103.36     55503.29  100.59     52991.19   96.04  55175.9733\n17  AAAAAAAAHFKFBAAA     58321.96  102.82     54407.93   95.92     57432.75  101.25  56720.8800\n18  AAAAAAAAKICJCAAA     53216.27  104.83     49455.19   97.42     49610.38   97.73  50760.6133\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018568,
                    "execution_time": 0.007826,
                    "compile_time": 5e-05,
                    "planning_time": 0.004294
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05681,
                    "execution_time": 0.008212,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039994
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIDCPAAAA     56577.62   96.79     60139.35  102.88     58640.43  100.32  58452.4666\n1   AAAAAAAANHFFEAAA     56976.78  104.85     53981.32   99.33     52064.03   95.81  54340.7100\n2   AAAAAAAAGMOBBAAA     58311.42  100.15     60677.30  104.22     55670.53   95.62  58219.7500\n3   AAAAAAAALNLNBAAA     52766.15   97.61     55841.84  103.30     53556.92   99.07  54054.9700\n4   AAAAAAAACBBDEAAA     57234.67   99.74     58917.33  102.67     55994.68   97.58  57382.2266\n5   AAAAAAAAECLGAAAA     55509.46  101.63     52355.46   95.86     55978.58  102.49  54614.5000\n6   AAAAAAAADJMCCAAA     49332.77  103.53     47249.66   99.16     46355.97   97.29  47646.1333\n7   AAAAAAAAHKJACAAA     55104.93  101.33     51184.76   94.12     56848.49  104.54  54379.3933\n8   AAAAAAAAMBFDBAAA     50910.46   98.06     52010.12  100.18     52823.77  101.75  51914.7833\n9   AAAAAAAAJOPOAAAA     52253.04  101.35     50038.30   97.05     52376.44  101.59  51555.9266\n10  AAAAAAAAOIMAEAAA     56154.68  103.28     55007.71  101.17     51936.86   95.53  54366.4166\n11  AAAAAAAADHFBDAAA     55204.19   99.24     52991.16   95.26     58673.28  105.48  55622.8766\n12  AAAAAAAAPLPOAAAA     53434.33  100.82     51379.42   96.94     54182.61  102.23  52998.7866\n13  AAAAAAAAPABGDAAA     52927.19  103.29     50844.44   99.22     49945.39   97.47  51239.0066\n14  AAAAAAAAOBJKBAAA     49447.39  104.50     45599.53   96.36     46906.15   99.13  47317.6900\n15  AAAAAAAAOGOCEAAA     52467.41  102.09     48327.46   94.04     53372.31  103.85  51389.0600\n16  AAAAAAAADIEHAAAA     57033.44  103.36     55503.29  100.59     52991.19   96.04  55175.9733\n17  AAAAAAAAHFKFBAAA     58321.96  102.82     54407.93   95.92     57432.75  101.25  56720.8800\n18  AAAAAAAAKICJCAAA     53216.27  104.83     49455.19   97.42     49610.38   97.73  50760.6133\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.144654,
                    "execution_time": 0.082633,
                    "compile_time": 0.014128,
                    "planning_time": 0.015251,
                    "create_size": 1397
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.93196,
                    "execution_time": 0.082186,
                    "compile_time": 3.737054,
                    "planning_time": 0.075736,
                    "create_size": 1397
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAMFKABAAA     66584.88   98.09     68454.07  100.84     68593.61  101.05  67877.5200\n1   AAAAAAAAHIBBCAAA     52381.96  102.31     49867.69   97.40     51345.47  100.28  51198.3733\n2   AAAAAAAABPFAEAAA     48025.39  100.44     49487.81  103.50     45921.42   96.04  47811.5400\n3   AAAAAAAAEMHPDAAA     56838.72   99.51     57774.59  101.15     56735.53   99.33  57116.2800\n4   AAAAAAAAMGJEEAAA     40241.33  103.06     38467.07   98.52     38422.74   98.40  39043.7133\n5   AAAAAAAAGNKBCAAA     53620.37   96.43     57494.46  103.40     55690.51  100.15  55601.7800\n6   AAAAAAAAIPCCEAAA     65408.36  102.06     66080.33  103.10     60773.09   94.82  64087.2600\n7   AAAAAAAAOOAPAAAA     60341.06  105.75     54910.36   96.23     55925.98   98.01  57059.1333\n8   AAAAAAAABFJOCAAA     50346.09  102.81     50313.10  102.74     46250.11   94.44  48969.7666\n9   AAAAAAAAHDAMAAAA     49636.85  102.84     45361.61   93.98     49798.66  103.17  48265.7066\n10  AAAAAAAAKIBIEAAA     66833.14  100.76     63046.26   95.05     69106.25  104.18  66328.5500\n11  AAAAAAAAECLGAAAA     55509.46  101.63     52355.46   95.86     55978.58  102.49  54614.5000\n12  AAAAAAAAGMOBBAAA     58311.42  100.15     60677.30  104.22     55670.53   95.62  58219.7500\n13  AAAAAAAABILEEAAA     48350.18   95.43     51397.67  101.44     52242.92  103.11  50663.5900\n14  AAAAAAAALNLNBAAA     52766.15   97.61     55841.84  103.30     53556.92   99.07  54054.9700\n15  AAAAAAAAIKOHBAAA     44354.83   95.90     47925.19  103.62     46459.63  100.46  46246.5500\n16  AAAAAAAAGFAPAAAA     60197.51  103.98     57435.01   99.21     56031.69   96.79  57888.0700\n17  AAAAAAAAGMHNAAAA     58578.91   99.87     59620.80  101.65     57749.00   98.46  58649.5700\n18  AAAAAAAAJIBJEAAA     45674.51  102.74     42407.97   95.39     45283.19  101.86  44455.2233\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019629,
                    "execution_time": 0.008568,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.004206
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056603,
                    "execution_time": 0.008613,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.03998
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAMFKABAAA     66584.88   98.09     68454.07  100.84     68593.61  101.05  67877.5200\n1   AAAAAAAAHIBBCAAA     52381.96  102.31     49867.69   97.40     51345.47  100.28  51198.3733\n2   AAAAAAAABPFAEAAA     48025.39  100.44     49487.81  103.50     45921.42   96.04  47811.5400\n3   AAAAAAAAEMHPDAAA     56838.72   99.51     57774.59  101.15     56735.53   99.33  57116.2800\n4   AAAAAAAAMGJEEAAA     40241.33  103.06     38467.07   98.52     38422.74   98.40  39043.7133\n5   AAAAAAAAGNKBCAAA     53620.37   96.43     57494.46  103.40     55690.51  100.15  55601.7800\n6   AAAAAAAAIPCCEAAA     65408.36  102.06     66080.33  103.10     60773.09   94.82  64087.2600\n7   AAAAAAAAOOAPAAAA     60341.06  105.75     54910.36   96.23     55925.98   98.01  57059.1333\n8   AAAAAAAABFJOCAAA     50346.09  102.81     50313.10  102.74     46250.11   94.44  48969.7666\n9   AAAAAAAAHDAMAAAA     49636.85  102.84     45361.61   93.98     49798.66  103.17  48265.7066\n10  AAAAAAAAKIBIEAAA     66833.14  100.76     63046.26   95.05     69106.25  104.18  66328.5500\n11  AAAAAAAAECLGAAAA     55509.46  101.63     52355.46   95.86     55978.58  102.49  54614.5000\n12  AAAAAAAAGMOBBAAA     58311.42  100.15     60677.30  104.22     55670.53   95.62  58219.7500\n13  AAAAAAAABILEEAAA     48350.18   95.43     51397.67  101.44     52242.92  103.11  50663.5900\n14  AAAAAAAALNLNBAAA     52766.15   97.61     55841.84  103.30     53556.92   99.07  54054.9700\n15  AAAAAAAAIKOHBAAA     44354.83   95.90     47925.19  103.62     46459.63  100.46  46246.5500\n16  AAAAAAAAGFAPAAAA     60197.51  103.98     57435.01   99.21     56031.69   96.79  57888.0700\n17  AAAAAAAAGMHNAAAA     58578.91   99.87     59620.80  101.65     57749.00   98.46  58649.5700\n18  AAAAAAAAJIBJEAAA     45674.51  102.74     42407.97   95.39     45283.19  101.86  44455.2233\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAAMPCAAA     54499.29   95.67     58963.58  103.51     57425.38  100.81  56962.7500\n1   AAAAAAAAABBFEAAA     72403.64  100.19     73583.65  101.82     70811.27   97.98  72266.1866\n2   AAAAAAAAABFBEAAA     30966.08   98.39     31396.14   99.76     32046.96  101.83  31469.7266\n3   AAAAAAAAACBEEAAA     50551.27   95.78     52467.38   99.41     55308.03  104.79  52775.5600\n4   AAAAAAAAACFJBAAA     44439.63  102.79     44506.10  102.94     40749.70   94.25  43231.8100\n5   AAAAAAAAACINDAAA     61347.18  102.10     61702.32  102.69     57204.52   95.20  60084.6733\n6   AAAAAAAAADIDAAAA     57550.03  100.72     57780.32  101.12     56080.03   98.15  57136.7933\n7   AAAAAAAAADNGEAAA     46261.70  100.16     46108.40   99.83     46186.49  100.00  46185.5300\n8   AAAAAAAAAEBOAAAA     59785.41   97.68     59387.61   97.03     64431.44  105.27  61201.4866\n9   AAAAAAAAAECBAAAA     63337.78  102.55     62056.93  100.47     59891.83   96.97  61762.1800\n10  AAAAAAAAAFGMDAAA     41829.50  104.38     39730.55   99.14     38656.38   96.46  40072.1433\n11  AAAAAAAAAGJBAAAA     64622.84  100.37     64407.15  100.04     64112.50   99.58  64380.8300\n12  AAAAAAAAAGOBCAAA     34085.16   94.70     37285.20  103.59     36598.69  101.69  35989.6833\n13  AAAAAAAAAGPDBAAA     57035.08  100.83     53936.89   95.35     58723.57  103.81  56565.1800\n14  AAAAAAAAAHOJBAAA     50358.37  103.07     49861.51  102.05     46350.89   94.87  48856.9233\n15  AAAAAAAAAIDMAAAA     61288.80   98.23     62753.15  100.57     63135.81  101.19  62392.5866\n16  AAAAAAAAAIIAAAAA     51795.34   99.25     53796.09  103.08     50962.39   97.65  52184.6066\n17  AAAAAAAAAJENCAAA     54974.26   96.48     59546.69  104.51     56402.05   98.99  56974.3333\n18  AAAAAAAAAJLDDAAA     52637.50   99.53     53782.81  101.69     52232.36   98.76  52884.2233\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020868,
                    "execution_time": 0.010405,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004179
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.181291,
                    "execution_time": 0.010346,
                    "compile_time": 0.12399,
                    "planning_time": 0.039799
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAAMPCAAA     54499.29   95.67     58963.58  103.51     57425.38  100.81  56962.7500\n1   AAAAAAAAABBFEAAA     72403.64  100.19     73583.65  101.82     70811.27   97.98  72266.1866\n2   AAAAAAAAABFBEAAA     30966.08   98.39     31396.14   99.76     32046.96  101.83  31469.7266\n3   AAAAAAAAACBEEAAA     50551.27   95.78     52467.38   99.41     55308.03  104.79  52775.5600\n4   AAAAAAAAACFJBAAA     44439.63  102.79     44506.10  102.94     40749.70   94.25  43231.8100\n5   AAAAAAAAACINDAAA     61347.18  102.10     61702.32  102.69     57204.52   95.20  60084.6733\n6   AAAAAAAAADIDAAAA     57550.03  100.72     57780.32  101.12     56080.03   98.15  57136.7933\n7   AAAAAAAAADNGEAAA     46261.70  100.16     46108.40   99.83     46186.49  100.00  46185.5300\n8   AAAAAAAAAEBOAAAA     59785.41   97.68     59387.61   97.03     64431.44  105.27  61201.4866\n9   AAAAAAAAAECBAAAA     63337.78  102.55     62056.93  100.47     59891.83   96.97  61762.1800\n10  AAAAAAAAAFGMDAAA     41829.50  104.38     39730.55   99.14     38656.38   96.46  40072.1433\n11  AAAAAAAAAGJBAAAA     64622.84  100.37     64407.15  100.04     64112.50   99.58  64380.8300\n12  AAAAAAAAAGOBCAAA     34085.16   94.70     37285.20  103.59     36598.69  101.69  35989.6833\n13  AAAAAAAAAGPDBAAA     57035.08  100.83     53936.89   95.35     58723.57  103.81  56565.1800\n14  AAAAAAAAAHOJBAAA     50358.37  103.07     49861.51  102.05     46350.89   94.87  48856.9233\n15  AAAAAAAAAIDMAAAA     61288.80   98.23     62753.15  100.57     63135.81  101.19  62392.5866\n16  AAAAAAAAAIIAAAAA     51795.34   99.25     53796.09  103.08     50962.39   97.65  52184.6066\n17  AAAAAAAAAJENCAAA     54974.26   96.48     59546.69  104.51     56402.05   98.99  56974.3333\n18  AAAAAAAAAJLDDAAA     52637.50   99.53     53782.81  101.69     52232.36   98.76  52884.2233\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" , \"SS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAAMPCAAA     54499.29   95.67     58963.58  103.51     57425.38  100.81  56962.7500\n1   AAAAAAAAABBFEAAA     72403.64  100.19     73583.65  101.82     70811.27   97.98  72266.1866\n2   AAAAAAAAABFBEAAA     30966.08   98.39     31396.14   99.76     32046.96  101.83  31469.7266\n3   AAAAAAAAACBEEAAA     50551.27   95.78     52467.38   99.41     55308.03  104.79  52775.5600\n4   AAAAAAAAACFJBAAA     44439.63  102.79     44506.10  102.94     40749.70   94.25  43231.8100\n5   AAAAAAAAACINDAAA     61347.18  102.10     61702.32  102.69     57204.52   95.20  60084.6733\n6   AAAAAAAAADIDAAAA     57550.03  100.72     57780.32  101.12     56080.03   98.15  57136.7933\n7   AAAAAAAAADNGEAAA     46261.70  100.16     46108.40   99.83     46186.49  100.00  46185.5300\n8   AAAAAAAAAEBOAAAA     59785.41   97.68     59387.61   97.03     64431.44  105.27  61201.4866\n9   AAAAAAAAAECBAAAA     63337.78  102.55     62056.93  100.47     59891.83   96.97  61762.1800\n10  AAAAAAAAAFGMDAAA     41829.50  104.38     39730.55   99.14     38656.38   96.46  40072.1433\n11  AAAAAAAAAGJBAAAA     64622.84  100.37     64407.15  100.04     64112.50   99.58  64380.8300\n12  AAAAAAAAAGOBCAAA     34085.16   94.70     37285.20  103.59     36598.69  101.69  35989.6833\n13  AAAAAAAAAGPDBAAA     57035.08  100.83     53936.89   95.35     58723.57  103.81  56565.1800\n14  AAAAAAAAAHOJBAAA     50358.37  103.07     49861.51  102.05     46350.89   94.87  48856.9233\n15  AAAAAAAAAIDMAAAA     61288.80   98.23     62753.15  100.57     63135.81  101.19  62392.5866\n16  AAAAAAAAAIIAAAAA     51795.34   99.25     53796.09  103.08     50962.39   97.65  52184.6066\n17  AAAAAAAAAJENCAAA     54974.26   96.48     59546.69  104.51     56402.05   98.99  56974.3333\n18  AAAAAAAAAJLDDAAA     52637.50   99.53     53782.81  101.69     52232.36   98.76  52884.2233\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022058,
                    "execution_time": 0.010252,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.005061
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.145674,
                    "execution_time": 0.010117,
                    "compile_time": 0.088982,
                    "planning_time": 0.039901
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAAMPCAAA     54499.29   95.67     58963.58  103.51     57425.38  100.81  56962.7500\n1   AAAAAAAAABBFEAAA     72403.64  100.19     73583.65  101.82     70811.27   97.98  72266.1866\n2   AAAAAAAAABFBEAAA     30966.08   98.39     31396.14   99.76     32046.96  101.83  31469.7266\n3   AAAAAAAAACBEEAAA     50551.27   95.78     52467.38   99.41     55308.03  104.79  52775.5600\n4   AAAAAAAAACFJBAAA     44439.63  102.79     44506.10  102.94     40749.70   94.25  43231.8100\n5   AAAAAAAAACINDAAA     61347.18  102.10     61702.32  102.69     57204.52   95.20  60084.6733\n6   AAAAAAAAADIDAAAA     57550.03  100.72     57780.32  101.12     56080.03   98.15  57136.7933\n7   AAAAAAAAADNGEAAA     46261.70  100.16     46108.40   99.83     46186.49  100.00  46185.5300\n8   AAAAAAAAAEBOAAAA     59785.41   97.68     59387.61   97.03     64431.44  105.27  61201.4866\n9   AAAAAAAAAECBAAAA     63337.78  102.55     62056.93  100.47     59891.83   96.97  61762.1800\n10  AAAAAAAAAFGMDAAA     41829.50  104.38     39730.55   99.14     38656.38   96.46  40072.1433\n11  AAAAAAAAAGJBAAAA     64622.84  100.37     64407.15  100.04     64112.50   99.58  64380.8300\n12  AAAAAAAAAGOBCAAA     34085.16   94.70     37285.20  103.59     36598.69  101.69  35989.6833\n13  AAAAAAAAAGPDBAAA     57035.08  100.83     53936.89   95.35     58723.57  103.81  56565.1800\n14  AAAAAAAAAHOJBAAA     50358.37  103.07     49861.51  102.05     46350.89   94.87  48856.9233\n15  AAAAAAAAAIDMAAAA     61288.80   98.23     62753.15  100.57     63135.81  101.19  62392.5866\n16  AAAAAAAAAIIAAAAA     51795.34   99.25     53796.09  103.08     50962.39   97.65  52184.6066\n17  AAAAAAAAAJENCAAA     54974.26   96.48     59546.69  104.51     56402.05   98.99  56974.3333\n18  AAAAAAAAAJLDDAAA     52637.50   99.53     53782.81  101.69     52232.36   98.76  52884.2233\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" , \"SS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAAMPCAAA     54499.29   95.67     58963.58  103.51     57425.38  100.81  56962.7500\n1   AAAAAAAAABBFEAAA     72403.64  100.19     73583.65  101.82     70811.27   97.98  72266.1866\n2   AAAAAAAAABFBEAAA     30966.08   98.39     31396.14   99.76     32046.96  101.83  31469.7266\n3   AAAAAAAAACBEEAAA     50551.27   95.78     52467.38   99.41     55308.03  104.79  52775.5600\n4   AAAAAAAAACFJBAAA     44439.63  102.79     44506.10  102.94     40749.70   94.25  43231.8100\n5   AAAAAAAAACINDAAA     61347.18  102.10     61702.32  102.69     57204.52   95.20  60084.6733\n6   AAAAAAAAADIDAAAA     57550.03  100.72     57780.32  101.12     56080.03   98.15  57136.7933\n7   AAAAAAAAADNGEAAA     46261.70  100.16     46108.40   99.83     46186.49  100.00  46185.5300\n8   AAAAAAAAAEBOAAAA     59785.41   97.68     59387.61   97.03     64431.44  105.27  61201.4866\n9   AAAAAAAAAECBAAAA     63337.78  102.55     62056.93  100.47     59891.83   96.97  61762.1800\n10  AAAAAAAAAFGMDAAA     41829.50  104.38     39730.55   99.14     38656.38   96.46  40072.1433\n11  AAAAAAAAAGJBAAAA     64622.84  100.37     64407.15  100.04     64112.50   99.58  64380.8300\n12  AAAAAAAAAGOBCAAA     34085.16   94.70     37285.20  103.59     36598.69  101.69  35989.6833\n13  AAAAAAAAAGPDBAAA     57035.08  100.83     53936.89   95.35     58723.57  103.81  56565.1800\n14  AAAAAAAAAHOJBAAA     50358.37  103.07     49861.51  102.05     46350.89   94.87  48856.9233\n15  AAAAAAAAAIDMAAAA     61288.80   98.23     62753.15  100.57     63135.81  101.19  62392.5866\n16  AAAAAAAAAIIAAAAA     51795.34   99.25     53796.09  103.08     50962.39   97.65  52184.6066\n17  AAAAAAAAAJENCAAA     54974.26   96.48     59546.69  104.51     56402.05   98.99  56974.3333\n18  AAAAAAAAAJLDDAAA     52637.50   99.53     53782.81  101.69     52232.36   98.76  52884.2233\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021402,
                    "execution_time": 0.010282,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004547
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021521,
                    "execution_time": 0.010399,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004504
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAAMPCAAA     54499.29   95.67     58963.58  103.51     57425.38  100.81  56962.7500\n1   AAAAAAAAABBFEAAA     72403.64  100.19     73583.65  101.82     70811.27   97.98  72266.1866\n2   AAAAAAAAABFBEAAA     30966.08   98.39     31396.14   99.76     32046.96  101.83  31469.7266\n3   AAAAAAAAACBEEAAA     50551.27   95.78     52467.38   99.41     55308.03  104.79  52775.5600\n4   AAAAAAAAACFJBAAA     44439.63  102.79     44506.10  102.94     40749.70   94.25  43231.8100\n5   AAAAAAAAACINDAAA     61347.18  102.10     61702.32  102.69     57204.52   95.20  60084.6733\n6   AAAAAAAAADIDAAAA     57550.03  100.72     57780.32  101.12     56080.03   98.15  57136.7933\n7   AAAAAAAAADNGEAAA     46261.70  100.16     46108.40   99.83     46186.49  100.00  46185.5300\n8   AAAAAAAAAEBOAAAA     59785.41   97.68     59387.61   97.03     64431.44  105.27  61201.4866\n9   AAAAAAAAAECBAAAA     63337.78  102.55     62056.93  100.47     59891.83   96.97  61762.1800\n10  AAAAAAAAAFGMDAAA     41829.50  104.38     39730.55   99.14     38656.38   96.46  40072.1433\n11  AAAAAAAAAGJBAAAA     64622.84  100.37     64407.15  100.04     64112.50   99.58  64380.8300\n12  AAAAAAAAAGOBCAAA     34085.16   94.70     37285.20  103.59     36598.69  101.69  35989.6833\n13  AAAAAAAAAGPDBAAA     57035.08  100.83     53936.89   95.35     58723.57  103.81  56565.1800\n14  AAAAAAAAAHOJBAAA     50358.37  103.07     49861.51  102.05     46350.89   94.87  48856.9233\n15  AAAAAAAAAIDMAAAA     61288.80   98.23     62753.15  100.57     63135.81  101.19  62392.5866\n16  AAAAAAAAAIIAAAAA     51795.34   99.25     53796.09  103.08     50962.39   97.65  52184.6066\n17  AAAAAAAAAJENCAAA     54974.26   96.48     59546.69  104.51     56402.05   98.99  56974.3333\n18  AAAAAAAAAJLDDAAA     52637.50   99.53     53782.81  101.69     52232.36   98.76  52884.2233\n...*/"
    }
]