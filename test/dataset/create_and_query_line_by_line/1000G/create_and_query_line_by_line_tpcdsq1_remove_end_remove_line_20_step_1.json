[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n-- Assuming date_dim is part of the schema, fixing missed join syntax\njoin date_dim on sr_returned_date_sk = d_date_sk\nwhere d_year = 1999\ngroup by sr_customer_sk, sr_store_sk\n) /* End of CTE */\nselect *\nfrom customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.924844,
                    "execution_time": 2.632622,
                    "compile_time": 0.000378,
                    "planning_time": 0.030845,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.593014,
                    "execution_time": 7.222122,
                    "compile_time": 0.004401,
                    "planning_time": 0.033758,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0          11625977            61            618.44\n1           5063702           446            226.25\n2           2813830           223            319.18\n3          10161302           349            919.02\n4           9247592           421            458.26\n5           5898881           752           2028.62\n6           2470449           572           3356.57\n7           7754769           841            739.27\n8           7742529           820           2290.51\n9           9181330           100            399.60\n10          9679880             7            759.94\n11          2259390            80            570.47\n12          4044500           115             42.40\n13          2024658           949             29.42\n14         11690076            68            319.97\n15         10216867           697           2451.02\n16           759337           734           4422.23\n17          5015872           484             95.68\n18           407295           517           5739.87\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016221,
                    "execution_time": 0.007416,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003048
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052883,
                    "execution_time": 0.007725,
                    "compile_time": 0.000994,
                    "planning_time": 0.03771
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0          11625977            61            618.44\n1           5063702           446            226.25\n2           2813830           223            319.18\n3          10161302           349            919.02\n4           9247592           421            458.26\n5           5898881           752           2028.62\n6           2470449           572           3356.57\n7           7754769           841            739.27\n8           7742529           820           2290.51\n9           9181330           100            399.60\n10          9679880             7            759.94\n11          2259390            80            570.47\n12          4044500           115             42.40\n13          2024658           949             29.42\n14         11690076            68            319.97\n15         10216867           697           2451.02\n16           759337           734           4422.23\n17          5015872           484             95.68\n18           407295           517           5739.87\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\nselect * from customer_total_return /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0           7622606           427           3306.98\n1           6904320            68            928.99\n2           7676517           884            605.64\n3           6160322           571           1225.07\n4           2853363           428           1466.10\n5           9083679           536             47.00\n6           8633747           643           3183.49\n7            438744           493           1505.64\n8          11924794           307              0.40\n9            827694           302           1033.91\n10         10910078           646            748.48\n11           142913           316             44.71\n12         10478178           692            393.70\n13          1486350           247           1285.13\n14         10453374           859            130.79\n15         11290257           398           1701.68\n16          2069762           706             28.18\n17          9054143           652            929.49\n18          7489210           790           1166.71\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016856,
                    "execution_time": 0.00766,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017049,
                    "execution_time": 0.007494,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003236
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0           7622606           427           3306.98\n1           6904320            68            928.99\n2           7676517           884            605.64\n3           6160322           571           1225.07\n4           2853363           428           1466.10\n5           9083679           536             47.00\n6           8633747           643           3183.49\n7            438744           493           1505.64\n8          11924794           307              0.40\n9            827694           302           1033.91\n10         10910078           646            748.48\n11           142913           316             44.71\n12         10478178           692            393.70\n13          1486350           247           1285.13\n14         10453374           859            130.79\n15         11290257           398           1701.68\n16          2069762           706             28.18\n17          9054143           652            929.49\n18          7489210           790           1166.71\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n-- Assuming date_dim is a valid table with the necessary columns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select ctr_customer_sk\nfrom customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.720954,
                    "execution_time": 0.646932,
                    "compile_time": 0.000248,
                    "planning_time": 0.002672,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.777927,
                    "execution_time": 0.643191,
                    "compile_time": 0.001949,
                    "planning_time": 0.057802,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk\n0           4885373\n1           6531701\n2           3658337\n3           1960930\n4            415048\n5           2563438\n6           7128407\n7           7246778\n8           4949275\n9           1523915\n10          5491632\n11          3741693\n12          6509004\n13          3272616\n14          1169862\n15          5067270\n16          5686483\n17          5507932\n18          9598132\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015116,
                    "execution_time": 0.00685,
                    "compile_time": 4e-05,
                    "planning_time": 0.002732
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052599,
                    "execution_time": 0.007484,
                    "compile_time": 0.001002,
                    "planning_time": 0.037357
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk\n0           4885373\n1           6531701\n2           3658337\n3           1960930\n4            415048\n5           2563438\n6           7128407\n7           7246778\n8           4949275\n9           1523915\n10          5491632\n11          3741693\n12          6509004\n13          3272616\n14          1169862\n15          5067270\n16          5686483\n17          5507932\n18          9598132\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select ctr_customer_sk, ctr_store_sk\nfrom customer_total_return ctr1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.910574,
                    "execution_time": 0.795114,
                    "compile_time": 0.000244,
                    "planning_time": 0.002869,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.007181,
                    "execution_time": 0.834151,
                    "compile_time": 0.000248,
                    "planning_time": 0.058845,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk\n0           2544739           124\n1           4029327           602\n2            225029           319\n3           7118616           421\n4           7330521           817\n5            406665           260\n6           3773938           259\n7           6798589           968\n8           8089397            49\n9           2103323            25\n10         11832649           205\n11          4527679           122\n12          2331763           472\n13          4597321           634\n14          2355219           506\n15         11593371           796\n16          6987238           830\n17          9238151           104\n18          2297566           242\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016869,
                    "execution_time": 0.007393,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.002994
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053098,
                    "execution_time": 0.007695,
                    "compile_time": 0.000985,
                    "planning_time": 0.037549
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\"",
                "rewrite": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk\n0           2544739           124\n1           4029327           602\n2            225029           319\n3           7118616           421\n4           7330521           817\n5            406665           260\n6           3773938           259\n7           6798589           968\n8           8089397            49\n9           2103323            25\n10         11832649           205\n11          4527679           122\n12          2331763           472\n13          4597321           634\n14          2355219           506\n15         11593371           796\n16          6987238           830\n17          9238151           104\n18          2297566           242\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  ctr_customer_sk\nfrom customer_total_return ctr1\n,store\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk\n0           4885373\n1           4885373\n2           4885373\n3           4885373\n4           4885373\n5           4885373\n6           4885373\n7           4885373\n8           4885373\n9           4885373\n10          4885373\n11          4885373\n12          4885373\n13          4885373\n14          4885373\n15          4885373\n16          4885373\n17          4885373\n18          4885373\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043947,
                    "execution_time": 0.010889,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.025789
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.100907,
                    "execution_time": 0.010048,
                    "compile_time": 0.001024,
                    "planning_time": 0.081616
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "rewrite": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk\n0           4885373\n1           4885373\n2           4885373\n3           4885373\n4           4885373\n5           4885373\n6           4885373\n7           4885373\n8           4885373\n9           4885373\n10          4885373\n11          4885373\n12          4885373\n13          4885373\n14          4885373\n15          4885373\n16          4885373\n17          4885373\n18          4885373\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT MAX ( 1 ) AS \"_\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT MAX ( 1 ) AS \"_\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.8373,
                    "execution_time": 1.752862,
                    "compile_time": 0.000369,
                    "planning_time": 0.034388,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.947632,
                    "execution_time": 1.796929,
                    "compile_time": 0.00227,
                    "planning_time": 0.097495,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LIMIT 21",
                "preview": "\n/*       c_customer_id\n0   AAAAAAAACNOHKJAA\n1   AAAAAAAACNOHKJAA\n2   AAAAAAAACNOHKJAA\n3   AAAAAAAACNOHKJAA\n4   AAAAAAAACNOHKJAA\n5   AAAAAAAACNOHKJAA\n6   AAAAAAAACNOHKJAA\n7   AAAAAAAACNOHKJAA\n8   AAAAAAAACNOHKJAA\n9   AAAAAAAACNOHKJAA\n10  AAAAAAAACNOHKJAA\n11  AAAAAAAACNOHKJAA\n12  AAAAAAAACNOHKJAA\n13  AAAAAAAACNOHKJAA\n14  AAAAAAAACNOHKJAA\n15  AAAAAAAACNOHKJAA\n16  AAAAAAAACNOHKJAA\n17  AAAAAAAACNOHKJAA\n18  AAAAAAAACNOHKJAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.315299,
                    "execution_time": 0.262651,
                    "compile_time": 0.000127,
                    "planning_time": 0.044342
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.364786,
                    "execution_time": 0.255079,
                    "compile_time": 0.001262,
                    "planning_time": 0.089506
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\""
            }
        ],
        "preview": "\n/*       c_customer_id\n0   AAAAAAAACNOHKJAA\n1   AAAAAAAACNOHKJAA\n2   AAAAAAAACNOHKJAA\n3   AAAAAAAACNOHKJAA\n4   AAAAAAAACNOHKJAA\n5   AAAAAAAACNOHKJAA\n6   AAAAAAAACNOHKJAA\n7   AAAAAAAACNOHKJAA\n8   AAAAAAAACNOHKJAA\n9   AAAAAAAACNOHKJAA\n10  AAAAAAAACNOHKJAA\n11  AAAAAAAACNOHKJAA\n12  AAAAAAAACNOHKJAA\n13  AAAAAAAACNOHKJAA\n14  AAAAAAAACNOHKJAA\n15  AAAAAAAACNOHKJAA\n16  AAAAAAAACNOHKJAA\n17  AAAAAAAACNOHKJAA\n18  AAAAAAAACNOHKJAA\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.082145,
                    "execution_time": 0.913549,
                    "compile_time": 0.000254,
                    "planning_time": 0.002744,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.171452,
                    "execution_time": 0.948832,
                    "compile_time": 0.000246,
                    "planning_time": 0.057413,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_5\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093496,
                    "execution_time": 0.064928,
                    "compile_time": 0.000294,
                    "planning_time": 0.00324,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154652,
                    "execution_time": 0.066571,
                    "compile_time": 0.00134,
                    "planning_time": 0.061145,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.094632,
                    "execution_time": 0.066085,
                    "compile_time": 0.00029,
                    "planning_time": 0.003283,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.24424,
                    "execution_time": 0.159242,
                    "compile_time": 0.000293,
                    "planning_time": 0.058565,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.272275,
                    "execution_time": 1.049888,
                    "compile_time": 0.000266,
                    "planning_time": 0.002939,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.565652,
                    "execution_time": 1.124277,
                    "compile_time": 0.150422,
                    "planning_time": 0.064167,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.14427,
                    "execution_time": 0.114857,
                    "compile_time": 0.00028,
                    "planning_time": 0.003698,
                    "create_size": 625
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.206318,
                    "execution_time": 0.115218,
                    "compile_time": 0.003556,
                    "planning_time": 0.05941,
                    "create_size": 625
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.147906,
                    "execution_time": 0.085627,
                    "compile_time": 0.000354,
                    "planning_time": 0.035152,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.820603,
                    "execution_time": 0.674759,
                    "compile_time": 0.006777,
                    "planning_time": 0.110355,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016281,
                    "execution_time": 0.006764,
                    "compile_time": 4e-05,
                    "planning_time": 0.003866
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052939,
                    "execution_time": 0.00699,
                    "compile_time": 0.001006,
                    "planning_time": 0.03858
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.143379,
                    "execution_time": 0.114169,
                    "compile_time": 0.000268,
                    "planning_time": 0.003802,
                    "create_size": 625
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.257623,
                    "execution_time": 0.173057,
                    "compile_time": 0.000268,
                    "planning_time": 0.058232,
                    "create_size": 625
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.104511,
                    "execution_time": 0.038063,
                    "compile_time": 0.000375,
                    "planning_time": 0.037135,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.411716,
                    "execution_time": 0.272896,
                    "compile_time": 0.004498,
                    "planning_time": 0.102604,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016901,
                    "execution_time": 0.007466,
                    "compile_time": 4e-05,
                    "planning_time": 0.003757
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052001,
                    "execution_time": 0.007139,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038871
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"C_CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017354,
                    "execution_time": 0.007648,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.004058
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054054,
                    "execution_time": 0.007908,
                    "compile_time": 0.001825,
                    "planning_time": 0.038945
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"C_CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01991,
                    "execution_time": 0.008752,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.004303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017972,
                    "execution_time": 0.007892,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.004397
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    }
]