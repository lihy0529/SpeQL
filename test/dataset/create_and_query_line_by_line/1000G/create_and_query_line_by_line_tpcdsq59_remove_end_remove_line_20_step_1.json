[
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nWITH /* TPC-DS query59.tpl 0.30 */ wss AS \n (SELECT d_week_seq,\n        ss_store_sk,\n        SUM(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales,\n        SUM(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales,\n        SUM(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales,\n        SUM(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales,\n        SUM(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales,\n        SUM(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales,\n        SUM(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales\n FROM store_sales, date_dim\n WHERE d_date_sk = ss_sold_date_sk\n GROUP BY d_week_seq, ss_store_sk\n ),\n store_info AS (\n  SELECT s_store_name,\n         s_store_id,\n         wss.d_week_seq,\n         sun_sales,\n         mon_sales,\n         tue_sales,\n         wed_sales,\n         thu_sales,\n         fri_sales,\n         sat_sales\n  FROM wss\n  JOIN store ON store.s_store_sk = wss.ss_store_sk\n )\n SELECT s_store_name1, s_store_id1, d_week_seq1,\n        sun_sales1/sun_sales2 AS sun_sales_ratio,\n        mon_sales1/mon_sales2 AS mon_sales_ratio,\n        tue_sales1/tue_sales2 AS tue_sales_ratio,\n        wed_sales1/wed_sales2 AS wed_sales_ratio,\n        thu_sales1/thu_sales2 AS thu_sales_ratio,\n        fri_sales1/fri_sales2 AS fri_sales_ratio,\n        sat_sales1/sat_sales2 AS sat_sales_ratio\n FROM\n (SELECT s_store_name AS s_store_name1,\n         d_week_seq AS d_week_seq1,\n         s_store_id AS s_store_id1,\n         sun_sales AS sun_sales1,\n         mon_sales AS mon_sales1,\n         tue_sales AS tue_sales1,\n         wed_sales AS wed_sales1,\n         thu_sales AS thu_sales1,\n         fri_sales AS fri_sales1,\n         sat_sales AS sat_sales1\n  FROM store_info\n  WHERE s_store_name = 'Store A') AS t1\n JOIN\n (SELECT s_store_name AS s_store_name2,\n         d_week_seq AS d_week_seq2,\n         s_store_id AS s_store_id2,\n         sun_sales AS sun_sales2,\n         mon_sales AS mon_sales2,\n         tue_sales AS tue_sales2,\n         wed_sales AS wed_sales2,\n         thu_sales AS thu_sales2,\n         fri_sales AS fri_sales2,\n         sat_sales AS sat_sales2\n  FROM store_info\n  WHERE s_store_name = 'Store B') AS t2\n ON t1.d_week_seq1 = t2.d_week_seq2;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"STORE_INFO\" AS ( SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE_INFO\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE_INFO\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"STORE_INFO\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE_INFO\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"STORE_INFO\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"STORE_INFO\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"STORE_INFO\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"STORE_INFO\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"STORE_INFO\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"STORE_INFO\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"STORE_INFO\" AS \"STORE_INFO\" JOIN \"STORE_INFO\" AS \"STORE_INFO_2\" ON \"STORE_INFO\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"STORE_INFO\".\"S_STORE_NAME\" = 'Store A'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 17.031279,
                    "execution_time": 16.29057,
                    "compile_time": 0.000501,
                    "planning_time": 0.048085,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 17.673548,
                    "execution_time": 16.733755,
                    "compile_time": 0.149783,
                    "planning_time": 0.109,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.949938,
                    "execution_time": 0.132038,
                    "compile_time": 0.034521,
                    "planning_time": 0.032617,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.446347,
                    "execution_time": 0.134677,
                    "compile_time": 3.464688,
                    "planning_time": 0.091415,
                    "create_size": 1664
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"STORE_INFO_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" = 'Store A'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.079593,
                    "execution_time": 0.041227,
                    "compile_time": 0.000289,
                    "planning_time": 0.010011,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.3987,
                    "execution_time": 0.040757,
                    "compile_time": 0.250611,
                    "planning_time": 0.075686,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [s_store_name1, s_store_id1, d_week_seq1, sun_sales_ratio, mon_sales_ratio, tue_sales_ratio, wed_sales_ratio, thu_sales_ratio, fri_sales_ratio, sat_sales_ratio]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019717,
                    "execution_time": 0.007511,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.005629
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058702,
                    "execution_time": 0.007944,
                    "compile_time": 0.001164,
                    "planning_time": 0.041595
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"STORE_INFO_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" = 'Store A'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [s_store_name1, s_store_id1, d_week_seq1, sun_sales_ratio, mon_sales_ratio, tue_sales_ratio, wed_sales_ratio, thu_sales_ratio, fri_sales_ratio, sat_sales_ratio]\nIndex: []*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name as s_store_name1, wss.d_week_seq as d_week_seq1\n        ,s_store_id as s_store_id1, sun_sales as sun_sales1\n        ,mon_sales as mon_sales1, tue_sales as tue_sales1\n        ,wed_sales as wed_sales1, thu_sales as thu_sales1\n        ,fri_sales as fri_sales1, sat_sales as sat_sales1\n from wss\n join store on wss.ss_store_sk = store.s_store_sk) as wss_data /*CURSOR_IDENTIFIER*/ \n join\n (\n select s_store_name as s_store_name2, wss.d_week_seq as d_week_seq2\n       ,s_store_id as s_store_id2, sun_sales as sun_sales2\n       ,mon_sales as mon_sales2, tue_sales as tue_sales2\n       ,wed_sales as wed_sales2, thu_sales as thu_sales2\n       ,fri_sales as fri_sales2, sat_sales as sat_sales2\n from wss\n join store on wss.ss_store_sk = store.s_store_sk) as wss_data2\n on wss_data.s_store_id1 = wss_data2.s_store_id2\n and wss_data.d_week_seq1 = wss_data2.d_week_seq2 - 1",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"WSS_DATA2\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_DATA2\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_DATA2\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_DATA2\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_DATA2\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_DATA2\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_DATA2\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_DATA2\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS_DATA2\" AS \"WSS_DATA2\" ON \"STORE\".\"S_STORE_ID\" = \"WSS_DATA2\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"WSS_DATA2\".\"D_WEEK_SEQ2\" - 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.899197,
                    "execution_time": 0.109298,
                    "compile_time": 0.045405,
                    "planning_time": 0.035093,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.229969,
                    "execution_time": 0.116448,
                    "compile_time": 3.313838,
                    "planning_time": 0.091332,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ2\" - 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.87549,
                    "execution_time": 0.139941,
                    "compile_time": 0.00047,
                    "planning_time": 0.032501,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.152049,
                    "execution_time": 0.158299,
                    "compile_time": 0.193776,
                    "planning_time": 0.098469,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAKECAAAAA         5281  1.0372  1.0560  1.1060  0.8038  0.8972  1.1538  0.9719\n1            bar  AAAAAAAAAFAAAAAA         5281  1.1150  0.8862  1.1612  1.0194  0.9049  1.2170  1.1402\n2          cally  AAAAAAAAGKAAAAAA         5281  1.1067  1.0052  1.1286  0.9599  0.8840  1.0843  1.0557\n3           anti  AAAAAAAAPICAAAAA         5281  1.0418  1.1578  0.9970  0.8498  0.9378  1.0350  0.9366\n4           able  AAAAAAAAGIDAAAAA         5281  0.9179  0.7776  0.9132  1.0078  1.0447  1.1611  0.8285\n5            ese  AAAAAAAAGGCAAAAA         5281  0.9928  1.0171  0.9001  1.1355  0.8928  0.8980  0.8580\n6            pri  AAAAAAAAPKDAAAAA         5281  1.1893  0.9760  0.6840  1.2079  1.2587  0.9421  1.0420\n7           eing  AAAAAAAAAFDAAAAA         5281  1.0432  1.3435  1.1931  0.7814  0.8467  0.7272  1.0304\n8           anti  AAAAAAAAJABAAAAA         5281  1.0821  0.9857  1.0462  1.0542  1.1069  1.1398  1.1459\n9                 AAAAAAAAINCAAAAA         5282  1.1708  0.9248  0.8863  0.8852  1.2137  0.8702  1.1158\n10           bar  AAAAAAAAGEAAAAAA         5282  0.8326  0.8439  0.9603  1.0213  0.8435  0.9042  1.1950\n11           pri  AAAAAAAADJBAAAAA         5282  1.0767  0.9330  0.9584  0.9700  1.0330  1.0882  0.9481\n12         cally  AAAAAAAAAABAAAAA         5282  1.0823  0.8757  0.8698  0.9443  0.8750  1.1447  1.2240\n13          eing  AAAAAAAAMPBAAAAA         5282  1.0226  0.9654  1.0626  1.0038  1.0432  1.1872  0.8943\n14          eing  AAAAAAAAMKBAAAAA         5282  1.0016  1.3070  0.8766  0.9947  0.8777  1.0623  0.9306\n15         cally  AAAAAAAAAIDAAAAA         5282  1.0848  0.8327  0.8443  0.9688  1.1405  0.7633  0.9948\n16         cally  AAAAAAAAGJBAAAAA         5282  0.9043  0.7745  1.0483  1.0565  1.0368  1.0540  0.9277\n17          anti  AAAAAAAAFEBAAAAA         5282  0.8856  1.0251  0.9895  0.9961  0.9170  0.9848  1.0631\n18          able  AAAAAAAAKKCAAAAA         5282  0.7103  1.0101  0.9678  0.8948  0.9778  0.8470  1.1961\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019283,
                    "execution_time": 0.008032,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004475
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057038,
                    "execution_time": 0.007849,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040326
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ2\" - 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAKECAAAAA         5281  1.0372  1.0560  1.1060  0.8038  0.8972  1.1538  0.9719\n1            bar  AAAAAAAAAFAAAAAA         5281  1.1150  0.8862  1.1612  1.0194  0.9049  1.2170  1.1402\n2          cally  AAAAAAAAGKAAAAAA         5281  1.1067  1.0052  1.1286  0.9599  0.8840  1.0843  1.0557\n3           anti  AAAAAAAAPICAAAAA         5281  1.0418  1.1578  0.9970  0.8498  0.9378  1.0350  0.9366\n4           able  AAAAAAAAGIDAAAAA         5281  0.9179  0.7776  0.9132  1.0078  1.0447  1.1611  0.8285\n5            ese  AAAAAAAAGGCAAAAA         5281  0.9928  1.0171  0.9001  1.1355  0.8928  0.8980  0.8580\n6            pri  AAAAAAAAPKDAAAAA         5281  1.1893  0.9760  0.6840  1.2079  1.2587  0.9421  1.0420\n7           eing  AAAAAAAAAFDAAAAA         5281  1.0432  1.3435  1.1931  0.7814  0.8467  0.7272  1.0304\n8           anti  AAAAAAAAJABAAAAA         5281  1.0821  0.9857  1.0462  1.0542  1.1069  1.1398  1.1459\n9                 AAAAAAAAINCAAAAA         5282  1.1708  0.9248  0.8863  0.8852  1.2137  0.8702  1.1158\n10           bar  AAAAAAAAGEAAAAAA         5282  0.8326  0.8439  0.9603  1.0213  0.8435  0.9042  1.1950\n11           pri  AAAAAAAADJBAAAAA         5282  1.0767  0.9330  0.9584  0.9700  1.0330  1.0882  0.9481\n12         cally  AAAAAAAAAABAAAAA         5282  1.0823  0.8757  0.8698  0.9443  0.8750  1.1447  1.2240\n13          eing  AAAAAAAAMPBAAAAA         5282  1.0226  0.9654  1.0626  1.0038  1.0432  1.1872  0.8943\n14          eing  AAAAAAAAMKBAAAAA         5282  1.0016  1.3070  0.8766  0.9947  0.8777  1.0623  0.9306\n15         cally  AAAAAAAAAIDAAAAA         5282  1.0848  0.8327  0.8443  0.9688  1.1405  0.7633  0.9948\n16         cally  AAAAAAAAGJBAAAAA         5282  0.9043  0.7745  1.0483  1.0565  1.0368  1.0540  0.9277\n17          anti  AAAAAAAAFEBAAAAA         5282  0.8856  1.0251  0.9895  0.9961  0.9170  0.9848  1.0631\n18          able  AAAAAAAAKKCAAAAA         5282  0.7103  1.0101  0.9678  0.8948  0.9778  0.8470  1.1961\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\n  select  s_store_name, s_store_id, wss1.d_week_seq\n       , wss1.sun_sales / wss2.sun_sales sun_sales_ratio\n       , wss1.mon_sales / wss2.mon_sales mon_sales_ratio\n       , wss1.tue_sales / wss2.tue_sales tue_sales_ratio\n       , wss1.wed_sales / wss2.wed_sales wed_sales_ratio\n       , wss1.thu_sales / wss2.thu_sales thu_sales_ratio\n       , wss1.fri_sales / wss2.fri_sales fri_sales_ratio\n       , wss1.sat_sales / wss2.sat_sales sat_sales_ratio\n from\n (select s_store_name, s_store_id, wss.d_week_seq, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales\n  from wss, store\n  where store.s_store_sk = wss.ss_store_sk) wss1\n join \n (select d_week_seq, sum(sun_sales) as sun_sales, sum(mon_sales) as mon_sales, sum(tue_sales) as tue_sales, \n          sum(wed_sales) as wed_sales, sum(thu_sales) as thu_sales, sum(fri_sales) as fri_sales, sum(sat_sales) as sat_sales\n  from wss\n  group by d_week_seq) wss2\n on wss1.d_week_seq = wss2.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"WSS2\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( \"WSS\".\"SUN_SALES\" ) AS \"SUN_SALES\" , SUM ( \"WSS\".\"MON_SALES\" ) AS \"MON_SALES\" , SUM ( \"WSS\".\"TUE_SALES\" ) AS \"TUE_SALES\" , SUM ( \"WSS\".\"WED_SALES\" ) AS \"WED_SALES\" , SUM ( \"WSS\".\"THU_SALES\" ) AS \"THU_SALES\" , SUM ( \"WSS\".\"FRI_SALES\" ) AS \"FRI_SALES\" , SUM ( \"WSS\".\"SAT_SALES\" ) AS \"SAT_SALES\" FROM \"WSS\" AS \"WSS\" GROUP BY \"WSS\".\"D_WEEK_SEQ\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WSS\".\"SUN_SALES\" / \"WSS2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"WSS\".\"MON_SALES\" / \"WSS2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"WSS\".\"TUE_SALES\" / \"WSS2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"WSS\".\"WED_SALES\" / \"WSS2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"WSS\".\"THU_SALES\" / \"WSS2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"WSS\".\"FRI_SALES\" / \"WSS2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"WSS\".\"SAT_SALES\" / \"WSS2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS2\" AS \"WSS2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" ) AS \"SUN_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" ) AS \"MON_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" ) AS \"TUE_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" ) AS \"WED_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" ) AS \"THU_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" ) AS \"FRI_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095298,
                    "execution_time": 0.062016,
                    "compile_time": 0.000284,
                    "planning_time": 0.005686,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.321326,
                    "execution_time": 0.068635,
                    "compile_time": 0.1578,
                    "planning_time": 0.064282,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.735819,
                    "execution_time": 0.122025,
                    "compile_time": 0.000476,
                    "planning_time": 0.032418,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.812811,
                    "execution_time": 0.131039,
                    "compile_time": 0.001579,
                    "planning_time": 0.097458,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   s_store_name        s_store_id  d_week_seq  sun_sales_ratio  mon_sales_ratio  tue_sales_ratio  wed_sales_ratio  thu_sales_ratio  fri_sales_ratio  sat_sales_ratio\n0          eing  AAAAAAAAIEBAAAAA        5189           0.0020           0.0021           0.0021           0.0019           0.0020           0.0019           0.0023\n1         ought  AAAAAAAAJFCAAAAA        5189           0.0021           0.0019           0.0019           0.0018           0.0019           0.0016           0.0022\n2         cally  AAAAAAAAKABAAAAA        5189           0.0019           0.0020           0.0020           0.0018           0.0021           0.0016           0.0021\n3           ese  AAAAAAAAMCAAAAAA        5189           0.0018           0.0019           0.0019           0.0021           0.0021           0.0018           0.0020\n4          able  AAAAAAAAGLAAAAAA        5189           0.0018           0.0016           0.0020           0.0020           0.0022           0.0018           0.0018\n5           bar  AAAAAAAAMMBAAAAA        5189           0.0023           0.0020           0.0019           0.0020           0.0019           0.0016           0.0018\n6           pri  AAAAAAAAPMBAAAAA        5189           0.0018           0.0017           0.0019           0.0019           0.0020           0.0016           0.0017\n7           bar  AAAAAAAAIKCAAAAA        5189           0.0016           0.0020           0.0019           0.0018           0.0016           0.0020           0.0022\n8           pri  AAAAAAAAHFBAAAAA        5189           0.0018           0.0018           0.0017           0.0020           0.0020           0.0020           0.0020\n9          anti  AAAAAAAALNBAAAAA        5189           0.0022           0.0017           0.0024           0.0021           0.0019           0.0015           0.0017\n10         n st  AAAAAAAAJICAAAAA        5189           0.0017           0.0021           0.0023           0.0019           0.0017           0.0020           0.0018\n11          bar  AAAAAAAAKPAAAAAA        5189           0.0019           0.0015           0.0019           0.0017           0.0019           0.0021           0.0019\n12        ation  AAAAAAAAHOBAAAAA        5189           0.0021           0.0016           0.0018           0.0021           0.0018           0.0019           0.0023\n13         able  AAAAAAAAKEDAAAAA        5189           0.0018           0.0020           0.0018           0.0020           0.0016           0.0019           0.0018\n14          ese  AAAAAAAACMAAAAAA        5189           0.0020           0.0021           0.0019           0.0018           0.0020           0.0022           0.0019\n15          bar  AAAAAAAAKICAAAAA        5189           0.0020           0.0023           0.0020           0.0021           0.0016           0.0019           0.0020\n16         able  AAAAAAAAMHDAAAAA        5189           0.0018           0.0019           0.0021           0.0021           0.0020           0.0018           0.0022\n17        cally  AAAAAAAAEMAAAAAA        5189           0.0020           0.0023           0.0016           0.0019           0.0021           0.0019           0.0020\n18        ation  AAAAAAAAJKDAAAAA        5189           0.0023           0.0019           0.0017           0.0021           0.0020           0.0021           0.0017\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019554,
                    "execution_time": 0.008452,
                    "compile_time": 5e-05,
                    "planning_time": 0.004504
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057341,
                    "execution_time": 0.008451,
                    "compile_time": 5e-05,
                    "planning_time": 0.040138
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   s_store_name        s_store_id  d_week_seq  sun_sales_ratio  mon_sales_ratio  tue_sales_ratio  wed_sales_ratio  thu_sales_ratio  fri_sales_ratio  sat_sales_ratio\n0          eing  AAAAAAAAIEBAAAAA        5189           0.0020           0.0021           0.0021           0.0019           0.0020           0.0019           0.0023\n1         ought  AAAAAAAAJFCAAAAA        5189           0.0021           0.0019           0.0019           0.0018           0.0019           0.0016           0.0022\n2         cally  AAAAAAAAKABAAAAA        5189           0.0019           0.0020           0.0020           0.0018           0.0021           0.0016           0.0021\n3           ese  AAAAAAAAMCAAAAAA        5189           0.0018           0.0019           0.0019           0.0021           0.0021           0.0018           0.0020\n4          able  AAAAAAAAGLAAAAAA        5189           0.0018           0.0016           0.0020           0.0020           0.0022           0.0018           0.0018\n5           bar  AAAAAAAAMMBAAAAA        5189           0.0023           0.0020           0.0019           0.0020           0.0019           0.0016           0.0018\n6           pri  AAAAAAAAPMBAAAAA        5189           0.0018           0.0017           0.0019           0.0019           0.0020           0.0016           0.0017\n7           bar  AAAAAAAAIKCAAAAA        5189           0.0016           0.0020           0.0019           0.0018           0.0016           0.0020           0.0022\n8           pri  AAAAAAAAHFBAAAAA        5189           0.0018           0.0018           0.0017           0.0020           0.0020           0.0020           0.0020\n9          anti  AAAAAAAALNBAAAAA        5189           0.0022           0.0017           0.0024           0.0021           0.0019           0.0015           0.0017\n10         n st  AAAAAAAAJICAAAAA        5189           0.0017           0.0021           0.0023           0.0019           0.0017           0.0020           0.0018\n11          bar  AAAAAAAAKPAAAAAA        5189           0.0019           0.0015           0.0019           0.0017           0.0019           0.0021           0.0019\n12        ation  AAAAAAAAHOBAAAAA        5189           0.0021           0.0016           0.0018           0.0021           0.0018           0.0019           0.0023\n13         able  AAAAAAAAKEDAAAAA        5189           0.0018           0.0020           0.0018           0.0020           0.0016           0.0019           0.0018\n14          ese  AAAAAAAACMAAAAAA        5189           0.0020           0.0021           0.0019           0.0018           0.0020           0.0022           0.0019\n15          bar  AAAAAAAAKICAAAAA        5189           0.0020           0.0023           0.0020           0.0021           0.0016           0.0019           0.0020\n16         able  AAAAAAAAMHDAAAAA        5189           0.0018           0.0019           0.0021           0.0021           0.0020           0.0018           0.0022\n17        cally  AAAAAAAAEMAAAAAA        5189           0.0020           0.0023           0.0016           0.0019           0.0021           0.0019           0.0020\n18        ation  AAAAAAAAJKDAAAAA        5189           0.0023           0.0019           0.0017           0.0021           0.0020           0.0021           0.0017\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n ),\n sales_totals as \n (select sum(sun_sales) as sun_sales_total,\n         sum(mon_sales) as mon_sales_total,\n         sum(tue_sales) as tue_sales_total,\n         sum(wed_sales) as wed_sales_total,\n         sum(thu_sales) as thu_sales_total,\n         sum(fri_sales) as fri_sales_total,\n         sum(sat_sales) as sat_sales_total\n  from wss)\n select s_store_name1, s_store_id1, d_week_seq1,\n        sun_sales1/sun_sales_total as sun_sales2,\n        mon_sales1/mon_sales_total as mon_sales2,\n        tue_sales1/tue_sales_total as tue_sales2,\n        wed_sales1/wed_sales_total as wed_sales2,\n        thu_sales1/thu_sales_total as thu_sales2,\n        fri_sales1/fri_sales_total as fri_sales2,\n        sat_sales1/sat_sales_total as sat_sales2\n from\n (select s_store_name s_store_name1, wss.d_week_seq d_week_seq1,\n         s_store_id s_store_id1, sun_sales sun_sales1,\n         mon_sales mon_sales1, tue_sales tue_sales1,\n         wed_sales wed_sales1, thu_sales thu_sales1,\n         fri_sales fri_sales1, sat_sales sat_sales1\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n/*CURSOR_IDENTIFIER*/\n  wss.ss_store_sk = s_store_sk), sales_totals",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.723704,
                    "execution_time": 0.581582,
                    "compile_time": 0.000586,
                    "planning_time": 0.036497,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.934127,
                    "execution_time": 0.590723,
                    "compile_time": 0.126752,
                    "planning_time": 0.104868,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUN_SALES1\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"MON_SALES1\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"TUE_SALES1\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"WED_SALES1\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"THU_SALES1\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"FRI_SALES1\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SAT_SALES1\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   s_store_name1  d_week_seq1       s_store_id1  sun_sales1  mon_sales1  tue_sales1  wed_sales1  thu_sales1  fri_sales1  sat_sales1\n0            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n1            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n2            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n3            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n4            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n5            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n6            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n7            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n8            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n9            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n10           ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n11           ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n12           ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n13          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n14          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n15          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n16          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n17          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n18          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018556,
                    "execution_time": 0.007633,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.456135,
                    "execution_time": 0.008099,
                    "compile_time": 0.398612,
                    "planning_time": 0.040508
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUN_SALES1\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"MON_SALES1\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"TUE_SALES1\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"WED_SALES1\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"THU_SALES1\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"FRI_SALES1\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SAT_SALES1\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   s_store_name1  d_week_seq1       s_store_id1  sun_sales1  mon_sales1  tue_sales1  wed_sales1  thu_sales1  fri_sales1  sat_sales1\n0            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n1            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n2            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n3            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n4            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n5            bar         5176  AAAAAAAAKMDAAAAA    56936.86    57131.25    66417.49    55756.75    68248.47    66705.39    54747.97\n6            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n7            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n8            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n9            ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n10           ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n11           ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n12           ese         5176  AAAAAAAAOAAAAAAA    55002.06    52195.56    56096.44    62708.31    67367.02    69619.14    58601.79\n13          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n14          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n15          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n16          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n17          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n18          n st         5176  AAAAAAAAHMAAAAAA    62792.57    59947.18    69049.80    67864.68    59696.06    71350.26    67261.99\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\n  select  s_store_name1, s_store_id1, d_week_seq1\n       , sun_sales1 / sun_sales2, mon_sales1 / mon_sales2\n       , tue_sales1 / tue_sales2, wed_sales1 / wed_sales2, thu_sales1 / thu_sales2\n       , fri_sales1 / fri_sales2, sat_sales1 / sat_sales2\n from\n (select s_store_name as s_store_name1, wss.d_week_seq as d_week_seq1\n        , s_store_id as s_store_id1, sun_sales as sun_sales1\n        , mon_sales as mon_sales1, tue_sales as tue_sales1\n        , wed_sales as wed_sales1, thu_sales as thu_sales1\n        , fri_sales as fri_sales1, sat_sales as sat_sales1\n  from wss, store\n  where ss_store_sk = s_store_sk\n ) s1\n join\n (select d_week_seq, sun_sales as sun_sales2, mon_sales as mon_sales2, tue_sales as tue_sales2,\n        wed_sales as wed_sales2, thu_sales as thu_sales2, fri_sales as fri_sales2, sat_sales as sat_sales2\n  from wss\n ) s2\n on s1.d_week_seq1 = s2.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.801768,
                    "execution_time": 5.628716,
                    "compile_time": 0.000628,
                    "planning_time": 0.032797,
                    "create_size": 9984
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.645965,
                    "execution_time": 7.398236,
                    "compile_time": 0.001746,
                    "planning_time": 0.095958,
                    "create_size": 9984
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           n st  AAAAAAAANGAAAAAA         5163  1.0138  0.9834  0.9699  0.9706  0.9291  0.9440  1.0667\n1           n st  AAAAAAAANGAAAAAA         5163  1.0679  1.0095  1.0194  1.0395  0.9925  0.9763  1.0037\n2           n st  AAAAAAAANGAAAAAA         5163  1.0210  0.9485  0.9480  0.9489  0.9571  0.9765  0.9472\n3           n st  AAAAAAAANGAAAAAA         5163  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000\n4           n st  AAAAAAAANGAAAAAA         5163  1.0426  1.0209  0.9744  0.9871  1.0666  1.0275  0.9179\n5           n st  AAAAAAAANGAAAAAA         5163  1.1286  0.9350  1.1133  0.9662  0.9398  0.9760  0.9443\n6           n st  AAAAAAAANGAAAAAA         5163  1.0412  0.9996  0.8854  1.0064  0.9968  0.8807  1.0057\n7           n st  AAAAAAAANGAAAAAA         5163  1.0537  0.9745  0.9659  1.0062  0.9633  0.9236  0.9920\n8           n st  AAAAAAAANGAAAAAA         5163  1.1193  1.0242  1.0710  0.8850  1.0350  0.9566  1.0260\n9           n st  AAAAAAAANGAAAAAA         5163  0.9611  1.0162  1.0609  0.9776  0.9834  0.9591  0.9792\n10          n st  AAAAAAAANGAAAAAA         5163  0.9331  0.9741  0.9472  0.9370  1.0227  0.9078  0.9995\n11          n st  AAAAAAAANGAAAAAA         5163  0.9882  0.9109  1.0800  0.9397  1.0363  1.0122  0.9646\n12          n st  AAAAAAAANGAAAAAA         5163  1.0234  0.9544  0.9492  0.9882  1.1295  0.9762  0.9273\n13          n st  AAAAAAAANGAAAAAA         5163  1.0054  1.0368  1.0149  1.0421  1.1186  0.9641  1.0027\n14          n st  AAAAAAAANGAAAAAA         5163  1.0404  0.9530  1.0706  1.0738  1.0703  1.0043  0.9932\n15          n st  AAAAAAAANGAAAAAA         5163  0.9420  1.0133  1.0629  0.9677  1.0475  1.0096  0.9491\n16          n st  AAAAAAAANGAAAAAA         5163  1.0796  1.0761  1.0751  0.9811  1.0115  0.9595  0.9217\n17          n st  AAAAAAAANGAAAAAA         5163  0.9985  1.0339  1.0069  1.0126  0.8988  1.0471  0.9422\n18          n st  AAAAAAAANGAAAAAA         5163  0.9830  1.0218  1.0453  0.9348  0.9776  0.9710  0.9340\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019207,
                    "execution_time": 0.008379,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004151
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057374,
                    "execution_time": 0.00829,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040195
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           n st  AAAAAAAANGAAAAAA         5163  1.0138  0.9834  0.9699  0.9706  0.9291  0.9440  1.0667\n1           n st  AAAAAAAANGAAAAAA         5163  1.0679  1.0095  1.0194  1.0395  0.9925  0.9763  1.0037\n2           n st  AAAAAAAANGAAAAAA         5163  1.0210  0.9485  0.9480  0.9489  0.9571  0.9765  0.9472\n3           n st  AAAAAAAANGAAAAAA         5163  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000\n4           n st  AAAAAAAANGAAAAAA         5163  1.0426  1.0209  0.9744  0.9871  1.0666  1.0275  0.9179\n5           n st  AAAAAAAANGAAAAAA         5163  1.1286  0.9350  1.1133  0.9662  0.9398  0.9760  0.9443\n6           n st  AAAAAAAANGAAAAAA         5163  1.0412  0.9996  0.8854  1.0064  0.9968  0.8807  1.0057\n7           n st  AAAAAAAANGAAAAAA         5163  1.0537  0.9745  0.9659  1.0062  0.9633  0.9236  0.9920\n8           n st  AAAAAAAANGAAAAAA         5163  1.1193  1.0242  1.0710  0.8850  1.0350  0.9566  1.0260\n9           n st  AAAAAAAANGAAAAAA         5163  0.9611  1.0162  1.0609  0.9776  0.9834  0.9591  0.9792\n10          n st  AAAAAAAANGAAAAAA         5163  0.9331  0.9741  0.9472  0.9370  1.0227  0.9078  0.9995\n11          n st  AAAAAAAANGAAAAAA         5163  0.9882  0.9109  1.0800  0.9397  1.0363  1.0122  0.9646\n12          n st  AAAAAAAANGAAAAAA         5163  1.0234  0.9544  0.9492  0.9882  1.1295  0.9762  0.9273\n13          n st  AAAAAAAANGAAAAAA         5163  1.0054  1.0368  1.0149  1.0421  1.1186  0.9641  1.0027\n14          n st  AAAAAAAANGAAAAAA         5163  1.0404  0.9530  1.0706  1.0738  1.0703  1.0043  0.9932\n15          n st  AAAAAAAANGAAAAAA         5163  0.9420  1.0133  1.0629  0.9677  1.0475  1.0096  0.9491\n16          n st  AAAAAAAANGAAAAAA         5163  1.0796  1.0761  1.0751  0.9811  1.0115  0.9595  0.9217\n17          n st  AAAAAAAANGAAAAAA         5163  0.9985  1.0339  1.0069  1.0126  0.8988  1.0471  0.9422\n18          n st  AAAAAAAANGAAAAAA         5163  0.9830  1.0218  1.0453  0.9348  0.9776  0.9710  0.9340\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1, s_store_id1, d_week_seq1\n       , NULL AS sun_sales2, NULL AS mon_sales2\n       , NULL AS tue_sales2, NULL AS wed_sales2, NULL AS thu_sales2\n       , NULL AS fri_sales2, NULL AS sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y\n \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119698,
                    "execution_time": 0.047333,
                    "compile_time": 0.000233,
                    "planning_time": 0.003128,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.252663,
                    "execution_time": 0.116822,
                    "compile_time": 0.000238,
                    "planning_time": 0.061802,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.437982,
                    "execution_time": 0.114627,
                    "compile_time": 0.09343,
                    "planning_time": 0.039236,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.010358,
                    "execution_time": 0.815414,
                    "compile_time": 6.891657,
                    "planning_time": 0.106206,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1 sun_sales2 mon_sales2 tue_sales2 wed_sales2 thu_sales2 fri_sales2 sat_sales2\n0          cally  AAAAAAAACNBAAAAA         5157       None       None       None       None       None       None       None\n1          cally  AAAAAAAACNBAAAAA         5157       None       None       None       None       None       None       None\n2          cally  AAAAAAAACNBAAAAA         5157       None       None       None       None       None       None       None\n3           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n4           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n5           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n6           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n7           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n8           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n9           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n10         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n11         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n12         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n13         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n14         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n15         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n16         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n17           pri  AAAAAAAANPAAAAAA         5157       None       None       None       None       None       None       None\n18           pri  AAAAAAAANPAAAAAA         5157       None       None       None       None       None       None       None\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019248,
                    "execution_time": 0.008166,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004519
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.285653,
                    "execution_time": 0.008522,
                    "compile_time": 0.22759,
                    "planning_time": 0.040553
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1 sun_sales2 mon_sales2 tue_sales2 wed_sales2 thu_sales2 fri_sales2 sat_sales2\n0          cally  AAAAAAAACNBAAAAA         5157       None       None       None       None       None       None       None\n1          cally  AAAAAAAACNBAAAAA         5157       None       None       None       None       None       None       None\n2          cally  AAAAAAAACNBAAAAA         5157       None       None       None       None       None       None       None\n3           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n4           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n5           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n6           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n7           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n8           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n9           able  AAAAAAAAAACAAAAA         5157       None       None       None       None       None       None       None\n10         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n11         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n12         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n13         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n14         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n15         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n16         cally  AAAAAAAAKNDAAAAA         5157       None       None       None       None       None       None       None\n17           pri  AAAAAAAANPAAAAAA         5157       None       None       None       None       None       None       None\n18           pri  AAAAAAAANPAAAAAA         5157       None       None       None       None       None       None       None\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\nselect  s_store_name1, s_store_id1, d_week_seq1\n       , sun_sales1/sun_sales2, mon_sales1/mon_sales2\n       , tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2\n       , fri_sales1/fri_sales2, sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1, wss.d_week_seq d_week_seq1\n        , s_store_id s_store_id1, sun_sales sun_sales1\n        , mon_sales mon_sales1, tue_sales tue_sales1\n        , wed_sales wed_sales1, thu_sales thu_sales1\n        , fri_sales fri_sales1, sat_sales sat_sales1\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d.d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2, wss.d_week_seq d_week_seq2\n        , s_store_id s_store_id2, sun_sales sun_sales2\n        , mon_sales mon_sales2, tue_sales tue_sales2\n        , wed_sales wed_sales2, thu_sales thu_sales2\n        , fri_sales fri_sales2, sat_sales sat_sales2\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d.d_month_seq between 1182 + 12 and 1182 + 23) z\nwhere s_store_id1 = s_store_id2\nand d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.032425,
                    "execution_time": 0.129534,
                    "compile_time": 0.035072,
                    "planning_time": 0.037898,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.171553,
                    "execution_time": 0.969697,
                    "compile_time": 3.246615,
                    "planning_time": 0.111794,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.14493,
                    "execution_time": 0.055343,
                    "compile_time": 0.00041,
                    "planning_time": 0.043082,
                    "create_size": 104
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.409168,
                    "execution_time": 0.068459,
                    "compile_time": 0.178469,
                    "planning_time": 0.112376,
                    "create_size": 104
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAMCDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAMCDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018148,
                    "execution_time": 0.007284,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056379,
                    "execution_time": 0.007561,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040148
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          cally  AAAAAAAAGFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAMCDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAMCDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         cally  AAAAAAAAANDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d_month_seq between 1182 + 12 and 1182 + 23) z\nwhere s_store_id1 = s_store_id2\nand d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18           bar  AAAAAAAAGOAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017763,
                    "execution_time": 0.007131,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004275
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054019,
                    "execution_time": 0.007825,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039531
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           eing  AAAAAAAAAKDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17          anti  AAAAAAAABIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18           bar  AAAAAAAAGOAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1182 + 12 and 1182 + 23) z where s_store_id1 = s_store_id2 and d_week_seq1 = d_week_seq2 order by s_store_name1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\" ORDER BY \"S_STORE_NAME1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"S_STORE_NAME1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11                AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13                AAAAAAAAPNDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15                AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17                AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019791,
                    "execution_time": 0.008738,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004561
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.220606,
                    "execution_time": 0.008582,
                    "compile_time": 0.164046,
                    "planning_time": 0.040014
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" ORDER BY \"S_STORE_NAME1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"S_STORE_NAME1\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8                 AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11                AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13                AAAAAAAAPNDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15                AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17                AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18                AAAAAAAAOJDAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085315,
                    "execution_time": 0.035211,
                    "compile_time": 0.000231,
                    "planning_time": 0.026519,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.334822,
                    "execution_time": 0.033389,
                    "compile_time": 0.189128,
                    "planning_time": 0.087591,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAACGAAAAAA         5164  0.9758  1.1430  0.9655  1.0476  0.9657  1.1144  0.9570\n1          ation  AAAAAAAAHMDAAAAA         5164  0.9246  1.0914  0.9999  0.9740  0.9534  1.1786  0.9879\n2           eing  AAAAAAAACFBAAAAA         5164  1.0180  1.0926  0.9927  0.9487  0.9546  1.1072  0.8528\n3          cally  AAAAAAAAKPBAAAAA         5164  1.0430  1.0271  1.0325  0.9672  1.0158  1.0834  0.9853\n4           anti  AAAAAAAADGBAAAAA         5164  1.0242  1.0575  0.9757  1.0430  0.9681  1.0957  0.9693\n5           n st  AAAAAAAALIAAAAAA         5164  0.9146  1.1601  0.8871  1.0457  1.0331  1.1478  0.8536\n6            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n7            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n8            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n9           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n10          anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n11          eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n12          able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n13           pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n14          anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n15         cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n16          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n17         ation  AAAAAAAALKBAAAAA         5164  1.0403  1.0509  1.0420  1.0098  1.0148  1.1073  0.8826\n18           bar  AAAAAAAACHBAAAAA         5164  0.9200  1.1358  0.9067  1.0060  1.0121  1.0986  0.9815\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.115374,
                    "execution_time": 0.053459,
                    "compile_time": 0.000373,
                    "planning_time": 0.042195
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.40908,
                    "execution_time": 0.055026,
                    "compile_time": 0.217398,
                    "planning_time": 0.103686
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAACGAAAAAA         5164  0.9758  1.1430  0.9655  1.0476  0.9657  1.1144  0.9570\n1          ation  AAAAAAAAHMDAAAAA         5164  0.9246  1.0914  0.9999  0.9740  0.9534  1.1786  0.9879\n2           eing  AAAAAAAACFBAAAAA         5164  1.0180  1.0926  0.9927  0.9487  0.9546  1.1072  0.8528\n3          cally  AAAAAAAAKPBAAAAA         5164  1.0430  1.0271  1.0325  0.9672  1.0158  1.0834  0.9853\n4           anti  AAAAAAAADGBAAAAA         5164  1.0242  1.0575  0.9757  1.0430  0.9681  1.0957  0.9693\n5           n st  AAAAAAAALIAAAAAA         5164  0.9146  1.1601  0.8871  1.0457  1.0331  1.1478  0.8536\n6            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n7            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n8            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n9           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n10          anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n11          eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n12          able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n13           pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n14          anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n15         cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n16          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n17         ation  AAAAAAAALKBAAAAA         5164  1.0403  1.0509  1.0420  1.0098  1.0148  1.1073  0.8826\n18           bar  AAAAAAAACHBAAAAA         5164  0.9200  1.1358  0.9067  1.0060  1.0121  1.0986  0.9815\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAACGAAAAAA         5164  0.9758  1.1430  0.9655  1.0476  0.9657  1.1144  0.9570\n1          ation  AAAAAAAAHMDAAAAA         5164  0.9246  1.0914  0.9999  0.9740  0.9534  1.1786  0.9879\n2           eing  AAAAAAAACFBAAAAA         5164  1.0180  1.0926  0.9927  0.9487  0.9546  1.1072  0.8528\n3          cally  AAAAAAAAKPBAAAAA         5164  1.0430  1.0271  1.0325  0.9672  1.0158  1.0834  0.9853\n4           anti  AAAAAAAADGBAAAAA         5164  1.0242  1.0575  0.9757  1.0430  0.9681  1.0957  0.9693\n5           n st  AAAAAAAALIAAAAAA         5164  0.9146  1.1601  0.8871  1.0457  1.0331  1.1478  0.8536\n6            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n7            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n8            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n9           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n10          anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n11          eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n12          able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n13           pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n14          anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n15         cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n16          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n17           bar  AAAAAAAAEFBAAAAA         5164  0.9509  1.0839  0.8644  0.9567  0.9831  1.1068  0.9947\n18          eing  AAAAAAAAOGDAAAAA         5164  1.0343  1.1180  0.9757  1.0113  0.9943  1.1042  1.0305\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.115842,
                    "execution_time": 0.052964,
                    "compile_time": 0.000372,
                    "planning_time": 0.043105
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.116865,
                    "execution_time": 0.0517,
                    "compile_time": 0.000393,
                    "planning_time": 0.04385
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAACGAAAAAA         5164  0.9758  1.1430  0.9655  1.0476  0.9657  1.1144  0.9570\n1          ation  AAAAAAAAHMDAAAAA         5164  0.9246  1.0914  0.9999  0.9740  0.9534  1.1786  0.9879\n2           eing  AAAAAAAACFBAAAAA         5164  1.0180  1.0926  0.9927  0.9487  0.9546  1.1072  0.8528\n3          cally  AAAAAAAAKPBAAAAA         5164  1.0430  1.0271  1.0325  0.9672  1.0158  1.0834  0.9853\n4           anti  AAAAAAAADGBAAAAA         5164  1.0242  1.0575  0.9757  1.0430  0.9681  1.0957  0.9693\n5           n st  AAAAAAAALIAAAAAA         5164  0.9146  1.1601  0.8871  1.0457  1.0331  1.1478  0.8536\n6            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n7            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n8            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n9           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n10          anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n11          eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n12          able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n13           pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n14          anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n15         cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n16          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n17           bar  AAAAAAAAEFBAAAAA         5164  0.9509  1.0839  0.8644  0.9567  0.9831  1.1068  0.9947\n18          eing  AAAAAAAAOGDAAAAA         5164  1.0343  1.1180  0.9757  1.0113  0.9943  1.1042  1.0305\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n1            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n2            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n3           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n4           anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n5           eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n6           able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n7            pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n8           anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n9          cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n10          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n11           bar  AAAAAAAAEFBAAAAA         5164  0.9509  1.0839  0.8644  0.9567  0.9831  1.1068  0.9947\n12          eing  AAAAAAAAOGDAAAAA         5164  1.0343  1.1180  0.9757  1.0113  0.9943  1.1042  1.0305\n13           ese  AAAAAAAAIDDAAAAA         5164  1.0089  0.9868  0.9722  1.0237  0.9660  1.0226  0.8696\n14           bar  AAAAAAAAADCAAAAA         5164  0.9537  1.1071  1.0292  0.9510  0.9291  1.1589  1.0422\n15           bar  AAAAAAAAAHDAAAAA         5164  0.9874  1.0952  1.0270  0.9679  0.9536  1.1589  0.9613\n16         cally  AAAAAAAAOBBAAAAA         5164  1.0186  1.1166  1.0038  0.9995  1.0401  1.1429  1.0066\n17         ation  AAAAAAAAPEDAAAAA         5164  1.0226  1.0852  0.9826  1.0103  1.0544  1.0552  1.0089\n18          able  AAAAAAAACDCAAAAA         5164  0.9938  1.0252  0.9351  1.0133  0.9705  1.0636  0.9230\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.116467,
                    "execution_time": 0.053983,
                    "compile_time": 0.000368,
                    "planning_time": 0.042889
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.128652,
                    "execution_time": 0.05564,
                    "compile_time": 0.000374,
                    "planning_time": 0.052493
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n1            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n2            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n3           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n4           anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n5           eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n6           able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n7            pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n8           anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n9          cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n10          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n11           bar  AAAAAAAAEFBAAAAA         5164  0.9509  1.0839  0.8644  0.9567  0.9831  1.1068  0.9947\n12          eing  AAAAAAAAOGDAAAAA         5164  1.0343  1.1180  0.9757  1.0113  0.9943  1.1042  1.0305\n13           ese  AAAAAAAAIDDAAAAA         5164  1.0089  0.9868  0.9722  1.0237  0.9660  1.0226  0.8696\n14           bar  AAAAAAAAADCAAAAA         5164  0.9537  1.1071  1.0292  0.9510  0.9291  1.1589  1.0422\n15           bar  AAAAAAAAAHDAAAAA         5164  0.9874  1.0952  1.0270  0.9679  0.9536  1.1589  0.9613\n16         cally  AAAAAAAAOBBAAAAA         5164  1.0186  1.1166  1.0038  0.9995  1.0401  1.1429  1.0066\n17         ation  AAAAAAAAPEDAAAAA         5164  1.0226  1.0852  0.9826  1.0103  1.0544  1.0552  1.0089\n18          able  AAAAAAAACDCAAAAA         5164  0.9938  1.0252  0.9351  1.0133  0.9705  1.0636  0.9230\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk\n) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n1          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n2          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n3          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n4          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n5          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n6          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n7          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n8          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n9          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n10         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n11         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n12         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n13         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n14         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n15         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n16         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n17         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n18         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.11957,
                    "execution_time": 0.042129,
                    "compile_time": 0.000402,
                    "planning_time": 0.056912
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.364338,
                    "execution_time": 0.039688,
                    "compile_time": 0.178131,
                    "planning_time": 0.12348
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n1          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n2          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n3          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n4          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n5          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n6          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n7          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n8          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n9          ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n10         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n11         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n12         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n13         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n14         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n15         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n16         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n17         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n18         ought  AAAAAAAABAAAAAAA         5171   1.065  0.8854   0.914  1.0727  1.1748  0.9881  0.9671\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n1            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n2            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n3           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n4           anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n5           eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n6           able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n7            pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n8           anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n9          cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n10          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n11           bar  AAAAAAAAEFBAAAAA         5164  0.9509  1.0839  0.8644  0.9567  0.9831  1.1068  0.9947\n12          eing  AAAAAAAAOGDAAAAA         5164  1.0343  1.1180  0.9757  1.0113  0.9943  1.1042  1.0305\n13           ese  AAAAAAAAIDDAAAAA         5164  1.0089  0.9868  0.9722  1.0237  0.9660  1.0226  0.8696\n14           bar  AAAAAAAAADCAAAAA         5164  0.9537  1.1071  1.0292  0.9510  0.9291  1.1589  1.0422\n15           bar  AAAAAAAAAHDAAAAA         5164  0.9874  1.0952  1.0270  0.9679  0.9536  1.1589  0.9613\n16         cally  AAAAAAAAOBBAAAAA         5164  1.0186  1.1166  1.0038  0.9995  1.0401  1.1429  1.0066\n17         ation  AAAAAAAAPEDAAAAA         5164  1.0226  1.0852  0.9826  1.0103  1.0544  1.0552  1.0089\n18          able  AAAAAAAACDCAAAAA         5164  0.9938  1.0252  0.9351  1.0133  0.9705  1.0636  0.9230\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.123995,
                    "execution_time": 0.053924,
                    "compile_time": 0.000372,
                    "planning_time": 0.050197
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.132385,
                    "execution_time": 0.056032,
                    "compile_time": 0.000403,
                    "planning_time": 0.045086
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAKICAAAAA         5164  0.9773  1.1739  1.0301  1.0345  0.9194  1.0808  0.9768\n1            ese  AAAAAAAAAOAAAAAA         5164  1.0125  1.0141  0.9736  1.0200  0.9123  1.1568  0.9711\n2            pri  AAAAAAAANMDAAAAA         5164  0.9392  0.9902  0.9273  0.9494  0.9811  1.1045  0.9441\n3           anti  AAAAAAAAPHDAAAAA         5164  0.8661  1.0865  0.9489  1.0206  0.9402  1.1736  0.9093\n4           anti  AAAAAAAAJNDAAAAA         5164  0.9633  1.2056  0.9312  1.0167  0.9674  1.1941  1.0053\n5           eing  AAAAAAAAIEBAAAAA         5164  0.9930  1.1032  0.9831  1.0814  1.0887  1.1575  0.8852\n6           able  AAAAAAAAELCAAAAA         5164  0.9944  1.1546  0.9459  0.9873  1.0399  1.0354  0.9253\n7            pri  AAAAAAAAPMBAAAAA         5164  1.0433  1.1045  1.0642  0.9898  1.0070  1.0976  0.8692\n8           anti  AAAAAAAALLDAAAAA         5164  0.9315  1.1721  0.9071  0.9622  0.9482  1.0887  0.9533\n9          cally  AAAAAAAAEEDAAAAA         5164  0.9842  1.1791  1.0076  1.0311  0.9297  1.1895  0.9478\n10          n st  AAAAAAAAJHDAAAAA         5164  0.9924  1.0760  1.0229  1.0691  0.9956  1.0724  0.9504\n11           bar  AAAAAAAAEFBAAAAA         5164  0.9509  1.0839  0.8644  0.9567  0.9831  1.1068  0.9947\n12          eing  AAAAAAAAOGDAAAAA         5164  1.0343  1.1180  0.9757  1.0113  0.9943  1.1042  1.0305\n13           ese  AAAAAAAAIDDAAAAA         5164  1.0089  0.9868  0.9722  1.0237  0.9660  1.0226  0.8696\n14           bar  AAAAAAAAADCAAAAA         5164  0.9537  1.1071  1.0292  0.9510  0.9291  1.1589  1.0422\n15           bar  AAAAAAAAAHDAAAAA         5164  0.9874  1.0952  1.0270  0.9679  0.9536  1.1589  0.9613\n16         cally  AAAAAAAAOBBAAAAA         5164  1.0186  1.1166  1.0038  0.9995  1.0401  1.1429  1.0066\n17         ation  AAAAAAAAPEDAAAAA         5164  1.0226  1.0852  0.9826  1.0103  1.0544  1.0552  1.0089\n18          able  AAAAAAAACDCAAAAA         5164  0.9938  1.0252  0.9351  1.0133  0.9705  1.0636  0.9230\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" CROSS JOIN \"WSS\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            pri  AAAAAAAAFGCAAAAA         5140  1.1110  1.0462  1.0285  0.9923  1.0112  0.9906  0.9666\n1          ought  AAAAAAAADKDAAAAA         5140  1.0758  1.0953  1.1356  0.9753  0.8226  0.9578  0.8964\n2          ation  AAAAAAAAJLCAAAAA         5140  1.2256  1.0896  1.2443  0.9444  0.8259  1.0183  0.9628\n3            pri  AAAAAAAALACAAAAA         5140  0.9436  1.1188  1.2141  1.0657  0.9248  0.9303  0.9001\n4          cally  AAAAAAAAAOCAAAAA         5140  1.0371  1.1454  1.0928  0.9817  0.9440  0.8814  0.9115\n5            bar  AAAAAAAAAFAAAAAA         5140  1.0551  0.7948  1.1273  0.8950  1.0227  0.8947  0.9197\n6          ation  AAAAAAAANIBAAAAA         5140  1.1455  0.9550  0.9743  1.1013  1.0298  0.9753  0.9400\n7          cally  AAAAAAAAGDCAAAAA         5140  1.2173  1.1156  0.9673  0.8726  0.9709  0.8851  0.8380\n8           able  AAAAAAAAEADAAAAA         5140  1.1808  1.1281  0.8600  1.0373  0.7881  1.0118  0.8608\n9            bar  AAAAAAAAMHBAAAAA         5140  1.2091  1.0105  1.1907  1.0603  0.9556  0.8961  0.8409\n10           ese  AAAAAAAAKHCAAAAA         5140  1.1562  1.1492  1.1767  1.0436  1.0468  0.8910  0.9698\n11           pri  AAAAAAAALCAAAAAA         5140  1.0977  1.1606  1.0771  1.0429  0.8489  0.9074  0.8649\n12           bar  AAAAAAAAENDAAAAA         5140  0.9427  0.9205  0.8335  1.1134  0.9178  0.8041  0.7922\n13          eing  AAAAAAAAOGDAAAAA         5140  1.0388  0.9679  1.1021  1.0970  0.9553  0.8807  0.8273\n14          able  AAAAAAAAECBAAAAA         5140  1.1366  0.9926  1.1657  0.8536  0.8896  0.9571  0.8851\n15          able  AAAAAAAAMEBAAAAA         5140  1.3104  1.0090  1.0905  1.3100  0.9616  0.9911  1.0059\n16           bar  AAAAAAAAMMBAAAAA         5140  1.1105  1.0317  1.0766  1.0082  0.8980  1.1680  0.9423\n17          n st  AAAAAAAAHLBAAAAA         5140  1.0129  0.9803  1.1031  0.9713  0.9493  0.8364  0.9012\n18          anti  AAAAAAAAJBAAAAAA         5140  1.1094  1.0290  1.1246  0.9469  0.9212  0.9080  0.8744\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.36435,
                    "execution_time": 2.194639,
                    "compile_time": 0.095081,
                    "planning_time": 0.059113
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.11119,
                    "execution_time": 2.277544,
                    "compile_time": 6.697856,
                    "planning_time": 0.126078
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            pri  AAAAAAAAFGCAAAAA         5140  1.1110  1.0462  1.0285  0.9923  1.0112  0.9906  0.9666\n1          ought  AAAAAAAADKDAAAAA         5140  1.0758  1.0953  1.1356  0.9753  0.8226  0.9578  0.8964\n2          ation  AAAAAAAAJLCAAAAA         5140  1.2256  1.0896  1.2443  0.9444  0.8259  1.0183  0.9628\n3            pri  AAAAAAAALACAAAAA         5140  0.9436  1.1188  1.2141  1.0657  0.9248  0.9303  0.9001\n4          cally  AAAAAAAAAOCAAAAA         5140  1.0371  1.1454  1.0928  0.9817  0.9440  0.8814  0.9115\n5            bar  AAAAAAAAAFAAAAAA         5140  1.0551  0.7948  1.1273  0.8950  1.0227  0.8947  0.9197\n6          ation  AAAAAAAANIBAAAAA         5140  1.1455  0.9550  0.9743  1.1013  1.0298  0.9753  0.9400\n7          cally  AAAAAAAAGDCAAAAA         5140  1.2173  1.1156  0.9673  0.8726  0.9709  0.8851  0.8380\n8           able  AAAAAAAAEADAAAAA         5140  1.1808  1.1281  0.8600  1.0373  0.7881  1.0118  0.8608\n9            bar  AAAAAAAAMHBAAAAA         5140  1.2091  1.0105  1.1907  1.0603  0.9556  0.8961  0.8409\n10           ese  AAAAAAAAKHCAAAAA         5140  1.1562  1.1492  1.1767  1.0436  1.0468  0.8910  0.9698\n11           pri  AAAAAAAALCAAAAAA         5140  1.0977  1.1606  1.0771  1.0429  0.8489  0.9074  0.8649\n12           bar  AAAAAAAAENDAAAAA         5140  0.9427  0.9205  0.8335  1.1134  0.9178  0.8041  0.7922\n13          eing  AAAAAAAAOGDAAAAA         5140  1.0388  0.9679  1.1021  1.0970  0.9553  0.8807  0.8273\n14          able  AAAAAAAAECBAAAAA         5140  1.1366  0.9926  1.1657  0.8536  0.8896  0.9571  0.8851\n15          able  AAAAAAAAMEBAAAAA         5140  1.3104  1.0090  1.0905  1.3100  0.9616  0.9911  1.0059\n16           bar  AAAAAAAAMMBAAAAA         5140  1.1105  1.0317  1.0766  1.0082  0.8980  1.1680  0.9423\n17          n st  AAAAAAAAHLBAAAAA         5140  1.0129  0.9803  1.1031  0.9713  0.9493  0.8364  0.9012\n18          anti  AAAAAAAAJBAAAAAA         5140  1.1094  1.0290  1.1246  0.9469  0.9212  0.9080  0.8744\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.940322,
                    "execution_time": 0.114612,
                    "compile_time": 0.000414,
                    "planning_time": 0.004346,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.440072,
                    "execution_time": 0.291017,
                    "compile_time": 0.258522,
                    "planning_time": 0.061614,
                    "create_size": 1408
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_ID2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.082476,
                    "execution_time": 5.868932,
                    "compile_time": 0.000662,
                    "planning_time": 0.04275,
                    "create_size": 10752
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.969213,
                    "execution_time": 5.652913,
                    "compile_time": 0.003834,
                    "planning_time": 0.114958,
                    "create_size": 10752
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n1          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n2          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n3          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n4          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n5          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n6          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n7          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n8          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n9          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n10         cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n11         cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n12         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n13         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n14         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n15         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n16         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n17         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n18         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019111,
                    "execution_time": 0.008079,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.00443
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058573,
                    "execution_time": 0.009296,
                    "compile_time": 5e-05,
                    "planning_time": 0.039976
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_15\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_ID2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n1          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n2          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n3          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n4          cally  AAAAAAAACIBAAAAA         5151  2.3676  2.2127  2.3245  2.3607  2.2243  2.6909  2.3966\n5          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n6          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n7          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n8          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n9          cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n10         cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n11         cally  AAAAAAAACIBAAAAA         5176  1.0782  1.0675  1.0447  1.1258  1.2310  1.1446  0.9908\n12         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n13         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n14         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n15         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n16         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n17         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n18         cally  AAAAAAAACIBAAAAA         5145  2.2732  2.4072  2.2183  2.3094  2.2688  2.4840  2.5638\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.614793,
                    "execution_time": 0.619846,
                    "compile_time": 0.000702,
                    "planning_time": 0.048062,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.816724,
                    "execution_time": 0.634868,
                    "compile_time": 0.132085,
                    "planning_time": 0.113964,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n1            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n2            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n3            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n4          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n5          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n6          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n7          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n8          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n9          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n10         cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n11         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n12         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n13         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n14         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n15         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n16         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n17          able  AAAAAAAAINBAAAAA         5140  0.9999  1.0986  1.0596  1.1783  0.8944  1.0748  0.9464\n18          able  AAAAAAAAINBAAAAA         5140  0.9999  1.0986  1.0596  1.1783  0.8944  1.0748  0.9464\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01906,
                    "execution_time": 0.007754,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004495
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056528,
                    "execution_time": 0.00804,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040577
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n1            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n2            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n3            pri  AAAAAAAAJEAAAAAA         5170  1.0136  0.9288  1.1575  1.0754  1.0148  1.2635  0.7637\n4          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n5          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n6          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n7          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n8          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n9          cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n10         cally  AAAAAAAAOBBAAAAA         5170  1.0686  0.8978  1.1571  0.9324  0.8494  1.0393  0.9737\n11         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n12         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n13         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n14         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n15         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n16         ought  AAAAAAAADNAAAAAA         5140  0.8962  0.9326  0.9322  1.1955  0.8981  0.9944  1.1898\n17          able  AAAAAAAAINBAAAAA         5140  0.9999  1.0986  1.0596  1.1783  0.8944  1.0748  0.9464\n18          able  AAAAAAAAINBAAAAA         5140  0.9999  1.0986  1.0596  1.1783  0.8944  1.0748  0.9464\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"S_STORE_NAME1\" , \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n1                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n2                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n3                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n4                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n5                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n6                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n7                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n8                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n9                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n10                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n11                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n12                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n13                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n14                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n15                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n16                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n17                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n18                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030055,
                    "execution_time": 0.017995,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.004955
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.248381,
                    "execution_time": 0.017984,
                    "compile_time": 0.18185,
                    "planning_time": 0.040411
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n1                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n2                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n3                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n4                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n5                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n6                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n7                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n8                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n9                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n10                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n11                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n12                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n13                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n14                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n15                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n16                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n17                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n18                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"S_STORE_NAME1\" , \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n1                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n2                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n3                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n4                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n5                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n6                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n7                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n8                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n9                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n10                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n11                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n12                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n13                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n14                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n15                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n16                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n17                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n18                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.028851,
                    "execution_time": 0.017381,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.00491
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.029024,
                    "execution_time": 0.017338,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004814
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n1                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n2                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n3                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n4                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n5                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n6                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n7                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n8                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n9                 AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n10                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n11                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n12                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n13                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n14                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n15                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n16                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n17                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n18                AAAAAAAAEFCAAAAA         5140  1.0163  1.2269  1.0368  0.9222  0.9555   1.043  1.0854\n...*/"
    }
]