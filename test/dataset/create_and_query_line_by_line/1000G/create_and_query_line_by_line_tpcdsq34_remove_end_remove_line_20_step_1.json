[
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n          from store_sales\n          group by ss_ticket_number, ss_customer_sk) as subquery\njoin customer on customer.c_customer_sk = subquery.ss_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 21.834351,
                    "execution_time": 21.66274,
                    "compile_time": 0.000285,
                    "planning_time": 0.02517,
                    "create_size": 7297
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 21.892928,
                    "execution_time": 21.653859,
                    "compile_time": 0.003348,
                    "planning_time": 0.085112,
                    "create_size": 7297
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.482899,
                    "execution_time": 11.025099,
                    "compile_time": 0.00046,
                    "planning_time": 0.034951,
                    "create_size": 12032
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.108679,
                    "execution_time": 12.58238,
                    "compile_time": 0.005549,
                    "planning_time": 0.095562,
                    "create_size": 12032
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         West    Charlotte         Miss                     N         123747496   15\n1        Berry        Ellen          Dr.                     N           5519044   12\n2    Applegate                                               Y           6975230   10\n3                                   Mrs.                     N         167456032    8\n4         Owen       Jeanie          Ms.                     Y          87940813   13\n5         Wise     Josefina         Miss                     Y         145707704   10\n6       Jansen         Cora          Dr.                     Y          44348623   14\n7     Hoffmann         Tina          Ms.                     N         167812505    7\n8          Roe     Franklin          Sir                     N         203740910    9\n9    Rodriquez         Rita          Ms.                     N         216363437    9\n10       Hicks      Jasmine         Miss                     N          77724983    8\n11         Lee    Bridgette          Dr.                     N          20959006    9\n12       Davis    Josephine         Mrs.                     Y          74790338   14\n13  Swearingen   Bernadette          Dr.                     N         219016902   16\n14      Galvan       Judith         Miss                     Y          37695024    9\n15        Russ       Martin          Dr.                     N         129270995    6\n16       Elder        Helen          Dr.                     Y          89636688    9\n17   Henderson         Vera         Miss                     N          58413310   15\n18      Brewer      Cecilia          Dr.                     Y         178869380   13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018354,
                    "execution_time": 0.008154,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003929
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056502,
                    "execution_time": 0.008151,
                    "compile_time": 0.001158,
                    "planning_time": 0.039218
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         West    Charlotte         Miss                     N         123747496   15\n1        Berry        Ellen          Dr.                     N           5519044   12\n2    Applegate                                               Y           6975230   10\n3                                   Mrs.                     N         167456032    8\n4         Owen       Jeanie          Ms.                     Y          87940813   13\n5         Wise     Josefina         Miss                     Y         145707704   10\n6       Jansen         Cora          Dr.                     Y          44348623   14\n7     Hoffmann         Tina          Ms.                     N         167812505    7\n8          Roe     Franklin          Sir                     N         203740910    9\n9    Rodriquez         Rita          Ms.                     N         216363437    9\n10       Hicks      Jasmine         Miss                     N          77724983    8\n11         Lee    Bridgette          Dr.                     N          20959006    9\n12       Davis    Josephine         Mrs.                     Y          74790338   14\n13  Swearingen   Bernadette          Dr.                     N         219016902   16\n14      Galvan       Judith         Miss                     Y          37695024    9\n15        Russ       Martin          Dr.                     N         129270995    6\n16       Elder        Helen          Dr.                     Y          89636688    9\n17   Henderson         Vera         Miss                     N          58413310   15\n18      Brewer      Cecilia          Dr.                     Y         178869380   13\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       \n       \n       \n       \n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.94439,
                    "execution_time": 4.826132,
                    "compile_time": 0.000274,
                    "planning_time": 0.002975,
                    "create_size": 6273
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 16.08856,
                    "execution_time": 15.913333,
                    "compile_time": 0.002032,
                    "planning_time": 0.058709,
                    "create_size": 6273
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  cnt\n0          170107637    1\n1          194572146   12\n2          227706657    3\n3            8031542    1\n4          183422843    1\n5          224389807    1\n6           69516636   15\n7            7005259    3\n8          178076969   12\n9          187313414   15\n10         199872942    8\n11         171166600    1\n12         225508619   11\n13         226684508    2\n14         196325991    1\n15          94379869   14\n16         116686166    9\n17          25225964    9\n18         169464572    1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017114,
                    "execution_time": 0.008254,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.003011
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055063,
                    "execution_time": 0.007958,
                    "compile_time": 0.000942,
                    "planning_time": 0.038591
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  cnt\n0          170107637    1\n1          194572146   12\n2          227706657    3\n3            8031542    1\n4          183422843    1\n5          224389807    1\n6           69516636   15\n7            7005259    3\n8          178076969   12\n9          187313414   15\n10         199872942    8\n11         171166600    1\n12         225508619   11\n13         226684508    2\n14         196325991    1\n15          94379869   14\n16         116686166    9\n17          25225964    9\n18         169464572    1\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk\n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    group by ss_ticket_number, ss_customer_sk\n   ) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 35.444663,
                    "execution_time": 35.229696,
                    "compile_time": 0.000378,
                    "planning_time": 0.052543,
                    "create_size": 5888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 40.323159,
                    "execution_time": 35.630537,
                    "compile_time": 4.405342,
                    "planning_time": 0.119789,
                    "create_size": 5888
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.193325,
                    "execution_time": 10.745753,
                    "compile_time": 0.000462,
                    "planning_time": 0.02635,
                    "create_size": 12032
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.417467,
                    "execution_time": 10.908038,
                    "compile_time": 0.000455,
                    "planning_time": 0.086801,
                    "create_size": 12032
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Ammons        Ellen         Mrs.                     N         134994597    8\n1     Sullivan      Kenneth          Mr.                     Y          56364193   16\n2          Box        Rhett          Mr.                     Y          66285664   12\n3        Knott      Patrick          Sir                     Y         204564360    8\n4                       Jim          Mr.                     N          66814153   13\n5    Zielinski        Carry          Dr.                     Y          97133991   13\n6        Mundy      Mildred         Mrs.                     N         107248412    8\n7     Peterson        Chris          Mr.                     N         151182893   10\n8    Dominguez        Larry          Mr.                     Y         214466738   11\n9        Scott                       Dr.                               175221332    6\n10    Fletcher        Donna          Dr.                     Y         211598748   10\n11      Harris        Jason          Sir                     Y          95624369   14\n12      Guerra       Cheryl          Dr.                     N         200937217   12\n13       Bryan                       Dr.                               226144200   10\n14       Baird      Matthew          Dr.                     Y         215461663    9\n15     Oglesby      Ignacio          Sir                     N         186746225   13\n16      Graves      Charles          Dr.                     Y         222789810   14\n17      Willis     Clarence          Mr.                     N          96830860    8\n18    Robinson      Vanessa         Miss                     Y          43739701    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0189,
                    "execution_time": 0.008814,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003827
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054023,
                    "execution_time": 0.008249,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039406
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Ammons        Ellen         Mrs.                     N         134994597    8\n1     Sullivan      Kenneth          Mr.                     Y          56364193   16\n2          Box        Rhett          Mr.                     Y          66285664   12\n3        Knott      Patrick          Sir                     Y         204564360    8\n4                       Jim          Mr.                     N          66814153   13\n5    Zielinski        Carry          Dr.                     Y          97133991   13\n6        Mundy      Mildred         Mrs.                     N         107248412    8\n7     Peterson        Chris          Mr.                     N         151182893   10\n8    Dominguez        Larry          Mr.                     Y         214466738   11\n9        Scott                       Dr.                               175221332    6\n10    Fletcher        Donna          Dr.                     Y         211598748   10\n11      Harris        Jason          Sir                     Y          95624369   14\n12      Guerra       Cheryl          Dr.                     N         200937217   12\n13       Bryan                       Dr.                               226144200   10\n14       Baird      Matthew          Dr.                     Y         215461663    9\n15     Oglesby      Ignacio          Sir                     N         186746225   13\n16      Graves      Charles          Dr.                     Y         222789810   14\n17      Willis     Clarence          Mr.                     N          96830860    8\n18    Robinson      Vanessa         Miss                     Y          43739701    9\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    where (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    group by ss_ticket_number, ss_customer_sk) as subquery_name\njoin customer on subquery_name.ss_customer_sk = customer.c_customer_sk\nwhere customer.c_preferred_cust_flag = 'Y'\nand subquery_name.cnt > 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY_NAME\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY_NAME\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY_NAME\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY_NAME\" AS \"SUBQUERY_NAME\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY_NAME\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SUBQUERY_NAME\".\"CNT\" > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 27.248023,
                    "execution_time": 27.034951,
                    "compile_time": 0.000398,
                    "planning_time": 0.050771,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 44.882866,
                    "execution_time": 40.363523,
                    "compile_time": 4.226504,
                    "planning_time": 0.127017,
                    "create_size": 1664
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.390129,
                    "execution_time": 1.948025,
                    "compile_time": 0.000479,
                    "planning_time": 0.027124,
                    "create_size": 2048
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.69814,
                    "execution_time": 2.009383,
                    "compile_time": 0.190491,
                    "planning_time": 0.087999,
                    "create_size": 2048
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Bell      Zachary          Mr.                     Y          11703746   13\n1        Ellis    Nathaniel          Dr.                     Y          71759731   14\n2         Weir        Damon          Mr.                     Y          64284297   14\n3        Story      Charles          Sir                     Y         146777485   16\n4       Sutton     Lorraine         Miss                     Y         101983627    7\n5       Cahill       Thomas          Mr.                     Y          56749548   14\n6      Mcguire       Martha         Miss                     Y          41978293    7\n7     Mitchell      Richard          Mr.                     Y          41979617   13\n8         Hall      Stephen          Sir                     Y         184300519   10\n9      Douglas      Beverly          Ms.                     Y         176790940   11\n10       Moore      Kenneth          Sir                     Y         131817525   13\n11       Tatum        Grace          Ms.                     Y          71774040   10\n12       Pearl        Peggy         Mrs.                     Y          64298532   13\n13      Brooks      Earnest          Sir                     Y         235954679   14\n14       Perez         Carl          Sir                     Y         206819061   13\n15      Graham       George          Mr.                     Y         183445102   12\n16     Leblanc      Carolyn          Dr.                     Y          18501185   10\n17      Tucker       Lester          Dr.                     Y         161595128   15\n18    Williams       Goldie          Dr.                     Y         191022556   14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020817,
                    "execution_time": 0.009564,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003814
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054869,
                    "execution_time": 0.008052,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039014
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Bell      Zachary          Mr.                     Y          11703746   13\n1        Ellis    Nathaniel          Dr.                     Y          71759731   14\n2         Weir        Damon          Mr.                     Y          64284297   14\n3        Story      Charles          Sir                     Y         146777485   16\n4       Sutton     Lorraine         Miss                     Y         101983627    7\n5       Cahill       Thomas          Mr.                     Y          56749548   14\n6      Mcguire       Martha         Miss                     Y          41978293    7\n7     Mitchell      Richard          Mr.                     Y          41979617   13\n8         Hall      Stephen          Sir                     Y         184300519   10\n9      Douglas      Beverly          Ms.                     Y         176790940   11\n10       Moore      Kenneth          Sir                     Y         131817525   13\n11       Tatum        Grace          Ms.                     Y          71774040   10\n12       Pearl        Peggy         Mrs.                     Y          64298532   13\n13      Brooks      Earnest          Sir                     Y         235954679   14\n14       Perez         Carl          Sir                     Y         206819061   13\n15      Graham       George          Mr.                     Y         183445102   12\n16     Leblanc      Carolyn          Dr.                     Y          18501185   10\n17      Tucker       Lester          Dr.                     Y         161595128   15\n18    Williams       Goldie          Dr.                     Y         191022556   14\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n          household_demographics.hd_buy_potential = '1001-1500')\n    group by ss_ticket_number, ss_customer_sk) as sales_data\n   join customer on sales_data.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_DATA\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_DATA\".\"CNT\" AS \"CNT\" FROM \"SALES_DATA\" AS \"SALES_DATA\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_DATA\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.465323,
                    "execution_time": 24.251394,
                    "compile_time": 0.000397,
                    "planning_time": 0.051171,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 33.745993,
                    "execution_time": 29.289481,
                    "compile_time": 4.164229,
                    "planning_time": 0.124857,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.651683,
                    "execution_time": 1.208305,
                    "compile_time": 0.000459,
                    "planning_time": 0.025249,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.770104,
                    "execution_time": 1.254649,
                    "compile_time": 0.003259,
                    "planning_time": 0.086497,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Jensen     Madeline         Mrs.                     Y         152195463   10\n1   Winchester       Melvin          Sir                     Y         135448282   14\n2      Coppola        James          Sir                     Y          34755894   13\n3      Emerson        Paula         Mrs.                     N         211058722    9\n4     Mcdaniel    Catherine          Ms.                     Y          60155117   15\n5     Mcdaniel    Catherine          Ms.                     Y         182134339   10\n6     Mcdaniel    Catherine          Ms.                     Y         197125154   10\n7      Bullock      Francis          Mr.                     N         233926341    8\n8        Doyle        Renee          Dr.                     N          94292947   12\n9        Doyle        Renee          Dr.                     N         155722620   15\n10       Doyle        Renee          Dr.                     N          74494716   15\n11     Seibert        David          Dr.                     Y          49491920   11\n12        Cruz        Dylan          Mr.                     Y         194170070   11\n13       Brown      Michael          Dr.                     Y          73659074   14\n14    Castillo         Brad          Mr.                     N         133042675    8\n15    Castillo         Brad          Mr.                     N           1292117   15\n16      Broome      Dorothy          Ms.                     Y         151180735    8\n17      Bryant      Barbara         Mrs.                     N         127935252   15\n18       Jones       Helena         Mrs.                     Y         195350401    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017937,
                    "execution_time": 0.008029,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003818
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055633,
                    "execution_time": 0.008244,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.03923
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Jensen     Madeline         Mrs.                     Y         152195463   10\n1   Winchester       Melvin          Sir                     Y         135448282   14\n2      Coppola        James          Sir                     Y          34755894   13\n3      Emerson        Paula         Mrs.                     N         211058722    9\n4     Mcdaniel    Catherine          Ms.                     Y          60155117   15\n5     Mcdaniel    Catherine          Ms.                     Y         182134339   10\n6     Mcdaniel    Catherine          Ms.                     Y         197125154   10\n7      Bullock      Francis          Mr.                     N         233926341    8\n8        Doyle        Renee          Dr.                     N          94292947   12\n9        Doyle        Renee          Dr.                     N         155722620   15\n10       Doyle        Renee          Dr.                     N          74494716   15\n11     Seibert        David          Dr.                     Y          49491920   11\n12        Cruz        Dylan          Mr.                     Y         194170070   11\n13       Brown      Michael          Dr.                     Y          73659074   14\n14    Castillo         Brad          Mr.                     N         133042675    8\n15    Castillo         Brad          Mr.                     N           1292117   15\n16      Broome      Dorothy          Ms.                     Y         151180735    8\n17      Bryant      Barbara         Mrs.                     N         127935252   15\n18       Jones       Helena         Mrs.                     Y         195350401    9\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n   ) as subquery_name\n   join customer on subquery_name.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SUBQUERY_NAME\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY_NAME\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY_NAME\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY_NAME\" AS \"SUBQUERY_NAME\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY_NAME\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.58911,
                    "execution_time": 24.376883,
                    "compile_time": 0.000414,
                    "planning_time": 0.049791,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 28.850822,
                    "execution_time": 28.55176,
                    "compile_time": 0.000404,
                    "planning_time": 0.122978,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.225528,
                    "execution_time": 1.78193,
                    "compile_time": 0.000456,
                    "planning_time": 0.025334,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.323762,
                    "execution_time": 1.81618,
                    "compile_time": 0.000452,
                    "planning_time": 0.084682,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Stephenson         Jane         Mrs.                     Y          16410023   13\n1   Stephenson         Jane         Mrs.                     Y          19916726    9\n2         Thao       Dollie          Ms.                     N         105214897    7\n3         Thao       Dollie          Ms.                     N         210186249   14\n4         Thao       Dollie          Ms.                     N         158504158    8\n5       Newman    Catherine          Dr.                     N         218605412    7\n6          Lee        Ricky          Dr.                     Y         117363822   10\n7          Lee        Ricky          Dr.                     Y          21102862   15\n8          Lee        Ricky          Dr.                     Y         163853323   15\n9          Lee        Ricky          Dr.                     Y         164380198    9\n10   Hernandez      Barbara         Miss                     Y          91217527   13\n11   Hernandez      Barbara         Miss                     Y           3262588   11\n12  Mccullough    Christene         Miss                     Y          61608091   12\n13  Mccullough    Christene         Miss                     Y         177072470   14\n14  Mccullough    Christene         Miss                     Y          72397253    9\n15  Mccullough    Christene         Miss                     Y           4458436   11\n16    Martinez       Walter          Sir                     Y         113360685   12\n17       Burns      William          Mr.                     N          71530766   12\n18    Thompson       Ashley          Dr.                     N         121185437   11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018392,
                    "execution_time": 0.008302,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003849
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055716,
                    "execution_time": 0.007859,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039663
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Stephenson         Jane         Mrs.                     Y          16410023   13\n1   Stephenson         Jane         Mrs.                     Y          19916726    9\n2         Thao       Dollie          Ms.                     N         105214897    7\n3         Thao       Dollie          Ms.                     N         210186249   14\n4         Thao       Dollie          Ms.                     N         158504158    8\n5       Newman    Catherine          Dr.                     N         218605412    7\n6          Lee        Ricky          Dr.                     Y         117363822   10\n7          Lee        Ricky          Dr.                     Y          21102862   15\n8          Lee        Ricky          Dr.                     Y         163853323   15\n9          Lee        Ricky          Dr.                     Y         164380198    9\n10   Hernandez      Barbara         Miss                     Y          91217527   13\n11   Hernandez      Barbara         Miss                     Y           3262588   11\n12  Mccullough    Christene         Miss                     Y          61608091   12\n13  Mccullough    Christene         Miss                     Y         177072470   14\n14  Mccullough    Christene         Miss                     Y          72397253    9\n15  Mccullough    Christene         Miss                     Y           4458436   11\n16    Martinez       Walter          Sir                     Y         113360685   12\n17       Burns      William          Mr.                     N          71530766   12\n18    Thompson       Ashley          Dr.                     N         121185437   11\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt \nfrom\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    group by ss_ticket_number, ss_customer_sk) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.50801,
                    "execution_time": 24.290304,
                    "compile_time": 0.000406,
                    "planning_time": 0.055452,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.834437,
                    "execution_time": 29.532749,
                    "compile_time": 0.001518,
                    "planning_time": 0.126308,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.894529,
                    "execution_time": 1.44927,
                    "compile_time": 0.000453,
                    "planning_time": 0.025496,
                    "create_size": 1172
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.954283,
                    "execution_time": 1.446656,
                    "compile_time": 0.000465,
                    "planning_time": 0.086689,
                    "create_size": 1173
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Caldwell         Anna         Mrs.                     N         181360658   15\n1         Kahn        Sarah          Ms.                     N         132766917   13\n2         Kahn        Sarah          Ms.                     N         115366366   14\n3       Bailey        Glenn          Sir                     Y          42198318   13\n4        Pratt      Kenneth          Sir                     N          63651502   13\n5      Collins      William          Dr.                     N         158659039   11\n6         Ware        Donna          Ms.                     Y         105256193   11\n7         Ware        Donna          Ms.                     Y           7472642   14\n8         Ware        Donna          Ms.                     Y         116379018   13\n9         Hall     Marjorie          Dr.                     N         143674719   13\n10        Hall     Marjorie          Dr.                     N         184286771   11\n11       Kirby        Betty          Ms.                     Y          38655278   12\n12    Santiago          Ron                                  Y          38292649    7\n13      Thomas        James          Sir                     Y         177388251   11\n14      Cathey      Cecilia          Dr.                     Y         238933714   11\n15      Harris         Sean          Sir                     Y          72988628   12\n16      Harris         Sean          Sir                     Y         186602170   12\n17      Church      William          Dr.                     N         124202706   12\n18      Church      William          Dr.                     N          21870911   16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018014,
                    "execution_time": 0.007982,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003782
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05509,
                    "execution_time": 0.008371,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039357
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Caldwell         Anna         Mrs.                     N         181360658   15\n1         Kahn        Sarah          Ms.                     N         132766917   13\n2         Kahn        Sarah          Ms.                     N         115366366   14\n3       Bailey        Glenn          Sir                     Y          42198318   13\n4        Pratt      Kenneth          Sir                     N          63651502   13\n5      Collins      William          Dr.                     N         158659039   11\n6         Ware        Donna          Ms.                     Y         105256193   11\n7         Ware        Donna          Ms.                     Y           7472642   14\n8         Ware        Donna          Ms.                     Y         116379018   13\n9         Hall     Marjorie          Dr.                     N         143674719   13\n10        Hall     Marjorie          Dr.                     N         184286771   11\n11       Kirby        Betty          Ms.                     Y          38655278   12\n12    Santiago          Ron                                  Y          38292649    7\n13      Thomas        James          Sir                     Y         177388251   11\n14      Cathey      Cecilia          Dr.                     Y         238933714   11\n15      Harris         Sean          Sir                     Y          72988628   12\n16      Harris         Sean          Sir                     Y         186602170   12\n17      Church      William          Dr.                     N         124202706   12\n18      Church      William          Dr.                     N          21870911   16\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 then 1 else 0 end) = 1 \n    group by ss_ticket_number, ss_customer_sk) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN 1 ELSE 0 END = 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN 1 ELSE 0 END = 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.520061,
                    "execution_time": 24.307246,
                    "compile_time": 0.000399,
                    "planning_time": 0.051168,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.48855,
                    "execution_time": 29.197748,
                    "compile_time": 0.001621,
                    "planning_time": 0.125997,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.866647,
                    "execution_time": 1.421117,
                    "compile_time": 0.00045,
                    "planning_time": 0.025783,
                    "create_size": 1173
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.976445,
                    "execution_time": 1.46993,
                    "compile_time": 0.000447,
                    "planning_time": 0.086194,
                    "create_size": 1173
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Montes         Mark          Sir                     N         190666509   11\n1       Montes         Mark          Sir                     N         157482799   16\n2       Martin        Sarah         Mrs.                     N          39725002    9\n3      Schmidt        Luana          Ms.                     N          23262923    9\n4       Miller         Dana          Mr.                     Y          38917468   11\n5       Hickey      Charles          Mr.                     N         141970806   11\n6    Lancaster     Nicholas          Dr.                     Y          12173682    9\n7        Scott        James          Sir                     Y          74374812   12\n8        Perez       Arthur          Dr.                     N         189766313   15\n9        Perez       Arthur          Dr.                     N         155129138    9\n10       Luong         Tara         Mrs.                     N          51120648   10\n11       Luong         Tara         Mrs.                     N          44447701    9\n12        Dent        Cindy          Ms.                     Y         230039745    8\n13        Dent        Cindy          Ms.                     Y          72514402   15\n14       Akers        Megan          Dr.                     Y          92573634   15\n15       Akers        Megan          Dr.                     Y          81485915   10\n16      Murphy      Vicente          Mr.                     Y          20902164   13\n17    Mayberry         Kent          Dr.                     Y         153266996   16\n18    Mayberry         Kent          Dr.                     Y         235274440   13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017648,
                    "execution_time": 0.007523,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003872
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054354,
                    "execution_time": 0.008598,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039468
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Montes         Mark          Sir                     N         190666509   11\n1       Montes         Mark          Sir                     N         157482799   16\n2       Martin        Sarah         Mrs.                     N          39725002    9\n3      Schmidt        Luana          Ms.                     N          23262923    9\n4       Miller         Dana          Mr.                     Y          38917468   11\n5       Hickey      Charles          Mr.                     N         141970806   11\n6    Lancaster     Nicholas          Dr.                     Y          12173682    9\n7        Scott        James          Sir                     Y          74374812   12\n8        Perez       Arthur          Dr.                     N         189766313   15\n9        Perez       Arthur          Dr.                     N         155129138    9\n10       Luong         Tara         Mrs.                     N          51120648   10\n11       Luong         Tara         Mrs.                     N          44447701    9\n12        Dent        Cindy          Ms.                     Y         230039745    8\n13        Dent        Cindy          Ms.                     Y          72514402   15\n14       Akers        Megan          Dr.                     Y          92573634   15\n15       Akers        Megan          Dr.                     Y          81485915   10\n16      Murphy      Vicente          Mr.                     Y          20902164   13\n17    Mayberry         Kent          Dr.                     Y         153266996   16\n18    Mayberry         Kent          Dr.                     Y         235274440   13\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \nelse 0 end) > 0\n    group by ss_ticket_number, ss_customer_sk\n) as agg_query\njoin customer on agg_query.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"AGG_QUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE 0 END > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"AGG_QUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"AGG_QUERY\".\"CNT\" AS \"CNT\" FROM \"AGG_QUERY\" AS \"AGG_QUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"AGG_QUERY\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE 0 END > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.477577,
                    "execution_time": 24.264914,
                    "compile_time": 0.000393,
                    "planning_time": 0.05058,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.743213,
                    "execution_time": 29.440931,
                    "compile_time": 0.001579,
                    "planning_time": 0.125613,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.713959,
                    "execution_time": 1.275585,
                    "compile_time": 0.000437,
                    "planning_time": 0.025984,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.794265,
                    "execution_time": 1.292531,
                    "compile_time": 0.000444,
                    "planning_time": 0.083569,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Olson       Andrea         Miss                     N          84179415   13\n1     Williams       Robert          Sir                     Y         230438913    7\n2      Freeman      Charles          Sir                     Y          90175121    8\n3      Roberts       Angela          Dr.                     Y         131515431   11\n4      Roberts       Angela          Dr.                     Y         161480033   12\n5       Peters     Lorraine          Ms.                     N         181166140    8\n6        Hardy       Elnora         Mrs.                     Y         120203287    8\n7        Hardy       Elnora         Mrs.                     Y         153237396   14\n8       Norris        Helen         Mrs.                     Y          87981662    7\n9    Hernandez       Amanda         Mrs.                     N         106434455    5\n10        Reid       Melvin          Mr.                     Y         185441787   14\n11        Reid       Melvin          Mr.                     Y         174111556    7\n12        Diaz       Sheila          Dr.                     Y          58988196   15\n13        Lees                       Ms.                                15184477   15\n14        Gunn     Virginia         Miss                     N          12577899   10\n15       Lewis        Doris          Ms.                     N          17267817    8\n16       Lewis        Doris          Ms.                     N          20884414    7\n17         Lee       Jaclyn          Ms.                     N          33336346    6\n18    Hastings        Jason          Dr.                     Y          43785765   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018028,
                    "execution_time": 0.007659,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004072
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 34.696556,
                    "execution_time": 0.008057,
                    "compile_time": 5e-05,
                    "planning_time": 34.677983
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Olson       Andrea         Miss                     N          84179415   13\n1     Williams       Robert          Sir                     Y         230438913    7\n2      Freeman      Charles          Sir                     Y          90175121    8\n3      Roberts       Angela          Dr.                     Y         131515431   11\n4      Roberts       Angela          Dr.                     Y         161480033   12\n5       Peters     Lorraine          Ms.                     N         181166140    8\n6        Hardy       Elnora         Mrs.                     Y         120203287    8\n7        Hardy       Elnora         Mrs.                     Y         153237396   14\n8       Norris        Helen         Mrs.                     Y          87981662    7\n9    Hernandez       Amanda         Mrs.                     N         106434455    5\n10        Reid       Melvin          Mr.                     Y         185441787   14\n11        Reid       Melvin          Mr.                     Y         174111556    7\n12        Diaz       Sheila          Dr.                     Y          58988196   15\n13        Lees                       Ms.                                15184477   15\n14        Gunn     Virginia         Miss                     N          12577899   10\n15       Lewis        Doris          Ms.                     N          17267817    8\n16       Lewis        Doris          Ms.                     N          20884414    7\n17         Lee       Jaclyn          Ms.                     N          33336346    6\n18    Hastings        Jason          Dr.                     Y          43785765   10\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.430515,
                    "execution_time": 24.216683,
                    "compile_time": 0.000406,
                    "planning_time": 0.05152,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 28.667708,
                    "execution_time": 28.37434,
                    "compile_time": 0.001581,
                    "planning_time": 0.128782,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.488593,
                    "execution_time": 1.028934,
                    "compile_time": 0.000456,
                    "planning_time": 0.030926,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.529631,
                    "execution_time": 1.024198,
                    "compile_time": 0.000446,
                    "planning_time": 0.086231,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0    Maldonado        Megan          Ms.                     N         224361814    9\n1     Anderson      Mildred         Mrs.                     Y          67279200    7\n2      Soriano       Daniel          Dr.                     N          35939355    9\n3     Johansen        Carla          Ms.                     N         229805649   11\n4      Cavazos         Matt          Dr.                     Y         196218734   10\n5       Medina        Freda         Mrs.                     Y          60051764   10\n6       Medina        Freda         Mrs.                     Y          34725872   12\n7         Lamb       Wilbur          Sir                     N         107579570    8\n8   Greenfield      Brandon          Mr.                     N         236113188   10\n9      Freeman       Willie          Dr.                     N          52243232   11\n10    Thompson        James          Mr.                                27216516   10\n11        Bell  Christopher          Sir                     Y         226159955   11\n12        Wood     Rosemary          Ms.                     Y         222155210    9\n13        Ware       Steven          Sir                     N         134782292   13\n14        Ware       Steven          Sir                     N          99369537   11\n15        Ware       Steven          Sir                     N          84543289   14\n16        Ware       Steven          Sir                     N          93391220   13\n17   Robertson        Sarah         Mrs.                     Y          43745343   10\n18       Coble      Michael          Dr.                     Y         154511077    7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018813,
                    "execution_time": 0.008356,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004114
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055198,
                    "execution_time": 0.007848,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039336
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0    Maldonado        Megan          Ms.                     N         224361814    9\n1     Anderson      Mildred         Mrs.                     Y          67279200    7\n2      Soriano       Daniel          Dr.                     N          35939355    9\n3     Johansen        Carla          Ms.                     N         229805649   11\n4      Cavazos         Matt          Dr.                     Y         196218734   10\n5       Medina        Freda         Mrs.                     Y          60051764   10\n6       Medina        Freda         Mrs.                     Y          34725872   12\n7         Lamb       Wilbur          Sir                     N         107579570    8\n8   Greenfield      Brandon          Mr.                     N         236113188   10\n9      Freeman       Willie          Dr.                     N          52243232   11\n10    Thompson        James          Mr.                                27216516   10\n11        Bell  Christopher          Sir                     Y         226159955   11\n12        Wood     Rosemary          Ms.                     Y         222155210    9\n13        Ware       Steven          Sir                     N         134782292   13\n14        Ware       Steven          Sir                     N          99369537   11\n15        Ware       Steven          Sir                     N          84543289   14\n16        Ware       Steven          Sir                     N          93391220   13\n17   Robertson        Sarah         Mrs.                     Y          43745343   10\n18       Coble      Michael          Dr.                     Y         154511077    7\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.297378,
                    "execution_time": 2.082994,
                    "compile_time": 0.000417,
                    "planning_time": 0.052086,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.743164,
                    "execution_time": 11.447835,
                    "compile_time": 0.001546,
                    "planning_time": 0.129325,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_20\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.306001,
                    "execution_time": 0.856329,
                    "compile_time": 0.000449,
                    "planning_time": 0.025382,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.371642,
                    "execution_time": 0.861855,
                    "compile_time": 0.000464,
                    "planning_time": 0.0868,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_21\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Mccullough    Christene         Miss                     Y         177072470   14\n1       Palmer     Fletcher          Mr.                     Y          96613856   15\n2        Garza       Carlos          Mr.                     N          13975077   12\n3     Williams        Julia          Dr.                     N         112526880   14\n4     Williams        Julia          Dr.                     N          24758099    8\n5        Smith  Christopher          Dr.                     N         238985656   12\n6       Bryant     Rosemary         Miss                     N          76203204   12\n7       Bryant     Rosemary         Miss                     N          75456614    7\n8   Cunningham        Henry          Sir                     Y          60384937    8\n9        Cooks       Robert          Sir                     Y          77845768   13\n10     Johnson        Janet          Ms.                     N          60612993    8\n11       Perez        Larry          Sir                     N         231735066   14\n12        Rice          Peg          Dr.                     Y          33682417   10\n13      Girard         John          Mr.                     N         108056120   12\n14       Perez      Vanessa         Miss                     N          42975663   13\n15    Whiteman      Carolyn          Dr.                     N          30707689    8\n16     Ferrell        Jorge          Dr.                     N         222518907    9\n17      Nelson        Chris          Mr.                     Y         134131052   12\n18       Biggs        Lilia          Dr.                     Y          46305751   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019341,
                    "execution_time": 0.00843,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004328
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055756,
                    "execution_time": 0.007764,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.03974
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_20\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_21\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Mccullough    Christene         Miss                     Y         177072470   14\n1       Palmer     Fletcher          Mr.                     Y          96613856   15\n2        Garza       Carlos          Mr.                     N          13975077   12\n3     Williams        Julia          Dr.                     N         112526880   14\n4     Williams        Julia          Dr.                     N          24758099    8\n5        Smith  Christopher          Dr.                     N         238985656   12\n6       Bryant     Rosemary         Miss                     N          76203204   12\n7       Bryant     Rosemary         Miss                     N          75456614    7\n8   Cunningham        Henry          Sir                     Y          60384937    8\n9        Cooks       Robert          Sir                     Y          77845768   13\n10     Johnson        Janet          Ms.                     N          60612993    8\n11       Perez        Larry          Sir                     N         231735066   14\n12        Rice          Peg          Dr.                     Y          33682417   10\n13      Girard         John          Mr.                     N         108056120   12\n14       Perez      Vanessa         Miss                     N          42975663   13\n15    Whiteman      Carolyn          Dr.                     N          30707689    8\n16     Ferrell        Jorge          Dr.                     N         222518907    9\n17      Nelson        Chris          Mr.                     Y         134131052   12\n18       Biggs        Lilia          Dr.                     Y          46305751   10\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County')\n    \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n   ) as sales_summary\n   join customer on sales_summary.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.563931,
                    "execution_time": 1.345572,
                    "compile_time": 0.00042,
                    "planning_time": 0.055056,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.117624,
                    "execution_time": 1.663518,
                    "compile_time": 4.153625,
                    "planning_time": 0.131652,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.748645,
                    "execution_time": 0.302588,
                    "compile_time": 0.000443,
                    "planning_time": 0.027567,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.850359,
                    "execution_time": 0.327838,
                    "compile_time": 0.000443,
                    "planning_time": 0.092104,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_23\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0          Lee                       Sir                     Y         193219286   13\n1        Moore     Jennifer         Mrs.                     Y         228845662   10\n2        Hanna         Kate         Mrs.                     Y         118862334    9\n3      Leblanc      Geraldo          Sir                     Y         228839355   15\n4       Gilley       Lesley          Mr.                     Y          35169121    8\n5    Mansfield       Sandra         Mrs.                     Y         100953325   14\n6     Johnston       Sharon         Mrs.                     N         209697857   10\n7      Bernard        Scott          Dr.                     N         202989102   10\n8       Abbott    Elizabeth         Mrs.                     N          32969950    8\n9       Wooten         Sara         Miss                     Y          28790777    8\n10      Greene      Dorothy          Ms.                     Y         171538883   14\n11     Freeman      Herbert          Mr.                     Y         116515041   15\n12       Lewis       Cheryl         Miss                     Y          99048143   14\n13       Jones      Alberta          Dr.                     N         165348006    9\n14     Griffin       Daniel          Sir                     Y         224255774    7\n15    Scoggins         Tony          Dr.                     N          28654734   15\n16        Popp         Eric          Sir                     N          16649072   13\n17     Schmidt        Lynda          Dr.                     N         206737050   11\n18      Dorsey     Brittany          Dr.                     N          51731287   14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019376,
                    "execution_time": 0.00808,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004276
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055377,
                    "execution_time": 0.00776,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039505
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_23\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0          Lee                       Sir                     Y         193219286   13\n1        Moore     Jennifer         Mrs.                     Y         228845662   10\n2        Hanna         Kate         Mrs.                     Y         118862334    9\n3      Leblanc      Geraldo          Sir                     Y         228839355   15\n4       Gilley       Lesley          Mr.                     Y          35169121    8\n5    Mansfield       Sandra         Mrs.                     Y         100953325   14\n6     Johnston       Sharon         Mrs.                     N         209697857   10\n7      Bernard        Scott          Dr.                     N         202989102   10\n8       Abbott    Elizabeth         Mrs.                     N          32969950    8\n9       Wooten         Sara         Miss                     Y          28790777    8\n10      Greene      Dorothy          Ms.                     Y         171538883   14\n11     Freeman      Herbert          Mr.                     Y         116515041   15\n12       Lewis       Cheryl         Miss                     Y          99048143   14\n13       Jones      Alberta          Dr.                     N         165348006    9\n14     Griffin       Daniel          Sir                     Y         224255774    7\n15    Scoggins         Tony          Dr.                     N          28654734   15\n16        Popp         Eric          Sir                     N          16649072   13\n17     Schmidt        Lynda          Dr.                     N         206737050   11\n18      Dorsey     Brittany          Dr.                     N          51731287   14\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.806161,
                    "execution_time": 1.583874,
                    "compile_time": 0.000466,
                    "planning_time": 0.057174,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.96322,
                    "execution_time": 1.658464,
                    "compile_time": 0.001571,
                    "planning_time": 0.137961,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.05187,
                    "execution_time": 0.594804,
                    "compile_time": 0.000446,
                    "planning_time": 0.025952,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.391494,
                    "execution_time": 0.882997,
                    "compile_time": 0.000461,
                    "planning_time": 0.087491,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Castillo         Brad          Mr.                     N           1292117   15\n1      Woodard     Kimberly          Ms.                     Y           1194528    8\n2       Haynes      Stanley          Sir                     N          20956858   13\n3       Potter      Rebecca          Dr.                     Y          15514549    9\n4   Huntington         June          Dr.                     N         215848803    8\n5        Pitts        Laura          Ms.                     Y         197859357    8\n6    Sanderson       Arlene          Dr.                     N          99048835   16\n7         Lamm         John          Dr.                     N          20291086   13\n8         Head       Thomas          Sir                     Y          60277715   10\n9    Schneider       Gladys          Ms.                     N          35941775   12\n10      Wilson      Toshiko          Dr.                     Y         149135347    9\n11       Smith       Joshua          Dr.                     N         105956554    9\n12       Toney        Norma          Dr.                     Y         102443535   11\n13     Johnson       Manuel          Mr.                     Y          81258246   10\n14    Williams        Marie         Miss                     Y          76665308   11\n15     Bolling       Harold          Sir                     N         151844455    8\n16      Rogers        Karen         Miss                     N         238361390    6\n17      Adkins        Twila         Mrs.                     N         134543805   11\n18     Chapman     Beatrice         Mrs.                     Y           2893009   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017471,
                    "execution_time": 0.007516,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003748
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055681,
                    "execution_time": 0.008603,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039631
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Castillo         Brad          Mr.                     N           1292117   15\n1      Woodard     Kimberly          Ms.                     Y           1194528    8\n2       Haynes      Stanley          Sir                     N          20956858   13\n3       Potter      Rebecca          Dr.                     Y          15514549    9\n4   Huntington         June          Dr.                     N         215848803    8\n5        Pitts        Laura          Ms.                     Y         197859357    8\n6    Sanderson       Arlene          Dr.                     N          99048835   16\n7         Lamm         John          Dr.                     N          20291086   13\n8         Head       Thomas          Sir                     Y          60277715   10\n9    Schneider       Gladys          Ms.                     N          35941775   12\n10      Wilson      Toshiko          Dr.                     Y         149135347    9\n11       Smith       Joshua          Dr.                     N         105956554    9\n12       Toney        Norma          Dr.                     Y         102443535   11\n13     Johnson       Manuel          Mr.                     Y          81258246   10\n14    Williams        Marie         Miss                     Y          76665308   11\n15     Bolling       Harold          Sir                     N         151844455    8\n16      Rogers        Karen         Miss                     N         238361390    6\n17      Adkins        Twila         Mrs.                     N         134543805   11\n18     Chapman     Beatrice         Mrs.                     Y           2893009   10\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.311967,
                    "execution_time": 0.197933,
                    "compile_time": 0.000246,
                    "planning_time": 0.003146,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.43116,
                    "execution_time": 0.257028,
                    "compile_time": 0.000243,
                    "planning_time": 0.060211,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Grant        Trena          Dr.                     N          66738356   12\n1        Grant        Trena          Dr.                     N          66738356    1\n2        Grant        Trena          Dr.                     N         150035506   14\n3        Grant        Trena          Dr.                     N         150663418   12\n4        Grant        Trena          Dr.                     N          68172635   13\n5        Grant        Trena          Dr.                     N          14760704    9\n6        Grant        Trena          Dr.                     N         172040783    8\n7        Grant        Trena          Dr.                     N          48774604   11\n8        Grant        Trena          Dr.                     N          81990192   14\n9        Grant        Trena          Dr.                     N         156917276   12\n10       Grant        Trena          Dr.                     N          85900517   16\n11       Grant        Trena          Dr.                     N         121321087    7\n12       Grant        Trena          Dr.                     N          18460899    8\n13       Grant        Trena          Dr.                     N         153417195    9\n14       Grant        Trena          Dr.                     N          24226201   15\n15       Grant        Trena          Dr.                     N         151714640    9\n16       Grant        Trena          Dr.                     N         167816852   11\n17       Grant        Trena          Dr.                     N         138942371   13\n18       Grant        Trena          Dr.                     N         138942371    1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.058181,
                    "execution_time": 0.025791,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.025048
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.176553,
                    "execution_time": 0.075077,
                    "compile_time": 0.001179,
                    "planning_time": 0.080853
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Grant        Trena          Dr.                     N          66738356   12\n1        Grant        Trena          Dr.                     N          66738356    1\n2        Grant        Trena          Dr.                     N         150035506   14\n3        Grant        Trena          Dr.                     N         150663418   12\n4        Grant        Trena          Dr.                     N          68172635   13\n5        Grant        Trena          Dr.                     N          14760704    9\n6        Grant        Trena          Dr.                     N         172040783    8\n7        Grant        Trena          Dr.                     N          48774604   11\n8        Grant        Trena          Dr.                     N          81990192   14\n9        Grant        Trena          Dr.                     N         156917276   12\n10       Grant        Trena          Dr.                     N          85900517   16\n11       Grant        Trena          Dr.                     N         121321087    7\n12       Grant        Trena          Dr.                     N          18460899    8\n13       Grant        Trena          Dr.                     N         153417195    9\n14       Grant        Trena          Dr.                     N          24226201   15\n15       Grant        Trena          Dr.                     N         151714640    9\n16       Grant        Trena          Dr.                     N         167816852   11\n17       Grant        Trena          Dr.                     N         138942371   13\n18       Grant        Trena          Dr.                     N         138942371    1\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Castillo         Brad          Mr.                     N           1292117   15\n1      Woodard     Kimberly          Ms.                     Y           1194528    8\n2       Haynes      Stanley          Sir                     N          20956858   13\n3       Potter      Rebecca          Dr.                     Y          15514549    9\n4   Huntington         June          Dr.                     N         215848803    8\n5        Pitts        Laura          Ms.                     Y         197859357    8\n6    Sanderson       Arlene          Dr.                     N          99048835   16\n7         Lamm         John          Dr.                     N          20291086   13\n8         Head       Thomas          Sir                     Y          60277715   10\n9    Schneider       Gladys          Ms.                     N          35941775   12\n10      Wilson      Toshiko          Dr.                     Y         149135347    9\n11       Smith       Joshua          Dr.                     N         105956554    9\n12       Toney        Norma          Dr.                     Y         102443535   11\n13     Johnson       Manuel          Mr.                     Y          81258246   10\n14    Williams        Marie         Miss                     Y          76665308   11\n15     Bolling       Harold          Sir                     N         151844455    8\n16      Rogers        Karen         Miss                     N         238361390    6\n17      Adkins        Twila         Mrs.                     N         134543805   11\n18     Chapman     Beatrice         Mrs.                     Y           2893009   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023301,
                    "execution_time": 0.013414,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003892
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053132,
                    "execution_time": 0.007578,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Castillo         Brad          Mr.                     N           1292117   15\n1      Woodard     Kimberly          Ms.                     Y           1194528    8\n2       Haynes      Stanley          Sir                     N          20956858   13\n3       Potter      Rebecca          Dr.                     Y          15514549    9\n4   Huntington         June          Dr.                     N         215848803    8\n5        Pitts        Laura          Ms.                     Y         197859357    8\n6    Sanderson       Arlene          Dr.                     N          99048835   16\n7         Lamm         John          Dr.                     N          20291086   13\n8         Head       Thomas          Sir                     Y          60277715   10\n9    Schneider       Gladys          Ms.                     N          35941775   12\n10      Wilson      Toshiko          Dr.                     Y         149135347    9\n11       Smith       Joshua          Dr.                     N         105956554    9\n12       Toney        Norma          Dr.                     Y         102443535   11\n13     Johnson       Manuel          Mr.                     Y          81258246   10\n14    Williams        Marie         Miss                     Y          76665308   11\n15     Bolling       Harold          Sir                     N         151844455    8\n16      Rogers        Karen         Miss                     N         238361390    6\n17      Adkins        Twila         Mrs.                     N         134543805   11\n18     Chapman     Beatrice         Mrs.                     Y           2893009   10\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.223997,
                    "execution_time": 0.056022,
                    "compile_time": 0.039858,
                    "planning_time": 0.00486,
                    "create_size": 711
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.459735,
                    "execution_time": 0.190295,
                    "compile_time": 3.078506,
                    "planning_time": 0.06164,
                    "create_size": 711
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_27\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_27\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Sherman          Sue         Miss                     N         103161860   15\n1     Southern       Angela          Dr.                     N         157129796   15\n2     Williams         Raul          Dr.                     Y          75238389   15\n3      Carlson     Gabriela         Miss                     Y          96825794   15\n4      Perkins        James          Dr.                     N         239246058   15\n5         Koch        Ralph          Mr.                     N         220335485   15\n6      Lawless     Michelle          Ms.                     Y         120470194   16\n7       Norton    Stephanie         Mrs.                     N          24000157   15\n8       Lawson       Dalton          Dr.                     Y          92595478   15\n9        Hicks        James          Dr.                     N         149043592   15\n10     Stevens         Maud          Dr.                     Y         221944762   16\n11     Wheeler      Alberto          Dr.                     Y         122496410   15\n12       Moses      Latonya          Dr.                     N         102592944   16\n13      Gibson         Tami          Ms.                     N         180968148   16\n14       Berry      Matthew          Dr.                     Y          56590409   15\n15      Hardee       Teresa          Ms.                     Y           8494471   15\n16    Castillo      Richard          Sir                     N         184192857   15\n17       Welch         Anna         Mrs.                     Y          45829653   15\n18   Hernandez       Joseph          Dr.                     N          34175303   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017693,
                    "execution_time": 0.00779,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003755
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05402,
                    "execution_time": 0.007622,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038985
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_27\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_27\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Sherman          Sue         Miss                     N         103161860   15\n1     Southern       Angela          Dr.                     N         157129796   15\n2     Williams         Raul          Dr.                     Y          75238389   15\n3      Carlson     Gabriela         Miss                     Y          96825794   15\n4      Perkins        James          Dr.                     N         239246058   15\n5         Koch        Ralph          Mr.                     N         220335485   15\n6      Lawless     Michelle          Ms.                     Y         120470194   16\n7       Norton    Stephanie         Mrs.                     N          24000157   15\n8       Lawson       Dalton          Dr.                     Y          92595478   15\n9        Hicks        James          Dr.                     N         149043592   15\n10     Stevens         Maud          Dr.                     Y         221944762   16\n11     Wheeler      Alberto          Dr.                     Y         122496410   15\n12       Moses      Latonya          Dr.                     N         102592944   16\n13      Gibson         Tami          Ms.                     N         180968148   16\n14       Berry      Matthew          Dr.                     Y          56590409   15\n15      Hardee       Teresa          Ms.                     Y           8494471   15\n16    Castillo      Richard          Sir                     N         184192857   15\n17       Welch         Anna         Mrs.                     Y          45829653   15\n18   Hernandez       Joseph          Dr.                     N          34175303   15\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" DESC , \"SS_TICKET_NUMBER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y           3153986   15\n1                                                            Y           3186982   15\n2                                                            Y           6252332   15\n3                                                            Y          11368224   15\n4                                                            Y          12010629   15\n5                                                            Y          12658818   16\n6                                                            Y          15312223   15\n7                                                            Y          17751751   16\n8                                                            Y          17804623   15\n9                                                            Y          22026021   15\n10                                                           Y          25477617   16\n11                                                           Y          25531351   15\n12                                                           Y          28995304   15\n13                                                           Y          32533350   16\n14                                                           Y          33426205   15\n15                                                           Y          34874680   16\n16                                                           Y          35345928   16\n17                                                           Y          35455637   15\n18                                                           Y          36605758   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038919,
                    "execution_time": 0.013317,
                    "compile_time": 0.012898,
                    "planning_time": 0.005747
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.126273,
                    "execution_time": 0.013364,
                    "compile_time": 3.062503,
                    "planning_time": 0.041116
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y           3153986   15\n1                                                            Y           3186982   15\n2                                                            Y           6252332   15\n3                                                            Y          11368224   15\n4                                                            Y          12010629   15\n5                                                            Y          12658818   16\n6                                                            Y          15312223   15\n7                                                            Y          17751751   16\n8                                                            Y          17804623   15\n9                                                            Y          22026021   15\n10                                                           Y          25477617   16\n11                                                           Y          25531351   15\n12                                                           Y          28995304   15\n13                                                           Y          32533350   16\n14                                                           Y          33426205   15\n15                                                           Y          34874680   16\n16                                                           Y          35345928   16\n17                                                           Y          35455637   15\n18                                                           Y          36605758   15\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" DESC , \"SS_TICKET_NUMBER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y           3153986   15\n1                                                            Y           3186982   15\n2                                                            Y           6252332   15\n3                                                            Y          11368224   15\n4                                                            Y          12010629   15\n5                                                            Y          12658818   16\n6                                                            Y          15312223   15\n7                                                            Y          17751751   16\n8                                                            Y          17804623   15\n9                                                            Y          22026021   15\n10                                                           Y          25477617   16\n11                                                           Y          25531351   15\n12                                                           Y          28995304   15\n13                                                           Y          32533350   16\n14                                                           Y          33426205   15\n15                                                           Y          34874680   16\n16                                                           Y          35345928   16\n17                                                           Y          35455637   15\n18                                                           Y          36605758   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024614,
                    "execution_time": 0.012548,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.005405
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.025279,
                    "execution_time": 0.012839,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.005622
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                                                            Y           3153986   15\n1                                                            Y           3186982   15\n2                                                            Y           6252332   15\n3                                                            Y          11368224   15\n4                                                            Y          12010629   15\n5                                                            Y          12658818   16\n6                                                            Y          15312223   15\n7                                                            Y          17751751   16\n8                                                            Y          17804623   15\n9                                                            Y          22026021   15\n10                                                           Y          25477617   16\n11                                                           Y          25531351   15\n12                                                           Y          28995304   15\n13                                                           Y          32533350   16\n14                                                           Y          33426205   15\n15                                                           Y          34874680   16\n16                                                           Y          35345928   16\n17                                                           Y          35455637   15\n18                                                           Y          36605758   15\n...*/"
    }
]