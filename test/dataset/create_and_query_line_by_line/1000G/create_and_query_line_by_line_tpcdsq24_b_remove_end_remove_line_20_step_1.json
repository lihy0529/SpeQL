[
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select ss_customer_sk  -- Placeholder since customer details are not available in schema\n      ,'unknown' as c_last_name  -- Placeholder value for customer's last name\n      ,'unknown' as c_first_name -- Placeholder value for customer's first name\n      ,'unknown' as s_store_name -- Placeholder value for store name\n      ,'unknown' as ca_state     -- Placeholder value for customer address state\n      ,'unknown' as s_state      -- Placeholder value for store state\n      ,'unknown' as i_color      -- Placeholder value for item color\n      ,0 as i_current_price      -- Placeholder value for item current price\n      ,0 as i_manager_id         -- Placeholder value for item manager ID\n      ,0 as i_units              -- Placeholder value for item units\n      ,0 as i_size               -- Placeholder value for item size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\ngroup by ss_customer_sk)\n/*CURSOR_IDENTIFIER*/ \nselect * from ssales",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , 'unknown' AS \"C_LAST_NAME\" , 'unknown' AS \"C_FIRST_NAME\" , 'unknown' AS \"S_STORE_NAME\" , 'unknown' AS \"CA_STATE\" , 'unknown' AS \"S_STATE\" , 'unknown' AS \"I_COLOR\" , 0 AS \"I_CURRENT_PRICE\" , 0 AS \"I_MANAGER_ID\" , 0 AS \"I_UNITS\" , 0 AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SSALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , 'unknown' AS \"C_LAST_NAME\" , 'unknown' AS \"C_FIRST_NAME\" , 'unknown' AS \"S_STORE_NAME\" , 'unknown' AS \"CA_STATE\" , 'unknown' AS \"S_STATE\" , 'unknown' AS \"I_COLOR\" , 0 AS \"I_CURRENT_PRICE\" , 0 AS \"I_MANAGER_ID\" , 0 AS \"I_UNITS\" , 0 AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 17.749408,
                    "execution_time": 17.209278,
                    "compile_time": 0.000569,
                    "planning_time": 0.025457,
                    "create_size": 2816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 18.843337,
                    "execution_time": 17.474737,
                    "compile_time": 0.765559,
                    "planning_time": 0.085364,
                    "create_size": 2816
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk c_last_name c_first_name s_store_name ca_state  s_state  i_color  i_current_price  i_manager_id  i_units  i_size   netpaid\n0          6851644     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  10195.88\n1         10174332     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11963.56\n2           969287     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11053.39\n3          4405300     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   5055.62\n4          5705922     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   8573.13\n5         10412709     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   6452.45\n6          7833647     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11467.35\n7          3154437     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   8581.58\n8          5922380     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   8391.65\n9          5515427     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7955.43\n10         5123139     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7015.14\n11         6519715     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11149.63\n12          533792     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   6393.98\n13         2794416     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   9598.42\n14         5302090     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   9776.90\n15          536573     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11084.76\n16         8046731     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7484.53\n17        11298021     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   9518.40\n18         3370308     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7805.61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01999,
                    "execution_time": 0.007944,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005092
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.296154,
                    "execution_time": 0.00861,
                    "compile_time": 0.236658,
                    "planning_time": 0.041147
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk c_last_name c_first_name s_store_name ca_state  s_state  i_color  i_current_price  i_manager_id  i_units  i_size   netpaid\n0          6851644     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  10195.88\n1         10174332     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11963.56\n2           969287     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11053.39\n3          4405300     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   5055.62\n4          5705922     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   8573.13\n5         10412709     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   6452.45\n6          7833647     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11467.35\n7          3154437     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   8581.58\n8          5922380     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   8391.65\n9          5515427     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7955.43\n10         5123139     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7015.14\n11         6519715     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11149.63\n12          533792     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   6393.98\n13         2794416     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   9598.42\n14         5302090     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   9776.90\n15          536573     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  11084.76\n16         8046731     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7484.53\n17        11298021     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   9518.40\n18         3370308     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0   7805.61\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_net_paid) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect * from ssales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30.256701,
                    "execution_time": 30.039606,
                    "compile_time": 0.000705,
                    "planning_time": 0.071859,
                    "create_size": 560
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30.085876,
                    "execution_time": 29.779848,
                    "compile_time": 0.000714,
                    "planning_time": 0.158556,
                    "create_size": 560
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_2\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state i_color  i_current_price  i_manager_id  i_units  i_size  netpaid\n0       Morgan      Octavio         eing       MI      OH    pale             0.11            11       Lb   large    64.73\n1       Fuller      Vincent        ought       MI      MI    pale             3.51            63     Each   large   386.24\n2     Matthews    Elizabeth        cally       MD      NC    plum             5.38            69   Bundle     N/A  1454.79\n3       Motley         Gwen         able       AL      TN     tan             4.22            12     Case   large   121.44\n4         Soto                      able       TX      LA   sandy             4.86             6     Case     N/A  2131.20\n5   Washington        Linda        ation       WY      NM  purple             0.37            18      Cup   large  8584.15\n6         Kern      Colleen          bar       GA      GA  salmon             2.01            29      Box     N/A  2503.25\n7        Price         Shay        cally       SD      SD     red             3.72             2     Dram   large    23.10\n8     Gonzalez     Maricela          ese       MI      IN  orange             4.35             2   Bundle     N/A   503.88\n9   Villarreal        Sarah         anti       IA      MN  yellow             4.43             8  Unknown     N/A     8.19\n10        Cobb        Julio        ought       OH      MI    lime             0.82            56    Ounce     N/A   551.72\n11      Newton      Isabell          bar       GA      GA   smoke             6.57             5      Tbl     N/A   402.80\n12      Ramsay      Pauline         able       MS      MN   steel             9.40             3       Oz     N/A   988.80\n13        King      Lillian         able       OH      IN    puff             1.13            22      Box     N/A  3239.08\n14      Newton      Isabell          bar       GA      GA   olive             2.09            12      Cup  medium  3786.24\n15    Williams      Theresa          bar       TX      LA  violet            77.31            82    Pound     N/A  1702.00\n16    Mckenzie   Jacqueline          ese       IN      MI    pink             7.20            45  Unknown     N/A   175.86\n17    Thompson      Alberto        ation       CO      NM    lace             5.91            41   Pallet     N/A  7215.00\n18        King      Lillian         able       OH      IN   brown             7.42            17     Case   large   414.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0203,
                    "execution_time": 0.008155,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005117
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056396,
                    "execution_time": 0.0077,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040894
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_2\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_2\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state i_color  i_current_price  i_manager_id  i_units  i_size  netpaid\n0       Morgan      Octavio         eing       MI      OH    pale             0.11            11       Lb   large    64.73\n1       Fuller      Vincent        ought       MI      MI    pale             3.51            63     Each   large   386.24\n2     Matthews    Elizabeth        cally       MD      NC    plum             5.38            69   Bundle     N/A  1454.79\n3       Motley         Gwen         able       AL      TN     tan             4.22            12     Case   large   121.44\n4         Soto                      able       TX      LA   sandy             4.86             6     Case     N/A  2131.20\n5   Washington        Linda        ation       WY      NM  purple             0.37            18      Cup   large  8584.15\n6         Kern      Colleen          bar       GA      GA  salmon             2.01            29      Box     N/A  2503.25\n7        Price         Shay        cally       SD      SD     red             3.72             2     Dram   large    23.10\n8     Gonzalez     Maricela          ese       MI      IN  orange             4.35             2   Bundle     N/A   503.88\n9   Villarreal        Sarah         anti       IA      MN  yellow             4.43             8  Unknown     N/A     8.19\n10        Cobb        Julio        ought       OH      MI    lime             0.82            56    Ounce     N/A   551.72\n11      Newton      Isabell          bar       GA      GA   smoke             6.57             5      Tbl     N/A   402.80\n12      Ramsay      Pauline         able       MS      MN   steel             9.40             3       Oz     N/A   988.80\n13        King      Lillian         able       OH      IN    puff             1.13            22      Box     N/A  3239.08\n14      Newton      Isabell          bar       GA      GA   olive             2.09            12      Cup  medium  3786.24\n15    Williams      Theresa          bar       TX      LA  violet            77.31            82    Pound     N/A  1702.00\n16    Mckenzie   Jacqueline          ese       IN      MI    pink             7.20            45  Unknown     N/A   175.86\n17    Thompson      Alberto        ation       CO      NM    lace             5.91            41   Pallet     N/A  7215.00\n18        King      Lillian         able       OH      IN   brown             7.42            17     Case   large   414.12\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\nfrom ssales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.076361,
                    "execution_time": 0.039652,
                    "compile_time": 0.000242,
                    "planning_time": 0.003048,
                    "create_size": 144
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.307682,
                    "execution_time": 0.0399,
                    "compile_time": 0.172214,
                    "planning_time": 0.057923,
                    "create_size": 148
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   c_last_name\n0         Gore\n1             \n2      England\n3      Clemons\n4       Graham\n5        Perry\n6        Perry\n7      Simpson\n8          Kay\n9         Webb\n10      Bailey\n11   Rodriguez\n12       Davis\n13    Santiago\n14        Reed\n15            \n16       Young\n17      Lemons\n18    Santiago\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015748,
                    "execution_time": 0.007203,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.002866
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053386,
                    "execution_time": 0.006997,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.038228
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   c_last_name\n0         Gore\n1             \n2      England\n3      Clemons\n4       Graham\n5        Perry\n6        Perry\n7      Simpson\n8          Kay\n9         Webb\n10      Bailey\n11   Rodriguez\n12       Davis\n13    Santiago\n14        Reed\n15            \n16       Young\n17      Lemons\n18    Santiago\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(SS_SALES_PRICE) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 28.929723,
                    "execution_time": 28.755358,
                    "compile_time": 0.000676,
                    "planning_time": 0.081215,
                    "create_size": 312
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.683752,
                    "execution_time": 29.128731,
                    "compile_time": 0.300108,
                    "planning_time": 0.156248,
                    "create_size": 312
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.074242,
                    "execution_time": 0.039836,
                    "compile_time": 0.000304,
                    "planning_time": 0.005634,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.133942,
                    "execution_time": 0.038579,
                    "compile_time": 0.000327,
                    "planning_time": 0.062377,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0       Watson        Sarah          bar   40.16\n1    Armstrong        James          pri   19.20\n2         Wade        David         eing   17.43\n3         Roth        Louis         anti   55.09\n4       Finley       Deanna        ought   36.25\n5     Hamilton        James          pri   20.30\n6      Arteaga         Kent        cally    3.72\n7   Williamson      Eleanor         able   14.60\n8       Hilton      Kathryn         eing    7.75\n9     Anderson      Richard          bar   10.95\n10      Nelson          Ida         able   75.23\n11        Pate        Irene          bar   41.47\n12       Small        Clint         anti    1.44\n13      Norman       Nicole         able   32.45\n14     Sweeney        Donna         able   12.95\n15       Kiser        James         anti   23.97\n16    Lawrence       Muriel         anti   10.45\n17       Brown        Diana         eing   78.49\n18        Chen         Lena        ation   62.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016821,
                    "execution_time": 0.007004,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003755
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054703,
                    "execution_time": 0.007076,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039186
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0       Watson        Sarah          bar   40.16\n1    Armstrong        James          pri   19.20\n2         Wade        David         eing   17.43\n3         Roth        Louis         anti   55.09\n4       Finley       Deanna        ought   36.25\n5     Hamilton        James          pri   20.30\n6      Arteaga         Kent        cally    3.72\n7   Williamson      Eleanor         able   14.60\n8       Hilton      Kathryn         eing    7.75\n9     Anderson      Richard          bar   10.95\n10      Nelson          Ida         able   75.23\n11        Pate        Irene          bar   41.47\n12       Small        Clint         anti    1.44\n13      Norman       Nicole         able   32.45\n14     Sweeney        Donna         able   12.95\n15       Kiser        James         anti   23.97\n16    Lawrence       Muriel         anti   10.45\n17       Brown        Diana         eing   78.49\n18        Chen         Lena        ation   62.53\n...*/"
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": null
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT 0.05 * AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.068245,
                    "execution_time": 0.038002,
                    "compile_time": 0.000302,
                    "planning_time": 0.00391,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.123709,
                    "execution_time": 0.038232,
                    "compile_time": 0.000318,
                    "planning_time": 0.058077,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080703,
                    "execution_time": 0.046671,
                    "compile_time": 0.000359,
                    "planning_time": 0.007179,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.139465,
                    "execution_time": 0.046414,
                    "compile_time": 0.000368,
                    "planning_time": 0.062678,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name   paid\n0                                   eing  42.37\n1      Shapiro      Bridget        ought   8.80\n2      Blakely     Kimberly         eing  20.69\n3       Garcia      Christa        cally  23.75\n4                    Sharon          ese  23.66\n5       Hailey       Dennis        cally   4.91\n6      Hawkins      Kristen        ation  67.96\n7      Lambert      Kristie        ation  25.16\n8        Davis      Marissa         eing  16.86\n9        Moore      Raymond        ought  56.41\n10     Wallace        Abbey         eing  39.39\n11       Chang       Ronald        cally  40.82\n12         Moe     Jennifer        cally  59.50\n13    Jennings      Barbara         able  46.20\n14      Atwood         Adam          ese  19.40\n15    Garrison      Richard        ation   4.44\n16     Rosales         Thuy        cally  62.88\n17       Jones           Ed          ese  24.96\n18      Morris   Bernadette        cally  43.32\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016656,
                    "execution_time": 0.00692,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00367
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055522,
                    "execution_time": 0.007509,
                    "compile_time": 5e-05,
                    "planning_time": 0.039303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name   paid\n0                                   eing  42.37\n1      Shapiro      Bridget        ought   8.80\n2      Blakely     Kimberly         eing  20.69\n3       Garcia      Christa        cally  23.75\n4                    Sharon          ese  23.66\n5       Hailey       Dennis        cally   4.91\n6      Hawkins      Kristen        ation  67.96\n7      Lambert      Kristie        ation  25.16\n8        Davis      Marissa         eing  16.86\n9        Moore      Raymond        ought  56.41\n10     Wallace        Abbey         eing  39.39\n11       Chang       Ronald        cally  40.82\n12         Moe     Jennifer        cally  59.50\n13    Jennings      Barbara         able  46.20\n14      Atwood         Adam          ese  19.40\n15    Garrison      Richard        ation   4.44\n16     Rosales         Thuy        cally  62.88\n17       Jones           Ed          ese  24.96\n18      Morris   Bernadette        cally  43.32\n...*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   able  158.95\n1                    Harold         eing   93.47\n2                    Sharon          ese   23.66\n3                      Jill        cally  154.25\n4                                   eing   42.37\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018862,
                    "execution_time": 0.008561,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.003895
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056129,
                    "execution_time": 0.009157,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.039214
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   able  158.95\n1                    Harold         eing   93.47\n2                    Sharon          ese   23.66\n3                      Jill        cally  154.25\n4                                   eing   42.37\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n        ,c_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   eing   42.37\n1                                   able  158.95\n2                    Harold         eing   93.47\n3                      Jill        cally  154.25\n4                    Sharon          ese   23.66\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018121,
                    "execution_time": 0.007913,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.003996
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054851,
                    "execution_time": 0.008364,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.039464
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   eing   42.37\n1                                   able  158.95\n2                    Harold         eing   93.47\n3                      Jill        cally  154.25\n4                    Sharon          ese   23.66\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   able  158.95\n1                                   eing   42.37\n2                    Harold         eing   93.47\n3                      Jill        cally  154.25\n4                    Sharon          ese   23.66\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018015,
                    "execution_time": 0.001552,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004092
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053587,
                    "execution_time": 0.007982,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.039369
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   able  158.95\n1                                   eing   42.37\n2                    Harold         eing   93.47\n3                      Jill        cally  154.25\n4                    Sharon          ese   23.66\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   able  158.95\n1                                   eing   42.37\n2                    Harold         eing   93.47\n3                      Jill        cally  154.25\n4                    Sharon          ese   23.66\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018499,
                    "execution_time": 0.008375,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.00403
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018972,
                    "execution_time": 0.008615,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.004127
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0                                   able  158.95\n1                                   eing   42.37\n2                    Harold         eing   93.47\n3                      Jill        cally  154.25\n4                    Sharon          ese   23.66\n5        Adams      Gregory        cally   31.74\n6        Amaya        Wonda         anti   57.87\n7     Anderson      Richard          bar   10.95\n8    Armstrong        James          pri   19.20\n9      Arteaga         Kent        cally    3.72\n10      Atwood         Adam          ese   19.40\n11        Baca        Buddy        cally    4.85\n12        Barr    Christian          bar    5.61\n13        Bean      Christy          bar  132.42\n14     Belcher      Allison        cally   86.38\n15      Benson        Homer         anti    8.05\n16     Blakely     Kimberly         eing   20.69\n17        Blue       Helena         eing  141.79\n18     Bowling        Eddie          pri   80.70\n...*/"
    }
]