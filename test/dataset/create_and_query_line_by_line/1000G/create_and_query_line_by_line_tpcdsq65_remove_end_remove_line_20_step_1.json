[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n/*CURSOR_IDENTIFIER*/ \n    where ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217 + 11\n    group by ss_store_sk, ss_item_sk) sc\nwhere s_store_sk = sc.ss_store_sk\n  and i_item_sk = sc.ss_item_sk\n  and s_store_sk = sb.ss_store_sk\n  and sc.revenue <= 0.1 * sb.ave\norder by s_store_name, i_item_desc;",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 12.859967,
                    "execution_time": 12.569656,
                    "compile_time": 0.000347,
                    "planning_time": 0.03691,
                    "create_size": 2816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.590847,
                    "execution_time": 12.309602,
                    "compile_time": 2.913179,
                    "planning_time": 0.105366,
                    "create_size": 2816
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_store_sk  ss_item_sk  revenue\n0           679       11353   407.10\n1          1000      280919   136.99\n2           679       73897   365.47\n3          1000      145661   388.90\n4           824      249151   483.19\n5           824      283119   263.99\n6           235      273085   251.93\n7           646      223117   208.67\n8           646      105485   339.95\n9           646      161599   223.91\n10          193      137849   169.63\n11          572      185695   219.86\n12          646       99469   158.82\n13          572       56195   111.18\n14          952       83533   344.70\n15          154      263167   307.22\n16          904       14721   216.28\n17          904      140077   153.58\n18          538      170755   727.25\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016712,
                    "execution_time": 0.007602,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003205
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054315,
                    "execution_time": 0.007861,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038281
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\", \"STORE_SALES\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_store_sk  ss_item_sk  revenue\n0           679       11353   407.10\n1          1000      280919   136.99\n2           679       73897   365.47\n3          1000      145661   388.90\n4           824      249151   483.19\n5           824      283119   263.99\n6           235      273085   251.93\n7           646      223117   208.67\n8           646      105485   339.95\n9           646      161599   223.91\n10          193      137849   169.63\n11          572      185695   219.86\n12          646       99469   158.82\n13          572       56195   111.18\n14          952       83533   344.70\n15          154      263167   307.22\n16          904       14721   216.28\n17          904      140077   153.58\n18          538      170755   727.25\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store s, item i,\n     (select sa.ss_store_sk, avg(sa.revenue) as ave\n \tfrom\n \t    (select ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by sa.ss_store_sk) sb,\n     (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n    group by ss_store_sk, ss_item_sk) sc\nwhere s.s_store_sk = sb.ss_store_sk\n    and s.s_store_sk = sc.ss_store_sk\n    and i.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SB\" AS \"SB\" ON \"S\".\"S_STORE_SK\" = \"SB\".\"SS_STORE_SK\" JOIN \"SC\" AS \"SC\" ON \"S\".\"S_STORE_SK\" = \"SC\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081173,
                    "execution_time": 0.031044,
                    "compile_time": 0.000224,
                    "planning_time": 0.027022,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.294315,
                    "execution_time": 0.031098,
                    "compile_time": 0.144845,
                    "planning_time": 0.093431,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.804444,
                    "execution_time": 8.704563,
                    "compile_time": 0.000351,
                    "planning_time": 0.028893,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.804965,
                    "execution_time": 8.573742,
                    "compile_time": 3.059775,
                    "planning_time": 0.096089,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119938,
                    "execution_time": 0.091577,
                    "compile_time": 0.000289,
                    "planning_time": 0.003403,
                    "create_size": 500
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.183565,
                    "execution_time": 0.094664,
                    "compile_time": 0.001184,
                    "planning_time": 0.061293,
                    "create_size": 500
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 13.12104,
                    "execution_time": 12.837809,
                    "compile_time": 0.000361,
                    "planning_time": 0.028653,
                    "create_size": 2816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.660586,
                    "execution_time": 12.309195,
                    "compile_time": 0.001446,
                    "planning_time": 0.091894,
                    "create_size": 2816
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 22.105006,
                    "execution_time": 21.457231,
                    "compile_time": 0.000649,
                    "planning_time": 0.04129,
                    "create_size": 16247
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30.416836,
                    "execution_time": 29.698492,
                    "compile_time": 0.007766,
                    "planning_time": 0.113093,
                    "create_size": 16252
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                            i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0           ese                                                                                    Able economies need even waiting developers. White days say even due to a pages; social, empty families may not go    260.03             3.40              1.93    edu packimporto #2\n1         ation                                                                      Eyes see black, big effects. Similar, excellent companies cultivate then small arrangements; campaigns could go blank parties. Co   196.91             2.53              1.46         amalgmaxi #12\n2         ation                               Little high women must read morally to the plants; head opportunities ought to go about previous holes; years can get so now english hospitals. Silently visible members   321.74             5.31              3.13     exportischolar #2\n3           ese                                                                               Important, available eyes must assist high discussions; long central couples penetrate for a notes. Simple, dear tests c    80.58             3.70              1.73    edu packimporto #2\n4           bar                                                                    Video-taped objects see muscles. American, coming towns remain as per a winners. Various students try local others. High, tiny acco    36.30             0.97              0.57    importoedu pack #2\n5          eing                                                                                                           Different cases go officially professional areas; likely, british efforts must use sometimes   193.30             4.22              5.44       exportibrand #8\n6          eing                                                                                                                                                                                                      C   305.40            30.93              2.93        scholarmaxi #4\n7          eing                                                                                                                                      Elements should enable economic, boring users. Highly gay groups    197.44             8.13              5.12    edu packscholar #2\n8          eing                                                                                                                                             Huge cards know then grounds. Weekends tell. Councillors w   201.44             0.52              0.32          corpbrand #4\n9          eing                                                                                      Games take perhaps sure values; especially international markets will think sometimes overall fingers. Voters see   214.08             1.24              0.89       corpnameless #2\n10          ese                                                                                                                                                                                    Different links enc   238.58            83.43             46.72    edu packimporto #2\n11          ese                     Merchants specify so good needs. Of course main elections must not make alternatively direct, quick fans. Thinking, mad policies ought to bow past drawings. Eyes help at least be   343.00             4.83              1.69      corpunivamalg #8\n12          bar                                     Exciting feet should not think again answers; american eyes dance. Very free years used to matter however perfect far tenants. Particular generations could dictat   244.54             7.89              5.91     importoscholar #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017646,
                    "execution_time": 0.007729,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.00376
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060654,
                    "execution_time": 0.012264,
                    "compile_time": 0.000869,
                    "planning_time": 0.039084
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                            i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0           ese                                                                                    Able economies need even waiting developers. White days say even due to a pages; social, empty families may not go    260.03             3.40              1.93    edu packimporto #2\n1         ation                                                                      Eyes see black, big effects. Similar, excellent companies cultivate then small arrangements; campaigns could go blank parties. Co   196.91             2.53              1.46         amalgmaxi #12\n2         ation                               Little high women must read morally to the plants; head opportunities ought to go about previous holes; years can get so now english hospitals. Silently visible members   321.74             5.31              3.13     exportischolar #2\n3           ese                                                                               Important, available eyes must assist high discussions; long central couples penetrate for a notes. Simple, dear tests c    80.58             3.70              1.73    edu packimporto #2\n4           bar                                                                    Video-taped objects see muscles. American, coming towns remain as per a winners. Various students try local others. High, tiny acco    36.30             0.97              0.57    importoedu pack #2\n5          eing                                                                                                           Different cases go officially professional areas; likely, british efforts must use sometimes   193.30             4.22              5.44       exportibrand #8\n6          eing                                                                                                                                                                                                      C   305.40            30.93              2.93        scholarmaxi #4\n7          eing                                                                                                                                      Elements should enable economic, boring users. Highly gay groups    197.44             8.13              5.12    edu packscholar #2\n8          eing                                                                                                                                             Huge cards know then grounds. Weekends tell. Councillors w   201.44             0.52              0.32          corpbrand #4\n9          eing                                                                                      Games take perhaps sure values; especially international markets will think sometimes overall fingers. Voters see   214.08             1.24              0.89       corpnameless #2\n10          ese                                                                                                                                                                                    Different links enc   238.58            83.43             46.72    edu packimporto #2\n11          ese                     Merchants specify so good needs. Of course main elections must not make alternatively direct, quick fans. Thinking, mad policies ought to bow past drawings. Eyes help at least be   343.00             4.83              1.69      corpunivamalg #8\n12          bar                                     Exciting feet should not think again answers; american eyes dance. Very free years used to matter however perfect far tenants. Particular generations could dictat   244.54             7.89              5.91     importoscholar #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SC\" AS \"SC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.675405,
                    "execution_time": 1.510455,
                    "compile_time": 0.000254,
                    "planning_time": 0.003033,
                    "create_size": 2048
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.841827,
                    "execution_time": 4.60794,
                    "compile_time": 0.000259,
                    "planning_time": 0.060513,
                    "create_size": 2048
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_7\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_7\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost           i_brand\n0         ought           F   362.00             4.46              0.85  edu packamalg #2\n1         ought           F   119.55             4.46              0.85  edu packamalg #2\n2         ought           F   244.31             4.46              0.85  edu packamalg #2\n3         ought           F   204.66             4.46              0.85  edu packamalg #2\n4         ought           F   276.76             4.46              0.85  edu packamalg #2\n5         ought           F   306.52             4.46              0.85  edu packamalg #2\n6         ought           F   206.72             4.46              0.85  edu packamalg #2\n7         ought           F   204.99             4.46              0.85  edu packamalg #2\n8         ought           F   331.86             4.46              0.85  edu packamalg #2\n9         ought           F   284.76             4.46              0.85  edu packamalg #2\n10        ought           F   103.75             4.46              0.85  edu packamalg #2\n11        ought           F   126.84             4.46              0.85  edu packamalg #2\n12        ought           F   354.39             4.46              0.85  edu packamalg #2\n13        ought           F   446.63             4.46              0.85  edu packamalg #2\n14        ought           F   386.89             4.46              0.85  edu packamalg #2\n15        ought           F   335.77             4.46              0.85  edu packamalg #2\n16        ought           F   367.33             4.46              0.85  edu packamalg #2\n17        ought           F   152.42             4.46              0.85  edu packamalg #2\n18        ought           F   201.75             4.46              0.85  edu packamalg #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.63327,
                    "execution_time": 2.550671,
                    "compile_time": 0.037677,
                    "planning_time": 0.037068
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.20853,
                    "execution_time": 2.732407,
                    "compile_time": 3.35413,
                    "planning_time": 0.10003
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_7\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_7\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost           i_brand\n0         ought           F   362.00             4.46              0.85  edu packamalg #2\n1         ought           F   119.55             4.46              0.85  edu packamalg #2\n2         ought           F   244.31             4.46              0.85  edu packamalg #2\n3         ought           F   204.66             4.46              0.85  edu packamalg #2\n4         ought           F   276.76             4.46              0.85  edu packamalg #2\n5         ought           F   306.52             4.46              0.85  edu packamalg #2\n6         ought           F   206.72             4.46              0.85  edu packamalg #2\n7         ought           F   204.99             4.46              0.85  edu packamalg #2\n8         ought           F   331.86             4.46              0.85  edu packamalg #2\n9         ought           F   284.76             4.46              0.85  edu packamalg #2\n10        ought           F   103.75             4.46              0.85  edu packamalg #2\n11        ought           F   126.84             4.46              0.85  edu packamalg #2\n12        ought           F   354.39             4.46              0.85  edu packamalg #2\n13        ought           F   446.63             4.46              0.85  edu packamalg #2\n14        ought           F   386.89             4.46              0.85  edu packamalg #2\n15        ought           F   335.77             4.46              0.85  edu packamalg #2\n16        ought           F   367.33             4.46              0.85  edu packamalg #2\n17        ought           F   152.42             4.46              0.85  edu packamalg #2\n18        ought           F   201.75             4.46              0.85  edu packamalg #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and sc.ss_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SB\" AS \"SB\" JOIN \"SC\" AS \"SC\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"SS_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n      sc.ss_item_sk = sc.ss_item_sk\n      and store.s_store_sk = sb.ss_store_sk\n      and item.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SC\" AS \"SC\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" AND \"SC\".\"SS_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC WHERE SB.SS_STORE_SK = SC.SS_STORE_SK AND SC.REVENUE <= 0.1 * SB.AVE AND SC.SS_ITEM_SK = SC.SS_ITEM_SK AND STORE.S_STORE_SK = SB.SS_STORE_SK AND ITEM.I_ITEM_SK = SC.SS_ITEM_SK LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                             i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0         ought     Inhabitants would not give afterwards. German ladies look nearby independent, excellent contexts. Eventually causal flowers put tonight. Critical visitors can supply perhaps colle    18.45            43.59             35.74  scholarunivamalg #12\n1          anti                                                                                                                                     More sheer feet will make increasingly communities.    19.18             4.78              2.62    edu packexporti #2\n2          eing                                                                                                                                         Overseas discussions mean drawings. Then senior    10.01             1.25              1.18    edu packimporto #2\n3          eing  Colleagues can abandon small rebels; more available consumers will set. High aims will appear different causes. About vast houses work over. Requests can run even rooms; highly diffe     1.73             6.17              0.58      edu packamalg #2\n4           ese                                                                                                                                                                                       R    10.99             2.44              1.80       importoamalg #2\n5          anti                                                                                                                                                                                 There d     1.02            28.90              8.67   edu packedu pack #2\n6         cally   Affairs learn forward. Good, successive seats take shares. Now financial votes may gather even. Broad, level things find certainly pretty, german cases. Basic publications could sel    19.18             1.26              0.64  namelessunivamalg #3\n7          eing               Occupational, senior novels ought to end merely however other passengers. Here appropriate lines can argue most rights. Times guarantee seeds. Cold friends will skip mor    17.02            55.89              1.38    edu packexporti #2\n8          eing                                                                                                                                                          Only historical hours help maj     9.98             9.46              5.45       edu packcorp #3\n9           ese                                                                                                                                                                      Necessary, fair al     9.55             1.71              0.53       exportiamalg #1\n10        cally                                                                      Young, immense beliefs must keep then commonly semantic groups. Definitions can look then likely, evolutionary mar     5.09             0.22              0.15    edu packimporto #1\n11         able                              Again similar prices know perhaps. Possible, normal authorities might plan already important drugs. Sufficient sources may not change away pockets. Thus c     2.44             6.47              2.71     univamalgamalg #2\n12          bar                                                                        Strong, sorry statements know also. National things will not update public points. Whole actions must not work o    18.67             1.02              9.44          maxibrand #3\n13        cally                                                                               Only formal premises show just to the police. Events would not contact well good relationships. New, econ    18.16             3.68              2.13    scholarnameless #8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 13.214658,
                    "execution_time": 12.728198,
                    "compile_time": 0.096841,
                    "planning_time": 12.919306
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 20.312274,
                    "execution_time": 12.998066,
                    "compile_time": 6.888525,
                    "planning_time": 16.92405
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name                                                                                                                                                                             i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0         ought     Inhabitants would not give afterwards. German ladies look nearby independent, excellent contexts. Eventually causal flowers put tonight. Critical visitors can supply perhaps colle    18.45            43.59             35.74  scholarunivamalg #12\n1          anti                                                                                                                                     More sheer feet will make increasingly communities.    19.18             4.78              2.62    edu packexporti #2\n2          eing                                                                                                                                         Overseas discussions mean drawings. Then senior    10.01             1.25              1.18    edu packimporto #2\n3          eing  Colleagues can abandon small rebels; more available consumers will set. High aims will appear different causes. About vast houses work over. Requests can run even rooms; highly diffe     1.73             6.17              0.58      edu packamalg #2\n4           ese                                                                                                                                                                                       R    10.99             2.44              1.80       importoamalg #2\n5          anti                                                                                                                                                                                 There d     1.02            28.90              8.67   edu packedu pack #2\n6         cally   Affairs learn forward. Good, successive seats take shares. Now financial votes may gather even. Broad, level things find certainly pretty, german cases. Basic publications could sel    19.18             1.26              0.64  namelessunivamalg #3\n7          eing               Occupational, senior novels ought to end merely however other passengers. Here appropriate lines can argue most rights. Times guarantee seeds. Cold friends will skip mor    17.02            55.89              1.38    edu packexporti #2\n8          eing                                                                                                                                                          Only historical hours help maj     9.98             9.46              5.45       edu packcorp #3\n9           ese                                                                                                                                                                      Necessary, fair al     9.55             1.71              0.53       exportiamalg #1\n10        cally                                                                      Young, immense beliefs must keep then commonly semantic groups. Definitions can look then likely, evolutionary mar     5.09             0.22              0.15    edu packimporto #1\n11         able                              Again similar prices know perhaps. Possible, normal authorities might plan already important drugs. Sufficient sources may not change away pockets. Thus c     2.44             6.47              2.71     univamalgamalg #2\n12          bar                                                                        Strong, sorry statements know also. National things will not update public points. Whole actions must not work o    18.67             1.02              9.44          maxibrand #3\n13        cally                                                                               Only formal premises show just to the police. Events would not contact well good relationships. New, econ    18.16             3.68              2.13    scholarnameless #8\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       store.s_store_sk = sc.ss_store_sk and\n      item.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC WHERE SB.SS_STORE_SK = SC.SS_STORE_SK AND SC.REVENUE <= 0.1 * SB.AVE AND STORE.S_STORE_SK = SC.SS_STORE_SK AND ITEM.I_ITEM_SK = SC.SS_ITEM_SK LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                              i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0           pri  Hands used to permit important, human influences; charges could hurt even paradoxically past notions. Exact, new societies could obstruct from the records. Special documents used to know nervously. W    20.50             3.91             53.30       amalgedu pack #2\n1           ese                                                                                                                                                             Elements take fully cold boxes; financial ca     3.79             3.52              2.78         scholarmaxi #4\n2         cally                                 Women want probably pockets. New requirements support again. Accounts call above relationships. Local, young months used to no now cold forms; elections help without th    17.00             3.60              2.91     exportiedu pack #2\n3         ought                                                                                                                                         In short british governments see. Also environmental winds must     15.18             4.76              3.90        importobrand #2\n4         ought                                                                                                                                         Either exact premises will not service too voluntary hundreds; s     6.59             3.81              2.81       amalgedu pack #2\n5         ought                                                     Always general weeks prove. Cognitive colours know. Significant circumstances must not provide only things. Possible, relative guests would not save    14.46             7.04              2.38  edu packamalgamalg #2\n6           bar                                                                                                                              Yet early cases may not comply probably recent single americans. Free quant    10.04             5.48              4.65      exportiimporto #2\n7           bar                                                                                                                                                       Racial, logical problems consider just various wom     7.68             6.56              1.43       edu packamalg #2\n8          eing                                                                                                                                                                           Forwards political variations     12.76             3.05              1.58    edu packedu pack #2\n9          anti                                                                                                                                      Clinical, inc initiatives make specially according to a activities.    11.44             0.84              5.53       edu packamalg #2\n10        ation                                                                                                                                                                               Early orders acknowledge n     9.45             0.85              4.05         scholarmaxi #7\n11        ought                                                                                                                                                              Always harsh competitors halt. Far likely w     5.71             6.09              1.13       edu packamalg #1\n12         eing                                                   Very small parties talk english, long towns. Identical workers require methods; for example great forms argue now valuable, ridiculous terms. Rather a    18.98             9.66              4.73           amalgcorp #8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 13.306064,
                    "execution_time": 12.960834,
                    "compile_time": 0.000608,
                    "planning_time": 13.103664
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 13.37301,
                    "execution_time": 12.960179,
                    "compile_time": 0.000609,
                    "planning_time": 13.179652
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name                                                                                                                                                                                              i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0           pri  Hands used to permit important, human influences; charges could hurt even paradoxically past notions. Exact, new societies could obstruct from the records. Special documents used to know nervously. W    20.50             3.91             53.30       amalgedu pack #2\n1           ese                                                                                                                                                             Elements take fully cold boxes; financial ca     3.79             3.52              2.78         scholarmaxi #4\n2         cally                                 Women want probably pockets. New requirements support again. Accounts call above relationships. Local, young months used to no now cold forms; elections help without th    17.00             3.60              2.91     exportiedu pack #2\n3         ought                                                                                                                                         In short british governments see. Also environmental winds must     15.18             4.76              3.90        importobrand #2\n4         ought                                                                                                                                         Either exact premises will not service too voluntary hundreds; s     6.59             3.81              2.81       amalgedu pack #2\n5         ought                                                     Always general weeks prove. Cognitive colours know. Significant circumstances must not provide only things. Possible, relative guests would not save    14.46             7.04              2.38  edu packamalgamalg #2\n6           bar                                                                                                                              Yet early cases may not comply probably recent single americans. Free quant    10.04             5.48              4.65      exportiimporto #2\n7           bar                                                                                                                                                       Racial, logical problems consider just various wom     7.68             6.56              1.43       edu packamalg #2\n8          eing                                                                                                                                                                           Forwards political variations     12.76             3.05              1.58    edu packedu pack #2\n9          anti                                                                                                                                      Clinical, inc initiatives make specially according to a activities.    11.44             0.84              5.53       edu packamalg #2\n10        ation                                                                                                                                                                               Early orders acknowledge n     9.45             0.85              4.05         scholarmaxi #7\n11        ought                                                                                                                                                              Always harsh competitors halt. Far likely w     5.71             6.09              1.13       edu packamalg #1\n12         eing                                                   Very small parties talk english, long towns. Identical workers require methods; for example great forms argue now valuable, ridiculous terms. Rather a    18.98             9.66              4.73           amalgcorp #8\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC WHERE SB.SS_STORE_SK = SC.SS_STORE_SK AND SC.REVENUE <= 0.1 * SB.AVE AND S_STORE_SK = SC.SS_STORE_SK AND I_ITEM_SK = SC.SS_ITEM_SK LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                              i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                               Offers could understand documents; local years shall make please available reasons. Alternative, english aspects might run poor assessments. Together maximum clothes woul    15.77             7.10              3.12         amalgamalg #2\n1          able                                                                                               Relations would say blind years. Buildings make purely eyes. Similar, successful orders give together smal     9.85             6.53              5.81      amalgnameless #8\n2          able                                                      Still important trials shall not dare somewhere cells. Normally administrative demands cannot produce never true goods. Firms ought to acquire so y    20.48             3.24              4.92    edu packscholar #2\n3         cally                                                                                           Effects shall cope still important beds; just poor improvements make available, main sales. Young, important t     8.07             0.49              1.43    edu packexporti #1\n4          anti                                                                                                 Gently thick words should not know best national hot banks. True, international persons kill front ways.     5.15             0.76              0.47   edu packedu pack #1\n5                                                                                       Afraid, available supplies could like commonly resources; recommendations shall create internal savings. For example spanish own    14.64             2.76              3.83  importoamalgamalg #7\n6         ought                           Hot, commercial eyes occur economic, social molecules. Secret, compatible points blame. Panels see however present observations. Successful days bring with a friends. Public      5.55            55.09             26.99      namelessbrand #1\n7         ought  Members occur automatically thence cultural leaders. Empty hands could participate. Stages could not describe now texts. Lines may play really objections. Small, labour others can begin so back piece     3.90             3.23             22.95       univnameless #1\n8          n st        Initially only figures pour effects. Long, equal jobs carry other leaders. Only kinds cannot protect impressive, young songs. Short rates will accept. More financial firms work yesterday casual    14.78             1.64              1.20    brandunivamalg #12\n9         ought                      Great reservations should develop usually by a countries. Black practices get past a gates. Level, revolutionary markets might let safely at least good years. Other, national disc     3.89             6.62             65.53        importomaxi #9\n10          bar                            Systems used to believe various elections. Existing models will stand about loyal men. Partial, new men see. Institutions travel by the studies. Main, human individuals need    19.32             2.15              0.94    exportiedu pack #1\n11         eing                                                                                                                                                             Free courts may not influence appeals. Small    12.16             4.91              1.64      amalgnameless #3\n12         eing                                                                                                                                                                                    Moments build earlier    18.12             5.91              0.15       amalgexporti #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 12.599142,
                    "execution_time": 12.25058,
                    "compile_time": 0.000613,
                    "planning_time": 12.402533
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 13.04523,
                    "execution_time": 12.617075,
                    "compile_time": 0.000623,
                    "planning_time": 12.847634
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name                                                                                                                                                                                              i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                               Offers could understand documents; local years shall make please available reasons. Alternative, english aspects might run poor assessments. Together maximum clothes woul    15.77             7.10              3.12         amalgamalg #2\n1          able                                                                                               Relations would say blind years. Buildings make purely eyes. Similar, successful orders give together smal     9.85             6.53              5.81      amalgnameless #8\n2          able                                                      Still important trials shall not dare somewhere cells. Normally administrative demands cannot produce never true goods. Firms ought to acquire so y    20.48             3.24              4.92    edu packscholar #2\n3         cally                                                                                           Effects shall cope still important beds; just poor improvements make available, main sales. Young, important t     8.07             0.49              1.43    edu packexporti #1\n4          anti                                                                                                 Gently thick words should not know best national hot banks. True, international persons kill front ways.     5.15             0.76              0.47   edu packedu pack #1\n5                                                                                       Afraid, available supplies could like commonly resources; recommendations shall create internal savings. For example spanish own    14.64             2.76              3.83  importoamalgamalg #7\n6         ought                           Hot, commercial eyes occur economic, social molecules. Secret, compatible points blame. Panels see however present observations. Successful days bring with a friends. Public      5.55            55.09             26.99      namelessbrand #1\n7         ought  Members occur automatically thence cultural leaders. Empty hands could participate. Stages could not describe now texts. Lines may play really objections. Small, labour others can begin so back piece     3.90             3.23             22.95       univnameless #1\n8          n st        Initially only figures pour effects. Long, equal jobs carry other leaders. Only kinds cannot protect impressive, young songs. Short rates will accept. More financial firms work yesterday casual    14.78             1.64              1.20    brandunivamalg #12\n9         ought                      Great reservations should develop usually by a countries. Black practices get past a gates. Level, revolutionary markets might let safely at least good years. Other, national disc     3.89             6.62             65.53        importomaxi #9\n10          bar                            Systems used to believe various elections. Existing models will stand about loyal men. Partial, new men see. Institutions travel by the studies. Main, human individuals need    19.32             2.15              0.94    exportiedu pack #1\n11         eing                                                                                                                                                             Free courts may not influence appeals. Small    12.16             4.91              1.64      amalgnameless #3\n12         eing                                                                                                                                                                                    Moments build earlier    18.12             5.91              0.15       amalgexporti #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC WHERE SB.SS_STORE_SK = SC.SS_STORE_SK AND SC.REVENUE <= 0.1 * SB.AVE AND S_STORE_SK = SC.SS_STORE_SK AND I_ITEM_SK = SC.SS_ITEM_SK ORDER BY S_STORE_NAME NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0                               6.40              NaN              1.46                       \n1                               6.35              NaN              3.58                       \n2                              12.04              NaN               NaN                       \n3                               3.07              NaN               NaN                       \n4                              19.09              NaN              0.62                       \n5                              16.10              NaN              1.18                       \n6                               5.86             0.69              0.57     importoedu pack #1\n7                               8.51             6.65               NaN        amalgscholar #1\n8                               5.20             1.62               NaN                       \n9                              15.06              NaN               NaN    scholarunivamalg #3\n10                             18.53             5.65               NaN      exportiimporto #1\n11                             15.55              NaN               NaN                       \n12                              6.26             1.45               NaN                       \n13                             14.43             1.80               NaN                       \n14                             16.30             1.96              0.98                       \n15                              5.09             2.78              2.06        amalgexporti #1\n16                             10.61              NaN               NaN  exportiamalgamalg #16\n17                             19.65             4.64               NaN                       \n18                              8.26             0.28              1.79     corpamalgamalg #17\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 13.689258,
                    "execution_time": 13.266262,
                    "compile_time": 0.074089,
                    "planning_time": 13.051061
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 20.90092,
                    "execution_time": 17.15142,
                    "compile_time": 4.476351,
                    "planning_time": 13.210786
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0                               6.40              NaN              1.46                       \n1                               6.35              NaN              3.58                       \n2                              12.04              NaN               NaN                       \n3                               3.07              NaN               NaN                       \n4                              19.09              NaN              0.62                       \n5                              16.10              NaN              1.18                       \n6                               5.86             0.69              0.57     importoedu pack #1\n7                               8.51             6.65               NaN        amalgscholar #1\n8                               5.20             1.62               NaN                       \n9                              15.06              NaN               NaN    scholarunivamalg #3\n10                             18.53             5.65               NaN      exportiimporto #1\n11                             15.55              NaN               NaN                       \n12                              6.26             1.45               NaN                       \n13                             14.43             1.80               NaN                       \n14                             16.30             1.96              0.98                       \n15                              5.09             2.78              2.06        amalgexporti #1\n16                             10.61              NaN               NaN  exportiamalgamalg #16\n17                             19.65             4.64               NaN                       \n18                              8.26             0.28              1.79     corpamalgamalg #17\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC WHERE SB.SS_STORE_SK = SC.SS_STORE_SK AND SC.REVENUE <= 0.1 * SB.AVE AND S_STORE_SK = SC.SS_STORE_SK AND I_ITEM_SK = SC.SS_ITEM_SK ORDER BY S_STORE_NAME NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0                              17.80              NaN              1.54    brandunivamalg #4\n1                               4.46             3.78              2.72    exportischolar #1\n2                               4.30             5.35              2.99                     \n3                               1.13             1.61              5.10                     \n4                               5.98              NaN               NaN   edu packimporto #1\n5                               1.74             2.90               NaN                     \n6                              15.40              NaN               NaN                     \n7                              13.02             8.93               NaN                     \n8                               0.50              NaN               NaN                     \n9                               7.85              NaN               NaN                     \n10                              6.06             2.58              1.67                     \n11                             14.05             9.29               NaN                     \n12                              0.69              NaN              4.01     namelessbrand #3\n13                             14.23              NaN              1.00                     \n14                             10.04              NaN               NaN      amalgscholar #1\n15                             18.53             5.65               NaN    exportiimporto #1\n16                             16.30             1.96              0.98                     \n17                             13.53             5.35              2.99                     \n18                             18.90             9.17               NaN     edu packamalg #1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 13.53136,
                    "execution_time": 13.183259,
                    "compile_time": 0.000645,
                    "planning_time": 12.970241
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 13.470712,
                    "execution_time": 13.12069,
                    "compile_time": 0.00067,
                    "planning_time": 12.911392
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0                              17.80              NaN              1.54    brandunivamalg #4\n1                               4.46             3.78              2.72    exportischolar #1\n2                               4.30             5.35              2.99                     \n3                               1.13             1.61              5.10                     \n4                               5.98              NaN               NaN   edu packimporto #1\n5                               1.74             2.90               NaN                     \n6                              15.40              NaN               NaN                     \n7                              13.02             8.93               NaN                     \n8                               0.50              NaN               NaN                     \n9                               7.85              NaN               NaN                     \n10                              6.06             2.58              1.67                     \n11                             14.05             9.29               NaN                     \n12                              0.69              NaN              4.01     namelessbrand #3\n13                             14.23              NaN              1.00                     \n14                             10.04              NaN               NaN      amalgscholar #1\n15                             18.53             5.65               NaN    exportiimporto #1\n16                             16.30             1.96              0.98                     \n17                             13.53             5.35              2.99                     \n18                             18.90             9.17               NaN     edu packamalg #1\n...*/"
    }
]