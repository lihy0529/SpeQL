[
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\nfrom\n  customer c, customer_address ca, customer_demographics cd\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk as customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n            select cs_bill_customer_sk as customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n           ) x\n           where customsk = c.c_customer_sk)\ngroup by\n  ca_state, \n  cd_gender, \n  cd_marital_status, \n  cd_dep_count, \n  cd_dep_employed_count, \n  cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.143435,
                    "execution_time": 2.036523,
                    "compile_time": 0.000324,
                    "planning_time": 0.032123,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.332413,
                    "execution_time": 2.14967,
                    "compile_time": 0.002577,
                    "planning_time": 0.101466,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081226,
                    "execution_time": 0.031553,
                    "compile_time": 0.000244,
                    "planning_time": 0.025368,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.141507,
                    "execution_time": 0.030794,
                    "compile_time": 0.001296,
                    "planning_time": 0.084504,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.732231,
                    "execution_time": 2.629198,
                    "compile_time": 0.000415,
                    "planning_time": 0.036588,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.9529,
                    "execution_time": 2.759607,
                    "compile_time": 0.003494,
                    "planning_time": 0.121926,
                    "create_size": 1792
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.403051,
                    "execution_time": 1.328505,
                    "compile_time": 0.00027,
                    "planning_time": 0.003197,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.493827,
                    "execution_time": 1.359594,
                    "compile_time": 0.001356,
                    "planning_time": 0.05936,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.901054,
                    "execution_time": 0.834279,
                    "compile_time": 0.313701,
                    "planning_time": 0.045473,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.753468,
                    "execution_time": 1.913647,
                    "compile_time": 9.991966,
                    "planning_time": 0.118524,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OK         M                 D             1    59       1       1       1                      0    59        0        0        0                     0    59        0        0        0\n1        KS         M                 W             0    78       0       0       0                      3    78        3        3        3                     5    78        5        5        5\n2        VT         F                 U             4    13       4       4       4                      6    13        6        6        6                     0    13        0        0        0\n3        TX         F                 U             3   218       3       3       3                      3   218        3        3        3                     4   218        4        4        4\n4        IN         F                 S             3    65       3       3       3                      4    65        4        4        4                     0    65        0        0        0\n5        AR         M                 D             1    65       1       1       1                      3    65        3        3        3                     3    65        3        3        3\n6        MO         F                 U             5    85       5       5       5                      2    85        2        2        2                     5    85        5        5        5\n7        MA         M                 S             2     7       2       2       2                      0     7        0        0        0                     5     7        5        5        5\n8        IL         F                 U             6    86       6       6       6                      4    86        4        4        4                     6    86        6        6        6\n9        CO         F                 D             6    55       6       6       6                      5    55        5        5        5                     0    55        0        0        0\n10       FL         M                 W             0    53       0       0       0                      3    53        3        3        3                     3    53        3        3        3\n11       MD         M                 S             6    25       6       6       6                      0    25        0        0        0                     6    25        6        6        6\n12       PA         F                 U             3    57       3       3       3                      6    57        6        6        6                     1    57        1        1        1\n13                  F                 M             5    87       5       5       5                      2    87        2        2        2                     2    87        2        2        2\n14       IA         M                 U             0    60       0       0       0                      2    60        2        2        2                     0    60        0        0        0\n15       MT         F                 S             0    43       0       0       0                      0    43        0        0        0                     6    43        6        6        6\n16       MS         M                 U             6    66       6       6       6                      0    66        0        0        0                     3    66        3        3        3\n17       VA         F                 U             1   113       1       1       1                      6   113        6        6        6                     4   113        4        4        4\n18       OK         F                 U             4    68       4       4       4                      4    68        4        4        4                     1    68        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022275,
                    "execution_time": 0.00858,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005922
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059244,
                    "execution_time": 0.008022,
                    "compile_time": 0.001119,
                    "planning_time": 0.041799
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OK         M                 D             1    59       1       1       1                      0    59        0        0        0                     0    59        0        0        0\n1        KS         M                 W             0    78       0       0       0                      3    78        3        3        3                     5    78        5        5        5\n2        VT         F                 U             4    13       4       4       4                      6    13        6        6        6                     0    13        0        0        0\n3        TX         F                 U             3   218       3       3       3                      3   218        3        3        3                     4   218        4        4        4\n4        IN         F                 S             3    65       3       3       3                      4    65        4        4        4                     0    65        0        0        0\n5        AR         M                 D             1    65       1       1       1                      3    65        3        3        3                     3    65        3        3        3\n6        MO         F                 U             5    85       5       5       5                      2    85        2        2        2                     5    85        5        5        5\n7        MA         M                 S             2     7       2       2       2                      0     7        0        0        0                     5     7        5        5        5\n8        IL         F                 U             6    86       6       6       6                      4    86        4        4        4                     6    86        6        6        6\n9        CO         F                 D             6    55       6       6       6                      5    55        5        5        5                     0    55        0        0        0\n10       FL         M                 W             0    53       0       0       0                      3    53        3        3        3                     3    53        3        3        3\n11       MD         M                 S             6    25       6       6       6                      0    25        0        0        0                     6    25        6        6        6\n12       PA         F                 U             3    57       3       3       3                      6    57        6        6        6                     1    57        1        1        1\n13                  F                 M             5    87       5       5       5                      2    87        2        2        2                     2    87        2        2        2\n14       IA         M                 U             0    60       0       0       0                      2    60        2        2        2                     0    60        0        0        0\n15       MT         F                 S             0    43       0       0       0                      0    43        0        0        0                     6    43        6        6        6\n16       MS         M                 U             6    66       6       6       6                      0    66        0        0        0                     3    66        3        3        3\n17       VA         F                 U             1   113       1       1       1                      6   113        6        6        6                     4   113        4        4        4\n18       OK         F                 U             4    68       4       4       4                      4    68        4        4        4                     1    68        1        1        1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales, date_dim\n            where \n/*CURSOR_IDENTIFIER*/ d_date_sk = cs_sold_date_sk and d_year = 1999 and d_qoy < 4\n)\n) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count \n",
        "optimize": [
            "SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.809576,
                    "execution_time": 1.702125,
                    "compile_time": 0.000318,
                    "planning_time": 0.034008,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.809852,
                    "execution_time": 1.630826,
                    "compile_time": 0.0014,
                    "planning_time": 0.100502,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    customsk\n0     112087\n1     112087\n2     112087\n3     112087\n4     112087\n5     926418\n6     926418\n7     926418\n8     926418\n9     926418\n10    926418\n11    926418\n12    926418\n13   1544967\n14   1544967\n15   1544967\n16   1544967\n17   1544967\n18   8605621\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016237,
                    "execution_time": 0.007212,
                    "compile_time": 4e-05,
                    "planning_time": 0.003256
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053161,
                    "execution_time": 0.007459,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.0387
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    customsk\n0     112087\n1     112087\n2     112087\n3     112087\n4     112087\n5     926418\n6     926418\n7     926418\n8     926418\n9     926418\n10    926418\n11    926418\n12    926418\n13   1544967\n14   1544967\n15   1544967\n16   1544967\n17   1544967\n18   8605621\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.133149,
                    "execution_time": 2.014567,
                    "compile_time": 0.000343,
                    "planning_time": 0.043563,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.207832,
                    "execution_time": 2.03301,
                    "compile_time": 0.00034,
                    "planning_time": 0.099827,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080378,
                    "execution_time": 0.031061,
                    "compile_time": 0.000246,
                    "planning_time": 0.024585,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.142639,
                    "execution_time": 0.031485,
                    "compile_time": 0.000272,
                    "planning_time": 0.085928,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.674241,
                    "execution_time": 2.570864,
                    "compile_time": 0.000418,
                    "planning_time": 0.037082,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.762477,
                    "execution_time": 2.576833,
                    "compile_time": 0.000429,
                    "planning_time": 0.11911,
                    "create_size": 1792
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.418383,
                    "execution_time": 1.343339,
                    "compile_time": 0.000281,
                    "planning_time": 0.00304,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.462084,
                    "execution_time": 1.330486,
                    "compile_time": 0.000271,
                    "planning_time": 0.058908,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.649834,
                    "execution_time": 0.893066,
                    "compile_time": 0.001078,
                    "planning_time": 0.047219,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.6364,
                    "execution_time": 0.808869,
                    "compile_time": 0.001072,
                    "planning_time": 0.115569,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        IL         M                 W             0    79       0       0       0                      3    79        3        3        3                     0    79        0        0        0\n1        CO         F                 W             1    52       1       1       1                      3    52        3        3        3                     6    52        6        6        6\n2        NH         F                 W             4     6       4       4       4                      0     6        0        0        0                     2     6        2        2        2\n3        TX         F                 S             3   247       3       3       3                      6   247        6        6        6                     6   247        6        6        6\n4        UT         F                 U             1    23       1       1       1                      3    23        3        3        3                     4    23        4        4        4\n5        CA         M                 U             4    51       4       4       4                      2    51        2        2        2                     0    51        0        0        0\n6        KS         M                 M             5    90       5       5       5                      1    90        1        1        1                     5    90        5        5        5\n7        VA         M                 D             4   101       4       4       4                      6   101        6        6        6                     6   101        6        6        6\n8        VT         F                 S             0     4       0       0       0                      0     4        0        0        0                     3     4        3        3        3\n9        TN         F                 M             2    57       2       2       2                      3    57        3        3        3                     2    57        2        2        2\n10       MS         F                 D             3    77       3       3       3                      1    77        1        1        1                     1    77        1        1        1\n11       FL         F                 S             5    67       5       5       5                      0    67        0        0        0                     4    67        4        4        4\n12       NE         F                 M             1    71       1       1       1                      6    71        6        6        6                     0    71        0        0        0\n13       TX         F                 M             5   190       5       5       5                      2   190        2        2        2                     1   190        1        1        1\n14       SC         F                 M             1    30       1       1       1                      0    30        0        0        0                     5    30        5        5        5\n15       CO         M                 M             0    45       0       0       0                      4    45        4        4        4                     3    45        3        3        3\n16       ND         M                 U             2    50       2       2       2                      6    50        6        6        6                     1    50        1        1        1\n17       IN         M                 S             0    71       0       0       0                      3    71        3        3        3                     6    71        6        6        6\n18       OK         F                 S             0    75       0       0       0                      1    75        1        1        1                     5    75        5        5        5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022293,
                    "execution_time": 0.00821,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.006198
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058578,
                    "execution_time": 0.008844,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.042198
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        IL         M                 W             0    79       0       0       0                      3    79        3        3        3                     0    79        0        0        0\n1        CO         F                 W             1    52       1       1       1                      3    52        3        3        3                     6    52        6        6        6\n2        NH         F                 W             4     6       4       4       4                      0     6        0        0        0                     2     6        2        2        2\n3        TX         F                 S             3   247       3       3       3                      6   247        6        6        6                     6   247        6        6        6\n4        UT         F                 U             1    23       1       1       1                      3    23        3        3        3                     4    23        4        4        4\n5        CA         M                 U             4    51       4       4       4                      2    51        2        2        2                     0    51        0        0        0\n6        KS         M                 M             5    90       5       5       5                      1    90        1        1        1                     5    90        5        5        5\n7        VA         M                 D             4   101       4       4       4                      6   101        6        6        6                     6   101        6        6        6\n8        VT         F                 S             0     4       0       0       0                      0     4        0        0        0                     3     4        3        3        3\n9        TN         F                 M             2    57       2       2       2                      3    57        3        3        3                     2    57        2        2        2\n10       MS         F                 D             3    77       3       3       3                      1    77        1        1        1                     1    77        1        1        1\n11       FL         F                 S             5    67       5       5       5                      0    67        0        0        0                     4    67        4        4        4\n12       NE         F                 M             1    71       1       1       1                      6    71        6        6        6                     0    71        0        0        0\n13       TX         F                 M             5   190       5       5       5                      2   190        2        2        2                     1   190        1        1        1\n14       SC         F                 M             1    30       1       1       1                      0    30        0        0        0                     5    30        5        5        5\n15       CO         M                 M             0    45       0       0       0                      4    45        4        4        4                     3    45        3        3        3\n16       ND         M                 U             2    50       2       2       2                      6    50        6        6        6                     1    50        1        1        1\n17       IN         M                 S             0    71       0       0       0                      3    71        3        3        3                     6    71        6        6        6\n18       OK         F                 S             0    75       0       0       0                      1    75        1        1        1                     5    75        5        5        5\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        GA         F                 M             5   102       5       5       5                      2   102        2        2        2                     2   102        2        2        2\n1        FL         F                 M             4    55       4       4       4                      5    55        5        5        5                     0    55        0        0        0\n2        OR         F                 D             4    36       4       4       4                      0    36        0        0        0                     3    36        3        3        3\n3        SC         F                 U             4    38       4       4       4                      5    38        5        5        5                     4    38        4        4        4\n4        OH         M                 U             2    69       2       2       2                      0    69        0        0        0                     6    69        6        6        6\n5        WV         M                 D             5    54       5       5       5                      1    54        1        1        1                     2    54        2        2        2\n6        TN         F                 S             4    76       4       4       4                      0    76        0        0        0                     5    76        5        5        5\n7        AL         F                 S             4    47       4       4       4                      6    47        6        6        6                     1    47        1        1        1\n8        TN         F                 U             2    75       2       2       2                      0    75        0        0        0                     5    75        5        5        5\n9        VA         M                 W             0   104       0       0       0                      3   104        3        3        3                     4   104        4        4        4\n10       MO         M                 U             6    79       6       6       6                      1    79        1        1        1                     2    79        2        2        2\n11       MO         M                 D             4    91       4       4       4                      0    91        0        0        0                     1    91        1        1        1\n12       NM         F                 U             0    33       0       0       0                      0    33        0        0        0                     5    33        5        5        5\n13       NE         M                 M             2    94       2       2       2                      0    94        0        0        0                     1    94        1        1        1\n14       TN         M                 U             5    82       5       5       5                      1    82        1        1        1                     6    82        6        6        6\n15       KS         M                 D             3    69       3       3       3                      4    69        4        4        4                     1    69        1        1        1\n16       CO         M                 W             5    48       5       5       5                      5    48        5        5        5                     2    48        2        2        2\n17       IN         M                 U             4    67       4       4       4                      1    67        1        1        1                     6    67        6        6        6\n18       KS         M                 U             0    89       0       0       0                      6    89        6        6        6                     4    89        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020533,
                    "execution_time": 0.007805,
                    "compile_time": 6e-05,
                    "planning_time": 0.005449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056183,
                    "execution_time": 0.008113,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.040849
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        GA         F                 M             5   102       5       5       5                      2   102        2        2        2                     2   102        2        2        2\n1        FL         F                 M             4    55       4       4       4                      5    55        5        5        5                     0    55        0        0        0\n2        OR         F                 D             4    36       4       4       4                      0    36        0        0        0                     3    36        3        3        3\n3        SC         F                 U             4    38       4       4       4                      5    38        5        5        5                     4    38        4        4        4\n4        OH         M                 U             2    69       2       2       2                      0    69        0        0        0                     6    69        6        6        6\n5        WV         M                 D             5    54       5       5       5                      1    54        1        1        1                     2    54        2        2        2\n6        TN         F                 S             4    76       4       4       4                      0    76        0        0        0                     5    76        5        5        5\n7        AL         F                 S             4    47       4       4       4                      6    47        6        6        6                     1    47        1        1        1\n8        TN         F                 U             2    75       2       2       2                      0    75        0        0        0                     5    75        5        5        5\n9        VA         M                 W             0   104       0       0       0                      3   104        3        3        3                     4   104        4        4        4\n10       MO         M                 U             6    79       6       6       6                      1    79        1        1        1                     2    79        2        2        2\n11       MO         M                 D             4    91       4       4       4                      0    91        0        0        0                     1    91        1        1        1\n12       NM         F                 U             0    33       0       0       0                      0    33        0        0        0                     5    33        5        5        5\n13       NE         M                 M             2    94       2       2       2                      0    94        0        0        0                     1    94        1        1        1\n14       TN         M                 U             5    82       5       5       5                      1    82        1        1        1                     6    82        6        6        6\n15       KS         M                 D             3    69       3       3       3                      4    69        4        4        4                     1    69        1        1        1\n16       CO         M                 W             5    48       5       5       5                      5    48        5        5        5                     2    48        2        2        2\n17       IN         M                 U             4    67       4       4       4                      1    67        1        1        1                     6    67        6        6        6\n18       KS         M                 U             0    89       0       0       0                      6    89        6        6        6                     4    89        4        4        4\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.606498,
                    "execution_time": 0.843105,
                    "compile_time": 0.001066,
                    "planning_time": 0.050895,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.750819,
                    "execution_time": 0.926241,
                    "compile_time": 0.001078,
                    "planning_time": 0.115609,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TX         F                 D             0   208       0       0       0                      5   208        5        5        5                     1   208        1        1        1\n1        MO         M                 D             4    87       4       4       4                      2    87        2        2        2                     1    87        1        1        1\n2        MN         M                 U             1    81       1       1       1                      5    81        5        5        5                     4    81        4        4        4\n3        NC         F                 D             3    75       3       3       3                      4    75        4        4        4                     6    75        6        6        6\n4        CO         M                 S             3    39       3       3       3                      4    39        4        4        4                     1    39        1        1        1\n5        MI         F                 M             4    72       4       4       4                      3    72        3        3        3                     6    72        6        6        6\n6        IN         F                 M             5    81       5       5       5                      3    81        3        3        3                     3    81        3        3        3\n7        GA         M                 D             2   121       2       2       2                      2   121        2        2        2                     3   121        3        3        3\n8        CO         F                 M             4    56       4       4       4                      0    56        0        0        0                     0    56        0        0        0\n9        IA         F                 S             0    78       0       0       0                      1    78        1        1        1                     1    78        1        1        1\n10       TX         M                 M             4   217       4       4       4                      0   217        0        0        0                     1   217        1        1        1\n11       IA         M                 W             6    87       6       6       6                      4    87        4        4        4                     3    87        3        3        3\n12       MO         M                 W             4    82       4       4       4                      0    82        0        0        0                     2    82        2        2        2\n13       VA         F                 D             1   132       1       1       1                      6   132        6        6        6                     6   132        6        6        6\n14       OH         F                 D             3    68       3       3       3                      6    68        6        6        6                     5    68        5        5        5\n15       IN         M                 U             0    77       0       0       0                      4    77        4        4        4                     4    77        4        4        4\n16       FL         F                 W             4    69       4       4       4                      4    69        4        4        4                     2    69        2        2        2\n17       AZ         M                 U             0     7       0       0       0                      4     7        4        4        4                     3     7        3        3        3\n18       SC         M                 M             0    32       0       0       0                      5    32        5        5        5                     5    32        5        5        5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021433,
                    "execution_time": 0.008085,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.006007
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058172,
                    "execution_time": 0.008279,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.042535
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TX         F                 D             0   208       0       0       0                      5   208        5        5        5                     1   208        1        1        1\n1        MO         M                 D             4    87       4       4       4                      2    87        2        2        2                     1    87        1        1        1\n2        MN         M                 U             1    81       1       1       1                      5    81        5        5        5                     4    81        4        4        4\n3        NC         F                 D             3    75       3       3       3                      4    75        4        4        4                     6    75        6        6        6\n4        CO         M                 S             3    39       3       3       3                      4    39        4        4        4                     1    39        1        1        1\n5        MI         F                 M             4    72       4       4       4                      3    72        3        3        3                     6    72        6        6        6\n6        IN         F                 M             5    81       5       5       5                      3    81        3        3        3                     3    81        3        3        3\n7        GA         M                 D             2   121       2       2       2                      2   121        2        2        2                     3   121        3        3        3\n8        CO         F                 M             4    56       4       4       4                      0    56        0        0        0                     0    56        0        0        0\n9        IA         F                 S             0    78       0       0       0                      1    78        1        1        1                     1    78        1        1        1\n10       TX         M                 M             4   217       4       4       4                      0   217        0        0        0                     1   217        1        1        1\n11       IA         M                 W             6    87       6       6       6                      4    87        4        4        4                     3    87        3        3        3\n12       MO         M                 W             4    82       4       4       4                      0    82        0        0        0                     2    82        2        2        2\n13       VA         F                 D             1   132       1       1       1                      6   132        6        6        6                     6   132        6        6        6\n14       OH         F                 D             3    68       3       3       3                      6    68        6        6        6                     5    68        5        5        5\n15       IN         M                 U             0    77       0       0       0                      4    77        4        4        4                     4    77        4        4        4\n16       FL         F                 W             4    69       4       4       4                      4    69        4        4        4                     2    69        2        2        2\n17       AZ         M                 U             0     7       0       0       0                      4     7        4        4        4                     3     7        3        3        3\n18       SC         M                 M             0    32       0       0       0                      5    32        5        5        5                     5    32        5        5        5\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca.ca_state,\n  cd.cd_gender,\n  cd.cd_marital_status,\n  cd.cd_dep_count,\n  count(*) cnt1,\n  max(cd.cd_dep_count),\n  min(cd.cd_dep_count),\n  max(cd.cd_dep_count),\n  cd.cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd.cd_dep_employed_count),\n  min(cd.cd_dep_employed_count),\n  max(cd.cd_dep_employed_count),\n  cd.cd_dep_college_count,\n  count(*) cnt3,\n  max(cd.cd_dep_college_count),\n  min(cd.cd_dep_college_count),\n  max(cd.cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws.ws_bill_customer_sk customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n    \t    select cs.cs_ship_customer_sk customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca.ca_state,\n          cd.cd_gender,\n          cd.cd_marital_status,\n          cd.cd_dep_count,\n          cd.cd_dep_employed_count,\n          cd.cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.627285,
                    "execution_time": 2.521629,
                    "compile_time": 0.000428,
                    "planning_time": 0.038427,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.863124,
                    "execution_time": 2.658923,
                    "compile_time": 0.000496,
                    "planning_time": 0.12568,
                    "create_size": 1792
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" GROUP BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.332583,
                    "execution_time": 1.25764,
                    "compile_time": 0.000291,
                    "planning_time": 0.003288,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.40343,
                    "execution_time": 1.272267,
                    "compile_time": 0.000276,
                    "planning_time": 0.059368,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.590503,
                    "execution_time": 0.834799,
                    "compile_time": 0.001084,
                    "planning_time": 0.046831,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.683496,
                    "execution_time": 3.856371,
                    "compile_time": 0.001072,
                    "planning_time": 0.116497,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 M             3    99       3       3       3                      5    99        5        5        5                     4    99        4        4        4\n1        MI         F                 S             3    59       3       3       3                      0    59        0        0        0                     1    59        1        1        1\n2        VA         F                 U             2   125       2       2       2                      0   125        0        0        0                     2   125        2        2        2\n3                   M                 S             1    95       1       1       1                      5    95        5        5        5                     5    95        5        5        5\n4        IL         F                 M             4    74       4       4       4                      1    74        1        1        1                     1    74        1        1        1\n5        NV         M                 M             0    13       0       0       0                      2    13        2        2        2                     4    13        4        4        4\n6        IL         M                 D             4    74       4       4       4                      6    74        6        6        6                     5    74        5        5        5\n7        TX         F                 M             3   187       3       3       3                      4   187        4        4        4                     1   187        1        1        1\n8        KY         M                 D             2    93       2       2       2                      0    93        0        0        0                     4    93        4        4        4\n9        KS         M                 D             1    82       1       1       1                      0    82        0        0        0                     1    82        1        1        1\n10       CO         F                 W             6    57       6       6       6                      3    57        3        3        3                     5    57        5        5        5\n11       CO         M                 S             3    50       3       3       3                      2    50        2        2        2                     2    50        2        2        2\n12       OH         M                 S             2    74       2       2       2                      2    74        2        2        2                     0    74        0        0        0\n13       KS         F                 D             1    75       1       1       1                      0    75        0        0        0                     4    75        4        4        4\n14       TN         F                 W             6    95       6       6       6                      4    95        4        4        4                     4    95        4        4        4\n15       FL         F                 M             3    45       3       3       3                      0    45        0        0        0                     6    45        6        6        6\n16       VA         F                 D             0   104       0       0       0                      4   104        4        4        4                     5   104        5        5        5\n17       MO         F                 M             0   100       0       0       0                      6   100        6        6        6                     6   100        6        6        6\n18       ND         F                 M             3    39       3       3       3                      0    39        0        0        0                     1    39        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021882,
                    "execution_time": 0.00856,
                    "compile_time": 6e-05,
                    "planning_time": 0.005968
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058454,
                    "execution_time": 0.008775,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.042109
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 M             3    99       3       3       3                      5    99        5        5        5                     4    99        4        4        4\n1        MI         F                 S             3    59       3       3       3                      0    59        0        0        0                     1    59        1        1        1\n2        VA         F                 U             2   125       2       2       2                      0   125        0        0        0                     2   125        2        2        2\n3                   M                 S             1    95       1       1       1                      5    95        5        5        5                     5    95        5        5        5\n4        IL         F                 M             4    74       4       4       4                      1    74        1        1        1                     1    74        1        1        1\n5        NV         M                 M             0    13       0       0       0                      2    13        2        2        2                     4    13        4        4        4\n6        IL         M                 D             4    74       4       4       4                      6    74        6        6        6                     5    74        5        5        5\n7        TX         F                 M             3   187       3       3       3                      4   187        4        4        4                     1   187        1        1        1\n8        KY         M                 D             2    93       2       2       2                      0    93        0        0        0                     4    93        4        4        4\n9        KS         M                 D             1    82       1       1       1                      0    82        0        0        0                     1    82        1        1        1\n10       CO         F                 W             6    57       6       6       6                      3    57        3        3        3                     5    57        5        5        5\n11       CO         M                 S             3    50       3       3       3                      2    50        2        2        2                     2    50        2        2        2\n12       OH         M                 S             2    74       2       2       2                      2    74        2        2        2                     0    74        0        0        0\n13       KS         F                 D             1    75       1       1       1                      0    75        0        0        0                     4    75        4        4        4\n14       TN         F                 W             6    95       6       6       6                      4    95        4        4        4                     4    95        4        4        4\n15       FL         F                 M             3    45       3       3       3                      0    45        0        0        0                     6    45        6        6        6\n16       VA         F                 D             0   104       0       0       0                      4   104        4        4        4                     5   104        5        5        5\n17       MO         F                 M             0   100       0       0       0                      6   100        6        6        6                     6   100        6        6        6\n18       ND         F                 M             3    39       3       3       3                      0    39        0        0        0                     1    39        1        1        1\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select *\n          from store_sales, date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * \n           from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales, date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales, date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4) x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TN         M                 W             3    80       3       3       3                      1    80        1        1        1                     6    80        6        6        6\n1        SC         F                 U             1    35       1       1       1                      1    35        1        1        1                     4    35        4        4        4\n2        MS         F                 D             2    68       2       2       2                      6    68        6        6        6                     5    68        5        5        5\n3        AK         M                 M             1    24       1       1       1                      1    24        1        1        1                     6    24        6        6        6\n4        OK         F                 W             4    66       4       4       4                      1    66        1        1        1                     3    66        3        3        3\n5        OK         M                 D             0    83       0       0       0                      0    83        0        0        0                     1    83        1        1        1\n6        MT         F                 D             6    47       6       6       6                      2    47        2        2        2                     1    47        1        1        1\n7        NC         F                 M             1    74       1       1       1                      0    74        0        0        0                     5    74        5        5        5\n8        WI         F                 W             6    56       6       6       6                      6    56        6        6        6                     6    56        6        6        6\n9        MT         F                 M             2    51       2       2       2                      0    51        0        0        0                     6    51        6        6        6\n10       MN         M                 M             4    77       4       4       4                      0    77        0        0        0                     0    77        0        0        0\n11       IL         F                 W             6    70       6       6       6                      1    70        1        1        1                     1    70        1        1        1\n12       CA         F                 W             3    53       3       3       3                      6    53        6        6        6                     6    53        6        6        6\n13       NM         M                 D             3    24       3       3       3                      5    24        5        5        5                     6    24        6        6        6\n14       VT         M                 S             1    14       1       1       1                      4    14        4        4        4                     5    14        5        5        5\n15       VA         M                 D             3    99       3       3       3                      6    99        6        6        6                     2    99        2        2        2\n16       KY         F                 W             6   121       6       6       6                      0   121        0        0        0                     5   121        5        5        5\n17       LA         F                 U             4    49       4       4       4                      6    49        6        6        6                     3    49        3        3        3\n18       SD         M                 M             3    63       3       3       3                      2    63        2        2        2                     3    63        3        3        3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020742,
                    "execution_time": 0.008315,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.00549
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056356,
                    "execution_time": 0.008264,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.040943
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TN         M                 W             3    80       3       3       3                      1    80        1        1        1                     6    80        6        6        6\n1        SC         F                 U             1    35       1       1       1                      1    35        1        1        1                     4    35        4        4        4\n2        MS         F                 D             2    68       2       2       2                      6    68        6        6        6                     5    68        5        5        5\n3        AK         M                 M             1    24       1       1       1                      1    24        1        1        1                     6    24        6        6        6\n4        OK         F                 W             4    66       4       4       4                      1    66        1        1        1                     3    66        3        3        3\n5        OK         M                 D             0    83       0       0       0                      0    83        0        0        0                     1    83        1        1        1\n6        MT         F                 D             6    47       6       6       6                      2    47        2        2        2                     1    47        1        1        1\n7        NC         F                 M             1    74       1       1       1                      0    74        0        0        0                     5    74        5        5        5\n8        WI         F                 W             6    56       6       6       6                      6    56        6        6        6                     6    56        6        6        6\n9        MT         F                 M             2    51       2       2       2                      0    51        0        0        0                     6    51        6        6        6\n10       MN         M                 M             4    77       4       4       4                      0    77        0        0        0                     0    77        0        0        0\n11       IL         F                 W             6    70       6       6       6                      1    70        1        1        1                     1    70        1        1        1\n12       CA         F                 W             3    53       3       3       3                      6    53        6        6        6                     6    53        6        6        6\n13       NM         M                 D             3    24       3       3       3                      5    24        5        5        5                     6    24        6        6        6\n14       VT         M                 S             1    14       1       1       1                      4    14        4        4        4                     5    14        5        5        5\n15       VA         M                 D             3    99       3       3       3                      6    99        6        6        6                     2    99        2        2        2\n16       KY         F                 W             6   121       6       6       6                      0   121        0        0        0                     5   121        5        5        5\n17       LA         F                 U             4    49       4       4       4                      6    49        6        6        6                     3    49        3        3        3\n18       SD         M                 M             3    63       3       3       3                      2    63        2        2        2                     3    63        3        3        3\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        AL         F                 M             5    56       5       5       5                      2    56        2        2        2                     3    56        3        3        3\n1        MI         F                 U             1    78       1       1       1                      4    78        4        4        4                     1    78        1        1        1\n2        GA         F                 S             2   127       2       2       2                      6   127        6        6        6                     4   127        4        4        4\n3        CO         F                 D             3    43       3       3       3                      2    43        2        2        2                     4    43        4        4        4\n4        PA         F                 S             2    65       2       2       2                      4    65        4        4        4                     1    65        1        1        1\n5        VA         F                 D             2    98       2       2       2                      0    98        0        0        0                     2    98        2        2        2\n6        ID         M                 U             0    37       0       0       0                      1    37        1        1        1                     5    37        5        5        5\n7        MT         F                 S             3    62       3       3       3                      3    62        3        3        3                     5    62        5        5        5\n8        KY         M                 U             1   121       1       1       1                      1   121        1        1        1                     3   121        3        3        3\n9        OK         M                 W             1    60       1       1       1                      4    60        4        4        4                     3    60        3        3        3\n10       OH         M                 D             6    65       6       6       6                      6    65        6        6        6                     5    65        5        5        5\n11       MA         M                 U             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n12       MO         M                 S             1    75       1       1       1                      5    75        5        5        5                     0    75        0        0        0\n13       UT         M                 U             2    24       2       2       2                      4    24        4        4        4                     5    24        5        5        5\n14       OH         F                 U             1    88       1       1       1                      4    88        4        4        4                     1    88        1        1        1\n15       AK         M                 M             4    23       4       4       4                      3    23        3        3        3                     0    23        0        0        0\n16       NM         F                 M             5    25       5       5       5                      3    25        3        3        3                     0    25        0        0        0\n17       AK         F                 S             3    26       3       3       3                      4    26        4        4        4                     1    26        1        1        1\n18       OH         M                 M             0    68       0       0       0                      0    68        0        0        0                     1    68        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020861,
                    "execution_time": 0.008014,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005753
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021191,
                    "execution_time": 0.008217,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005879
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        AL         F                 M             5    56       5       5       5                      2    56        2        2        2                     3    56        3        3        3\n1        MI         F                 U             1    78       1       1       1                      4    78        4        4        4                     1    78        1        1        1\n2        GA         F                 S             2   127       2       2       2                      6   127        6        6        6                     4   127        4        4        4\n3        CO         F                 D             3    43       3       3       3                      2    43        2        2        2                     4    43        4        4        4\n4        PA         F                 S             2    65       2       2       2                      4    65        4        4        4                     1    65        1        1        1\n5        VA         F                 D             2    98       2       2       2                      0    98        0        0        0                     2    98        2        2        2\n6        ID         M                 U             0    37       0       0       0                      1    37        1        1        1                     5    37        5        5        5\n7        MT         F                 S             3    62       3       3       3                      3    62        3        3        3                     5    62        5        5        5\n8        KY         M                 U             1   121       1       1       1                      1   121        1        1        1                     3   121        3        3        3\n9        OK         M                 W             1    60       1       1       1                      4    60        4        4        4                     3    60        3        3        3\n10       OH         M                 D             6    65       6       6       6                      6    65        6        6        6                     5    65        5        5        5\n11       MA         M                 U             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n12       MO         M                 S             1    75       1       1       1                      5    75        5        5        5                     0    75        0        0        0\n13       UT         M                 U             2    24       2       2       2                      4    24        4        4        4                     5    24        5        5        5\n14       OH         F                 U             1    88       1       1       1                      4    88        4        4        4                     1    88        1        1        1\n15       AK         M                 M             4    23       4       4       4                      3    23        3        3        3                     0    23        0        0        0\n16       NM         F                 M             5    25       5       5       5                      3    25        3        3        3                     0    25        0        0        0\n17       AK         F                 S             3    26       3       3       3                      4    26        4        4        4                     1    26        1        1        1\n18       OH         M                 M             0    68       0       0       0                      0    68        0        0        0                     1    68        1        1        1\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   M                 U             2    71       2       2       2                      0    71        0        0        0                     4    71        4        4        4\n1                   M                 M             6    83       6       6       6                      2    83        2        2        2                     4    83        4        4        4\n2                   F                 S             2    76       2       2       2                      5    76        5        5        5                     2    76        2        2        2\n3                   F                 W             0   101       0       0       0                      4   101        4        4        4                     6   101        6        6        6\n4                   F                 U             4    76       4       4       4                      5    76        5        5        5                     3    76        3        3        3\n5                   M                 U             3    77       3       3       3                      3    77        3        3        3                     5    77        5        5        5\n6                   M                 M             3    90       3       3       3                      5    90        5        5        5                     6    90        6        6        6\n7                   M                 W             3    90       3       3       3                      4    90        4        4        4                     3    90        3        3        3\n8                   F                 U             4    68       4       4       4                      4    68        4        4        4                     1    68        1        1        1\n9                   F                 D             5    79       5       5       5                      4    79        4        4        4                     4    79        4        4        4\n10                  M                 D             2    69       2       2       2                      2    69        2        2        2                     1    69        1        1        1\n11                  M                 W             1    71       1       1       1                      3    71        3        3        3                     6    71        6        6        6\n12                  M                 M             5    82       5       5       5                      1    82        1        1        1                     4    82        4        4        4\n13                  F                 D             1    69       1       1       1                      6    69        6        6        6                     2    69        2        2        2\n14                  F                 U             4    77       4       4       4                      4    77        4        4        4                     4    77        4        4        4\n15                  M                 U             6    70       6       6       6                      5    70        5        5        5                     0    70        0        0        0\n16                  M                 M             0    69       0       0       0                      4    69        4        4        4                     0    69        0        0        0\n17                  F                 D             0    74       0       0       0                      2    74        2        2        2                     5    74        5        5        5\n18                  F                 U             2    92       2       2       2                      4    92        4        4        4                     6    92        6        6        6\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026316,
                    "execution_time": 0.012853,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.005976
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.224431,
                    "execution_time": 0.012631,
                    "compile_time": 0.161822,
                    "planning_time": 0.042101
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   M                 U             2    71       2       2       2                      0    71        0        0        0                     4    71        4        4        4\n1                   M                 M             6    83       6       6       6                      2    83        2        2        2                     4    83        4        4        4\n2                   F                 S             2    76       2       2       2                      5    76        5        5        5                     2    76        2        2        2\n3                   F                 W             0   101       0       0       0                      4   101        4        4        4                     6   101        6        6        6\n4                   F                 U             4    76       4       4       4                      5    76        5        5        5                     3    76        3        3        3\n5                   M                 U             3    77       3       3       3                      3    77        3        3        3                     5    77        5        5        5\n6                   M                 M             3    90       3       3       3                      5    90        5        5        5                     6    90        6        6        6\n7                   M                 W             3    90       3       3       3                      4    90        4        4        4                     3    90        3        3        3\n8                   F                 U             4    68       4       4       4                      4    68        4        4        4                     1    68        1        1        1\n9                   F                 D             5    79       5       5       5                      4    79        4        4        4                     4    79        4        4        4\n10                  M                 D             2    69       2       2       2                      2    69        2        2        2                     1    69        1        1        1\n11                  M                 W             1    71       1       1       1                      3    71        3        3        3                     6    71        6        6        6\n12                  M                 M             5    82       5       5       5                      1    82        1        1        1                     4    82        4        4        4\n13                  F                 D             1    69       1       1       1                      6    69        6        6        6                     2    69        2        2        2\n14                  F                 U             4    77       4       4       4                      4    77        4        4        4                     4    77        4        4        4\n15                  M                 U             6    70       6       6       6                      5    70        5        5        5                     0    70        0        0        0\n16                  M                 M             0    69       0       0       0                      4    69        4        4        4                     0    69        0        0        0\n17                  F                 D             0    74       0       0       0                      2    74        2        2        2                     5    74        5        5        5\n18                  F                 U             2    92       2       2       2                      4    92        4        4        4                     6    92        6        6        6\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws.ws_bill_customer_sk customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n    \t    select cs.cs_ship_customer_sk customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n/*CURSOR_IDENTIFIER*/\n          cd_marital_status",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             4    79       4       4       4                      2    79        2        2        2                     0    79        0        0        0\n1                   F                 D             0    88       0       0       0                      0    88        0        0        0                     6    88        6        6        6\n2                   F                 D             1    75       1       1       1                      0    75        0        0        0                     6    75        6        6        6\n3                   F                 D             0    78       0       0       0                      5    78        5        5        5                     6    78        6        6        6\n4                   F                 D             3    80       3       3       3                      0    80        0        0        0                     4    80        4        4        4\n5                   F                 D             3    69       3       3       3                      5    69        5        5        5                     0    69        0        0        0\n6                   F                 D             4    80       4       4       4                      4    80        4        4        4                     0    80        0        0        0\n7                   F                 D             5    80       5       5       5                      5    80        5        5        5                     2    80        2        2        2\n8                   F                 D             5    83       5       5       5                      3    83        3        3        3                     0    83        0        0        0\n9                   F                 D             0    74       0       0       0                      4    74        4        4        4                     3    74        3        3        3\n10                  F                 D             6    67       6       6       6                      6    67        6        6        6                     1    67        1        1        1\n11                  F                 D             6    89       6       6       6                      6    89        6        6        6                     4    89        4        4        4\n12                  F                 D             3    77       3       3       3                      2    77        2        2        2                     3    77        3        3        3\n13                  F                 D             6    84       6       6       6                      0    84        0        0        0                     6    84        6        6        6\n14                  F                 D             5    82       5       5       5                      5    82        5        5        5                     5    82        5        5        5\n15                  F                 D             3    74       3       3       3                      2    74        2        2        2                     6    74        6        6        6\n16                  F                 D             2    94       2       2       2                      6    94        6        6        6                     2    94        2        2        2\n17                  F                 D             0    74       0       0       0                      2    74        2        2        2                     5    74        5        5        5\n18                  F                 D             4    77       4       4       4                      6    77        6        6        6                     3    77        3        3        3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026748,
                    "execution_time": 0.012869,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006265
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.181685,
                    "execution_time": 0.012807,
                    "compile_time": 0.118883,
                    "planning_time": 0.042097
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             4    79       4       4       4                      2    79        2        2        2                     0    79        0        0        0\n1                   F                 D             0    88       0       0       0                      0    88        0        0        0                     6    88        6        6        6\n2                   F                 D             1    75       1       1       1                      0    75        0        0        0                     6    75        6        6        6\n3                   F                 D             0    78       0       0       0                      5    78        5        5        5                     6    78        6        6        6\n4                   F                 D             3    80       3       3       3                      0    80        0        0        0                     4    80        4        4        4\n5                   F                 D             3    69       3       3       3                      5    69        5        5        5                     0    69        0        0        0\n6                   F                 D             4    80       4       4       4                      4    80        4        4        4                     0    80        0        0        0\n7                   F                 D             5    80       5       5       5                      5    80        5        5        5                     2    80        2        2        2\n8                   F                 D             5    83       5       5       5                      3    83        3        3        3                     0    83        0        0        0\n9                   F                 D             0    74       0       0       0                      4    74        4        4        4                     3    74        3        3        3\n10                  F                 D             6    67       6       6       6                      6    67        6        6        6                     1    67        1        1        1\n11                  F                 D             6    89       6       6       6                      6    89        6        6        6                     4    89        4        4        4\n12                  F                 D             3    77       3       3       3                      2    77        2        2        2                     3    77        3        3        3\n13                  F                 D             6    84       6       6       6                      0    84        0        0        0                     6    84        6        6        6\n14                  F                 D             5    82       5       5       5                      5    82        5        5        5                     5    82        5        5        5\n15                  F                 D             3    74       3       3       3                      2    74        2        2        2                     6    74        6        6        6\n16                  F                 D             2    94       2       2       2                      6    94        6        6        6                     2    94        2        2        2\n17                  F                 D             0    74       0       0       0                      2    74        2        2        2                     5    74        5        5        5\n18                  F                 D             4    77       4       4       4                      6    77        6        6        6                     3    77        3        3        3\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             2    87       2       2       2                      4    87        4        4        4                     0    87        0        0        0\n1                   F                 D             4    77       4       4       4                      2    77        2        2        2                     4    77        4        4        4\n2                   F                 D             1    83       1       1       1                      6    83        6        6        6                     3    83        3        3        3\n3                   F                 D             3    78       3       3       3                      3    78        3        3        3                     0    78        0        0        0\n4                   F                 D             3    78       3       3       3                      4    78        4        4        4                     5    78        5        5        5\n5                   F                 D             1    86       1       1       1                      3    86        3        3        3                     2    86        2        2        2\n6                   F                 D             0    68       0       0       0                      2    68        2        2        2                     6    68        6        6        6\n7                   F                 D             5    85       5       5       5                      4    85        4        4        4                     1    85        1        1        1\n8                   F                 D             6    66       6       6       6                      4    66        4        4        4                     2    66        2        2        2\n9                   F                 D             6    83       6       6       6                      4    83        4        4        4                     1    83        1        1        1\n10                  F                 D             4    89       4       4       4                      3    89        3        3        3                     6    89        6        6        6\n11                  F                 D             1    67       1       1       1                      3    67        3        3        3                     5    67        5        5        5\n12                  F                 D             1    88       1       1       1                      3    88        3        3        3                     0    88        0        0        0\n13                  F                 D             3    86       3       3       3                      6    86        6        6        6                     3    86        3        3        3\n14                  F                 D             5    83       5       5       5                      0    83        0        0        0                     6    83        6        6        6\n15                  F                 D             5    71       5       5       5                      5    71        5        5        5                     6    71        6        6        6\n16                  F                 D             1    89       1       1       1                      1    89        1        1        1                     6    89        6        6        6\n17                  F                 D             0    82       0       0       0                      5    82        5        5        5                     2    82        2        2        2\n18                  F                 D             3    87       3       3       3                      4    87        4        4        4                     3    87        3        3        3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.027277,
                    "execution_time": 0.013133,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.006425
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.062564,
                    "execution_time": 0.012819,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.041896
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             2    87       2       2       2                      4    87        4        4        4                     0    87        0        0        0\n1                   F                 D             4    77       4       4       4                      2    77        2        2        2                     4    77        4        4        4\n2                   F                 D             1    83       1       1       1                      6    83        6        6        6                     3    83        3        3        3\n3                   F                 D             3    78       3       3       3                      3    78        3        3        3                     0    78        0        0        0\n4                   F                 D             3    78       3       3       3                      4    78        4        4        4                     5    78        5        5        5\n5                   F                 D             1    86       1       1       1                      3    86        3        3        3                     2    86        2        2        2\n6                   F                 D             0    68       0       0       0                      2    68        2        2        2                     6    68        6        6        6\n7                   F                 D             5    85       5       5       5                      4    85        4        4        4                     1    85        1        1        1\n8                   F                 D             6    66       6       6       6                      4    66        4        4        4                     2    66        2        2        2\n9                   F                 D             6    83       6       6       6                      4    83        4        4        4                     1    83        1        1        1\n10                  F                 D             4    89       4       4       4                      3    89        3        3        3                     6    89        6        6        6\n11                  F                 D             1    67       1       1       1                      3    67        3        3        3                     5    67        5        5        5\n12                  F                 D             1    88       1       1       1                      3    88        3        3        3                     0    88        0        0        0\n13                  F                 D             3    86       3       3       3                      6    86        6        6        6                     3    86        3        3        3\n14                  F                 D             5    83       5       5       5                      0    83        0        0        0                     6    83        6        6        6\n15                  F                 D             5    71       5       5       5                      5    71        5        5        5                     6    71        6        6        6\n16                  F                 D             1    89       1       1       1                      1    89        1        1        1                     6    89        6        6        6\n17                  F                 D             0    82       0       0       0                      5    82        5        5        5                     2    82        2        2        2\n18                  F                 D             3    87       3       3       3                      4    87        4        4        4                     3    87        3        3        3\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    87       0       0       0                      6    87        6        6        6                     2    87        2        2        2\n1                   F                 D             0    62       0       0       0                      3    62        3        3        3                     1    62        1        1        1\n2                   F                 D             0    92       0       0       0                      0    92        0        0        0                     3    92        3        3        3\n3                   F                 D             0    61       0       0       0                      4    61        4        4        4                     5    61        5        5        5\n4                   F                 D             0    83       0       0       0                      3    83        3        3        3                     3    83        3        3        3\n5                   F                 D             0    87       0       0       0                      5    87        5        5        5                     4    87        4        4        4\n6                   F                 D             0    68       0       0       0                      2    68        2        2        2                     6    68        6        6        6\n7                   F                 D             0    82       0       0       0                      5    82        5        5        5                     2    82        2        2        2\n8                   F                 D             0    87       0       0       0                      4    87        4        4        4                     2    87        2        2        2\n9                   F                 D             0    74       0       0       0                      2    74        2        2        2                     5    74        5        5        5\n10                  F                 D             0    99       0       0       0                      1    99        1        1        1                     1    99        1        1        1\n11                  F                 D             0    69       0       0       0                      0    69        0        0        0                     5    69        5        5        5\n12                  F                 D             0    90       0       0       0                      2    90        2        2        2                     2    90        2        2        2\n13                  F                 D             0    85       0       0       0                      6    85        6        6        6                     6    85        6        6        6\n14                  F                 D             0    74       0       0       0                      4    74        4        4        4                     3    74        3        3        3\n15                  F                 D             0    71       0       0       0                      5    71        5        5        5                     0    71        0        0        0\n16                  F                 D             0    79       0       0       0                      4    79        4        4        4                     0    79        0        0        0\n17                  F                 D             0    79       0       0       0                      0    79        0        0        0                     0    79        0        0        0\n18                  F                 D             0    93       0       0       0                      5    93        5        5        5                     1    93        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026723,
                    "execution_time": 0.01278,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.006336
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.216137,
                    "execution_time": 0.013601,
                    "compile_time": 0.152815,
                    "planning_time": 0.042073
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    87       0       0       0                      6    87        6        6        6                     2    87        2        2        2\n1                   F                 D             0    62       0       0       0                      3    62        3        3        3                     1    62        1        1        1\n2                   F                 D             0    92       0       0       0                      0    92        0        0        0                     3    92        3        3        3\n3                   F                 D             0    61       0       0       0                      4    61        4        4        4                     5    61        5        5        5\n4                   F                 D             0    83       0       0       0                      3    83        3        3        3                     3    83        3        3        3\n5                   F                 D             0    87       0       0       0                      5    87        5        5        5                     4    87        4        4        4\n6                   F                 D             0    68       0       0       0                      2    68        2        2        2                     6    68        6        6        6\n7                   F                 D             0    82       0       0       0                      5    82        5        5        5                     2    82        2        2        2\n8                   F                 D             0    87       0       0       0                      4    87        4        4        4                     2    87        2        2        2\n9                   F                 D             0    74       0       0       0                      2    74        2        2        2                     5    74        5        5        5\n10                  F                 D             0    99       0       0       0                      1    99        1        1        1                     1    99        1        1        1\n11                  F                 D             0    69       0       0       0                      0    69        0        0        0                     5    69        5        5        5\n12                  F                 D             0    90       0       0       0                      2    90        2        2        2                     2    90        2        2        2\n13                  F                 D             0    85       0       0       0                      6    85        6        6        6                     6    85        6        6        6\n14                  F                 D             0    74       0       0       0                      4    74        4        4        4                     3    74        3        3        3\n15                  F                 D             0    71       0       0       0                      5    71        5        5        5                     0    71        0        0        0\n16                  F                 D             0    79       0       0       0                      4    79        4        4        4                     0    79        0        0        0\n17                  F                 D             0    79       0       0       0                      0    79        0        0        0                     0    79        0        0        0\n18                  F                 D             0    93       0       0       0                      5    93        5        5        5                     1    93        1        1        1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    79       0       0       0                      0    79        0        0        0                     0    79        0        0        0\n1                   F                 D             0    80       0       0       0                      0    80        0        0        0                     1    80        1        1        1\n2                   F                 D             0    86       0       0       0                      0    86        0        0        0                     2    86        2        2        2\n3                   F                 D             0    92       0       0       0                      0    92        0        0        0                     3    92        3        3        3\n4                   F                 D             0    78       0       0       0                      0    78        0        0        0                     4    78        4        4        4\n5                   F                 D             0    69       0       0       0                      0    69        0        0        0                     5    69        5        5        5\n6                   F                 D             0    88       0       0       0                      0    88        0        0        0                     6    88        6        6        6\n7                   F                 D             0    93       0       0       0                      1    93        1        1        1                     0    93        0        0        0\n8                   F                 D             0    99       0       0       0                      1    99        1        1        1                     1    99        1        1        1\n9                   F                 D             0    76       0       0       0                      1    76        1        1        1                     2    76        2        2        2\n10                  F                 D             0    89       0       0       0                      1    89        1        1        1                     3    89        3        3        3\n11                  F                 D             0    97       0       0       0                      1    97        1        1        1                     4    97        4        4        4\n12                  F                 D             0    82       0       0       0                      1    82        1        1        1                     5    82        5        5        5\n13                  F                 D             0    77       0       0       0                      1    77        1        1        1                     6    77        6        6        6\n14                  F                 D             0    72       0       0       0                      2    72        2        2        2                     0    72        0        0        0\n15                  F                 D             0    76       0       0       0                      2    76        2        2        2                     1    76        1        1        1\n16                  F                 D             0    90       0       0       0                      2    90        2        2        2                     2    90        2        2        2\n17                  F                 D             0    92       0       0       0                      2    92        2        2        2                     3    92        3        3        3\n18                  F                 D             0    67       0       0       0                      2    67        2        2        2                     4    67        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.027266,
                    "execution_time": 0.013166,
                    "compile_time": 9e-05,
                    "planning_time": 0.006496
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.137056,
                    "execution_time": 0.013314,
                    "compile_time": 0.072274,
                    "planning_time": 0.04318
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    79       0       0       0                      0    79        0        0        0                     0    79        0        0        0\n1                   F                 D             0    80       0       0       0                      0    80        0        0        0                     1    80        1        1        1\n2                   F                 D             0    86       0       0       0                      0    86        0        0        0                     2    86        2        2        2\n3                   F                 D             0    92       0       0       0                      0    92        0        0        0                     3    92        3        3        3\n4                   F                 D             0    78       0       0       0                      0    78        0        0        0                     4    78        4        4        4\n5                   F                 D             0    69       0       0       0                      0    69        0        0        0                     5    69        5        5        5\n6                   F                 D             0    88       0       0       0                      0    88        0        0        0                     6    88        6        6        6\n7                   F                 D             0    93       0       0       0                      1    93        1        1        1                     0    93        0        0        0\n8                   F                 D             0    99       0       0       0                      1    99        1        1        1                     1    99        1        1        1\n9                   F                 D             0    76       0       0       0                      1    76        1        1        1                     2    76        2        2        2\n10                  F                 D             0    89       0       0       0                      1    89        1        1        1                     3    89        3        3        3\n11                  F                 D             0    97       0       0       0                      1    97        1        1        1                     4    97        4        4        4\n12                  F                 D             0    82       0       0       0                      1    82        1        1        1                     5    82        5        5        5\n13                  F                 D             0    77       0       0       0                      1    77        1        1        1                     6    77        6        6        6\n14                  F                 D             0    72       0       0       0                      2    72        2        2        2                     0    72        0        0        0\n15                  F                 D             0    76       0       0       0                      2    76        2        2        2                     1    76        1        1        1\n16                  F                 D             0    90       0       0       0                      2    90        2        2        2                     2    90        2        2        2\n17                  F                 D             0    92       0       0       0                      2    92        2        2        2                     3    92        3        3        3\n18                  F                 D             0    67       0       0       0                      2    67        2        2        2                     4    67        4        4        4\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    79       0       0       0                      0    79        0        0        0                     0    79        0        0        0\n1                   F                 D             0    80       0       0       0                      0    80        0        0        0                     1    80        1        1        1\n2                   F                 D             0    86       0       0       0                      0    86        0        0        0                     2    86        2        2        2\n3                   F                 D             0    92       0       0       0                      0    92        0        0        0                     3    92        3        3        3\n4                   F                 D             0    78       0       0       0                      0    78        0        0        0                     4    78        4        4        4\n5                   F                 D             0    69       0       0       0                      0    69        0        0        0                     5    69        5        5        5\n6                   F                 D             0    88       0       0       0                      0    88        0        0        0                     6    88        6        6        6\n7                   F                 D             0    93       0       0       0                      1    93        1        1        1                     0    93        0        0        0\n8                   F                 D             0    99       0       0       0                      1    99        1        1        1                     1    99        1        1        1\n9                   F                 D             0    76       0       0       0                      1    76        1        1        1                     2    76        2        2        2\n10                  F                 D             0    89       0       0       0                      1    89        1        1        1                     3    89        3        3        3\n11                  F                 D             0    97       0       0       0                      1    97        1        1        1                     4    97        4        4        4\n12                  F                 D             0    82       0       0       0                      1    82        1        1        1                     5    82        5        5        5\n13                  F                 D             0    77       0       0       0                      1    77        1        1        1                     6    77        6        6        6\n14                  F                 D             0    72       0       0       0                      2    72        2        2        2                     0    72        0        0        0\n15                  F                 D             0    76       0       0       0                      2    76        2        2        2                     1    76        1        1        1\n16                  F                 D             0    90       0       0       0                      2    90        2        2        2                     2    90        2        2        2\n17                  F                 D             0    92       0       0       0                      2    92        2        2        2                     3    92        3        3        3\n18                  F                 D             0    67       0       0       0                      2    67        2        2        2                     4    67        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.027503,
                    "execution_time": 0.013223,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.006452
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.027868,
                    "execution_time": 0.013305,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006679
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    79       0       0       0                      0    79        0        0        0                     0    79        0        0        0\n1                   F                 D             0    80       0       0       0                      0    80        0        0        0                     1    80        1        1        1\n2                   F                 D             0    86       0       0       0                      0    86        0        0        0                     2    86        2        2        2\n3                   F                 D             0    92       0       0       0                      0    92        0        0        0                     3    92        3        3        3\n4                   F                 D             0    78       0       0       0                      0    78        0        0        0                     4    78        4        4        4\n5                   F                 D             0    69       0       0       0                      0    69        0        0        0                     5    69        5        5        5\n6                   F                 D             0    88       0       0       0                      0    88        0        0        0                     6    88        6        6        6\n7                   F                 D             0    93       0       0       0                      1    93        1        1        1                     0    93        0        0        0\n8                   F                 D             0    99       0       0       0                      1    99        1        1        1                     1    99        1        1        1\n9                   F                 D             0    76       0       0       0                      1    76        1        1        1                     2    76        2        2        2\n10                  F                 D             0    89       0       0       0                      1    89        1        1        1                     3    89        3        3        3\n11                  F                 D             0    97       0       0       0                      1    97        1        1        1                     4    97        4        4        4\n12                  F                 D             0    82       0       0       0                      1    82        1        1        1                     5    82        5        5        5\n13                  F                 D             0    77       0       0       0                      1    77        1        1        1                     6    77        6        6        6\n14                  F                 D             0    72       0       0       0                      2    72        2        2        2                     0    72        0        0        0\n15                  F                 D             0    76       0       0       0                      2    76        2        2        2                     1    76        1        1        1\n16                  F                 D             0    90       0       0       0                      2    90        2        2        2                     2    90        2        2        2\n17                  F                 D             0    92       0       0       0                      2    92        2        2        2                     3    92        3        3        3\n18                  F                 D             0    67       0       0       0                      2    67        2        2        2                     4    67        4        4        4\n...*/"
    }
]