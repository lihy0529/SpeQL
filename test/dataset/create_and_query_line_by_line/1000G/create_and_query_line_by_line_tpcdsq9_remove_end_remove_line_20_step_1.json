[
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 50000000\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 50000000 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 50000000 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 50000000 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 50000000 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity > 60) > 1000000\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity > 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity > 60) end bucket4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60 ) > 1000000 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60 ) > 1000000 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   123.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.022574,
                    "execution_time": 13.888111,
                    "compile_time": 0.001256,
                    "planning_time": 0.086806
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 28.890118,
                    "execution_time": 28.669252,
                    "compile_time": 0.003139,
                    "planning_time": 0.157466
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60) > 1000000 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60) > 1000000 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" > 60) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   123.45*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) /*CURSOR_IDENTIFIER*/ end bucket4",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.506617,
                    "execution_time": 14.378565,
                    "compile_time": 0.001274,
                    "planning_time": 0.079725
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.579397,
                    "execution_time": 14.371838,
                    "compile_time": 0.003243,
                    "planning_time": 0.157313
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\nelse (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.500685,
                    "execution_time": 14.370009,
                    "compile_time": 0.001323,
                    "planning_time": 0.081464
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.509441,
                    "execution_time": 14.378833,
                    "compile_time": 0.001311,
                    "planning_time": 0.081697
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44    77.44*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.533474,
                    "execution_time": 14.401752,
                    "compile_time": 0.001315,
                    "planning_time": 0.081621
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 17.272631,
                    "execution_time": 14.393736,
                    "compile_time": 2.666076,
                    "planning_time": 0.162415
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\") ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\") ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44    77.44*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\nelse (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.512837,
                    "execution_time": 14.38369,
                    "compile_time": 0.001293,
                    "planning_time": 0.080304
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.516862,
                    "execution_time": 14.364375,
                    "compile_time": 0.001345,
                    "planning_time": 0.084264
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.500233,
                    "execution_time": 14.369667,
                    "compile_time": 0.001338,
                    "planning_time": 0.081979
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.517036,
                    "execution_time": 14.369057,
                    "compile_time": 0.001316,
                    "planning_time": 0.099378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n                        else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.575144,
                    "execution_time": 14.445722,
                    "compile_time": 0.001307,
                    "planning_time": 0.080315
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.498753,
                    "execution_time": 14.370463,
                    "compile_time": 0.001292,
                    "planning_time": 0.07887
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.498195,
                    "execution_time": 14.369073,
                    "compile_time": 0.001288,
                    "planning_time": 0.080698
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.49596,
                    "execution_time": 14.360702,
                    "compile_time": 0.001309,
                    "planning_time": 0.086363
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4\n0    16.09    46.76    77.44   108.11*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)) > 0 then 0 end as example_result\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" ) > 0 THEN 0 END AS \"EXAMPLE_RESULT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" ) > 0 THEN 0 END AS \"EXAMPLE_RESULT\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  example_result\n0    16.09    46.76    77.44   108.11               0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.509508,
                    "execution_time": 14.375088,
                    "compile_time": 0.001425,
                    "planning_time": 0.081826
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.590888,
                    "execution_time": 14.369987,
                    "compile_time": 0.002204,
                    "planning_time": 0.165658
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\") > 0 THEN 0 END AS \"EXAMPLE_RESULT\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\") > 0 THEN 0 END AS \"EXAMPLE_RESULT\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  example_result\n0    16.09    46.76    77.44   108.11               0*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales) > 0\n /*CURSOR_IDENTIFIER*/ then null else null end bucket5",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) > 0 THEN NULL ELSE NULL END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) > 0 THEN NULL ELSE NULL END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4 bucket5\n0    16.09    46.76    77.44   108.11    None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.519101,
                    "execution_time": 14.380612,
                    "compile_time": 0.001464,
                    "planning_time": 0.085722
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 14.600588,
                    "execution_time": 14.378134,
                    "compile_time": 0.00232,
                    "planning_time": 0.166494
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\") > 0 THEN NULL ELSE NULL END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\") > 0 THEN NULL ELSE NULL END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4 bucket5\n0    16.09    46.76    77.44   108.11    None*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 81 and 100) /*CURSOR_IDENTIFIER*/ end bucket5",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 18.23146,
                    "execution_time": 18.070764,
                    "compile_time": 0.001651,
                    "planning_time": 0.101057
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.345344,
                    "execution_time": 18.102499,
                    "compile_time": 0.001649,
                    "planning_time": 0.181141
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n/*CURSOR_IDENTIFIER*/ end bucket5",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 16.67207,
                    "execution_time": 16.524581,
                    "compile_time": 0.001498,
                    "planning_time": 0.091479
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 16.749754,
                    "execution_time": 16.517545,
                    "compile_time": 0.001528,
                    "planning_time": 0.173686
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales) end bucket5 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11    77.44*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 16.696334,
                    "execution_time": 16.545235,
                    "compile_time": 0.001511,
                    "planning_time": 0.095222
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 19.227342,
                    "execution_time": 16.547602,
                    "compile_time": 2.44575,
                    "planning_time": 0.176938
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\") END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\") END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11    77.44*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n/*CURSOR_IDENTIFIER*/ end bucket5",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 16.660744,
                    "execution_time": 16.514654,
                    "compile_time": 0.001499,
                    "planning_time": 0.090879
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 16.654024,
                    "execution_time": 16.505898,
                    "compile_time": 0.001541,
                    "planning_time": 0.089873
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\nfrom store_sales where ss_quantity between 81 and 100) end bucket5 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 18.21048,
                    "execution_time": 18.054469,
                    "compile_time": 0.001679,
                    "planning_time": 0.095599
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.213412,
                    "execution_time": 18.057006,
                    "compile_time": 0.001654,
                    "planning_time": 0.096369
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n/*CURSOR_IDENTIFIER*/ end bucket5",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 18.222027,
                    "execution_time": 18.068319,
                    "compile_time": 0.001649,
                    "planning_time": 0.094497
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.224682,
                    "execution_time": 18.068503,
                    "compile_time": 0.001709,
                    "planning_time": 0.095898
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) > 12171089 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) END AS \"BUCKET1\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) > 111772806 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) END AS \"BUCKET2\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) > 23211533 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) END AS \"BUCKET3\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) > 56475617 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) END AS \"BUCKET4\" , CASE WHEN ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) > 43543186 THEN ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) ELSE ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) END AS \"BUCKET5\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 18.210492,
                    "execution_time": 18.053658,
                    "compile_time": 0.001659,
                    "planning_time": 0.095163
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 18.21415,
                    "execution_time": 18.054132,
                    "compile_time": 0.001645,
                    "planning_time": 0.09995
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\"",
                "rewrite": "SELECT CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) > 12171089 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1) END AS \"BUCKET1\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) > 111772806 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21) END AS \"BUCKET2\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) > 23211533 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41) END AS \"BUCKET3\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) > 56475617 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61) END AS \"BUCKET4\", CASE WHEN (SELECT COUNT(*) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) > 43543186 THEN (SELECT AVG(\"STORE_SALES\".\"SS_EXT_TAX\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) ELSE (SELECT AVG(\"STORE_SALES\".\"SS_NET_PAID\") AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81) END AS \"BUCKET5\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_10\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) , \"_U_11\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) , \"_U_12\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_13\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_14\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_3\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_6\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_7\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_8\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_9\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) SELECT CASE WHEN \"_U_0\".\"_COL_0\" > 12171089 THEN \"_U_1\".\"_COL_0\" ELSE \"_U_2\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"_U_3\".\"_COL_0\" > 111772806 THEN \"_U_4\".\"_COL_0\" ELSE \"_U_5\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"_U_6\".\"_COL_0\" > 23211533 THEN \"_U_7\".\"_COL_0\" ELSE \"_U_8\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"_U_9\".\"_COL_0\" > 56475617 THEN \"_U_10\".\"_COL_0\" ELSE \"_U_11\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"_U_12\".\"_COL_0\" > 43543186 THEN \"_U_13\".\"_COL_0\" ELSE \"_U_14\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"_U_0\" AS \"_U_0\" CROSS JOIN \"_U_1\" AS \"_U_1\" CROSS JOIN \"_U_10\" AS \"_U_10\" CROSS JOIN \"_U_11\" AS \"_U_11\" CROSS JOIN \"_U_12\" AS \"_U_12\" CROSS JOIN \"_U_13\" AS \"_U_13\" CROSS JOIN \"_U_14\" AS \"_U_14\" CROSS JOIN \"_U_2\" AS \"_U_2\" CROSS JOIN \"_U_3\" AS \"_U_3\" CROSS JOIN \"_U_4\" AS \"_U_4\" CROSS JOIN \"_U_5\" AS \"_U_5\" CROSS JOIN \"_U_6\" AS \"_U_6\" CROSS JOIN \"_U_7\" AS \"_U_7\" CROSS JOIN \"_U_8\" AS \"_U_8\" CROSS JOIN \"_U_9\" AS \"_U_9\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.532634,
                    "execution_time": 0.481801,
                    "compile_time": 0.000305,
                    "planning_time": 0.025077,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.597052,
                    "execution_time": 0.481805,
                    "compile_time": 0.002412,
                    "planning_time": 0.084887,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.48643,
                    "execution_time": 1.43596,
                    "compile_time": 0.000328,
                    "planning_time": 0.024208,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.54914,
                    "execution_time": 1.437946,
                    "compile_time": 0.000318,
                    "planning_time": 0.083482,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.63333,
                    "execution_time": 1.582351,
                    "compile_time": 0.000296,
                    "planning_time": 0.024782,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.692695,
                    "execution_time": 1.581786,
                    "compile_time": 0.000311,
                    "planning_time": 0.083856,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.64694,
                    "execution_time": 1.580409,
                    "compile_time": 0.000307,
                    "planning_time": 0.035349,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.68905,
                    "execution_time": 1.57846,
                    "compile_time": 0.000304,
                    "planning_time": 0.084185,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.677789,
                    "execution_time": 0.626321,
                    "compile_time": 0.000319,
                    "planning_time": 0.024554,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.741523,
                    "execution_time": 0.626623,
                    "compile_time": 0.000306,
                    "planning_time": 0.088898,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.633329,
                    "execution_time": 1.582652,
                    "compile_time": 0.000317,
                    "planning_time": 0.024247,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.693557,
                    "execution_time": 1.58176,
                    "compile_time": 0.0003,
                    "planning_time": 0.085517,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.631669,
                    "execution_time": 1.578796,
                    "compile_time": 0.0003,
                    "planning_time": 0.026875,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.693387,
                    "execution_time": 1.579275,
                    "compile_time": 0.0003,
                    "planning_time": 0.087389,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.48386,
                    "execution_time": 1.434833,
                    "compile_time": 0.000299,
                    "planning_time": 0.023367,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.543745,
                    "execution_time": 1.434313,
                    "compile_time": 0.000305,
                    "planning_time": 0.083427,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.677077,
                    "execution_time": 0.627482,
                    "compile_time": 0.000327,
                    "planning_time": 0.023546,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.740366,
                    "execution_time": 0.626563,
                    "compile_time": 0.000311,
                    "planning_time": 0.087132,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.632208,
                    "execution_time": 1.582478,
                    "compile_time": 0.000288,
                    "planning_time": 0.024136,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.698118,
                    "execution_time": 1.583564,
                    "compile_time": 0.000295,
                    "planning_time": 0.088003,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.638394,
                    "execution_time": 1.581257,
                    "compile_time": 0.000317,
                    "planning_time": 0.030426,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.692508,
                    "execution_time": 1.580499,
                    "compile_time": 0.000309,
                    "planning_time": 0.085349,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.680408,
                    "execution_time": 0.627724,
                    "compile_time": 0.000308,
                    "planning_time": 0.027098,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.737198,
                    "execution_time": 0.626559,
                    "compile_time": 0.000297,
                    "planning_time": 0.084268,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.634735,
                    "execution_time": 1.58461,
                    "compile_time": 0.000316,
                    "planning_time": 0.023446,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.699793,
                    "execution_time": 1.585115,
                    "compile_time": 0.000312,
                    "planning_time": 0.087441,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.631633,
                    "execution_time": 1.580857,
                    "compile_time": 0.000307,
                    "planning_time": 0.024582,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.695525,
                    "execution_time": 1.582164,
                    "compile_time": 0.00031,
                    "planning_time": 0.086601,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.675625,
                    "execution_time": 0.6262,
                    "compile_time": 0.000309,
                    "planning_time": 0.024238,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.744483,
                    "execution_time": 0.627711,
                    "compile_time": 0.0003,
                    "planning_time": 0.090563,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" > 12171089 THEN \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" > 111772806 THEN \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" > 23211533 THEN \"SPEQLITE_TEMP_TABLE_13\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_15\".\"_COL_0\" > 56475617 THEN \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" > 43543186 THEN \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.232398,
                    "execution_time": 0.146354,
                    "compile_time": 0.072296,
                    "planning_time": 10.973039,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.210445,
                    "execution_time": 0.275199,
                    "compile_time": 3.292962,
                    "planning_time": 10.600141,
                    "create_size": 8
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET1\" AS \"BUCKET1\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET2\" AS \"BUCKET2\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET3\" AS \"BUCKET3\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET4\" AS \"BUCKET4\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET5\" AS \"BUCKET5\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*    bucket1  bucket2  bucket3  bucket4  bucket5\n0     16.09    46.76    77.44   108.11   138.79\n1     16.09    46.76    77.44   108.11   138.79\n2     16.09    46.76    77.44   108.11   138.79\n3     16.09    46.76    77.44   108.11   138.79\n4     16.09    46.76    77.44   108.11   138.79\n5     16.09    46.76    77.44   108.11   138.79\n6     16.09    46.76    77.44   108.11   138.79\n7     16.09    46.76    77.44   108.11   138.79\n8     16.09    46.76    77.44   108.11   138.79\n9     16.09    46.76    77.44   108.11   138.79\n10    16.09    46.76    77.44   108.11   138.79\n11    16.09    46.76    77.44   108.11   138.79\n12    16.09    46.76    77.44   108.11   138.79\n13    16.09    46.76    77.44   108.11   138.79\n14    16.09    46.76    77.44   108.11   138.79\n15    16.09    46.76    77.44   108.11   138.79\n16    16.09    46.76    77.44   108.11   138.79\n17    16.09    46.76    77.44   108.11   138.79\n18    16.09    46.76    77.44   108.11   138.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01664,
                    "execution_time": 0.007054,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003544
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054288,
                    "execution_time": 0.007487,
                    "compile_time": 0.000951,
                    "planning_time": 0.038616
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" > 12171089 THEN \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" > 111772806 THEN \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" > 23211533 THEN \"SPEQLITE_TEMP_TABLE_13\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_15\".\"_COL_0\" > 56475617 THEN \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" > 43543186 THEN \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET1\" AS \"BUCKET1\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET2\" AS \"BUCKET2\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET3\" AS \"BUCKET3\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET4\" AS \"BUCKET4\" , \"SPEQLITE_TEMP_TABLE_16\".\"BUCKET5\" AS \"BUCKET5\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*    bucket1  bucket2  bucket3  bucket4  bucket5\n0     16.09    46.76    77.44   108.11   138.79\n1     16.09    46.76    77.44   108.11   138.79\n2     16.09    46.76    77.44   108.11   138.79\n3     16.09    46.76    77.44   108.11   138.79\n4     16.09    46.76    77.44   108.11   138.79\n5     16.09    46.76    77.44   108.11   138.79\n6     16.09    46.76    77.44   108.11   138.79\n7     16.09    46.76    77.44   108.11   138.79\n8     16.09    46.76    77.44   108.11   138.79\n9     16.09    46.76    77.44   108.11   138.79\n10    16.09    46.76    77.44   108.11   138.79\n11    16.09    46.76    77.44   108.11   138.79\n12    16.09    46.76    77.44   108.11   138.79\n13    16.09    46.76    77.44   108.11   138.79\n14    16.09    46.76    77.44   108.11   138.79\n15    16.09    46.76    77.44   108.11   138.79\n16    16.09    46.76    77.44   108.11   138.79\n17    16.09    46.76    77.44   108.11   138.79\n18    16.09    46.76    77.44   108.11   138.79\n...*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_10\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) , \"_U_11\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) , \"_U_12\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_13\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_14\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_3\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_6\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_7\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_8\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_9\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) SELECT CASE WHEN \"_U_0\".\"_COL_0\" > 12171089 THEN \"_U_1\".\"_COL_0\" ELSE \"_U_2\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"_U_3\".\"_COL_0\" > 111772806 THEN \"_U_4\".\"_COL_0\" ELSE \"_U_5\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"_U_6\".\"_COL_0\" > 23211533 THEN \"_U_7\".\"_COL_0\" ELSE \"_U_8\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"_U_9\".\"_COL_0\" > 56475617 THEN \"_U_10\".\"_COL_0\" ELSE \"_U_11\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"_U_12\".\"_COL_0\" > 43543186 THEN \"_U_13\".\"_COL_0\" ELSE \"_U_14\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"_U_0\" AS \"_U_0\" CROSS JOIN \"_U_1\" AS \"_U_1\" CROSS JOIN \"_U_10\" AS \"_U_10\" CROSS JOIN \"_U_11\" AS \"_U_11\" CROSS JOIN \"_U_12\" AS \"_U_12\" CROSS JOIN \"_U_13\" AS \"_U_13\" CROSS JOIN \"_U_14\" AS \"_U_14\" CROSS JOIN \"_U_2\" AS \"_U_2\" CROSS JOIN \"_U_3\" AS \"_U_3\" CROSS JOIN \"_U_4\" AS \"_U_4\" CROSS JOIN \"_U_5\" AS \"_U_5\" CROSS JOIN \"_U_6\" AS \"_U_6\" CROSS JOIN \"_U_7\" AS \"_U_7\" CROSS JOIN \"_U_8\" AS \"_U_8\" CROSS JOIN \"_U_9\" AS \"_U_9\" WHERE \"REASON\".\"R_REASON_SK\" = 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" > 12171089 THEN \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" > 111772806 THEN \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" > 23211533 THEN \"SPEQLITE_TEMP_TABLE_13\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_15\".\"_COL_0\" > 56475617 THEN \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" > 43543186 THEN \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" WHERE \"REASON\".\"R_REASON_SK\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 10.405917,
                    "execution_time": 0.144928,
                    "compile_time": 0.000894,
                    "planning_time": 10.220829,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.495715,
                    "execution_time": 0.283126,
                    "compile_time": 0.002929,
                    "planning_time": 10.166506,
                    "create_size": 8
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET1\" AS \"BUCKET1\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET2\" AS \"BUCKET2\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET3\" AS \"BUCKET3\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET4\" AS \"BUCKET4\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET5\" AS \"BUCKET5\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016621,
                    "execution_time": 0.007065,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003452
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052863,
                    "execution_time": 0.007289,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038733
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" > 12171089 THEN \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" > 111772806 THEN \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" > 23211533 THEN \"SPEQLITE_TEMP_TABLE_13\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_15\".\"_COL_0\" > 56475617 THEN \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" > 43543186 THEN \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" WHERE \"REASON\".\"R_REASON_SK\" = 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET1\" AS \"BUCKET1\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET2\" AS \"BUCKET2\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET3\" AS \"BUCKET3\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET4\" AS \"BUCKET4\" , \"SPEQLITE_TEMP_TABLE_17\".\"BUCKET5\" AS \"BUCKET5\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    },
    {
        "input": "-- start template query9.tpl query 49 in stream 0\nselect /* TPC-DS query9.tpl 0.49 */ case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 12171089\n            then (select avg(ss_ext_tax) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 111772806\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 23211533\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 56475617\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 43543186\n            then (select avg(ss_ext_tax)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_paid)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_10\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) , \"_U_11\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) , \"_U_12\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_13\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_14\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 100 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 81 ) , \"_U_2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 1 ) , \"_U_3\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 40 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"_U_6\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_7\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_EXT_TAX\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_8\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 60 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 41 ) , \"_U_9\" AS ( SELECT COUNT ( * ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 80 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 61 ) SELECT CASE WHEN \"_U_0\".\"_COL_0\" > 12171089 THEN \"_U_1\".\"_COL_0\" ELSE \"_U_2\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"_U_3\".\"_COL_0\" > 111772806 THEN \"_U_4\".\"_COL_0\" ELSE \"_U_5\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"_U_6\".\"_COL_0\" > 23211533 THEN \"_U_7\".\"_COL_0\" ELSE \"_U_8\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"_U_9\".\"_COL_0\" > 56475617 THEN \"_U_10\".\"_COL_0\" ELSE \"_U_11\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"_U_12\".\"_COL_0\" > 43543186 THEN \"_U_13\".\"_COL_0\" ELSE \"_U_14\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"_U_0\" AS \"_U_0\" CROSS JOIN \"_U_1\" AS \"_U_1\" CROSS JOIN \"_U_10\" AS \"_U_10\" CROSS JOIN \"_U_11\" AS \"_U_11\" CROSS JOIN \"_U_12\" AS \"_U_12\" CROSS JOIN \"_U_13\" AS \"_U_13\" CROSS JOIN \"_U_14\" AS \"_U_14\" CROSS JOIN \"_U_2\" AS \"_U_2\" CROSS JOIN \"_U_3\" AS \"_U_3\" CROSS JOIN \"_U_4\" AS \"_U_4\" CROSS JOIN \"_U_5\" AS \"_U_5\" CROSS JOIN \"_U_6\" AS \"_U_6\" CROSS JOIN \"_U_7\" AS \"_U_7\" CROSS JOIN \"_U_8\" AS \"_U_8\" CROSS JOIN \"_U_9\" AS \"_U_9\" WHERE \"REASON\".\"R_REASON_SK\" = 1"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017218,
                    "execution_time": 0.007659,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003421
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052262,
                    "execution_time": 0.007431,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.03856
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" > 12171089 THEN \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" END AS \"BUCKET1\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" > 111772806 THEN \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" END AS \"BUCKET2\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" > 23211533 THEN \"SPEQLITE_TEMP_TABLE_13\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" END AS \"BUCKET3\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_15\".\"_COL_0\" > 56475617 THEN \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" END AS \"BUCKET4\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" > 43543186 THEN \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" ELSE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" END AS \"BUCKET5\" FROM \"REASON\" AS \"REASON\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" WHERE \"REASON\".\"R_REASON_SK\" = 1",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   bucket1  bucket2  bucket3  bucket4  bucket5\n0    16.09    46.76    77.44   108.11   138.79*/"
    }
]