[
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n group by a.ca_state/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\ngroup by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.67998,
                    "execution_time": 24.591105,
                    "compile_time": 0.000539,
                    "planning_time": 0.053207,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 24.97695,
                    "execution_time": 24.755811,
                    "compile_time": 0.005318,
                    "planning_time": 0.179648,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   state       cnt\n0     ND  44360118\n1     AR  62642737\n2     WV  46181754\n3     MO  91669224\n4     WY  19305703\n5     IA  82871610\n6     SD  55037436\n7     CT   6582814\n8     RI   4206529\n9     IL  84735041\n10    WI  59451452\n11    MN  71865290\n12    CO  52669692\n13    FL  53669875\n14    IN  76499944\n15    NH   8416402\n16    AK  19136121\n17    ID  36863116\n18    UT  24289691\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015838,
                    "execution_time": 0.00725,
                    "compile_time": 3.9e-05,
                    "planning_time": 0.00294
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052696,
                    "execution_time": 0.006957,
                    "compile_time": 0.001009,
                    "planning_time": 0.038349
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   state       cnt\n0     ND  44360118\n1     AR  62642737\n2     WV  46181754\n3     MO  91669224\n4     WY  19305703\n5     IA  82871610\n6     SD  55037436\n7     CT   6582814\n8     RI   4206529\n9     IL  84735041\n10    WI  59451452\n11    MN  71865290\n12    CO  52669692\n13    FL  53669875\n14    IN  76499944\n15    NH   8416402\n16    AK  19136121\n17    ID  36863116\n18    UT  24289691\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,date_dim d\n where       a.ca_address_sk = d.d_date_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n/*CURSOR_IDENTIFIER*/)\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080259,
                    "execution_time": 0.03164,
                    "compile_time": 0.00026,
                    "planning_time": 0.024005,
                    "create_size": 16
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.420881,
                    "execution_time": 0.155773,
                    "compile_time": 0.138056,
                    "planning_time": 0.101095,
                    "create_size": 16
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.159664,
                    "execution_time": 0.090243,
                    "compile_time": 0.000377,
                    "planning_time": 0.04025,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.302429,
                    "execution_time": 0.091924,
                    "compile_time": 0.084537,
                    "planning_time": 0.095893,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   state   cnt\n0     ND  1222\n1     AR  1751\n2     MO  2454\n3     WV  1231\n4     IL  2255\n5     MN  1950\n6     CO  1425\n7     FL  1427\n8     AK   515\n9     WA   826\n10    IA  2181\n11    SD  1496\n12    WY   533\n13    IN  2076\n14    NH   251\n15    UT   666\n16    OK  1808\n17    DC    25\n18    WI  1636\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015048,
                    "execution_time": 0.006579,
                    "compile_time": 4e-05,
                    "planning_time": 0.002937
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050212,
                    "execution_time": 0.006952,
                    "compile_time": 4e-05,
                    "planning_time": 0.037586
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   state   cnt\n0     ND  1222\n1     AR  1751\n2     MO  2454\n3     WV  1231\n4     IL  2255\n5     MN  1950\n6     CO  1425\n7     FL  1427\n8     AK   515\n9     WA   826\n10    IA  2181\n11    SD  1496\n12    WY   533\n13    IN  2076\n14    NH   251\n15    UT   666\n16    OK  1808\n17    DC    25\n18    WI  1636\n...*/"
    },
    {
        "input": "select /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081047,
                    "execution_time": 0.031323,
                    "compile_time": 0.000258,
                    "planning_time": 0.025567,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.256274,
                    "execution_time": 0.032556,
                    "compile_time": 0.11289,
                    "planning_time": 0.084662,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.8065,
                    "execution_time": 8.715408,
                    "compile_time": 0.000588,
                    "planning_time": 0.054111,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.58147,
                    "execution_time": 8.896732,
                    "compile_time": 3.508377,
                    "planning_time": 0.136701,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   state       cnt\n0     MI  13671852\n1     NE  15693055\n2     DE    507351\n3     NM   5534455\n4     MS  13819461\n5     VA  22695460\n6     OR   6086106\n7     NC  16884707\n8         16218257\n9     OH  14813658\n10    TN  16024012\n11    CA   9813477\n12    NV   2887757\n13    HI    662068\n14    KY  20245740\n15    MA   2346333\n16    MD   3887125\n17    VT   2355865\n18    TX  42781624\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016425,
                    "execution_time": 0.007283,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003251
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052175,
                    "execution_time": 0.007615,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038005
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   state       cnt\n0     MI  13671852\n1     NE  15693055\n2     DE    507351\n3     NM   5534455\n4     MS  13819461\n5     VA  22695460\n6     OR   6086106\n7     NC  16884707\n8         16218257\n9     OH  14813658\n10    TN  16024012\n11    CA   9813477\n12    NV   2887757\n13    HI    662068\n14    KY  20245740\n15    MA   2346333\n16    MD   3887125\n17    VT   2355865\n18    TX  42781624\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08025,
                    "execution_time": 0.03066,
                    "compile_time": 0.000249,
                    "planning_time": 0.024749,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.331728,
                    "execution_time": 0.031242,
                    "compile_time": 0.190429,
                    "planning_time": 0.084532,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.683195,
                    "execution_time": 0.585639,
                    "compile_time": 0.000614,
                    "planning_time": 0.05944,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.908323,
                    "execution_time": 0.606839,
                    "compile_time": 0.127979,
                    "planning_time": 0.135493,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   state     cnt\n0     ND  416084\n1     AR  595634\n2     MO  871779\n3     WV  438552\n4     SD  521508\n5     IA  783327\n6     WY  181910\n7     IL  809710\n8     MN  681625\n9     CT   62353\n10    RI   39999\n11    IN  721971\n12    NH   81555\n13    UT  229155\n14    OK  610259\n15    DC    8206\n16    WI  565608\n17    FL  504412\n18    CO  498018\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016069,
                    "execution_time": 0.006886,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003221
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051037,
                    "execution_time": 0.007013,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.03814
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   state     cnt\n0     ND  416084\n1     AR  595634\n2     MO  871779\n3     WV  438552\n4     SD  521508\n5     IA  783327\n6     WY  181910\n7     IL  809710\n8     MN  681625\n9     CT   62353\n10    RI   39999\n11    IN  721971\n12    NH   81555\n13    UT  229155\n14    OK  610259\n15    DC    8206\n16    WI  565608\n17    FL  504412\n18    CO  498018\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * i.i_current_price\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.141119,
                    "execution_time": 0.049103,
                    "compile_time": 0.000503,
                    "planning_time": 0.057639,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.792929,
                    "execution_time": 0.611666,
                    "compile_time": 0.005777,
                    "planning_time": 0.139721,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017651,
                    "execution_time": 0.006929,
                    "compile_time": 5e-05,
                    "planning_time": 0.004403
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053329,
                    "execution_time": 0.007172,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039539
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n              from item j)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"_U_1\" AS \"_U_1\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081631,
                    "execution_time": 0.033262,
                    "compile_time": 0.000288,
                    "planning_time": 0.02362,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.145045,
                    "execution_time": 0.034154,
                    "compile_time": 0.001204,
                    "planning_time": 0.083818,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" = 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.177691,
                    "execution_time": 0.07582,
                    "compile_time": 0.000663,
                    "planning_time": 0.063491,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.420474,
                    "execution_time": 0.062887,
                    "compile_time": 0.176197,
                    "planning_time": 0.144794,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017278,
                    "execution_time": 0.007397,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004191
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052827,
                    "execution_time": 0.007571,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039337
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j)\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"_U_1\" AS \"_U_1\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016489,
                    "execution_time": 0.006865,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003979
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052925,
                    "execution_time": 0.007365,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039707
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085879,
                    "execution_time": 0.036962,
                    "compile_time": 0.000286,
                    "planning_time": 0.023529,
                    "create_size": 50
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.960716,
                    "execution_time": 0.640244,
                    "compile_time": 0.204409,
                    "planning_time": 0.087856,
                    "create_size": 50
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.365232,
                    "execution_time": 0.249025,
                    "compile_time": 0.000676,
                    "planning_time": 0.075657,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.44396,
                    "execution_time": 0.248129,
                    "compile_time": 0.003227,
                    "planning_time": 0.152265,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   state     cnt\n0     NJ   16358\n1     MD   17876\n2     NY   47715\n3     ME   12484\n4     NM   25578\n5     GA  123502\n6     AZ   11623\n7     AL   51302\n8     LA   42358\n9     OH   68350\n10    TN   73805\n11    HI    3097\n12    CA   45067\n13    NV   13419\n14    MI   63161\n15    MA   10998\n16    KY   93721\n17    NE   72079\n18    DE    2332\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015505,
                    "execution_time": 0.006813,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003025
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051064,
                    "execution_time": 0.007086,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038092
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   state     cnt\n0     NJ   16358\n1     MD   17876\n2     NY   47715\n3     ME   12484\n4     NM   25578\n5     GA  123502\n6     AZ   11623\n7     AL   51302\n8     LA   42358\n9     OH   68350\n10    TN   73805\n11    HI    3097\n12    CA   45067\n13    NV   13419\n14    MI   63161\n15    MA   10998\n16    KY   93721\n17    NE   72079\n18    DE    2332\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   state     cnt\n0     NY   47715\n1     ME   12484\n2     TX  199001\n3     LA   42358\n4          75205\n5     NC   78085\n6     OH   68350\n7     MI   63161\n8     HI    3097\n9     CA   45067\n10    NV   13419\n11    TN   73805\n12    MA   10998\n13    KY   93721\n14    NJ   16358\n15    NE   72079\n16    DE    2332\n17    MD   17876\n18    AL   51302\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016357,
                    "execution_time": 0.007253,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003218
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051259,
                    "execution_time": 0.007092,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.037973
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   state     cnt\n0     NY   47715\n1     ME   12484\n2     TX  199001\n3     LA   42358\n4          75205\n5     NC   78085\n6     OH   68350\n7     MI   63161\n8     HI    3097\n9     CA   45067\n10    NV   13419\n11    TN   73805\n12    MA   10998\n13    KY   93721\n14    NJ   16358\n15    NE   72079\n16    DE    2332\n17    MD   17876\n18    AL   51302\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.363995,
                    "execution_time": 0.25202,
                    "compile_time": 0.000657,
                    "planning_time": 0.071114,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.06474,
                    "execution_time": 0.267839,
                    "compile_time": 4.602435,
                    "planning_time": 0.15233,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   state    cnt\n0     AR  58732\n1     IN  71286\n2     NH   8004\n3     UT  22571\n4     WA  30073\n5     ND  40633\n6     MO  85703\n7     WV  43160\n8     IL  79780\n9     WI  55233\n10    CO  48844\n11    FL  49140\n12    AK  17892\n13    OK  59783\n14    DC    806\n15    IA  77149\n16    WY  17799\n17    SD  51278\n18    MN  67008\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016024,
                    "execution_time": 0.00716,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.003092
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051653,
                    "execution_time": 0.007462,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038092
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   state    cnt\n0     AR  58732\n1     IN  71286\n2     NH   8004\n3     UT  22571\n4     WA  30073\n5     ND  40633\n6     MO  85703\n7     WV  43160\n8     IL  79780\n9     WI  55233\n10    CO  48844\n11    FL  49140\n12    AK  17892\n13    OK  59783\n14    DC    806\n15    IA  77149\n16    WY  17799\n17    SD  51278\n18    MN  67008\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" , \"STATE\" LIMIT 21",
                "preview": "\n/*   state    cnt\n0     DC    806\n1     DE   2332\n2     HI   3097\n3     RI   3798\n4     CT   6079\n5     NH   8004\n6     VT  10840\n7     MA  10998\n8     AZ  11623\n9     ME  12484\n10    NV  13419\n11    NJ  16358\n12    WY  17799\n13    MD  17876\n14    AK  17892\n15    UT  22571\n16    NM  25578\n17    OR  28128\n18    WA  30073\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016675,
                    "execution_time": 0.00775,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.003215
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.19883,
                    "execution_time": 0.008352,
                    "compile_time": 0.146473,
                    "planning_time": 0.038385
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   state    cnt\n0     DC    806\n1     DE   2332\n2     HI   3097\n3     RI   3798\n4     CT   6079\n5     NH   8004\n6     VT  10840\n7     MA  10998\n8     AZ  11623\n9     ME  12484\n10    NV  13419\n11    NJ  16358\n12    WY  17799\n13    MD  17876\n14    AK  17892\n15    UT  22571\n16    NM  25578\n17    OR  28128\n18    WA  30073\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" , \"STATE\" LIMIT 21",
                "preview": "\n/*   state    cnt\n0     DC    806\n1     DE   2332\n2     HI   3097\n3     RI   3798\n4     CT   6079\n5     NH   8004\n6     VT  10840\n7     MA  10998\n8     AZ  11623\n9     ME  12484\n10    NV  13419\n11    NJ  16358\n12    WY  17799\n13    MD  17876\n14    AK  17892\n15    UT  22571\n16    NM  25578\n17    OR  28128\n18    WA  30073\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017212,
                    "execution_time": 0.007812,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.003438
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016728,
                    "execution_time": 0.007972,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.002947
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   state    cnt\n0     DC    806\n1     DE   2332\n2     HI   3097\n3     RI   3798\n4     CT   6079\n5     NH   8004\n6     VT  10840\n7     MA  10998\n8     AZ  11623\n9     ME  12484\n10    NV  13419\n11    NJ  16358\n12    WY  17799\n13    MD  17876\n14    AK  17892\n15    UT  22571\n16    NM  25578\n17    OR  28128\n18    WA  30073\n...*/"
    }
]