[
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 27.839304,
                    "execution_time": 27.724473,
                    "compile_time": 0.000607,
                    "planning_time": 0.068647,
                    "create_size": 144
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 45.384082,
                    "execution_time": 27.900059,
                    "compile_time": 17.268758,
                    "planning_time": 0.150252,
                    "create_size": 144
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city                s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         cally             1             711           Hill            Dr.      Suite 440    Greenville          Daviess County      MO  61387      930         686         653          707         1368\n1           bar             1             939           View          Court      Suite 400    Friendship           Walker County      AL  34536      923         672         664          647         1320\n2         ation             1             489          Cedar           Cir.      Suite 450      Glenwood          Ziebach County      SD  53511      921         657         677          655         1284\n3          able             1             970            7th            Dr.       Suite 50  Mount Vernon             Gage County      NE  68482      894         677         648          677         1304\n4          eing             1             225    Davis Sunset          Road        Suite U   Mount Olive       Williamson County      TN  38059      915         638         666          633         1319\n5           bar             1             365  Railroad Smith     Boulevard        Suite O    Stringtown       Williamson County      TN  30162      822         627         659          677         1336\n6         ation             1             421   Adams Madison            Ln        Suite P   Cedar Grove          Raleigh County      WV  20411      898         652         642          658         1293\n7          eing             1             163           13th         Circle       Suite 60         Salem         Maverick County      TX  78048      936         632         623          661         1344\n8          eing             1             743           14th            Dr.        Suite D  Walnut Grove          Ziebach County      SD  57752      896         627         623          654         1260\n9          able             1             325         Walnut         Circle        Suite D     Fairfield          Jackson County      NC  26192      878         626         682          637         1384\n10         eing             1             505       9th Birch     Boulevard       Suite 20      Lakewood          Dauphin County      PA  18877      901         664         707          691         1337\n11         n st             1              49     Locust Lake           Way       Suite 90    Friendship         Franklin Parish      LA  74536      947         674         674          673         1286\n12         n st             1             347     Washington           Lane      Suite 240    Georgetown           Mobile County      AL  37057      914         691         632          690         1221\n13        cally             1             709            7th           Lane      Suite 210   Five Points             Luce County      MI  46098      898         648         724          678         1324\n14        ought             1             667        3rd 15th           Ct.        Suite U      Lakeview           Walker County      AL  38579      950         695         622          652         1342\n15          ese             1             479        West Elm           Ave        Suite V     Greenwood         Franklin Parish      LA  78828      956         680         684          703         1289\n16          ese             1             986        2nd Park           Ave        Suite V      Hopewell            Bronx County      NY  10587      885         658         655          606         1381\n17         eing             1             586            Oak          Drive      Suite 330       Oakdale        Fairfield County      SC  29584      888         662         653          662         1312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020532,
                    "execution_time": 0.007566,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005782
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060079,
                    "execution_time": 0.007613,
                    "compile_time": 0.001171,
                    "planning_time": 0.042029
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city                s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         cally             1             711           Hill            Dr.      Suite 440    Greenville          Daviess County      MO  61387      930         686         653          707         1368\n1           bar             1             939           View          Court      Suite 400    Friendship           Walker County      AL  34536      923         672         664          647         1320\n2         ation             1             489          Cedar           Cir.      Suite 450      Glenwood          Ziebach County      SD  53511      921         657         677          655         1284\n3          able             1             970            7th            Dr.       Suite 50  Mount Vernon             Gage County      NE  68482      894         677         648          677         1304\n4          eing             1             225    Davis Sunset          Road        Suite U   Mount Olive       Williamson County      TN  38059      915         638         666          633         1319\n5           bar             1             365  Railroad Smith     Boulevard        Suite O    Stringtown       Williamson County      TN  30162      822         627         659          677         1336\n6         ation             1             421   Adams Madison            Ln        Suite P   Cedar Grove          Raleigh County      WV  20411      898         652         642          658         1293\n7          eing             1             163           13th         Circle       Suite 60         Salem         Maverick County      TX  78048      936         632         623          661         1344\n8          eing             1             743           14th            Dr.        Suite D  Walnut Grove          Ziebach County      SD  57752      896         627         623          654         1260\n9          able             1             325         Walnut         Circle        Suite D     Fairfield          Jackson County      NC  26192      878         626         682          637         1384\n10         eing             1             505       9th Birch     Boulevard       Suite 20      Lakewood          Dauphin County      PA  18877      901         664         707          691         1337\n11         n st             1              49     Locust Lake           Way       Suite 90    Friendship         Franklin Parish      LA  74536      947         674         674          673         1286\n12         n st             1             347     Washington           Lane      Suite 240    Georgetown           Mobile County      AL  37057      914         691         632          690         1221\n13        cally             1             709            7th           Lane      Suite 210   Five Points             Luce County      MI  46098      898         648         724          678         1324\n14        ought             1             667        3rd 15th           Ct.        Suite U      Lakeview           Walker County      AL  38579      950         695         622          652         1342\n15          ese             1             479        West Elm           Ave        Suite V     Greenwood         Franklin Parish      LA  78828      956         680         684          703         1289\n16          ese             1             986        2nd Park           Ave        Suite V      Hopewell            Bronx County      NY  10587      885         658         655          606         1381\n17         eing             1             586            Oak          Drive      Suite 330       Oakdale        Fairfield County      SC  29584      888         662         653          662         1312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                           Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n1                         1.0                      Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                                                      Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n3                         NaN                     Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n4                         1.0                       Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n5                         NaN                                            Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n6          able           1.0             293          7th Hill           Ave        Suite W       Antioch    Kittitas County      WA  98605      919         637         659          668         1303\n7          able           1.0             441             11th             ST        Suite H     Sunnyside    Marshall County      IN  41952      892         648         707          643         1294\n8          able           1.0             206             Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n9          able           1.0              49      Highland 1st         Drive       Suite 80     Greenwood  Pennington County      MN  58828      954         672         655          669         1364\n10         able           1.0             824           Valley           Cir.        Suite A      Highland     Daviess County      MO  69454      909         645         668          688         1321\n11         able           1.0             667           Sunset            Ct.        Suite Q     Oak Grove      Walker County      AL  38370      896         638         652          662         1342\n12         able           1.0             443  Hickory Sycamore        Street        Suite C        Shiloh       Bronx County      NY  19275      941         693         699          634         1231\n13         able           1.0             667       Ridge Maple          Pkwy        Suite X      Glendale  San Miguel County      NM  83951      887         654         646          688         1343\n14         able           1.0             634          Park 4th        Avenue       Suite 70     Riverside     Ziebach County      SD  59231      888         611         677          671         1277\n15         able           1.0             400           Locust           Lane        Suite B    Providence    Marshall County      IN  46614      909         645         636          654         1331\n16         able           1.0             170             Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370        Shiloh    Richland County      OH  49275      910         633         679          661         1349\n18         able           1.0             924        2nd Meadow           Way        Suite Y     Oak Grove     Raleigh County      WV  28370      863         641         636          652         1368\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021949,
                    "execution_time": 0.008511,
                    "compile_time": 0.0001,
                    "planning_time": 0.005804
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.19337,
                    "execution_time": 0.0085,
                    "compile_time": 0.135349,
                    "planning_time": 0.041495
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                           Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n1                         1.0                      Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                                                      Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n3                         NaN                     Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n4                         1.0                       Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n5                         NaN                                            Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n6          able           1.0             293          7th Hill           Ave        Suite W       Antioch    Kittitas County      WA  98605      919         637         659          668         1303\n7          able           1.0             441             11th             ST        Suite H     Sunnyside    Marshall County      IN  41952      892         648         707          643         1294\n8          able           1.0             206             Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n9          able           1.0              49      Highland 1st         Drive       Suite 80     Greenwood  Pennington County      MN  58828      954         672         655          669         1364\n10         able           1.0             824           Valley           Cir.        Suite A      Highland     Daviess County      MO  69454      909         645         668          688         1321\n11         able           1.0             667           Sunset            Ct.        Suite Q     Oak Grove      Walker County      AL  38370      896         638         652          662         1342\n12         able           1.0             443  Hickory Sycamore        Street        Suite C        Shiloh       Bronx County      NY  19275      941         693         699          634         1231\n13         able           1.0             667       Ridge Maple          Pkwy        Suite X      Glendale  San Miguel County      NM  83951      887         654         646          688         1343\n14         able           1.0             634          Park 4th        Avenue       Suite 70     Riverside     Ziebach County      SD  59231      888         611         677          671         1277\n15         able           1.0             400           Locust           Lane        Suite B    Providence    Marshall County      IN  46614      909         645         636          654         1331\n16         able           1.0             170             Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370        Shiloh    Richland County      OH  49275      910         633         679          661         1349\n18         able           1.0             924        2nd Meadow           Way        Suite Y     Oak Grove     Raleigh County      WV  28370      863         641         636          652         1368\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n2                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n3                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n4                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n5                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n6          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n7          able           1.0             441           11th             ST        Suite H     Sunnyside    Marshall County      IN  41952      892         648         707          643         1294\n8          able           1.0             605  Williams South            Ln        Suite D      Fairview       Bronx County      NY  15709      894         668         609          689         1365\n9          able           1.0              49    Highland 1st         Drive       Suite 80     Greenwood  Pennington County      MN  58828      954         672         655          669         1364\n10         able           1.0             868       Main Park           Ct.      Suite 240      Glendale      Mobile County      AL  33951      961         677         654          678         1336\n11         able           1.0             667         Sunset            Ct.        Suite Q     Oak Grove      Walker County      AL  38370      896         638         652          662         1342\n12         able           1.0             300         Forest           Lane      Suite 230   Cedar Grove      Walker County      AL  30411      969         666         707          622         1288\n13         able           1.0             667     Ridge Maple          Pkwy        Suite X      Glendale  San Miguel County      NM  83951      887         654         646          688         1343\n14         able           1.0             738         Miller          Court        Suite R       Oakdale        Luce County      MI  49584      937         669         648          669         1337\n15         able           1.0             400         Locust           Lane        Suite B    Providence    Marshall County      IN  46614      909         645         636          654         1331\n16         able           1.0             521     Fourth 12th          Lane        Suite O  Walnut Grove    Franklin Parish      LA  77752      879         638         665          626         1346\n17         able           1.0             702       Cedar 6th          Blvd      Suite 370        Shiloh    Richland County      OH  49275      910         633         679          661         1349\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022343,
                    "execution_time": 0.009133,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.005765
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.200283,
                    "execution_time": 0.008808,
                    "compile_time": 0.142132,
                    "planning_time": 0.041547
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n2                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n3                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n4                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n5                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n6          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n7          able           1.0             441           11th             ST        Suite H     Sunnyside    Marshall County      IN  41952      892         648         707          643         1294\n8          able           1.0             605  Williams South            Ln        Suite D      Fairview       Bronx County      NY  15709      894         668         609          689         1365\n9          able           1.0              49    Highland 1st         Drive       Suite 80     Greenwood  Pennington County      MN  58828      954         672         655          669         1364\n10         able           1.0             868       Main Park           Ct.      Suite 240      Glendale      Mobile County      AL  33951      961         677         654          678         1336\n11         able           1.0             667         Sunset            Ct.        Suite Q     Oak Grove      Walker County      AL  38370      896         638         652          662         1342\n12         able           1.0             300         Forest           Lane      Suite 230   Cedar Grove      Walker County      AL  30411      969         666         707          622         1288\n13         able           1.0             667     Ridge Maple          Pkwy        Suite X      Glendale  San Miguel County      NM  83951      887         654         646          688         1343\n14         able           1.0             738         Miller          Court        Suite R       Oakdale        Luce County      MI  49584      937         669         648          669         1337\n15         able           1.0             400         Locust           Lane        Suite B    Providence    Marshall County      IN  46614      909         645         636          654         1331\n16         able           1.0             521     Fourth 12th          Lane        Suite O  Walnut Grove    Franklin Parish      LA  77752      879         638         665          626         1346\n17         able           1.0             702       Cedar 6th          Blvd      Suite 370        Shiloh    Richland County      OH  49275      910         633         679          661         1349\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n2                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n3                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n4                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n5                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022336,
                    "execution_time": 0.008508,
                    "compile_time": 0.000101,
                    "planning_time": 0.005997
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.180793,
                    "execution_time": 0.009288,
                    "compile_time": 0.121925,
                    "planning_time": 0.041744
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n2                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n3                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n4                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n5                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021913,
                    "execution_time": 0.008566,
                    "compile_time": 0.000105,
                    "planning_time": 0.005896
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.156321,
                    "execution_time": 0.008965,
                    "compile_time": 0.098388,
                    "planning_time": 0.041484
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022167,
                    "execution_time": 0.008657,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.006083
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.21776,
                    "execution_time": 0.008571,
                    "compile_time": 0.1598,
                    "planning_time": 0.041793
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023029,
                    "execution_time": 0.009139,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.006279
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.196215,
                    "execution_time": 0.009422,
                    "compile_time": 0.137294,
                    "planning_time": 0.041781
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023363,
                    "execution_time": 0.008855,
                    "compile_time": 0.000107,
                    "planning_time": 0.006433
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.197132,
                    "execution_time": 0.008732,
                    "compile_time": 0.13845,
                    "planning_time": 0.042059
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022519,
                    "execution_time": 0.008772,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.006343
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.184396,
                    "execution_time": 0.008634,
                    "compile_time": 0.126065,
                    "planning_time": 0.041941
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022864,
                    "execution_time": 0.00862,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.006553
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.174782,
                    "execution_time": 0.008708,
                    "compile_time": 0.116005,
                    "planning_time": 0.042316
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" , \"S_ZIP\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022453,
                    "execution_time": 0.008509,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.006447
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.196731,
                    "execution_time": 0.009057,
                    "compile_time": 0.137561,
                    "planning_time": 0.042444
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST, \"S_ZIP\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" , \"S_ZIP\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023511,
                    "execution_time": 0.009259,
                    "compile_time": 0.000102,
                    "planning_time": 0.006446
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.024446,
                    "execution_time": 0.00928,
                    "compile_time": 0.000107,
                    "planning_time": 0.006757
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST, \"S_ZIP\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number        s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         1.0                                                    Suite 310        Bethel                         SD  55281      947         640         628          692         1333\n1                         1.0                    Chestnut Elm         Drive      Suite 350      Wildwood                             46871      916         640         654          665         1342\n2                         1.0                     Fourth Main        Circle      Suite 180    Providence  Williamson County          36614      932         653         661          659         1310\n3                         NaN                                          Pkwy        Suite V                                       MN  54098      940         647         609          655         1284\n4                         NaN                         Fourth                                Walnut Grove      Barrow County          37752      925         660         662          666         1363\n5                         NaN                   Valley Valley                      Suite S                                           77752      882         664         662          661         1316\n6          able           1.0             113          South        Parkway      Suite 200  Walnut Grove      Barrow County      GA  37752      843         659         704          651         1308\n7          able           1.0             128           15th             RD        Suite T      Lakewood      Wadena County      MN  58877      919         620         675          646         1363\n8          able           1.0             140            6th         Avenue      Suite 120      Fairview  Pennington County      MN  55709      950         694         679          657         1345\n9          able           1.0             148       River 2nd          Road       Suite 10         Salem       Huron County      MI  48048      881         723         609          679         1273\n10         able           1.0             170           Mill         Circle        Suite J      New Hope    Marshall County      IN  49431      964         685         644          648         1340\n11         able           1.0             184        Main Elm           Ct.       Suite 90      Lakeview    Richland County      OH  48579      903         716         661          639         1368\n12         able           1.0             193            5th            Ave      Suite 420   Centerville  Pennington County      MN  50059      932         623         673          657         1288\n13         able           1.0             197  Central Second          Cir.        Suite H      Lakewood      Barrow County      GA  38877      933         640         652          635         1253\n14         able           1.0             206           Main           Pkwy        Suite I     Greenwood      Wadena County      MN  58828      866         660         683          659         1317\n15         able           1.0             227            8th           Road      Suite 290       Oakdale      Wadena County      MN  59584      874         730         674          657         1284\n16         able           1.0             228         Cherry         Avenue        Suite G       Antioch        Levy County      FL  38605      941         659         718          673         1306\n17         able           1.0             244  Maple Lakeview           Way      Suite 430      Fairview  Oglethorpe County      GA  35709      928         644         657          648         1338\n18         able           1.0             255       Sycamore            Dr.      Suite 410   Buena Vista  Pennington County      MN  55752      892         643         614          654         1326\n...*/"
    }
]