[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      group by i_manager_id\n      ) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 19.15947,
                    "execution_time": 19.082016,
                    "compile_time": 0.000488,
                    "planning_time": 0.053582,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 22.276804,
                    "execution_time": 22.113005,
                    "compile_time": 0.000494,
                    "planning_time": 0.135676,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0           56.0  8.918721e+08       8.918721e+08\n1           80.0  2.852162e+08       2.852162e+08\n2            NaN  2.520196e+08       2.520196e+08\n3            1.0  1.835513e+09       1.835513e+09\n4           61.0  9.186878e+08       9.186878e+08\n5           29.0  1.823508e+09       1.823508e+09\n6           37.0  9.087847e+08       9.087847e+08\n7           38.0  9.031897e+08       9.031897e+08\n8           97.0  2.843995e+08       2.843995e+08\n9           53.0  9.609549e+08       9.609549e+08\n10          22.0  1.847017e+09       1.847017e+09\n11          10.0  1.837685e+09       1.837685e+09\n12          16.0  1.757878e+09       1.757878e+09\n13          88.0  3.008423e+08       3.008423e+08\n14          44.0  9.200856e+08       9.200856e+08\n15          71.0  2.872378e+08       2.872378e+08\n16           2.0  1.792487e+09       1.792487e+09\n17          68.0  2.988416e+08       2.988416e+08\n18          14.0  1.767174e+09       1.767174e+09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017286,
                    "execution_time": 0.00707,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.004288
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052983,
                    "execution_time": 0.007553,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.039562
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0           56.0  8.918721e+08       8.918721e+08\n1           80.0  2.852162e+08       2.852162e+08\n2            NaN  2.520196e+08       2.520196e+08\n3            1.0  1.835513e+09       1.835513e+09\n4           61.0  9.186878e+08       9.186878e+08\n5           29.0  1.823508e+09       1.823508e+09\n6           37.0  9.087847e+08       9.087847e+08\n7           38.0  9.031897e+08       9.031897e+08\n8           97.0  2.843995e+08       2.843995e+08\n9           53.0  9.609549e+08       9.609549e+08\n10          22.0  1.847017e+09       1.847017e+09\n11          10.0  1.837685e+09       1.837685e+09\n12          16.0  1.757878e+09       1.757878e+09\n13          88.0  3.008423e+08       3.008423e+08\n14          44.0  9.200856e+08       9.200856e+08\n15          71.0  2.872378e+08       2.872378e+08\n16           2.0  1.792487e+09       1.792487e+09\n17          68.0  2.988416e+08       2.988416e+08\n18          14.0  1.767174e+09       1.767174e+09\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.003844,
                    "execution_time": 2.91947,
                    "compile_time": 0.000526,
                    "planning_time": 0.057441,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.243251,
                    "execution_time": 3.078883,
                    "compile_time": 0.000545,
                    "planning_time": 0.13514,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0             54  1.833646e+08       1.833646e+08\n1             95  5.982798e+07       5.982798e+07\n2             82  6.115724e+07       6.115724e+07\n3             40  1.899342e+08       1.899342e+08\n4             30  3.668477e+08       3.668477e+08\n5             33  3.657561e+08       3.657561e+08\n6             13  3.508884e+08       3.508884e+08\n7             76  6.140758e+07       6.140758e+07\n8             42  1.704649e+08       1.704649e+08\n9             81  6.255573e+07       6.255573e+07\n10            87  6.094731e+07       6.094731e+07\n11            75  6.140667e+07       6.140667e+07\n12            57  1.884769e+08       1.884769e+08\n13            96  5.307614e+07       5.307614e+07\n14            15  3.702084e+08       3.702084e+08\n15            72  5.605518e+07       5.605518e+07\n16             5  3.642941e+08       3.642941e+08\n17            46  1.849289e+08       1.849289e+08\n18            86  5.651108e+07       5.651108e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017451,
                    "execution_time": 0.007229,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.00429
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053036,
                    "execution_time": 0.007582,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.039634
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0             54  1.833646e+08       1.833646e+08\n1             95  5.982798e+07       5.982798e+07\n2             82  6.115724e+07       6.115724e+07\n3             40  1.899342e+08       1.899342e+08\n4             30  3.668477e+08       3.668477e+08\n5             33  3.657561e+08       3.657561e+08\n6             13  3.508884e+08       3.508884e+08\n7             76  6.140758e+07       6.140758e+07\n8             42  1.704649e+08       1.704649e+08\n9             81  6.255573e+07       6.255573e+07\n10            87  6.094731e+07       6.094731e+07\n11            75  6.140667e+07       6.140667e+07\n12            57  1.884769e+08       1.884769e+08\n13            96  5.307614e+07       5.307614e+07\n14            15  3.702084e+08       3.702084e+08\n15            72  5.605518e+07       5.605518e+07\n16             5  3.642941e+08       3.642941e+08\n17            46  1.849289e+08       1.849289e+08\n18            86  5.651108e+07       5.651108e+07\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and (    i_category in ('Books','Children','Electronics')\n\n)\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.714274,
                    "execution_time": 3.632218,
                    "compile_time": 0.000549,
                    "planning_time": 0.055174,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.797405,
                    "execution_time": 3.63116,
                    "compile_time": 0.000544,
                    "planning_time": 0.135653,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0           56.0  5.077346e+07       5.077346e+07\n1            1.0  1.126980e+08       1.126980e+08\n2           61.0  5.777870e+07       5.777870e+07\n3           80.0  1.787907e+07       1.787907e+07\n4           53.0  5.680238e+07       5.680238e+07\n5            NaN  7.188502e+06       7.188502e+06\n6           29.0  1.077125e+08       1.077125e+08\n7           37.0  5.887926e+07       5.887926e+07\n8           38.0  5.425358e+07       5.425358e+07\n9           97.0  1.772898e+07       1.772898e+07\n10          71.0  1.382287e+07       1.382287e+07\n11          10.0  1.130831e+08       1.130831e+08\n12          16.0  1.113297e+08       1.113297e+08\n13          88.0  1.811034e+07       1.811034e+07\n14           2.0  1.112903e+08       1.112903e+08\n15          84.0  1.714086e+07       1.714086e+07\n16          31.0  1.085778e+08       1.085778e+08\n17          98.0  1.705581e+07       1.705581e+07\n18          48.0  5.369767e+07       5.369767e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017614,
                    "execution_time": 0.007344,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004376
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05322,
                    "execution_time": 0.007725,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.03956
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0           56.0  5.077346e+07       5.077346e+07\n1            1.0  1.126980e+08       1.126980e+08\n2           61.0  5.777870e+07       5.777870e+07\n3           80.0  1.787907e+07       1.787907e+07\n4           53.0  5.680238e+07       5.680238e+07\n5            NaN  7.188502e+06       7.188502e+06\n6           29.0  1.077125e+08       1.077125e+08\n7           37.0  5.887926e+07       5.887926e+07\n8           38.0  5.425358e+07       5.425358e+07\n9           97.0  1.772898e+07       1.772898e+07\n10          71.0  1.382287e+07       1.382287e+07\n11          10.0  1.130831e+08       1.130831e+08\n12          16.0  1.113297e+08       1.113297e+08\n13          88.0  1.811034e+07       1.811034e+07\n14           2.0  1.112903e+08       1.112903e+08\n15          84.0  1.714086e+07       1.714086e+07\n16          31.0  1.085778e+08       1.085778e+08\n17          98.0  1.705581e+07       1.705581e+07\n18          48.0  5.369767e+07       5.369767e+07\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) as sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) as avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and (    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help'))\n      group by i_manager_id) as sales_data /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SALES_DATA\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.909983,
                    "execution_time": 0.82625,
                    "compile_time": 0.000593,
                    "planning_time": 0.056806,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.652828,
                    "execution_time": 1.485563,
                    "compile_time": 0.001686,
                    "planning_time": 0.139681,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0            1.0   9851202.18         9851202.18\n1           61.0   6253120.80         6253120.80\n2            NaN    391897.43          391897.43\n3           56.0   3234130.05         3234130.05\n4           53.0   4597896.07         4597896.07\n5           80.0   1180088.05         1180088.05\n6           22.0   6881171.58         6881171.58\n7           29.0   8864343.65         8864343.65\n8           37.0   3900602.11         3900602.11\n9           38.0   4563188.51         4563188.51\n10          97.0    811430.56          811430.56\n11          71.0   1215197.88         1215197.88\n12          20.0   8078066.12         8078066.12\n13          10.0  12096430.08        12096430.08\n14          16.0   8992931.61         8992931.61\n15          84.0    945484.41          945484.41\n16          68.0   2159988.79         2159988.79\n17          93.0   1617854.63         1617854.63\n18          60.0   4187774.46         4187774.46\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017739,
                    "execution_time": 0.007245,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004494
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053998,
                    "execution_time": 0.008222,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039798
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0            1.0   9851202.18         9851202.18\n1           61.0   6253120.80         6253120.80\n2            NaN    391897.43          391897.43\n3           56.0   3234130.05         3234130.05\n4           53.0   4597896.07         4597896.07\n5           80.0   1180088.05         1180088.05\n6           22.0   6881171.58         6881171.58\n7           29.0   8864343.65         8864343.65\n8           37.0   3900602.11         3900602.11\n9           38.0   4563188.51         4563188.51\n10          97.0    811430.56          811430.56\n11          71.0   1215197.88         1215197.88\n12          20.0   8078066.12         8078066.12\n13          10.0  12096430.08        12096430.08\n14          16.0   8992931.61         8992931.61\n15          84.0    945484.41          945484.41\n16          68.0   2159988.79         2159988.79\n17          93.0   1617854.63         1617854.63\n18          60.0   4187774.46         4187774.46\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')))\n      group by i_manager_id)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.435775,
                    "execution_time": 3.346906,
                    "compile_time": 0.000563,
                    "planning_time": 0.060304,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.295283,
                    "execution_time": 3.938739,
                    "compile_time": 0.18436,
                    "planning_time": 0.141934,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0              7  1.081357e+08       1.081357e+08\n1             74  1.905751e+07       1.905751e+07\n2             65  5.716729e+07       5.716729e+07\n3             90  2.046691e+07       2.046691e+07\n4              5  1.099341e+08       1.099341e+08\n5             46  5.740654e+07       5.740654e+07\n6             86  1.811114e+07       1.811114e+07\n7              9  1.109006e+08       1.109006e+08\n8             25  1.031135e+08       1.031135e+08\n9             52  5.002955e+07       5.002955e+07\n10            33  1.095597e+08       1.095597e+08\n11            13  1.030786e+08       1.030786e+08\n12            76  1.681181e+07       1.681181e+07\n13            34  5.316113e+07       5.316113e+07\n14            32  1.050521e+08       1.050521e+08\n15            96  1.454311e+07       1.454311e+07\n16            77  1.873823e+07       1.873823e+07\n17            28  1.048640e+08       1.048640e+08\n18            83  1.827996e+07       1.827996e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017783,
                    "execution_time": 0.007368,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.00456
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053368,
                    "execution_time": 0.007752,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.039679
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0              7  1.081357e+08       1.081357e+08\n1             74  1.905751e+07       1.905751e+07\n2             65  5.716729e+07       5.716729e+07\n3             90  2.046691e+07       2.046691e+07\n4              5  1.099341e+08       1.099341e+08\n5             46  5.740654e+07       5.740654e+07\n6             86  1.811114e+07       1.811114e+07\n7              9  1.109006e+08       1.109006e+08\n8             25  1.031135e+08       1.031135e+08\n9             52  5.002955e+07       5.002955e+07\n10            33  1.095597e+08       1.095597e+08\n11            13  1.030786e+08       1.030786e+08\n12            76  1.681181e+07       1.681181e+07\n13            34  5.316113e+07       5.316113e+07\n14            32  1.050521e+08       1.050521e+08\n15            96  1.454311e+07       1.454311e+07\n16            77  1.873823e+07       1.873823e+07\n17            28  1.048640e+08       1.048640e+08\n18            83  1.827996e+07       1.827996e+07\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) as sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) as avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\n      group by i_manager_id\n     ) /* Added missing closing parenthesis */\n /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.965341,
                    "execution_time": 0.867191,
                    "compile_time": 0.000592,
                    "planning_time": 0.068544,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.189419,
                    "execution_time": 0.86534,
                    "compile_time": 0.140322,
                    "planning_time": 0.152087,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0           56.0   5030221.33         5030221.33\n1            1.0  11377424.40        11377424.40\n2           61.0   5577853.71         5577853.71\n3           53.0   5234296.31         5234296.31\n4            NaN    336644.21          336644.21\n5           71.0   1448613.69         1448613.69\n6           20.0   8013084.85         8013084.85\n7            2.0  10700733.01        10700733.01\n8           68.0   1118650.94         1118650.94\n9           44.0   4590826.87         4590826.87\n10          11.0  11348833.86        11348833.86\n11         100.0   1993527.71         1993527.71\n12           3.0  11755183.67        11755183.67\n13           8.0   9918587.01         9918587.01\n14          79.0   1472082.96         1472082.96\n15          23.0  11906533.35        11906533.35\n16          66.0   5037131.37         5037131.37\n17          69.0   2349539.14         2349539.14\n18          14.0  10038478.06        10038478.06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018365,
                    "execution_time": 0.008038,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.004351
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05386,
                    "execution_time": 0.008079,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039774
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0           56.0   5030221.33         5030221.33\n1            1.0  11377424.40        11377424.40\n2           61.0   5577853.71         5577853.71\n3           53.0   5234296.31         5234296.31\n4            NaN    336644.21          336644.21\n5           71.0   1448613.69         1448613.69\n6           20.0   8013084.85         8013084.85\n7            2.0  10700733.01        10700733.01\n8           68.0   1118650.94         1118650.94\n9           44.0   4590826.87         4590826.87\n10          11.0  11348833.86        11348833.86\n11         100.0   1993527.71         1993527.71\n12           3.0  11755183.67        11755183.67\n13           8.0   9918587.01         9918587.01\n14          79.0   1472082.96         1472082.96\n15          23.0  11906533.35        11906533.35\n16          66.0   5037131.37         5037131.37\n17          69.0   2349539.14         2349539.14\n18          14.0  10038478.06        10038478.06\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.017841,
                    "execution_time": 0.927911,
                    "compile_time": 0.000582,
                    "planning_time": 0.063,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.11828,
                    "execution_time": 0.933923,
                    "compile_time": 0.002627,
                    "planning_time": 0.148842,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              7   635729.09          989486.24\n1              7   634105.33          989486.24\n2              7  1428335.09          989486.24\n3              7  2089100.90          989486.24\n4              7   619989.73          989486.24\n5              7  1420088.29          989486.24\n6              7   763489.34          989486.24\n7              7   621153.94          989486.24\n8              7   583444.11          989486.24\n9              7  1476022.11          989486.24\n10             7   612890.73          989486.24\n11            74   103270.98          149184.73\n12            74   103582.45          149184.73\n13            74   229349.32          149184.73\n14            74    94990.25          149184.73\n15            74   233368.83          149184.73\n16            74    22510.16          149184.73\n17            74   123916.86          149184.73\n18            74   101007.71          149184.73\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016999,
                    "execution_time": 0.007029,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.004247
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054388,
                    "execution_time": 0.007335,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.039865
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              7   635729.09          989486.24\n1              7   634105.33          989486.24\n2              7  1428335.09          989486.24\n3              7  2089100.90          989486.24\n4              7   619989.73          989486.24\n5              7  1420088.29          989486.24\n6              7   763489.34          989486.24\n7              7   621153.94          989486.24\n8              7   583444.11          989486.24\n9              7  1476022.11          989486.24\n10             7   612890.73          989486.24\n11            74   103270.98          149184.73\n12            74   103582.45          149184.73\n13            74   229349.32          149184.73\n14            74    94990.25          149184.73\n15            74   233368.83          149184.73\n16            74    22510.16          149184.73\n17            74   123916.86          149184.73\n18            74   101007.71          149184.73\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.022085,
                    "execution_time": 0.930313,
                    "compile_time": 0.000586,
                    "planning_time": 0.060504,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.105421,
                    "execution_time": 0.929752,
                    "compile_time": 0.000584,
                    "planning_time": 0.14643,
                    "create_size": 888
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.102432,
                    "execution_time": 0.069852,
                    "compile_time": 0.000229,
                    "planning_time": 0.006459,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.163389,
                    "execution_time": 0.068851,
                    "compile_time": 0.000235,
                    "planning_time": 0.066676,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   610697.12          957230.81\n1              1   152879.58          957230.81\n2              1   809382.51          957230.81\n3              1   666164.29          957230.81\n4              1  2195845.63          957230.81\n5              1  1511520.02          957230.81\n6              1   650344.52          957230.81\n7              1   663711.02          957230.81\n8              1   638761.87          957230.81\n9              1  1470200.32          957230.81\n10             1   642383.81          957230.81\n11             1  1474879.03          957230.81\n12            61   305228.53          475837.24\n13            61   311333.14          475837.24\n14            61   323251.65          475837.24\n15            61   730780.68          475837.24\n16            61   756355.47          475837.24\n17            61   319657.35          475837.24\n18            61   330897.45          475837.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017234,
                    "execution_time": 0.007178,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004263
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05521,
                    "execution_time": 0.007239,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039797
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   610697.12          957230.81\n1              1   152879.58          957230.81\n2              1   809382.51          957230.81\n3              1   666164.29          957230.81\n4              1  2195845.63          957230.81\n5              1  1511520.02          957230.81\n6              1   650344.52          957230.81\n7              1   663711.02          957230.81\n8              1   638761.87          957230.81\n9              1  1470200.32          957230.81\n10             1   642383.81          957230.81\n11             1  1474879.03          957230.81\n12            61   305228.53          475837.24\n13            61   311333.14          475837.24\n14            61   323251.65          475837.24\n15            61   730780.68          475837.24\n16            61   756355.47          475837.24\n17            61   319657.35          475837.24\n18            61   330897.45          475837.24\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   610697.12          957230.81\n1              1   152879.58          957230.81\n2              1   809382.51          957230.81\n3              1   666164.29          957230.81\n4              1  2195845.63          957230.81\n5              1  1511520.02          957230.81\n6              1   650344.52          957230.81\n7              1   663711.02          957230.81\n8              1   638761.87          957230.81\n9              1  1470200.32          957230.81\n10             1   642383.81          957230.81\n11             1  1474879.03          957230.81\n12             2   633241.77          900864.33\n13             2   619784.51          900864.33\n14             2  1457489.40          900864.33\n15             2  1414434.75          900864.33\n16             2    69230.20          900864.33\n17             2   747858.73          900864.33\n18             2  2064393.23          900864.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020867,
                    "execution_time": 0.009612,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004337
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.321308,
                    "execution_time": 0.012087,
                    "compile_time": 0.256592,
                    "planning_time": 0.040951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   610697.12          957230.81\n1              1   152879.58          957230.81\n2              1   809382.51          957230.81\n3              1   666164.29          957230.81\n4              1  2195845.63          957230.81\n5              1  1511520.02          957230.81\n6              1   650344.52          957230.81\n7              1   663711.02          957230.81\n8              1   638761.87          957230.81\n9              1  1470200.32          957230.81\n10             1   642383.81          957230.81\n11             1  1474879.03          957230.81\n12             2   633241.77          900864.33\n13             2   619784.51          900864.33\n14             2  1457489.40          900864.33\n15             2  1414434.75          900864.33\n16             2    69230.20          900864.33\n17             2   747858.73          900864.33\n18             2  2064393.23          900864.33\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n        ,avg_monthly_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST , \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   663711.02          957230.81\n1              1   650344.52          957230.81\n2              1  2195845.63          957230.81\n3              1   666164.29          957230.81\n4              1   809382.51          957230.81\n5              1   610697.12          957230.81\n6              1   152879.58          957230.81\n7              1  1470200.32          957230.81\n8              1   638761.87          957230.81\n9              1   642383.81          957230.81\n10             1  1474879.03          957230.81\n11             1  1511520.02          957230.81\n12             2   633241.77          900864.33\n13             2  2064393.23          900864.33\n14             2  1380474.15          900864.33\n15             2   608174.56          900864.33\n16             2   619784.51          900864.33\n17             2   747858.73          900864.33\n18             2   638963.02          900864.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019187,
                    "execution_time": 0.008239,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004889
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.202369,
                    "execution_time": 0.008469,
                    "compile_time": 0.146026,
                    "planning_time": 0.03986
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   663711.02          957230.81\n1              1   650344.52          957230.81\n2              1  2195845.63          957230.81\n3              1   666164.29          957230.81\n4              1   809382.51          957230.81\n5              1   610697.12          957230.81\n6              1   152879.58          957230.81\n7              1  1470200.32          957230.81\n8              1   638761.87          957230.81\n9              1   642383.81          957230.81\n10             1  1474879.03          957230.81\n11             1  1511520.02          957230.81\n12             2   633241.77          900864.33\n13             2  2064393.23          900864.33\n14             2  1380474.15          900864.33\n15             2   608174.56          900864.33\n16             2   619784.51          900864.33\n17             2   747858.73          900864.33\n18             2   638963.02          900864.33\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n        ,avg_monthly_sales\n        ,sum_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST , \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   152879.58          957230.81\n1              1   610697.12          957230.81\n2              1   638761.87          957230.81\n3              1   642383.81          957230.81\n4              1   650344.52          957230.81\n5              1   663711.02          957230.81\n6              1   666164.29          957230.81\n7              1   809382.51          957230.81\n8              1  1470200.32          957230.81\n9              1  1474879.03          957230.81\n10             1  1511520.02          957230.81\n11             1  2195845.63          957230.81\n12             2    69230.20          900864.33\n13             2   573991.33          900864.33\n14             2   602336.35          900864.33\n15             2   608174.56          900864.33\n16             2   619784.51          900864.33\n17             2   633241.77          900864.33\n18             2   638963.02          900864.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019931,
                    "execution_time": 0.008185,
                    "compile_time": 7e-05,
                    "planning_time": 0.004778
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.262353,
                    "execution_time": 0.008473,
                    "compile_time": 0.207782,
                    "planning_time": 0.040222
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   152879.58          957230.81\n1              1   610697.12          957230.81\n2              1   638761.87          957230.81\n3              1   642383.81          957230.81\n4              1   650344.52          957230.81\n5              1   663711.02          957230.81\n6              1   666164.29          957230.81\n7              1   809382.51          957230.81\n8              1  1470200.32          957230.81\n9              1  1474879.03          957230.81\n10             1  1511520.02          957230.81\n11             1  2195845.63          957230.81\n12             2    69230.20          900864.33\n13             2   573991.33          900864.33\n14             2   602336.35          900864.33\n15             2   608174.56          900864.33\n16             2   619784.51          900864.33\n17             2   633241.77          900864.33\n18             2   638963.02          900864.33\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n        ,avg_monthly_sales\n        ,sum_sales\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST , \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   152879.58          957230.81\n1              1   610697.12          957230.81\n2              1   638761.87          957230.81\n3              1   642383.81          957230.81\n4              1   650344.52          957230.81\n5              1   663711.02          957230.81\n6              1   666164.29          957230.81\n7              1   809382.51          957230.81\n8              1  1470200.32          957230.81\n9              1  1474879.03          957230.81\n10             1  1511520.02          957230.81\n11             1  2195845.63          957230.81\n12             2    69230.20          900864.33\n13             2   573991.33          900864.33\n14             2   602336.35          900864.33\n15             2   608174.56          900864.33\n16             2   619784.51          900864.33\n17             2   633241.77          900864.33\n18             2   638963.02          900864.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018378,
                    "execution_time": 0.008146,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.004475
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020009,
                    "execution_time": 0.009261,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004807
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0              1   152879.58          957230.81\n1              1   610697.12          957230.81\n2              1   638761.87          957230.81\n3              1   642383.81          957230.81\n4              1   650344.52          957230.81\n5              1   663711.02          957230.81\n6              1   666164.29          957230.81\n7              1   809382.51          957230.81\n8              1  1470200.32          957230.81\n9              1  1474879.03          957230.81\n10             1  1511520.02          957230.81\n11             1  2195845.63          957230.81\n12             2    69230.20          900864.33\n13             2   573991.33          900864.33\n14             2   602336.35          900864.33\n15             2   608174.56          900864.33\n16             2   619784.51          900864.33\n17             2   633241.77          900864.33\n18             2   638963.02          900864.33\n...*/"
    }
]