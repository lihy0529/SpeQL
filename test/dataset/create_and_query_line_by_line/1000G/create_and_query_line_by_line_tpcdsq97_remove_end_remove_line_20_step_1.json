[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk as customer_sk\n      ,ss_item_sk as item_sk\nfrom store_sales \n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0     9147435.0    65479\n1     3582130.0   154444\n2     9147435.0   122761\n3     3582130.0   130556\n4     9147435.0    50614\n5     3582130.0    13684\n6     9147435.0   136112\n7     3582130.0   223057\n8     9147435.0   128224\n9     3582130.0    44119\n10          NaN   125204\n11    3582130.0    63170\n12    9147435.0    66550\n13    3582130.0   103858\n14    9147435.0    80200\n15    3582130.0    66235\n16    9147435.0    55048\n17    2868183.0    50449\n18    6319639.0   136442\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046651,
                    "execution_time": 0.015082,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.02528
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.247236,
                    "execution_time": 0.022205,
                    "compile_time": 0.131906,
                    "planning_time": 0.083948
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0     9147435.0    65479\n1     3582130.0   154444\n2     9147435.0   122761\n3     3582130.0   130556\n4     9147435.0    50614\n5     3582130.0    13684\n6     9147435.0   136112\n7     3582130.0   223057\n8     9147435.0   128224\n9     3582130.0    44119\n10          NaN   125204\n11    3582130.0    63170\n12    9147435.0    66550\n13    3582130.0   103858\n14    9147435.0    80200\n15    3582130.0    66235\n16    9147435.0    55048\n17    2868183.0    50449\n18    6319639.0   136442\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk as customer_sk\n      ,ss_item_sk as item_sk\nfrom store_sales, date_dim\nwhere ss_sold_date_sk = d_date_sk\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 51.971547,
                    "execution_time": 51.808917,
                    "compile_time": 0.0003,
                    "planning_time": 0.041808,
                    "create_size": 26754
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 53.765264,
                    "execution_time": 53.525164,
                    "compile_time": 0.002318,
                    "planning_time": 0.108656,
                    "create_size": 26754
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0       5363118    63289\n1        268515   219992\n2       5363118   253028\n3        268515   250126\n4       5363118   197750\n5        268515   121816\n6       5363118   256729\n7        268515   181165\n8       9225998   180175\n9        268515   146899\n10      9225998   244082\n11      4937887   297283\n12      9225998   287845\n13      4937887   163544\n14      9225998   151558\n15      4937887   256726\n16      9225998   274627\n17      4937887    77146\n18      9225998     6302\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019757,
                    "execution_time": 0.010294,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003281
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061995,
                    "execution_time": 0.014448,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038792
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0       5363118    63289\n1        268515   219992\n2       5363118   253028\n3        268515   250126\n4       5363118   197750\n5        268515   121816\n6       5363118   256729\n7        268515   181165\n8       9225998   180175\n9        268515   146899\n10      9225998   244082\n11      4937887   297283\n12      9225998   287845\n13      4937887   163544\n14      9225998   151558\n15      4937887   256726\n16      9225998   274627\n17      4937887    77146\n18      9225998     6302\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0       3529392    13177\n1       3529392    13177\n2       3529392    13177\n3       3529392    13177\n4       3529392    13177\n5       3529392    13177\n6       3529392    13177\n7       3529392    13177\n8       3529392    13177\n9       3529392    13177\n10      3529392    13177\n11      3529392    13177\n12      3529392    13177\n13      3529392    13177\n14      3529392    13177\n15      3529392    13177\n16      3529392    13177\n17      3529392    13177\n18      3529392    13177\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04728,
                    "execution_time": 0.010732,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.028519
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.121402,
                    "execution_time": 0.01184,
                    "compile_time": 0.001025,
                    "planning_time": 0.087327
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180"
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0       3529392    13177\n1       3529392    13177\n2       3529392    13177\n3       3529392    13177\n4       3529392    13177\n5       3529392    13177\n6       3529392    13177\n7       3529392    13177\n8       3529392    13177\n9       3529392    13177\n10      3529392    13177\n11      3529392    13177\n12      3529392    13177\n13      3529392    13177\n14      3529392    13177\n15      3529392    13177\n16      3529392    13177\n17      3529392    13177\n18      3529392    13177\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk, ss_item_sk\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 17.765304,
                    "execution_time": 17.60291,
                    "compile_time": 0.000362,
                    "planning_time": 0.037247,
                    "create_size": 5633
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 17.879649,
                    "execution_time": 17.646606,
                    "compile_time": 0.002258,
                    "planning_time": 0.103623,
                    "create_size": 5633
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0       7676772   281953\n1       6354459    84140\n2      11927370   184777\n3       1562870    49303\n4      11462433   223813\n5       1288462   109186\n6       2963144   256430\n7       6623788   169384\n8       1247343   279026\n9      11477166   261772\n10       842113   250360\n11      2956674    36508\n12      8399471   286616\n13      7740038   173779\n14      2819475   192913\n15      3927053   102082\n16      4228381    75133\n17      9254564   298603\n18       376778   114508\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017315,
                    "execution_time": 0.008204,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003277
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053676,
                    "execution_time": 0.00787,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038458
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0       7676772   281953\n1       6354459    84140\n2      11927370   184777\n3       1562870    49303\n4      11462433   223813\n5       1288462   109186\n6       2963144   256430\n7       6623788   169384\n8       1247343   279026\n9      11477166   261772\n10       842113   250360\n11      2956674    36508\n12      8399471   286616\n13      7740038   173779\n14      2819475   192913\n15      3927053   102082\n16      4228381    75133\n17      9254564   298603\n18       376778   114508\n...*/"
    },
    {
        "input": "with /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales, date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk\n)\n/*CURSOR_IDENTIFIER*/\nSELECT * FROM ssci; -- Placeholder continuation query",
        "optimize": [
            "WITH \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0       4750793   274442\n1       4940782   236200\n2       1957054   238646\n3       6523206   281726\n4        283003   116719\n5       3989229   283108\n6        593300   150133\n7      11967426   288784\n8       1389724   213896\n9      10461987    60212\n10     10985524    63208\n11      2841948   229768\n12      4239045    76156\n13      5100847   273724\n14      7594115   250658\n15      9725960    47539\n16      4398788    55570\n17      6529350   186148\n18      8422445   195634\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016658,
                    "execution_time": 0.007809,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003099
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017329,
                    "execution_time": 0.007763,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003425
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0       4750793   274442\n1       4940782   236200\n2       1957054   238646\n3       6523206   281726\n4        283003   116719\n5       3989229   283108\n6        593300   150133\n7      11967426   288784\n8       1389724   213896\n9      10461987    60212\n10     10985524    63208\n11      2841948   229768\n12      4239045    76156\n13      5100847   273724\n14      7594115   250658\n15      9725960    47539\n16      4398788    55570\n17      6529350   186148\n18      8422445   195634\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n/*CURSOR_IDENTIFIER*/ select * from ssci, csci",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" , \"CSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\" CROSS JOIN \"CSCI\" AS \"CSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080913,
                    "execution_time": 0.030946,
                    "compile_time": 0.000227,
                    "planning_time": 0.02642,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.319885,
                    "execution_time": 0.030616,
                    "compile_time": 0.17489,
                    "planning_time": 0.089301,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 18.449857,
                    "execution_time": 18.297859,
                    "compile_time": 0.000364,
                    "planning_time": 0.027734,
                    "create_size": 5633
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 23.564415,
                    "execution_time": 23.336817,
                    "compile_time": 0.000349,
                    "planning_time": 0.0914,
                    "create_size": 5633
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 10.098632,
                    "execution_time": 9.944239,
                    "compile_time": 0.000351,
                    "planning_time": 0.030232,
                    "create_size": 3103
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.183112,
                    "execution_time": 12.961395,
                    "compile_time": 0.00036,
                    "planning_time": 0.095821,
                    "create_size": 3103
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk  customer_sk_col_2  item_sk_col_3\n0       3285597   263888            9254612          39050\n1       3285597   263888           11671393          39376\n2       3285597   263888            3751478          46576\n3       3285597   263888            3747250         145060\n4       3285597   263888            8281424          21145\n5       3285597   263888           10075461         232840\n6       3285597   263888            2436333         165440\n7       3285597   263888            5493765         244855\n8       3285597   263888            6699553          80749\n9       3285597   263888            7526592         271568\n10      3285597   263888            6984238         161500\n11      3285597   263888            8667415         215918\n12      3285597   263888            8986670          67808\n13      3285597   263888             719930          44623\n14      3285597   263888            2660349          12067\n15      3285597   263888            3903333         165313\n16      3285597   263888            4001169          68018\n17      3285597   263888            5275420         276379\n18      3285597   263888            9018066         166231\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 3.123282,
                    "execution_time": 3.111625,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.004338
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.120607,
                    "execution_time": 3.071235,
                    "compile_time": 0.186271,
                    "planning_time": 0.03951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk  customer_sk_col_2  item_sk_col_3\n0       3285597   263888            9254612          39050\n1       3285597   263888           11671393          39376\n2       3285597   263888            3751478          46576\n3       3285597   263888            3747250         145060\n4       3285597   263888            8281424          21145\n5       3285597   263888           10075461         232840\n6       3285597   263888            2436333         165440\n7       3285597   263888            5493765         244855\n8       3285597   263888            6699553          80749\n9       3285597   263888            7526592         271568\n10      3285597   263888            6984238         161500\n11      3285597   263888            8667415         215918\n12      3285597   263888            8986670          67808\n13      3285597   263888             719930          44623\n14      3285597   263888            2660349          12067\n15      3285597   263888            3903333         165313\n16      3285597   263888            4001169          68018\n17      3285597   263888            5275420         276379\n18      3285597   263888            9018066         166231\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only from ssci, csci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SSCI\" AS \"SSCI\" CROSS JOIN \"CSCI\" AS \"CSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.917305,
                    "execution_time": 4.842458,
                    "compile_time": 0.000265,
                    "planning_time": 0.002972,
                    "create_size": 3457
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.113087,
                    "execution_time": 4.97179,
                    "compile_time": 0.000264,
                    "planning_time": 0.066127,
                    "create_size": 3457
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.732831,
                    "execution_time": 2.658154,
                    "compile_time": 0.000254,
                    "planning_time": 0.002911,
                    "create_size": 1951
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.818562,
                    "execution_time": 2.684052,
                    "compile_time": 0.000257,
                    "planning_time": 0.059558,
                    "create_size": 1951
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\nfrom (select * from ssci) as ssci left join (select * from csci) as csci on ssci.customer_sk = csci.customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SSCI\" AS \"SSCI\" LEFT JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales join date_dim on ss_sold_date_sk = d_date_sk\n\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales join date_dim on cs_sold_date_sk = d_date_sk\n\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on ssci.customer_sk = csci.customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n                               and ssci.item_sk = csci.item_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\" AND \"CSCI\".\"ITEM_SK\" = \"SSCI\".\"ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.13651,
                    "execution_time": 9.096344,
                    "compile_time": 0.000446,
                    "planning_time": 0.008142,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.703662,
                    "execution_time": 9.494888,
                    "compile_time": 3.094347,
                    "planning_time": 0.079564,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0   537038093     284161772              88235*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016735,
                    "execution_time": 0.007577,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003243
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05499,
                    "execution_time": 0.007837,
                    "compile_time": 0.000887,
                    "planning_time": 0.038406
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0   537038093     284161772              88235*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n                               and ssci.item_sk = csci.item_sk)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\" AND \"CSCI\".\"ITEM_SK\" = \"SSCI\".\"ITEM_SK\" LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0   537038093     284161772              88235*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016616,
                    "execution_time": 0.007292,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00337
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017452,
                    "execution_time": 0.007626,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003512
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 100"
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0   537038093     284161772              88235*/"
    }
]