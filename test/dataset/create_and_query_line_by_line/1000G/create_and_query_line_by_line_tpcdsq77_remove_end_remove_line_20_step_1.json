[
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales\n      , date_dim\n      , store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns\n      , date_dim\n      , store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales\n      , date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns\n      , date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales\n      , date_dim\n      , web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns\n      , date_dim\n      , web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n/*CURSOR_IDENTIFIER*/\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , ws.sales\n        , coalesce(wr.returns, 0) as returns\n        , (ws.profit - coalesce(wr.profit_loss, 0)) as profit\n from ws\n left join wr\n   on ws.wp_web_page_sk = wr.wp_web_page_sk\n)\n group by channel, id\n)\nselect channel\n      , id\n      , sales\n      , returns\n      , profit\n from results",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , WS.SALES , COALESCE ( WR.RETURNS , 0 ) AS RETURNS , ( WS.PROFIT - COALESCE ( WR.PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel    id         sales       returns        profit\n0     store channel   289  2.267678e+08  5.623602e+06 -1.023464e+08\n1     store channel   991  2.195676e+08  5.575902e+06 -9.874677e+07\n2     store channel   400  2.245524e+08  5.580190e+06 -1.004931e+08\n3     store channel   308  2.287319e+08  5.757472e+06 -1.019954e+08\n4     store channel   218  2.253011e+08  5.392849e+06 -1.031540e+08\n5     store channel   608  2.289359e+08  5.881860e+06 -1.023483e+08\n6     store channel   856  2.264826e+08  5.581815e+06 -1.005452e+08\n7     store channel    46  2.246231e+08  5.497652e+06 -1.003850e+08\n8     store channel   392  2.262998e+08  5.517323e+06 -1.005586e+08\n9   catalog channel    35  1.122207e+11  2.068071e+09 -1.244556e+10\n10      web channel    85  2.623738e+07  8.383531e+05 -3.501837e+06\n11      web channel   668  2.772925e+07  8.318467e+05 -2.887518e+06\n12      web channel  2947  2.776182e+07  8.622660e+05 -3.266719e+06\n13      web channel  1949  2.733265e+07  3.956882e+05 -3.250014e+06\n14      web channel   569  2.688093e+07  3.158352e+05 -2.968510e+06\n15      web channel  2431  2.753349e+07  8.850801e+05 -3.172145e+06\n16      web channel   121  2.715018e+07  1.022680e+06 -3.370167e+06\n17      web channel   374  2.767415e+07  8.820496e+05 -3.153472e+06\n18      web channel  2231  2.785371e+07  3.793866e+05 -2.693620e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.94817,
                    "execution_time": 0.747847,
                    "compile_time": 0.001078,
                    "planning_time": 0.148111
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 13.702997,
                    "execution_time": 13.48994,
                    "compile_time": 0.014022,
                    "planning_time": 0.147499
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel    id         sales       returns        profit\n0     store channel   289  2.267678e+08  5.623602e+06 -1.023464e+08\n1     store channel   991  2.195676e+08  5.575902e+06 -9.874677e+07\n2     store channel   400  2.245524e+08  5.580190e+06 -1.004931e+08\n3     store channel   308  2.287319e+08  5.757472e+06 -1.019954e+08\n4     store channel   218  2.253011e+08  5.392849e+06 -1.031540e+08\n5     store channel   608  2.289359e+08  5.881860e+06 -1.023483e+08\n6     store channel   856  2.264826e+08  5.581815e+06 -1.005452e+08\n7     store channel    46  2.246231e+08  5.497652e+06 -1.003850e+08\n8     store channel   392  2.262998e+08  5.517323e+06 -1.005586e+08\n9   catalog channel    35  1.122207e+11  2.068071e+09 -1.244556e+10\n10      web channel    85  2.623738e+07  8.383531e+05 -3.501837e+06\n11      web channel   668  2.772925e+07  8.318467e+05 -2.887518e+06\n12      web channel  2947  2.776182e+07  8.622660e+05 -3.266719e+06\n13      web channel  1949  2.733265e+07  3.956882e+05 -3.250014e+06\n14      web channel   569  2.688093e+07  3.158352e+05 -2.968510e+06\n15      web channel  2431  2.753349e+07  8.850801e+05 -3.172145e+06\n16      web channel   121  2.715018e+07  1.022680e+06 -3.370167e+06\n17      web channel   374  2.767415e+07  8.820496e+05 -3.153472e+06\n18      web channel  2231  2.785371e+07  3.793866e+05 -2.693620e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       join cr\n       on cs.cs_call_center_sk = cr.cr_call_center_sk\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from  ws left join wr\n        on ws.wp_web_page_sk = wr.wp_web_page_sk\n )\n group by channel, id\n )\n select * from results;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" AS \"CR_CALL_CENTER_SK\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" JOIN \"CR\" AS \"CR\" ON \"CR\".\"CR_CALL_CENTER_SK\" = \"CS\".\"CS_CALL_CENTER_SK\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS JOIN CR ON CS.CS_CALL_CENTER_SK = CR.CR_CALL_CENTER_SK UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   589  2.213231e+08  5599539.34 -9.836690e+07\n1   store channel   217  2.236545e+08  5365300.34 -1.006003e+08\n2   store channel   520  2.281370e+08  5333056.57 -1.023990e+08\n3   store channel   922  2.232166e+08  5462957.57 -1.013532e+08\n4     web channel  2845  2.715287e+07   999988.26 -3.490437e+06\n5     web channel   757  2.743184e+07   939956.83 -3.144455e+06\n6     web channel  2066  2.784351e+07  1032262.51 -3.496336e+06\n7     web channel  2471  2.697384e+07   402928.53 -3.193583e+06\n8     web channel  1019  2.708559e+07   455497.73 -3.194370e+06\n9     web channel  2222  2.746678e+07   969883.19 -3.241573e+06\n10    web channel   710  2.768373e+07   839413.36 -3.143778e+06\n11    web channel  1285  2.659798e+07   974958.52 -3.491260e+06\n12    web channel  2918  2.703464e+07   984273.87 -3.106743e+06\n13    web channel   931  2.815391e+07   948957.18 -3.266390e+06\n14    web channel  1754  2.643656e+07  1029045.20 -3.510912e+06\n15    web channel  1106  2.818570e+07   993603.72 -3.279242e+06\n16    web channel   884  2.749719e+07   992546.81 -3.327953e+06\n17    web channel   469  2.745621e+07   978308.38 -2.864235e+06\n18    web channel   485  2.737757e+07   305773.53 -3.114860e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.768491,
                    "execution_time": 0.559,
                    "compile_time": 0.001072,
                    "planning_time": 0.156671
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.891237,
                    "execution_time": 0.556192,
                    "compile_time": 0.003927,
                    "planning_time": 0.274053
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   589  2.213231e+08  5599539.34 -9.836690e+07\n1   store channel   217  2.236545e+08  5365300.34 -1.006003e+08\n2   store channel   520  2.281370e+08  5333056.57 -1.023990e+08\n3   store channel   922  2.232166e+08  5462957.57 -1.013532e+08\n4     web channel  2845  2.715287e+07   999988.26 -3.490437e+06\n5     web channel   757  2.743184e+07   939956.83 -3.144455e+06\n6     web channel  2066  2.784351e+07  1032262.51 -3.496336e+06\n7     web channel  2471  2.697384e+07   402928.53 -3.193583e+06\n8     web channel  1019  2.708559e+07   455497.73 -3.194370e+06\n9     web channel  2222  2.746678e+07   969883.19 -3.241573e+06\n10    web channel   710  2.768373e+07   839413.36 -3.143778e+06\n11    web channel  1285  2.659798e+07   974958.52 -3.491260e+06\n12    web channel  2918  2.703464e+07   984273.87 -3.106743e+06\n13    web channel   931  2.815391e+07   948957.18 -3.266390e+06\n14    web channel  1754  2.643656e+07  1029045.20 -3.510912e+06\n15    web channel  1106  2.818570e+07   993603.72 -3.279242e+06\n16    web channel   884  2.749719e+07   992546.81 -3.327953e+06\n17    web channel   469  2.745621e+07   978308.38 -2.864235e+06\n18    web channel   485  2.737757e+07   305773.53 -3.114860e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n (select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       join cr on cs.cs_call_center_sk = cr.cr_call_center_sk\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , ws.sales\n        , coalesce(wr.returns, 0) as returns\n        , (ws.profit - coalesce(wr.profit_loss, 0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n )\n group by channel, id\n )\nselect *\nfrom results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" AS \"CR_CALL_CENTER_SK\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" JOIN \"CR\" AS \"CR\" ON \"CR\".\"CR_CALL_CENTER_SK\" = \"CS\".\"CS_CALL_CENTER_SK\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS JOIN CR ON CS.CS_CALL_CENTER_SK = CR.CR_CALL_CENTER_SK UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , WS.SALES , COALESCE ( WR.RETURNS , 0 ) AS RETURNS , ( WS.PROFIT - COALESCE ( WR.PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   217  2.236545e+08  5365300.34 -1.006003e+08\n1   store channel   589  2.213231e+08  5599539.34 -9.836690e+07\n2   store channel   922  2.232166e+08  5462957.57 -1.013532e+08\n3   store channel   520  2.281370e+08  5333056.57 -1.023990e+08\n4     web channel  2222  2.746678e+07   969883.19 -3.241573e+06\n5     web channel   884  2.749719e+07   992546.81 -3.327953e+06\n6     web channel   485  2.737757e+07   305773.53 -3.114860e+06\n7     web channel   710  2.768373e+07   839413.36 -3.143778e+06\n8     web channel  2918  2.703464e+07   984273.87 -3.106743e+06\n9     web channel  2060  2.766949e+07  1023353.00 -3.134457e+06\n10    web channel   931  2.815391e+07   948957.18 -3.266390e+06\n11    web channel  2857  2.733361e+07   985133.28 -3.494320e+06\n12    web channel  1106  2.818570e+07   993603.72 -3.279242e+06\n13    web channel  2845  2.715287e+07   999988.26 -3.490437e+06\n14    web channel   757  2.743184e+07   939956.83 -3.144455e+06\n15    web channel  2471  2.697384e+07   402928.53 -3.193583e+06\n16    web channel  1754  2.643656e+07  1029045.20 -3.510912e+06\n17    web channel   908  2.732123e+07   885570.05 -2.889581e+06\n18    web channel   469  2.745621e+07   978308.38 -2.864235e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.758118,
                    "execution_time": 0.553846,
                    "compile_time": 0.001097,
                    "planning_time": 0.150727
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.878389,
                    "execution_time": 0.55417,
                    "compile_time": 0.001075,
                    "planning_time": 0.271066
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   217  2.236545e+08  5365300.34 -1.006003e+08\n1   store channel   589  2.213231e+08  5599539.34 -9.836690e+07\n2   store channel   922  2.232166e+08  5462957.57 -1.013532e+08\n3   store channel   520  2.281370e+08  5333056.57 -1.023990e+08\n4     web channel  2222  2.746678e+07   969883.19 -3.241573e+06\n5     web channel   884  2.749719e+07   992546.81 -3.327953e+06\n6     web channel   485  2.737757e+07   305773.53 -3.114860e+06\n7     web channel   710  2.768373e+07   839413.36 -3.143778e+06\n8     web channel  2918  2.703464e+07   984273.87 -3.106743e+06\n9     web channel  2060  2.766949e+07  1023353.00 -3.134457e+06\n10    web channel   931  2.815391e+07   948957.18 -3.266390e+06\n11    web channel  2857  2.733361e+07   985133.28 -3.494320e+06\n12    web channel  1106  2.818570e+07   993603.72 -3.279242e+06\n13    web channel  2845  2.715287e+07   999988.26 -3.490437e+06\n14    web channel   757  2.743184e+07   939956.83 -3.144455e+06\n15    web channel  2471  2.697384e+07   402928.53 -3.193583e+06\n16    web channel  1754  2.643656e+07  1029045.20 -3.510912e+06\n17    web channel   908  2.732123e+07   885570.05 -2.889581e+06\n18    web channel   469  2.745621e+07   978308.38 -2.864235e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n )\n group by channel, id\n )\nselect *\nfrom results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   847  2.261267e+08  5787440.60 -1.034844e+08\n1   store channel   508  2.255490e+08  5671204.36 -1.001089e+08\n2   store channel   757  2.263650e+08  5737425.66 -1.014336e+08\n3   store channel   781  2.255256e+08  5509735.08 -1.013086e+08\n4   store channel   811  2.264832e+08  5644604.40 -1.010164e+08\n5   store channel   487  2.290404e+08  5754191.37 -1.020023e+08\n6     web channel   395  2.726214e+07   429930.88 -2.817134e+06\n7     web channel  2983  2.710741e+07   953071.95 -3.373953e+06\n8     web channel  2981  2.704884e+07   397436.57 -3.136318e+06\n9     web channel  1711  2.730019e+07   952858.53 -3.429981e+06\n10    web channel   740  2.741335e+07   886897.82 -3.238323e+06\n11    web channel  1160  2.689180e+07   953015.89 -3.087902e+06\n12    web channel   770  2.759283e+07   693246.83 -2.891136e+06\n13    web channel    44  2.706402e+07   935303.40 -3.781873e+06\n14    web channel  1753  2.725290e+07   909627.72 -3.381379e+06\n15    web channel   811  2.675504e+07   971673.04 -3.234923e+06\n16    web channel  1808  2.781822e+07  1076145.72 -3.110777e+06\n17    web channel  2897  2.687082e+07   342123.41 -3.104148e+06\n18    web channel  2263  2.750671e+07   886227.87 -3.284194e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.730107,
                    "execution_time": 0.529462,
                    "compile_time": 0.001063,
                    "planning_time": 0.148211
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.846123,
                    "execution_time": 0.529679,
                    "compile_time": 0.001045,
                    "planning_time": 0.262438
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   847  2.261267e+08  5787440.60 -1.034844e+08\n1   store channel   508  2.255490e+08  5671204.36 -1.001089e+08\n2   store channel   757  2.263650e+08  5737425.66 -1.014336e+08\n3   store channel   781  2.255256e+08  5509735.08 -1.013086e+08\n4   store channel   811  2.264832e+08  5644604.40 -1.010164e+08\n5   store channel   487  2.290404e+08  5754191.37 -1.020023e+08\n6     web channel   395  2.726214e+07   429930.88 -2.817134e+06\n7     web channel  2983  2.710741e+07   953071.95 -3.373953e+06\n8     web channel  2981  2.704884e+07   397436.57 -3.136318e+06\n9     web channel  1711  2.730019e+07   952858.53 -3.429981e+06\n10    web channel   740  2.741335e+07   886897.82 -3.238323e+06\n11    web channel  1160  2.689180e+07   953015.89 -3.087902e+06\n12    web channel   770  2.759283e+07   693246.83 -2.891136e+06\n13    web channel    44  2.706402e+07   935303.40 -3.781873e+06\n14    web channel  1753  2.725290e+07   909627.72 -3.381379e+06\n15    web channel   811  2.675504e+07   971673.04 -3.234923e+06\n16    web channel  1808  2.781822e+07  1076145.72 -3.110777e+06\n17    web channel  2897  2.687082e+07   342123.41 -3.104148e+06\n18    web channel  2263  2.750671e+07   886227.87 -3.284194e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , coalesce(profit_loss, 0) as profit_loss\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n )\n group by channel, id\n )\nselect *\nfrom results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT_LOSS\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , COALESCE ( PROFIT_LOSS , 0 ) AS PROFIT_LOSS FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel    id         sales       returns        profit\n0     store channel   943  2.257674e+08  5.830235e+06 -1.006165e+08\n1     store channel   796  2.259821e+08  5.471694e+06 -1.001305e+08\n2     store channel    40  2.289495e+08  5.609662e+06 -1.029965e+08\n3   catalog channel     7  1.118066e+11  2.068071e+09 -1.242048e+10\n4       web channel  2375  2.713279e+07  4.040373e+05  2.216688e+05\n5       web channel   745  2.781389e+07  9.355610e+05  5.364562e+05\n6       web channel  2912  2.763138e+07  9.187455e+05  5.448782e+05\n7       web channel  2161  2.689355e+07  8.876740e+05  5.366161e+05\n8       web channel   650  2.744844e+07  8.194673e+05  4.987519e+05\n9       web channel   314  2.709131e+07  1.014709e+06  5.656323e+05\n10      web channel   614  2.690152e+07  9.289845e+05  5.523170e+05\n11      web channel   182  2.664409e+07  1.005856e+06  5.785141e+05\n12      web channel  1675  2.750690e+07  9.851960e+05  5.542930e+05\n13      web channel  2591  2.658018e+07  4.241728e+05  2.396878e+05\n14      web channel  1679  2.718405e+07  4.660507e+05  2.536875e+05\n15      web channel   725  2.773422e+07  3.588729e+05  1.962969e+05\n16    store channel   292  2.224636e+08  5.586536e+06 -1.001531e+08\n17    store channel    94  2.237972e+08  5.588857e+06 -9.944740e+07\n18    store channel   931  2.246515e+08  5.861779e+06 -1.019964e+08\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.718034,
                    "execution_time": 0.519639,
                    "compile_time": 0.001098,
                    "planning_time": 0.145194
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.99696,
                    "execution_time": 0.518345,
                    "compile_time": 0.159492,
                    "planning_time": 0.262839
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel    id         sales       returns        profit\n0     store channel   943  2.257674e+08  5.830235e+06 -1.006165e+08\n1     store channel   796  2.259821e+08  5.471694e+06 -1.001305e+08\n2     store channel    40  2.289495e+08  5.609662e+06 -1.029965e+08\n3   catalog channel     7  1.118066e+11  2.068071e+09 -1.242048e+10\n4       web channel  2375  2.713279e+07  4.040373e+05  2.216688e+05\n5       web channel   745  2.781389e+07  9.355610e+05  5.364562e+05\n6       web channel  2912  2.763138e+07  9.187455e+05  5.448782e+05\n7       web channel  2161  2.689355e+07  8.876740e+05  5.366161e+05\n8       web channel   650  2.744844e+07  8.194673e+05  4.987519e+05\n9       web channel   314  2.709131e+07  1.014709e+06  5.656323e+05\n10      web channel   614  2.690152e+07  9.289845e+05  5.523170e+05\n11      web channel   182  2.664409e+07  1.005856e+06  5.785141e+05\n12      web channel  1675  2.750690e+07  9.851960e+05  5.542930e+05\n13      web channel  2591  2.658018e+07  4.241728e+05  2.396878e+05\n14      web channel  1679  2.718405e+07  4.660507e+05  2.536875e+05\n15      web channel   725  2.773422e+07  3.588729e+05  1.962969e+05\n16    store channel   292  2.224636e+08  5.586536e+06 -1.001531e+08\n17    store channel    94  2.237972e+08  5.588857e+06 -9.944740e+07\n18    store channel   931  2.246515e+08  5.861779e+06 -1.019964e+08\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss, 0)) as profit\n from   cs left join cr\n        on  cs.cs_call_center_sk = cr.cr_call_center_sk\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) as c\n group by channel, id\n )\n select * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" AS \"CR_CALL_CENTER_SK\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"C\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , COALESCE ( \"CR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"CS\".\"PROFIT\" - COALESCE ( \"CR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"CS\" AS \"CS\" LEFT JOIN \"CR\" AS \"CR\" ON \"CR\".\"CR_CALL_CENTER_SK\" = \"CS\".\"CS_CALL_CENTER_SK\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"C\".\"CHANNEL\" AS \"CHANNEL\" , \"C\".\"ID\" AS \"ID\" , SUM ( \"C\".\"SALES\" ) AS \"SALES\" , SUM ( \"C\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"C\".\"PROFIT\" ) AS \"PROFIT\" FROM \"C\" AS \"C\" GROUP BY \"C\".\"CHANNEL\" , \"C\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM CS LEFT JOIN CR ON CS.CS_CALL_CENTER_SK = CR.CR_CALL_CENTER_SK UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS C GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel      id         sales     returns        profit\n0     store channel   520.0  2.281370e+08  5333056.57 -1.023990e+08\n1     store channel   217.0  2.236545e+08  5365300.34 -1.006003e+08\n2     store channel   922.0  2.232166e+08  5462957.57 -1.013532e+08\n3     store channel   589.0  2.213231e+08  5599539.34 -9.836690e+07\n4   catalog channel     NaN  1.043375e+08        0.00 -2.071265e+07\n5       web channel  2222.0  2.746678e+07   969883.19 -3.241573e+06\n6       web channel   884.0  2.749719e+07   992546.81 -3.327953e+06\n7       web channel   485.0  2.737757e+07   305773.53 -3.114860e+06\n8       web channel   710.0  2.768373e+07   839413.36 -3.143778e+06\n9       web channel  2918.0  2.703464e+07   984273.87 -3.106743e+06\n10      web channel  2060.0  2.766949e+07  1023353.00 -3.134457e+06\n11      web channel   931.0  2.815391e+07   948957.18 -3.266390e+06\n12      web channel  2857.0  2.733361e+07   985133.28 -3.494320e+06\n13      web channel  1106.0  2.818570e+07   993603.72 -3.279242e+06\n14      web channel  2845.0  2.715287e+07   999988.26 -3.490437e+06\n15      web channel   757.0  2.743184e+07   939956.83 -3.144455e+06\n16      web channel  2471.0  2.697384e+07   402928.53 -3.193583e+06\n17      web channel  1754.0  2.643656e+07  1029045.20 -3.510912e+06\n18      web channel   908.0  2.732123e+07   885570.05 -2.889581e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.758882,
                    "execution_time": 0.553448,
                    "compile_time": 0.001099,
                    "planning_time": 0.151259
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.468835,
                    "execution_time": 0.558864,
                    "compile_time": 6.587682,
                    "planning_time": 0.262942
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel      id         sales     returns        profit\n0     store channel   520.0  2.281370e+08  5333056.57 -1.023990e+08\n1     store channel   217.0  2.236545e+08  5365300.34 -1.006003e+08\n2     store channel   922.0  2.232166e+08  5462957.57 -1.013532e+08\n3     store channel   589.0  2.213231e+08  5599539.34 -9.836690e+07\n4   catalog channel     NaN  1.043375e+08        0.00 -2.071265e+07\n5       web channel  2222.0  2.746678e+07   969883.19 -3.241573e+06\n6       web channel   884.0  2.749719e+07   992546.81 -3.327953e+06\n7       web channel   485.0  2.737757e+07   305773.53 -3.114860e+06\n8       web channel   710.0  2.768373e+07   839413.36 -3.143778e+06\n9       web channel  2918.0  2.703464e+07   984273.87 -3.106743e+06\n10      web channel  2060.0  2.766949e+07  1023353.00 -3.134457e+06\n11      web channel   931.0  2.815391e+07   948957.18 -3.266390e+06\n12      web channel  2857.0  2.733361e+07   985133.28 -3.494320e+06\n13      web channel  1106.0  2.818570e+07   993603.72 -3.279242e+06\n14      web channel  2845.0  2.715287e+07   999988.26 -3.490437e+06\n15      web channel   757.0  2.743184e+07   939956.83 -3.144455e+06\n16      web channel  2471.0  2.697384e+07   402928.53 -3.193583e+06\n17      web channel  1754.0  2.643656e+07  1029045.20 -3.510912e+06\n18      web channel   908.0  2.732123e+07   885570.05 -2.889581e+06\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id \n)\nselect * from results\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   830  2.222642e+08  5539342.42 -9.805821e+07\n1   store channel    58  2.247860e+08  5688899.89 -1.013460e+08\n2   store channel   817  2.274341e+08  5779387.03 -1.018894e+08\n3   store channel   214  2.266380e+08  5551734.75 -1.021457e+08\n4   store channel    70  2.243114e+08  5815468.09 -1.013449e+08\n5   store channel   958  2.276968e+08  5584047.94 -1.031365e+08\n6     web channel   199  2.678827e+07   963214.28 -3.462376e+06\n7     web channel    32  2.691254e+07   953573.23 -3.359154e+06\n8     web channel   785  2.784060e+07   346682.27 -2.947862e+06\n9     web channel  1741  2.762774e+07   898559.62 -3.156740e+06\n10    web channel  1087  2.637018e+07   847693.12 -3.039856e+06\n11    web channel   481  2.722128e+07  1034292.36 -3.285721e+06\n12    web channel  1100  2.725433e+07   964611.59 -3.521157e+06\n13    web channel  1699  2.693980e+07   951895.95 -3.613819e+06\n14    web channel   593  2.745462e+07   423092.49 -2.750428e+06\n15    web channel   620  2.736418e+07   986139.70 -3.681791e+06\n16    web channel  1199  2.773463e+07   400488.80 -2.798014e+06\n17    web channel  1789  2.800742e+07   933145.61 -3.057764e+06\n18    web channel  1580  2.796108e+07   960604.91 -3.516030e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.736646,
                    "execution_time": 0.53411,
                    "compile_time": 0.001027,
                    "planning_time": 0.150646
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.845617,
                    "execution_time": 0.529878,
                    "compile_time": 0.001032,
                    "planning_time": 0.26412
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   830  2.222642e+08  5539342.42 -9.805821e+07\n1   store channel    58  2.247860e+08  5688899.89 -1.013460e+08\n2   store channel   817  2.274341e+08  5779387.03 -1.018894e+08\n3   store channel   214  2.266380e+08  5551734.75 -1.021457e+08\n4   store channel    70  2.243114e+08  5815468.09 -1.013449e+08\n5   store channel   958  2.276968e+08  5584047.94 -1.031365e+08\n6     web channel   199  2.678827e+07   963214.28 -3.462376e+06\n7     web channel    32  2.691254e+07   953573.23 -3.359154e+06\n8     web channel   785  2.784060e+07   346682.27 -2.947862e+06\n9     web channel  1741  2.762774e+07   898559.62 -3.156740e+06\n10    web channel  1087  2.637018e+07   847693.12 -3.039856e+06\n11    web channel   481  2.722128e+07  1034292.36 -3.285721e+06\n12    web channel  1100  2.725433e+07   964611.59 -3.521157e+06\n13    web channel  1699  2.693980e+07   951895.95 -3.613819e+06\n14    web channel   593  2.745462e+07   423092.49 -2.750428e+06\n15    web channel   620  2.736418e+07   986139.70 -3.681791e+06\n16    web channel  1199  2.773463e+07   400488.80 -2.798014e+06\n17    web channel  1789  2.800742e+07   933145.61 -3.057764e+06\n18    web channel  1580  2.796108e+07   960604.91 -3.516030e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   634  2.249304e+08  5752643.15 -1.013417e+08\n1   store channel   350  2.253872e+08  5461759.57 -1.015375e+08\n2   store channel   229  2.266408e+08  5667519.20 -1.022489e+08\n3   store channel    28  2.254473e+08  5476924.39 -1.008314e+08\n4   store channel   727  2.254772e+08  5499887.58 -1.012002e+08\n5     web channel  1898  2.666473e+07  1013512.13 -3.334153e+06\n6     web channel  1784  2.715386e+07   736356.35 -2.830304e+06\n7     web channel   247  2.816350e+07   993425.73 -3.383265e+06\n8     web channel  2641  2.701107e+07   999597.72 -3.136567e+06\n9     web channel  1361  2.812073e+07   381823.29 -3.067261e+06\n10    web channel   608  2.718970e+07   961334.91 -3.612941e+06\n11    web channel  2267  2.798011e+07   391789.55 -2.820242e+06\n12    web channel   607  2.653741e+07   926007.32 -3.283230e+06\n13    web channel  1658  2.705895e+07   965665.77 -3.169946e+06\n14    web channel   127  2.718719e+07   747094.59 -3.460180e+06\n15    web channel   359  2.717718e+07   359454.37 -2.727822e+06\n16    web channel  1628  2.674260e+07  1019860.19 -3.438308e+06\n17    web channel  2570  2.757582e+07  1069681.88 -3.232376e+06\n18    web channel     5  2.735579e+07   406241.46 -3.034975e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.732142,
                    "execution_time": 0.532434,
                    "compile_time": 0.001043,
                    "planning_time": 0.14831
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.726032,
                    "execution_time": 0.526414,
                    "compile_time": 0.001069,
                    "planning_time": 0.146156
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   634  2.249304e+08  5752643.15 -1.013417e+08\n1   store channel   350  2.253872e+08  5461759.57 -1.015375e+08\n2   store channel   229  2.266408e+08  5667519.20 -1.022489e+08\n3   store channel    28  2.254473e+08  5476924.39 -1.008314e+08\n4   store channel   727  2.254772e+08  5499887.58 -1.012002e+08\n5     web channel  1898  2.666473e+07  1013512.13 -3.334153e+06\n6     web channel  1784  2.715386e+07   736356.35 -2.830304e+06\n7     web channel   247  2.816350e+07   993425.73 -3.383265e+06\n8     web channel  2641  2.701107e+07   999597.72 -3.136567e+06\n9     web channel  1361  2.812073e+07   381823.29 -3.067261e+06\n10    web channel   608  2.718970e+07   961334.91 -3.612941e+06\n11    web channel  2267  2.798011e+07   391789.55 -2.820242e+06\n12    web channel   607  2.653741e+07   926007.32 -3.283230e+06\n13    web channel  1658  2.705895e+07   965665.77 -3.169946e+06\n14    web channel   127  2.718719e+07   747094.59 -3.460180e+06\n15    web channel   359  2.717718e+07   359454.37 -2.727822e+06\n16    web channel  1628  2.674260e+07  1019860.19 -3.438308e+06\n17    web channel  2570  2.757582e+07  1069681.88 -3.232376e+06\n18    web channel     5  2.735579e+07   406241.46 -3.034975e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales\n join date_dim on ss_sold_date_sk = d_date_sk\n join store on ss_store_sk = s_store_sk\n where d_date between cast('2000-08-02' as date) \n       and dateadd(day,30,cast('2000-08-02' as date))  \n group by s_store_sk)\n ,\n sr as\n (select sr_store_sk as s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date between cast('2000-08-02' as date)\n       and dateadd(day,30,cast('2000-08-02' as date))  \n group by sr_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales\n join date_dim on cs_sold_date_sk = d_date_sk\n where d_date between cast('2000-08-02' as date)\n       and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date between cast('2000-08-02' as date)\n       and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales\n join date_dim on ws_sold_date_sk = d_date_sk\n join web_page on ws_web_page_sk = wp_web_page_sk\n where d_date between cast('2000-08-02' as date)\n       and dateadd(day,30,cast('2000-08-02' as date))  \n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns\n join date_dim on wr_returned_date_sk = d_date_sk\n join web_page on wr_web_page_sk = wp_web_page_sk\n where d_date between cast('2000-08-02' as date)\n       and dateadd(day,30,cast('2000-08-02' as date))  \n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       left join cr on cs.cs_call_center_sk = cr.cr_call_center_sk\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" GROUP BY \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" AS \"CR_CALL_CENTER_SK\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" LEFT JOIN \"CR\" AS \"CR\" ON \"CR\".\"CR_CALL_CENTER_SK\" = \"CS\".\"CS_CALL_CENTER_SK\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES JOIN DATE_DIM ON SS_SOLD_DATE_SK = D_DATE_SK JOIN STORE ON SS_STORE_SK = S_STORE_SK WHERE D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY S_STORE_SK ) , SR AS ( SELECT SR_STORE_SK AS S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS JOIN DATE_DIM ON SR_RETURNED_DATE_SK = D_DATE_SK WHERE D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY SR_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES JOIN DATE_DIM ON CS_SOLD_DATE_SK = D_DATE_SK WHERE D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS JOIN DATE_DIM ON CR_RETURNED_DATE_SK = D_DATE_SK WHERE D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES JOIN DATE_DIM ON WS_SOLD_DATE_SK = D_DATE_SK JOIN WEB_PAGE ON WS_WEB_PAGE_SK = WP_WEB_PAGE_SK WHERE D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS JOIN DATE_DIM ON WR_RETURNED_DATE_SK = D_DATE_SK JOIN WEB_PAGE ON WR_WEB_PAGE_SK = WP_WEB_PAGE_SK WHERE D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS LEFT JOIN CR ON CS.CS_CALL_CENTER_SK = CR.CR_CALL_CENTER_SK UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   350  2.253872e+08  5461759.57 -1.015375e+08\n1   store channel   634  2.249304e+08  5752643.15 -1.013417e+08\n2   store channel   727  2.254772e+08  5499887.58 -1.012002e+08\n3   store channel   229  2.266408e+08  5667519.20 -1.022489e+08\n4   store channel    28  2.254473e+08  5476924.39 -1.008314e+08\n5     web channel  1898  2.666473e+07  1013512.13 -3.334153e+06\n6     web channel   308  2.788507e+07   923097.38 -3.207951e+06\n7     web channel   127  2.718719e+07   747094.59 -3.460180e+06\n8     web channel   530  2.748792e+07  1046211.23 -3.117761e+06\n9     web channel   926  2.758585e+07   975272.44 -3.273849e+06\n10    web channel  2369  2.629990e+07   350239.73 -3.247947e+06\n11    web channel  2641  2.701107e+07   999597.72 -3.136567e+06\n12    web channel  2267  2.798011e+07   391789.55 -2.820242e+06\n13    web channel   247  2.816350e+07   993425.73 -3.383265e+06\n14    web channel  2570  2.757582e+07  1069681.88 -3.232376e+06\n15    web channel  1628  2.674260e+07  1019860.19 -3.438308e+06\n16    web channel  2159  2.676455e+07   496253.51 -3.030540e+06\n17    web channel   607  2.653741e+07   926007.32 -3.283230e+06\n18    web channel  1361  2.812073e+07   381823.29 -3.067261e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.768023,
                    "execution_time": 0.54444,
                    "compile_time": 0.001064,
                    "planning_time": 0.170381
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.638255,
                    "execution_time": 0.544369,
                    "compile_time": 3.749827,
                    "planning_time": 0.286695
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   350  2.253872e+08  5461759.57 -1.015375e+08\n1   store channel   634  2.249304e+08  5752643.15 -1.013417e+08\n2   store channel   727  2.254772e+08  5499887.58 -1.012002e+08\n3   store channel   229  2.266408e+08  5667519.20 -1.022489e+08\n4   store channel    28  2.254473e+08  5476924.39 -1.008314e+08\n5     web channel  1898  2.666473e+07  1013512.13 -3.334153e+06\n6     web channel   308  2.788507e+07   923097.38 -3.207951e+06\n7     web channel   127  2.718719e+07   747094.59 -3.460180e+06\n8     web channel   530  2.748792e+07  1046211.23 -3.117761e+06\n9     web channel   926  2.758585e+07   975272.44 -3.273849e+06\n10    web channel  2369  2.629990e+07   350239.73 -3.247947e+06\n11    web channel  2641  2.701107e+07   999597.72 -3.136567e+06\n12    web channel  2267  2.798011e+07   391789.55 -2.820242e+06\n13    web channel   247  2.816350e+07   993425.73 -3.383265e+06\n14    web channel  2570  2.757582e+07  1069681.88 -3.232376e+06\n15    web channel  1628  2.674260e+07  1019860.19 -3.438308e+06\n16    web channel  2159  2.676455e+07   496253.51 -3.030540e+06\n17    web channel   607  2.653741e+07   926007.32 -3.283230e+06\n18    web channel  1361  2.812073e+07   381823.29 -3.067261e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS ) LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   328  2.281597e+08  5355277.51 -1.004856e+08\n1   store channel   956  2.257012e+08  5801335.88 -1.000806e+08\n2   store channel   842  2.224594e+08  5837165.63 -1.011139e+08\n3   store channel   512  2.247451e+08  5688405.99 -1.008932e+08\n4   store channel   146  2.262509e+08  5578881.50 -1.008841e+08\n5   store channel   598  2.232035e+08  5402342.56 -1.004761e+08\n6     web channel  2738  2.721974e+07  1022337.85 -2.800719e+06\n7     web channel    37  2.776483e+07   944608.42 -2.994894e+06\n8     web channel   163  2.762435e+07   992263.01 -2.984111e+06\n9     web channel   845  2.715725e+07   432844.82 -3.170875e+06\n10    web channel  1667  2.791305e+07   420041.94 -3.278333e+06\n11    web channel   611  2.718827e+07   448496.92 -3.296062e+06\n12    web channel  1802  2.718868e+07   914583.45 -3.429422e+06\n13    web channel  1238  2.738158e+07   957467.61 -3.131751e+06\n14    web channel  2618  2.767263e+07   830004.74 -3.224953e+06\n15    web channel   629  2.695614e+07   391778.35 -3.105363e+06\n16  store channel   560  2.251821e+08  5265085.05 -1.014575e+08\n17  store channel   355  2.233078e+08  5433419.32 -9.968796e+07\n18    web channel  1703  2.698726e+07   346939.67 -2.606438e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.73703,
                    "execution_time": 0.530647,
                    "compile_time": 0.001127,
                    "planning_time": 0.154169
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.874402,
                    "execution_time": 0.540792,
                    "compile_time": 0.001079,
                    "planning_time": 0.281479
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   328  2.281597e+08  5355277.51 -1.004856e+08\n1   store channel   956  2.257012e+08  5801335.88 -1.000806e+08\n2   store channel   842  2.224594e+08  5837165.63 -1.011139e+08\n3   store channel   512  2.247451e+08  5688405.99 -1.008932e+08\n4   store channel   146  2.262509e+08  5578881.50 -1.008841e+08\n5   store channel   598  2.232035e+08  5402342.56 -1.004761e+08\n6     web channel  2738  2.721974e+07  1022337.85 -2.800719e+06\n7     web channel    37  2.776483e+07   944608.42 -2.994894e+06\n8     web channel   163  2.762435e+07   992263.01 -2.984111e+06\n9     web channel   845  2.715725e+07   432844.82 -3.170875e+06\n10    web channel  1667  2.791305e+07   420041.94 -3.278333e+06\n11    web channel   611  2.718827e+07   448496.92 -3.296062e+06\n12    web channel  1802  2.718868e+07   914583.45 -3.429422e+06\n13    web channel  1238  2.738158e+07   957467.61 -3.131751e+06\n14    web channel  2618  2.767263e+07   830004.74 -3.224953e+06\n15    web channel   629  2.695614e+07   391778.35 -3.105363e+06\n16  store channel   560  2.251821e+08  5265085.05 -1.014575e+08\n17  store channel   355  2.233078e+08  5433419.32 -9.968796e+07\n18    web channel  1703  2.698726e+07   346939.67 -2.606438e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from results\n )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS ) LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   727  2.254772e+08  5499887.58 -1.012002e+08\n1   store channel   350  2.253872e+08  5461759.57 -1.015375e+08\n2   store channel    28  2.254473e+08  5476924.39 -1.008314e+08\n3   store channel   229  2.266408e+08  5667519.20 -1.022489e+08\n4   store channel   634  2.249304e+08  5752643.15 -1.013417e+08\n5     web channel  1898  2.666473e+07  1013512.13 -3.334153e+06\n6     web channel  1658  2.705895e+07   965665.77 -3.169946e+06\n7     web channel  2582  2.794998e+07   898894.05 -3.245590e+06\n8     web channel   608  2.718970e+07   961334.91 -3.612941e+06\n9     web channel     5  2.735579e+07   406241.46 -3.034975e+06\n10    web channel  2570  2.757582e+07  1069681.88 -3.232376e+06\n11    web channel   308  2.788507e+07   923097.38 -3.207951e+06\n12    web channel  2267  2.798011e+07   391789.55 -2.820242e+06\n13    web channel  1784  2.715386e+07   736356.35 -2.830304e+06\n14    web channel   247  2.816350e+07   993425.73 -3.383265e+06\n15    web channel  2159  2.676455e+07   496253.51 -3.030540e+06\n16    web channel   530  2.748792e+07  1046211.23 -3.117761e+06\n17    web channel   127  2.718719e+07   747094.59 -3.460180e+06\n18    web channel  1361  2.812073e+07   381823.29 -3.067261e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.742933,
                    "execution_time": 0.535993,
                    "compile_time": 0.001066,
                    "planning_time": 0.155355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.753576,
                    "execution_time": 0.532612,
                    "compile_time": 0.001051,
                    "planning_time": 0.166924
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0   store channel   727  2.254772e+08  5499887.58 -1.012002e+08\n1   store channel   350  2.253872e+08  5461759.57 -1.015375e+08\n2   store channel    28  2.254473e+08  5476924.39 -1.008314e+08\n3   store channel   229  2.266408e+08  5667519.20 -1.022489e+08\n4   store channel   634  2.249304e+08  5752643.15 -1.013417e+08\n5     web channel  1898  2.666473e+07  1013512.13 -3.334153e+06\n6     web channel  1658  2.705895e+07   965665.77 -3.169946e+06\n7     web channel  2582  2.794998e+07   898894.05 -3.245590e+06\n8     web channel   608  2.718970e+07   961334.91 -3.612941e+06\n9     web channel     5  2.735579e+07   406241.46 -3.034975e+06\n10    web channel  2570  2.757582e+07  1069681.88 -3.232376e+06\n11    web channel   308  2.788507e+07   923097.38 -3.207951e+06\n12    web channel  2267  2.798011e+07   391789.55 -2.820242e+06\n13    web channel  1784  2.715386e+07   736356.35 -2.830304e+06\n14    web channel   247  2.816350e+07   993425.73 -3.383265e+06\n15    web channel  2159  2.676455e+07   496253.51 -3.030540e+06\n16    web channel   530  2.748792e+07  1046211.23 -3.117761e+06\n17    web channel   127  2.718719e+07   747094.59 -3.460180e+06\n18    web channel  1361  2.812073e+07   381823.29 -3.067261e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  * \n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"RETURNS\" AS \"RETURNS\" , \"_Q_0\".\"PROFIT\" AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS GROUP BY CHANNEL ) LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0     web channel   811  2.675504e+07   971673.04 -3.234923e+06\n1     web channel   770  2.759283e+07   693246.83 -2.891136e+06\n2     web channel  1574  2.623263e+07   973441.23 -3.263247e+06\n3   store channel   373  2.262795e+08  5558600.33 -1.023687e+08\n4   store channel   802  2.237868e+08  5885720.49 -1.006145e+08\n5     web channel  2378  2.735662e+07   888149.62 -3.430979e+06\n6     web channel    68  2.659708e+07   809561.18 -3.339295e+06\n7   store channel   266  2.244364e+08  5779689.47 -1.019217e+08\n8     web channel  2563  2.714510e+07   964990.67 -3.412188e+06\n9     web channel   203  2.776854e+07   426049.63 -2.715055e+06\n10    web channel  2834  2.742569e+07   858183.07 -2.893603e+06\n11    web channel   935  2.767623e+07   409396.74 -2.776737e+06\n12    web channel   254  2.811960e+07   875893.27 -3.159140e+06\n13    web channel  2243  2.682841e+07   453321.11 -3.135656e+06\n14    web channel  2083  2.712945e+07   936147.56 -3.460090e+06\n15  store channel   116  2.255006e+08  5486511.53 -1.014754e+08\n16  store channel   704  2.252973e+08  5532256.76 -1.011094e+08\n17    web channel   716  2.741020e+07  1072631.43 -3.111510e+06\n18    web channel   349  2.702130e+07   941386.00 -3.495053e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.442464,
                    "execution_time": 0.870766,
                    "compile_time": 0.003146,
                    "planning_time": 1.297604
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.595693,
                    "execution_time": 0.892554,
                    "compile_time": 0.03242,
                    "planning_time": 1.434281
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0     web channel   811  2.675504e+07   971673.04 -3.234923e+06\n1     web channel   770  2.759283e+07   693246.83 -2.891136e+06\n2     web channel  1574  2.623263e+07   973441.23 -3.263247e+06\n3   store channel   373  2.262795e+08  5558600.33 -1.023687e+08\n4   store channel   802  2.237868e+08  5885720.49 -1.006145e+08\n5     web channel  2378  2.735662e+07   888149.62 -3.430979e+06\n6     web channel    68  2.659708e+07   809561.18 -3.339295e+06\n7   store channel   266  2.244364e+08  5779689.47 -1.019217e+08\n8     web channel  2563  2.714510e+07   964990.67 -3.412188e+06\n9     web channel   203  2.776854e+07   426049.63 -2.715055e+06\n10    web channel  2834  2.742569e+07   858183.07 -2.893603e+06\n11    web channel   935  2.767623e+07   409396.74 -2.776737e+06\n12    web channel   254  2.811960e+07   875893.27 -3.159140e+06\n13    web channel  2243  2.682841e+07   453321.11 -3.135656e+06\n14    web channel  2083  2.712945e+07   936147.56 -3.460090e+06\n15  store channel   116  2.255006e+08  5486511.53 -1.014754e+08\n16  store channel   704  2.252973e+08  5532256.76 -1.011094e+08\n17    web channel   716  2.741020e+07  1072631.43 -3.111510e+06\n18    web channel   349  2.702130e+07   941386.00 -3.495053e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel\n union\n select 'total' as channel, NULL as id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from results\n) /*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT 'total' AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"RETURNS\" AS \"RETURNS\" , \"_Q_0\".\"PROFIT\" AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS GROUP BY CHANNEL UNION SELECT 'total' AS CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS ) LIMIT 21",
                "preview": "\n/*          channel    id         sales     returns        profit\n0     web channel  1754  2.643656e+07  1029045.20 -3.510912e+06\n1     web channel  2066  2.784351e+07  1032262.51 -3.496336e+06\n2     web channel   533  2.679193e+07   368069.08 -2.948393e+06\n3     web channel  1019  2.708559e+07   455497.73 -3.194370e+06\n4   store channel    46  2.246231e+08  5497651.99 -1.003850e+08\n5     web channel  1253  2.733865e+07   406525.12 -2.942484e+06\n6     web channel  1286  2.669217e+07   969778.11 -3.032396e+06\n7     web channel  1949  2.733265e+07   395688.21 -3.250014e+06\n8     web channel   389  2.751641e+07   369398.81 -3.285716e+06\n9     web channel  1193  2.741592e+07   470923.67 -3.167198e+06\n10    web channel  2431  2.753349e+07   885080.09 -3.172145e+06\n11  store channel   157  2.186448e+08  5648302.61 -9.810239e+07\n12    web channel   181  2.787264e+07   905307.13 -2.828238e+06\n13    web channel  1721  2.735566e+07   421036.42 -2.809440e+06\n14    web channel  2959  2.740071e+07   894184.80 -3.222934e+06\n15    web channel   649  2.673909e+07   965928.50 -3.620558e+06\n16    web channel  2894  2.764520e+07  1078418.17 -3.237810e+06\n17    web channel  2474  2.752613e+07  1001064.88 -3.667000e+06\n18  store channel    14  2.250662e+08  5697922.50 -1.011722e+08\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.729043,
                    "execution_time": 0.958417,
                    "compile_time": 0.003715,
                    "planning_time": 1.537931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.851422,
                    "execution_time": 0.972917,
                    "compile_time": 0.017225,
                    "planning_time": 1.65212
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*          channel    id         sales     returns        profit\n0     web channel  1754  2.643656e+07  1029045.20 -3.510912e+06\n1     web channel  2066  2.784351e+07  1032262.51 -3.496336e+06\n2     web channel   533  2.679193e+07   368069.08 -2.948393e+06\n3     web channel  1019  2.708559e+07   455497.73 -3.194370e+06\n4   store channel    46  2.246231e+08  5497651.99 -1.003850e+08\n5     web channel  1253  2.733865e+07   406525.12 -2.942484e+06\n6     web channel  1286  2.669217e+07   969778.11 -3.032396e+06\n7     web channel  1949  2.733265e+07   395688.21 -3.250014e+06\n8     web channel   389  2.751641e+07   369398.81 -3.285716e+06\n9     web channel  1193  2.741592e+07   470923.67 -3.167198e+06\n10    web channel  2431  2.753349e+07   885080.09 -3.172145e+06\n11  store channel   157  2.186448e+08  5648302.61 -9.810239e+07\n12    web channel   181  2.787264e+07   905307.13 -2.828238e+06\n13    web channel  1721  2.735566e+07   421036.42 -2.809440e+06\n14    web channel  2959  2.740071e+07   894184.80 -3.222934e+06\n15    web channel   649  2.673909e+07   965928.50 -3.620558e+06\n16    web channel  2894  2.764520e+07  1078418.17 -3.237810e+06\n17    web channel  2474  2.752613e+07  1001064.88 -3.667000e+06\n18  store channel    14  2.250662e+08  5697922.50 -1.011722e+08\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel\n union\n select NULL AS channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"RETURNS\" AS \"RETURNS\" , \"_Q_0\".\"PROFIT\" AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS ) LIMIT 21",
                "preview": "\n/*            channel    id         sales       returns        profit\n0     store channel   385  2.255799e+08  5.460939e+06 -1.000162e+08\n1       web channel  2419  2.708063e+07  8.957044e+05 -3.208080e+06\n2       web channel   140  2.642300e+07  9.961310e+05 -3.610840e+06\n3       web channel   680  2.703725e+07  9.217076e+05 -3.137539e+06\n4     store channel   938  2.243303e+08  5.527878e+06 -1.019722e+08\n5   catalog channel    29  1.123220e+11  2.068071e+09 -1.250782e+10\n6       web channel  1891  2.708649e+07  8.810049e+05 -3.303859e+06\n7       web channel  2576  2.751920e+07  1.028065e+06 -3.179237e+06\n8     store channel   907  2.263117e+08  5.640699e+06 -1.005662e+08\n9       web channel  2483  2.730639e+07  4.425446e+05 -2.945109e+06\n10      web channel  2935  2.753388e+07  8.579498e+05 -2.953806e+06\n11      web channel  1517  2.765532e+07  3.396335e+05 -2.528288e+06\n12      web channel   188  2.671373e+07  9.030008e+05 -3.203604e+06\n13      web channel  2623  2.745362e+07  8.948381e+05 -3.319085e+06\n14      web channel  1142  2.735349e+07  9.222585e+05 -3.286954e+06\n15      web channel  1411  2.693046e+07  1.015926e+06 -3.318868e+06\n16      web channel  2051  2.728059e+07  3.761136e+05 -3.110551e+06\n17      web channel   293  2.679233e+07  3.807972e+05 -3.351798e+06\n18      web channel  1561  2.675466e+07  9.624788e+05 -3.063836e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.758046,
                    "execution_time": 0.979258,
                    "compile_time": 0.003736,
                    "planning_time": 1.564297
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.817985,
                    "execution_time": 0.955832,
                    "compile_time": 0.004474,
                    "planning_time": 1.62735
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel    id         sales       returns        profit\n0     store channel   385  2.255799e+08  5.460939e+06 -1.000162e+08\n1       web channel  2419  2.708063e+07  8.957044e+05 -3.208080e+06\n2       web channel   140  2.642300e+07  9.961310e+05 -3.610840e+06\n3       web channel   680  2.703725e+07  9.217076e+05 -3.137539e+06\n4     store channel   938  2.243303e+08  5.527878e+06 -1.019722e+08\n5   catalog channel    29  1.123220e+11  2.068071e+09 -1.250782e+10\n6       web channel  1891  2.708649e+07  8.810049e+05 -3.303859e+06\n7       web channel  2576  2.751920e+07  1.028065e+06 -3.179237e+06\n8     store channel   907  2.263117e+08  5.640699e+06 -1.005662e+08\n9       web channel  2483  2.730639e+07  4.425446e+05 -2.945109e+06\n10      web channel  2935  2.753388e+07  8.579498e+05 -2.953806e+06\n11      web channel  1517  2.765532e+07  3.396335e+05 -2.528288e+06\n12      web channel   188  2.671373e+07  9.030008e+05 -3.203604e+06\n13      web channel  2623  2.745362e+07  8.948381e+05 -3.319085e+06\n14      web channel  1142  2.735349e+07  9.222585e+05 -3.286954e+06\n15      web channel  1411  2.693046e+07  1.015926e+06 -3.318868e+06\n16      web channel  2051  2.728059e+07  3.761136e+05 -3.110551e+06\n17      web channel   293  2.679233e+07  3.807972e+05 -3.351798e+06\n18      web channel  1561  2.675466e+07  9.624788e+05 -3.063836e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel\n union\n select NULL AS channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results\n) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"CHANNEL\" AS \"CHANNEL\" , \"FOO\".\"ID\" AS \"ID\" , \"FOO\".\"SALES\" AS \"SALES\" , \"FOO\".\"RETURNS\" AS \"RETURNS\" , \"FOO\".\"PROFIT\" AS \"PROFIT\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS ) AS FOO LIMIT 21",
                "preview": "\n/*            channel    id         sales       returns        profit\n0       web channel   983  2.658339e+07  4.228171e+05 -3.110360e+06\n1       web channel  2153  2.668552e+07  4.252899e+05 -3.292379e+06\n2     store channel   778  2.233026e+08  5.665080e+06 -1.005061e+08\n3   catalog channel     1  1.117677e+11  2.068071e+09 -1.230843e+10\n4     store channel   410  2.222382e+08  5.749886e+06 -1.008011e+08\n5       web channel  2873  2.723692e+07  4.453876e+05 -3.221305e+06\n6       web channel  2725  2.716624e+07  9.359655e+05 -3.317030e+06\n7       web channel  2147  2.688233e+07  4.303443e+05 -3.323472e+06\n8       web channel  1655  2.786113e+07  4.397607e+05 -3.038875e+06\n9       web channel  2477  2.697706e+07  3.975847e+05 -3.333726e+06\n10    store channel     8  2.234808e+08  5.562027e+06 -1.000170e+08\n11    store channel   112  2.285648e+08  5.526580e+06 -1.030372e+08\n12      web channel  1547  2.761436e+07  4.904209e+05 -3.043048e+06\n13      web channel   578  2.769801e+07  9.249695e+05 -3.035094e+06\n14      web channel  2377  2.617141e+07  9.101985e+05 -3.772826e+06\n15      web channel  2011  2.635225e+07  9.906321e+05 -3.033481e+06\n16    store channel   524  2.225537e+08  5.808742e+06 -9.957390e+07\n17    store channel   529  2.263843e+08  5.631281e+06 -1.023216e+08\n18      web channel  2749  2.682633e+07  1.035092e+06 -3.388418e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.729304,
                    "execution_time": 0.957393,
                    "compile_time": 0.003758,
                    "planning_time": 1.536627
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.834308,
                    "execution_time": 0.965324,
                    "compile_time": 0.00373,
                    "planning_time": 1.642564
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel    id         sales       returns        profit\n0       web channel   983  2.658339e+07  4.228171e+05 -3.110360e+06\n1       web channel  2153  2.668552e+07  4.252899e+05 -3.292379e+06\n2     store channel   778  2.233026e+08  5.665080e+06 -1.005061e+08\n3   catalog channel     1  1.117677e+11  2.068071e+09 -1.230843e+10\n4     store channel   410  2.222382e+08  5.749886e+06 -1.008011e+08\n5       web channel  2873  2.723692e+07  4.453876e+05 -3.221305e+06\n6       web channel  2725  2.716624e+07  9.359655e+05 -3.317030e+06\n7       web channel  2147  2.688233e+07  4.303443e+05 -3.323472e+06\n8       web channel  1655  2.786113e+07  4.397607e+05 -3.038875e+06\n9       web channel  2477  2.697706e+07  3.975847e+05 -3.333726e+06\n10    store channel     8  2.234808e+08  5.562027e+06 -1.000170e+08\n11    store channel   112  2.285648e+08  5.526580e+06 -1.030372e+08\n12      web channel  1547  2.761436e+07  4.904209e+05 -3.043048e+06\n13      web channel   578  2.769801e+07  9.249695e+05 -3.035094e+06\n14      web channel  2377  2.617141e+07  9.101985e+05 -3.772826e+06\n15      web channel  2011  2.635225e+07  9.906321e+05 -3.033481e+06\n16    store channel   524  2.225537e+08  5.808742e+06 -9.957390e+07\n17    store channel   529  2.263843e+08  5.631281e+06 -1.023216e+08\n18      web channel  2749  2.682633e+07  1.035092e+06 -3.388418e+06\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel\n union\n select NULL AS channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results\n) foo\norder by channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"CHANNEL\" AS \"CHANNEL\" , \"FOO\".\"ID\" AS \"ID\" , \"FOO\".\"SALES\" AS \"SALES\" , \"FOO\".\"RETURNS\" AS \"RETURNS\" , \"FOO\".\"PROFIT\" AS \"PROFIT\" FROM \"FOO\" AS \"FOO\" ORDER BY \"FOO\".\"CHANNEL\" NULLS LAST , \"FOO\".\"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS ) AS FOO ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel    id         sales       returns        profit\n0              None   NaN  2.511778e+12  4.944189e+10 -3.183603e+11\n1   catalog channel   NaN  2.357734e+12  4.549756e+10 -2.628525e+11\n2   catalog channel   NaN  3.025787e+09  2.068071e+09 -1.807222e+09\n3   catalog channel   1.0  1.117677e+11  2.068071e+09 -1.230843e+10\n4   catalog channel   2.0  1.124598e+11  2.068071e+09 -1.230098e+10\n5   catalog channel   5.0  1.121806e+11  2.068071e+09 -1.254112e+10\n6   catalog channel   7.0  1.118066e+11  2.068071e+09 -1.242048e+10\n7   catalog channel   8.0  1.121242e+11  2.068071e+09 -1.240345e+10\n8   catalog channel  11.0  1.124947e+11  2.068071e+09 -1.246812e+10\n9   catalog channel  13.0  1.119693e+11  2.068071e+09 -1.227272e+10\n10  catalog channel  14.0  1.119016e+11  2.068071e+09 -1.238481e+10\n11  catalog channel  17.0  1.116380e+11  2.068071e+09 -1.246555e+10\n12  catalog channel  19.0  1.122321e+11  2.068071e+09 -1.255202e+10\n13  catalog channel  20.0  1.120734e+11  2.068071e+09 -1.247479e+10\n14  catalog channel  23.0  1.124069e+11  2.068071e+09 -1.247475e+10\n15  catalog channel  25.0  1.122557e+11  2.068071e+09 -1.243274e+10\n16  catalog channel  26.0  1.124460e+11  2.068071e+09 -1.242512e+10\n17  catalog channel  29.0  1.123220e+11  2.068071e+09 -1.250782e+10\n18  catalog channel  31.0  1.121909e+11  2.068071e+09 -1.243566e+10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.863831,
                    "execution_time": 1.074912,
                    "compile_time": 0.003861,
                    "planning_time": 1.664585
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.873189,
                    "execution_time": 0.993431,
                    "compile_time": 0.00825,
                    "planning_time": 1.668479
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel    id         sales       returns        profit\n0              None   NaN  2.511778e+12  4.944189e+10 -3.183603e+11\n1   catalog channel   NaN  2.357734e+12  4.549756e+10 -2.628525e+11\n2   catalog channel   NaN  3.025787e+09  2.068071e+09 -1.807222e+09\n3   catalog channel   1.0  1.117677e+11  2.068071e+09 -1.230843e+10\n4   catalog channel   2.0  1.124598e+11  2.068071e+09 -1.230098e+10\n5   catalog channel   5.0  1.121806e+11  2.068071e+09 -1.254112e+10\n6   catalog channel   7.0  1.118066e+11  2.068071e+09 -1.242048e+10\n7   catalog channel   8.0  1.121242e+11  2.068071e+09 -1.240345e+10\n8   catalog channel  11.0  1.124947e+11  2.068071e+09 -1.246812e+10\n9   catalog channel  13.0  1.119693e+11  2.068071e+09 -1.227272e+10\n10  catalog channel  14.0  1.119016e+11  2.068071e+09 -1.238481e+10\n11  catalog channel  17.0  1.116380e+11  2.068071e+09 -1.246555e+10\n12  catalog channel  19.0  1.122321e+11  2.068071e+09 -1.255202e+10\n13  catalog channel  20.0  1.120734e+11  2.068071e+09 -1.247479e+10\n14  catalog channel  23.0  1.124069e+11  2.068071e+09 -1.247475e+10\n15  catalog channel  25.0  1.122557e+11  2.068071e+09 -1.243274e+10\n16  catalog channel  26.0  1.124460e+11  2.068071e+09 -1.242512e+10\n17  catalog channel  29.0  1.123220e+11  2.068071e+09 -1.250782e+10\n18  catalog channel  31.0  1.121909e+11  2.068071e+09 -1.243566e+10\n...*/"
    },
    {
        "input": "-- start template query77a.tpl query 78 in stream 0\nwith /* TPC-DS query77a.tpl 0.78 */ ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date) \n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n group by cr_call_center_sk), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2000-08-02' as date)\n                  and dateadd(day,30,cast('2000-08-02' as date))  \n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel\n union\n select NULL AS channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results\n) foo\norder by channel, id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-02' AS DATE ) ) , \"STORE_2\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" FROM \"STORE\" AS \"STORE\" ) , \"SS\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"SR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"S_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"STORE_RETURNS\".\"SR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"STORE_2\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_RETURNS\".\"SR_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CS\" AS ( SELECT \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" AS \"CS_CALL_CENTER_SK\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" ) , \"CR\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" ) AS \"RETURNS\" , SUM ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_CALL_CENTER_SK\" ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" ) , \"WS\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"WR\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"WEB_RETURNS\".\"WR_NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_RETURNS\".\"WR_WEB_PAGE_SK\" GROUP BY \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , \"SS\".\"S_STORE_SK\" AS \"ID\" , \"SS\".\"SALES\" AS \"SALES\" , COALESCE ( \"SR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"SS\".\"PROFIT\" - COALESCE ( \"SR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"SS\" AS \"SS\" LEFT JOIN \"SR\" AS \"SR\" ON \"SR\".\"S_STORE_SK\" = \"SS\".\"S_STORE_SK\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , \"CS\".\"CS_CALL_CENTER_SK\" AS \"ID\" , \"CS\".\"SALES\" AS \"SALES\" , \"CR\".\"RETURNS\" AS \"RETURNS\" , \"CS\".\"PROFIT\" - \"CR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CS\" AS \"CS\" CROSS JOIN \"CR\" AS \"CR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , \"WS\".\"WP_WEB_PAGE_SK\" AS \"ID\" , \"WS\".\"SALES\" AS \"SALES\" , COALESCE ( \"WR\".\"RETURNS\" , 0 ) AS \"RETURNS\" , \"WS\".\"PROFIT\" - COALESCE ( \"WR\".\"PROFIT_LOSS\" , 0 ) AS \"PROFIT\" FROM \"WS\" AS \"WS\" LEFT JOIN \"WR\" AS \"WR\" ON \"WR\".\"WP_WEB_PAGE_SK\" = \"WS\".\"WP_WEB_PAGE_SK\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"CHANNEL\" AS \"CHANNEL\" , \"FOO\".\"ID\" AS \"ID\" , \"FOO\".\"SALES\" AS \"SALES\" , \"FOO\".\"RETURNS\" AS \"RETURNS\" , \"FOO\".\"PROFIT\" AS \"PROFIT\" FROM \"FOO\" AS \"FOO\" ORDER BY \"FOO\".\"CHANNEL\" NULLS LAST , \"FOO\".\"ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SS AS ( SELECT S_STORE_SK , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , SR AS ( SELECT S_STORE_SK , SUM ( SR_RETURN_AMT ) AS RETURNS , SUM ( SR_NET_LOSS ) AS PROFIT_LOSS FROM STORE_RETURNS , DATE_DIM , STORE WHERE SR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND SR_STORE_SK = S_STORE_SK GROUP BY S_STORE_SK ) , CS AS ( SELECT CS_CALL_CENTER_SK , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( CS_NET_PROFIT ) AS PROFIT FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CS_CALL_CENTER_SK ) , CR AS ( SELECT CR_CALL_CENTER_SK , SUM ( CR_RETURN_AMOUNT ) AS RETURNS , SUM ( CR_NET_LOSS ) AS PROFIT_LOSS FROM CATALOG_RETURNS , DATE_DIM WHERE CR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) GROUP BY CR_CALL_CENTER_SK ) , WS AS ( SELECT WP_WEB_PAGE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( WS_NET_PROFIT ) AS PROFIT FROM WEB_SALES , DATE_DIM , WEB_PAGE WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WS_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , WR AS ( SELECT WP_WEB_PAGE_SK , SUM ( WR_RETURN_AMT ) AS RETURNS , SUM ( WR_NET_LOSS ) AS PROFIT_LOSS FROM WEB_RETURNS , DATE_DIM , WEB_PAGE WHERE WR_RETURNED_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-02' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-02' AS DATE ) ) AND WR_WEB_PAGE_SK = WP_WEB_PAGE_SK GROUP BY WP_WEB_PAGE_SK ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , SS.S_STORE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM SS LEFT JOIN SR ON SS.S_STORE_SK = SR.S_STORE_SK UNION ALL SELECT 'catalog channel' AS CHANNEL , CS_CALL_CENTER_SK AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CS , CR UNION ALL SELECT 'web channel' AS CHANNEL , WS.WP_WEB_PAGE_SK AS ID , SALES , COALESCE ( RETURNS , 0 ) AS RETURNS , ( PROFIT - COALESCE ( PROFIT_LOSS , 0 ) ) AS PROFIT FROM WS LEFT JOIN WR ON WS.WP_WEB_PAGE_SK = WR.WP_WEB_PAGE_SK ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM RESULTS ) AS FOO ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel    id         sales       returns        profit\n0              None   NaN  2.511778e+12  4.944189e+10 -3.183603e+11\n1   catalog channel   NaN  2.357734e+12  4.549756e+10 -2.628525e+11\n2   catalog channel   NaN  3.025787e+09  2.068071e+09 -1.807222e+09\n3   catalog channel   1.0  1.117677e+11  2.068071e+09 -1.230843e+10\n4   catalog channel   2.0  1.124598e+11  2.068071e+09 -1.230098e+10\n5   catalog channel   5.0  1.121806e+11  2.068071e+09 -1.254112e+10\n6   catalog channel   7.0  1.118066e+11  2.068071e+09 -1.242048e+10\n7   catalog channel   8.0  1.121242e+11  2.068071e+09 -1.240345e+10\n8   catalog channel  11.0  1.124947e+11  2.068071e+09 -1.246812e+10\n9   catalog channel  13.0  1.119693e+11  2.068071e+09 -1.227272e+10\n10  catalog channel  14.0  1.119016e+11  2.068071e+09 -1.238481e+10\n11  catalog channel  17.0  1.116380e+11  2.068071e+09 -1.246555e+10\n12  catalog channel  19.0  1.122321e+11  2.068071e+09 -1.255202e+10\n13  catalog channel  20.0  1.120734e+11  2.068071e+09 -1.247479e+10\n14  catalog channel  23.0  1.124069e+11  2.068071e+09 -1.247475e+10\n15  catalog channel  25.0  1.122557e+11  2.068071e+09 -1.243274e+10\n16  catalog channel  26.0  1.124460e+11  2.068071e+09 -1.242512e+10\n17  catalog channel  29.0  1.123220e+11  2.068071e+09 -1.250782e+10\n18  catalog channel  31.0  1.121909e+11  2.068071e+09 -1.243566e+10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.736336,
                    "execution_time": 0.960221,
                    "compile_time": 0.003862,
                    "planning_time": 1.542821
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.758716,
                    "execution_time": 0.978182,
                    "compile_time": 0.003777,
                    "planning_time": 1.561502
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel    id         sales       returns        profit\n0              None   NaN  2.511778e+12  4.944189e+10 -3.183603e+11\n1   catalog channel   NaN  2.357734e+12  4.549756e+10 -2.628525e+11\n2   catalog channel   NaN  3.025787e+09  2.068071e+09 -1.807222e+09\n3   catalog channel   1.0  1.117677e+11  2.068071e+09 -1.230843e+10\n4   catalog channel   2.0  1.124598e+11  2.068071e+09 -1.230098e+10\n5   catalog channel   5.0  1.121806e+11  2.068071e+09 -1.254112e+10\n6   catalog channel   7.0  1.118066e+11  2.068071e+09 -1.242048e+10\n7   catalog channel   8.0  1.121242e+11  2.068071e+09 -1.240345e+10\n8   catalog channel  11.0  1.124947e+11  2.068071e+09 -1.246812e+10\n9   catalog channel  13.0  1.119693e+11  2.068071e+09 -1.227272e+10\n10  catalog channel  14.0  1.119016e+11  2.068071e+09 -1.238481e+10\n11  catalog channel  17.0  1.116380e+11  2.068071e+09 -1.246555e+10\n12  catalog channel  19.0  1.122321e+11  2.068071e+09 -1.255202e+10\n13  catalog channel  20.0  1.120734e+11  2.068071e+09 -1.247479e+10\n14  catalog channel  23.0  1.124069e+11  2.068071e+09 -1.247475e+10\n15  catalog channel  25.0  1.122557e+11  2.068071e+09 -1.243274e+10\n16  catalog channel  26.0  1.124460e+11  2.068071e+09 -1.242512e+10\n17  catalog channel  29.0  1.123220e+11  2.068071e+09 -1.250782e+10\n18  catalog channel  31.0  1.121909e+11  2.068071e+09 -1.243566e+10\n...*/"
    }
]