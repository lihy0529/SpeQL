[
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.489097,
                    "execution_time": 0.318237,
                    "compile_time": 0.000251,
                    "planning_time": 0.023407,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.558019,
                    "execution_time": 0.321916,
                    "compile_time": 0.003249,
                    "planning_time": 0.0835,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117468,
                    "execution_time": 0.043796,
                    "compile_time": 0.000245,
                    "planning_time": 0.023693,
                    "create_size": 576
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.183181,
                    "execution_time": 0.045992,
                    "compile_time": 0.001098,
                    "planning_time": 0.085273,
                    "create_size": 576
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 21.739844,
                    "execution_time": 21.629751,
                    "compile_time": 0.000436,
                    "planning_time": 0.029464,
                    "create_size": 385
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 45.190536,
                    "execution_time": 44.998973,
                    "compile_time": 0.006684,
                    "planning_time": 0.09113,
                    "create_size": 385
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.204865,
                    "execution_time": 5.118088,
                    "compile_time": 0.000427,
                    "planning_time": 0.029917,
                    "create_size": 220
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.823178,
                    "execution_time": 11.668069,
                    "compile_time": 0.002257,
                    "planning_time": 0.094149,
                    "create_size": 220
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   McLean County    1998              0.1561                1.0458              1.1278                1.0203\n1   McLean County    1998              0.1561                1.0055              1.1278                1.0612\n2   McLean County    1998              0.1561                1.8922              1.1278                0.5639\n3   McLean County    1998              0.1561                1.0128              1.1278                1.0535\n4   McLean County    1998              0.1561                1.0875              1.1278                0.9811\n5   McLean County    1998              0.1561                0.0818              1.1278               13.0409\n6   McLean County    1998              0.1561                1.0089              1.1278                1.0576\n7   McLean County    1998              0.1561                1.0000              1.1278                1.0670\n8   McLean County    1998              0.1561                1.8993              1.1278                0.5618\n9   McLean County    1998              0.1561                1.0185              1.1278                1.0476\n10  McLean County    1998              0.1561                1.0860              1.1278                0.9825\n11  McLean County    1998              0.1561                3.1020              1.1278                0.3439\n12  McLean County    1998              0.1561                3.0880              1.1278                0.3455\n13  McLean County    1998              0.1561                1.8893              1.1278                0.5647\n14  McLean County    1998              0.1561                1.8964              1.1278                0.5626\n15  McLean County    1998              0.1561                1.0139              1.1278                1.0524\n16  McLean County    1998              0.1561                3.0901              1.1278                0.3453\n17  McLean County    1998              0.1561                1.0892              1.1278                0.9796\n18  McLean County    1998              0.1561                1.8659              1.1278                0.5718\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.110411,
                    "execution_time": 0.048763,
                    "compile_time": 0.036568,
                    "planning_time": 0.011636
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.391774,
                    "execution_time": 0.246083,
                    "compile_time": 3.079561,
                    "planning_time": 0.0471
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   McLean County    1998              0.1561                1.0458              1.1278                1.0203\n1   McLean County    1998              0.1561                1.0055              1.1278                1.0612\n2   McLean County    1998              0.1561                1.8922              1.1278                0.5639\n3   McLean County    1998              0.1561                1.0128              1.1278                1.0535\n4   McLean County    1998              0.1561                1.0875              1.1278                0.9811\n5   McLean County    1998              0.1561                0.0818              1.1278               13.0409\n6   McLean County    1998              0.1561                1.0089              1.1278                1.0576\n7   McLean County    1998              0.1561                1.0000              1.1278                1.0670\n8   McLean County    1998              0.1561                1.8993              1.1278                0.5618\n9   McLean County    1998              0.1561                1.0185              1.1278                1.0476\n10  McLean County    1998              0.1561                1.0860              1.1278                0.9825\n11  McLean County    1998              0.1561                3.1020              1.1278                0.3439\n12  McLean County    1998              0.1561                3.0880              1.1278                0.3455\n13  McLean County    1998              0.1561                1.8893              1.1278                0.5647\n14  McLean County    1998              0.1561                1.8964              1.1278                0.5626\n15  McLean County    1998              0.1561                1.0139              1.1278                1.0524\n16  McLean County    1998              0.1561                3.0901              1.1278                0.3453\n17  McLean County    1998              0.1561                1.0892              1.1278                0.9796\n18  McLean County    1998              0.1561                1.8659              1.1278                0.5718\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Langlade County    1998              5.5842                1.0582              0.1646                3.0882\n1     Langlade County    1998              5.5842                1.0144              0.1646                3.2215\n2     Langlade County    1998              5.5842                1.0051              0.1646                3.2513\n3     Langlade County    1998              5.5842                0.9709              0.1646                3.3657\n4     Langlade County    1998              5.5842                1.0061              0.1646                3.2479\n5       Nelson County    1998              5.5842                1.0097              0.1646                1.0599\n6       Nelson County    1998              5.5842                1.0143              0.1646                1.0551\n7       Nelson County    1998              5.5842                1.0086              0.1646                1.0611\n8       Nelson County    1998              5.5842                1.0249              0.1646                1.0441\n9       Nelson County    1998              5.5842                1.0042              0.1646                1.0657\n10       Dawes County    1998              5.5842                1.0291              0.1646                3.2428\n11       Dawes County    1998              5.5842                1.0124              0.1646                3.2963\n12       Dawes County    1998              5.5842                0.9740              0.1646                3.4263\n13       Dawes County    1998              5.5842                0.9985              0.1646                3.3422\n14       Dawes County    1998              5.5842                0.9997              0.1646                3.3383\n15    Comanche County    1998              5.5842                1.0227              0.1646                1.0664\n16    Comanche County    1998              5.5842                1.0315              0.1646                1.0572\n17    Comanche County    1998              5.5842                1.0315              0.1646                1.0572\n18    Comanche County    1998              5.5842                0.9994              0.1646                1.0912\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.072922,
                    "execution_time": 0.047423,
                    "compile_time": 0.000283,
                    "planning_time": 0.011716
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.33047,
                    "execution_time": 0.1738,
                    "compile_time": 0.089942,
                    "planning_time": 0.047778
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Langlade County    1998              5.5842                1.0582              0.1646                3.0882\n1     Langlade County    1998              5.5842                1.0144              0.1646                3.2215\n2     Langlade County    1998              5.5842                1.0051              0.1646                3.2513\n3     Langlade County    1998              5.5842                0.9709              0.1646                3.3657\n4     Langlade County    1998              5.5842                1.0061              0.1646                3.2479\n5       Nelson County    1998              5.5842                1.0097              0.1646                1.0599\n6       Nelson County    1998              5.5842                1.0143              0.1646                1.0551\n7       Nelson County    1998              5.5842                1.0086              0.1646                1.0611\n8       Nelson County    1998              5.5842                1.0249              0.1646                1.0441\n9       Nelson County    1998              5.5842                1.0042              0.1646                1.0657\n10       Dawes County    1998              5.5842                1.0291              0.1646                3.2428\n11       Dawes County    1998              5.5842                1.0124              0.1646                3.2963\n12       Dawes County    1998              5.5842                0.9740              0.1646                3.4263\n13       Dawes County    1998              5.5842                0.9985              0.1646                3.3422\n14       Dawes County    1998              5.5842                0.9997              0.1646                3.3383\n15    Comanche County    1998              5.5842                1.0227              0.1646                1.0664\n16    Comanche County    1998              5.5842                1.0315              0.1646                1.0572\n17    Comanche County    1998              5.5842                1.0315              0.1646                1.0572\n18    Comanche County    1998              5.5842                0.9994              0.1646                1.0912\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0             Suffolk County    1998              6.4032                1.0161               0.179                1.5673\n1                Kent County    1998              6.4032                0.9865               0.179                0.6501\n2           Box Elder County    1998              6.4032                0.9957               0.179                2.9625\n3            McDowell County    1998              6.4032                1.0446               0.179                1.5434\n4            Lampasas County    1998              6.4032                1.0610               0.179                3.2120\n5   Lake of the Woods County    1998              6.4032                1.0555               0.179                3.0627\n6               Moody County    1998              6.4032                1.0474               0.179                3.1663\n7              Bladen County    1998              6.4032                0.9841               0.179                3.1269\n8               Bowie County    1998              6.4032                1.0274               0.179                3.1691\n9          Des Moines County    1998              6.4032                1.0507               0.179                3.1441\n10            Gratiot County    1998              6.4032                1.0440               0.179                3.2066\n11             Cherry County    1998              6.4032                0.9807               0.179                3.1139\n12            Telfair County    1998              6.4032                1.0829               0.179                3.1433\n13         Tallapoosa County    1998              6.4032                1.0620               0.179                3.2908\n14           Phillips County    1998              6.4032                1.0187               0.179                0.7949\n15         Hood River County    1998              6.4032                0.9926               0.179                3.2174\n16             Franklin city    1998              6.4032                1.0253               0.179                2.9790\n17          San Diego County    1998              6.4032                0.9686               0.179                3.1422\n18          Nantucket County    1998              6.4032                1.0298               0.179                3.1218\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.106956,
                    "execution_time": 0.047709,
                    "compile_time": 0.032541,
                    "planning_time": 0.012565
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.181358,
                    "execution_time": 0.04841,
                    "compile_time": 3.0578,
                    "planning_time": 0.048848
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0             Suffolk County    1998              6.4032                1.0161               0.179                1.5673\n1                Kent County    1998              6.4032                0.9865               0.179                0.6501\n2           Box Elder County    1998              6.4032                0.9957               0.179                2.9625\n3            McDowell County    1998              6.4032                1.0446               0.179                1.5434\n4            Lampasas County    1998              6.4032                1.0610               0.179                3.2120\n5   Lake of the Woods County    1998              6.4032                1.0555               0.179                3.0627\n6               Moody County    1998              6.4032                1.0474               0.179                3.1663\n7              Bladen County    1998              6.4032                0.9841               0.179                3.1269\n8               Bowie County    1998              6.4032                1.0274               0.179                3.1691\n9          Des Moines County    1998              6.4032                1.0507               0.179                3.1441\n10            Gratiot County    1998              6.4032                1.0440               0.179                3.2066\n11             Cherry County    1998              6.4032                0.9807               0.179                3.1139\n12            Telfair County    1998              6.4032                1.0829               0.179                3.1433\n13         Tallapoosa County    1998              6.4032                1.0620               0.179                3.2908\n14           Phillips County    1998              6.4032                1.0187               0.179                0.7949\n15         Hood River County    1998              6.4032                0.9926               0.179                3.2174\n16             Franklin city    1998              6.4032                1.0253               0.179                2.9790\n17          San Diego County    1998              6.4032                0.9686               0.179                3.1422\n18          Nantucket County    1998              6.4032                1.0298               0.179                3.1218\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Placer County    1998              0.9194                1.0452              1.0876                1.8585\n1   Placer County    1998              0.9194                1.0452              1.0876                0.9467\n2   Placer County    1998              0.9194                1.0452              1.0876                0.9567\n3   Placer County    1998              0.9194                1.0452              1.0876                0.0661\n4   Placer County    1998              0.9194                1.0452              1.0876                0.9843\n5   Placer County    1998              0.9194                1.0452              1.0876                0.9901\n6   Placer County    1998              0.9194                1.0452              1.0876                1.8075\n7   Placer County    1998              0.9194                1.0452              1.0876                2.9665\n8   Placer County    1998              0.9194                1.0452              1.0876                2.9576\n9   Placer County    1998              0.9194                1.0452              1.0876                1.8701\n10  Placer County    1998              0.9194                1.0452              1.0876                1.0355\n11  Placer County    1998              0.9194                1.0452              1.0876                1.0000\n12  Placer County    1998              0.9194                1.0452              1.0876                1.8044\n13  Placer County    1998              0.9194                1.0452              1.0876                0.9729\n14  Placer County    1998              0.9194                1.0452              1.0876                1.8587\n15  Placer County    1998              0.9194                1.0452              1.0876                1.0553\n16  Placer County    1998              0.9194                1.0452              1.0876                2.9532\n17  Placer County    1998              0.9194                1.0452              1.0876                3.0367\n18  Placer County    1998              0.9194                1.0452              1.0876                1.0480\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.07782,
                    "execution_time": 0.050037,
                    "compile_time": 0.000303,
                    "planning_time": 0.01296
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.120282,
                    "execution_time": 0.049857,
                    "compile_time": 0.001195,
                    "planning_time": 0.048714
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Placer County    1998              0.9194                1.0452              1.0876                1.8585\n1   Placer County    1998              0.9194                1.0452              1.0876                0.9467\n2   Placer County    1998              0.9194                1.0452              1.0876                0.9567\n3   Placer County    1998              0.9194                1.0452              1.0876                0.0661\n4   Placer County    1998              0.9194                1.0452              1.0876                0.9843\n5   Placer County    1998              0.9194                1.0452              1.0876                0.9901\n6   Placer County    1998              0.9194                1.0452              1.0876                1.8075\n7   Placer County    1998              0.9194                1.0452              1.0876                2.9665\n8   Placer County    1998              0.9194                1.0452              1.0876                2.9576\n9   Placer County    1998              0.9194                1.0452              1.0876                1.8701\n10  Placer County    1998              0.9194                1.0452              1.0876                1.0355\n11  Placer County    1998              0.9194                1.0452              1.0876                1.0000\n12  Placer County    1998              0.9194                1.0452              1.0876                1.8044\n13  Placer County    1998              0.9194                1.0452              1.0876                0.9729\n14  Placer County    1998              0.9194                1.0452              1.0876                1.8587\n15  Placer County    1998              0.9194                1.0452              1.0876                1.0553\n16  Placer County    1998              0.9194                1.0452              1.0876                2.9532\n17  Placer County    1998              0.9194                1.0452              1.0876                3.0367\n18  Placer County    1998              0.9194                1.0452              1.0876                1.0480\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Pushmataha County    1998              1.9145                1.0140               0.568                1.8375\n1   Pushmataha County    1998              1.9145                1.0140               0.568                1.7534\n2   Pushmataha County    1998              1.9145                1.0140               0.568                1.8040\n3   Pushmataha County    1998              1.9145                1.0140               0.568                1.8402\n4   Pushmataha County    1998              1.9145                1.0140               0.568                1.8539\n5     McKenzie County    1998              1.9145                1.0227               0.568                1.8120\n6     McKenzie County    1998              1.9145                1.0227               0.568                1.8148\n7     McKenzie County    1998              1.9145                1.0227               0.568                1.8699\n8     McKenzie County    1998              1.9145                1.0227               0.568                1.8770\n9     McKenzie County    1998              1.9145                1.0227               0.568                1.8778\n10     Broward County    1998              1.9145                1.0067               0.568                1.8054\n11     Broward County    1998              1.9145                1.0067               0.568                1.7766\n12     Broward County    1998              1.9145                1.0067               0.568                1.7751\n13     Broward County    1998              1.9145                1.0067               0.568                1.8230\n14     Broward County    1998              1.9145                1.0067               0.568                1.8118\n15        Ware County    1998              1.9145                1.0353               0.568                1.8613\n16        Ware County    1998              1.9145                1.0353               0.568                1.8785\n17        Ware County    1998              1.9145                1.0353               0.568                1.9130\n18        Ware County    1998              1.9145                1.0353               0.568                1.9152\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.079293,
                    "execution_time": 0.050776,
                    "compile_time": 0.000418,
                    "planning_time": 0.013282
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.123942,
                    "execution_time": 0.047859,
                    "compile_time": 0.000314,
                    "planning_time": 0.049196
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Pushmataha County    1998              1.9145                1.0140               0.568                1.8375\n1   Pushmataha County    1998              1.9145                1.0140               0.568                1.7534\n2   Pushmataha County    1998              1.9145                1.0140               0.568                1.8040\n3   Pushmataha County    1998              1.9145                1.0140               0.568                1.8402\n4   Pushmataha County    1998              1.9145                1.0140               0.568                1.8539\n5     McKenzie County    1998              1.9145                1.0227               0.568                1.8120\n6     McKenzie County    1998              1.9145                1.0227               0.568                1.8148\n7     McKenzie County    1998              1.9145                1.0227               0.568                1.8699\n8     McKenzie County    1998              1.9145                1.0227               0.568                1.8770\n9     McKenzie County    1998              1.9145                1.0227               0.568                1.8778\n10     Broward County    1998              1.9145                1.0067               0.568                1.8054\n11     Broward County    1998              1.9145                1.0067               0.568                1.7766\n12     Broward County    1998              1.9145                1.0067               0.568                1.7751\n13     Broward County    1998              1.9145                1.0067               0.568                1.8230\n14     Broward County    1998              1.9145                1.0067               0.568                1.8118\n15        Ware County    1998              1.9145                1.0353               0.568                1.8613\n16        Ware County    1998              1.9145                1.0353               0.568                1.8785\n17        Ware County    1998              1.9145                1.0353               0.568                1.9130\n18        Ware County    1998              1.9145                1.0353               0.568                1.9152\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0                Idaho County    1998                 1.0                1.0192              5.5842                1.8633\n1                 Wake County    1998                 1.0                1.0690              5.5842                1.7769\n2              Henrico County    1998                 1.0                1.0336              5.5842                1.8367\n3               Oliver County    1998                 1.0                1.0353              5.5842                1.8052\n4               Blanco County    1998                 1.0                1.0252              5.5842                1.7889\n5               Custer County    1998                 1.0                1.0070              5.5842                1.8754\n6               Tunica County    1998                 1.0                1.0049              5.5842                1.8117\n7         Westmoreland County    1998                 1.0                1.0102              5.5842                1.8616\n8               Mercer County    1998                 1.0                1.0214              5.5842                1.8583\n9                Henry County    1998                 1.0                0.9975              5.5842                1.8820\n10           Sagadahoc County    1998                 1.0                1.0267              5.5842                1.8478\n11          Vermillion County    1998                 1.0                0.9768              5.5842                1.9849\n12               Rabun County    1998                 1.0                0.9768              5.5842                1.9061\n13               Anoka County    1998                 1.0                1.0826              5.5842                1.7549\n14               Dukes County    1998                 1.0                1.0292              5.5842                1.7368\n15              Norton County    1998                 1.0                0.9949              5.5842                1.9221\n16         Buena Vista County    1998                 1.0                1.0162              5.5842                1.8571\n17           Trousdale County    1998                 1.0                0.9953              5.5842                1.8964\n18  Matanuska-Susitna Borough    1998                 1.0                1.0421              5.5842                1.8121\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.078223,
                    "execution_time": 0.048678,
                    "compile_time": 0.000324,
                    "planning_time": 0.014166
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.123958,
                    "execution_time": 0.049604,
                    "compile_time": 0.002426,
                    "planning_time": 0.051199
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0                Idaho County    1998                 1.0                1.0192              5.5842                1.8633\n1                 Wake County    1998                 1.0                1.0690              5.5842                1.7769\n2              Henrico County    1998                 1.0                1.0336              5.5842                1.8367\n3               Oliver County    1998                 1.0                1.0353              5.5842                1.8052\n4               Blanco County    1998                 1.0                1.0252              5.5842                1.7889\n5               Custer County    1998                 1.0                1.0070              5.5842                1.8754\n6               Tunica County    1998                 1.0                1.0049              5.5842                1.8117\n7         Westmoreland County    1998                 1.0                1.0102              5.5842                1.8616\n8               Mercer County    1998                 1.0                1.0214              5.5842                1.8583\n9                Henry County    1998                 1.0                0.9975              5.5842                1.8820\n10           Sagadahoc County    1998                 1.0                1.0267              5.5842                1.8478\n11          Vermillion County    1998                 1.0                0.9768              5.5842                1.9849\n12               Rabun County    1998                 1.0                0.9768              5.5842                1.9061\n13               Anoka County    1998                 1.0                1.0826              5.5842                1.7549\n14               Dukes County    1998                 1.0                1.0292              5.5842                1.7368\n15              Norton County    1998                 1.0                0.9949              5.5842                1.9221\n16         Buena Vista County    1998                 1.0                1.0162              5.5842                1.8571\n17           Trousdale County    1998                 1.0                0.9953              5.5842                1.8964\n18  Matanuska-Susitna Borough    1998                 1.0                1.0421              5.5842                1.8121\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.23707,
                    "execution_time": 5.131025,
                    "compile_time": 0.000427,
                    "planning_time": 0.035385,
                    "create_size": 275
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.888967,
                    "execution_time": 5.575912,
                    "compile_time": 0.146104,
                    "planning_time": 0.094687,
                    "create_size": 275
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Suffolk County    1998              0.8436                1.0161              1.0071                1.8815\n1   Suffolk County    1998              0.2964                1.0161              1.0071                1.8815\n2   Suffolk County    1998              0.8127                1.0161              1.0071                1.8815\n3   Suffolk County    1998              0.2890                1.0161              1.0071                1.8815\n4   Suffolk County    1998              0.2925                1.0161              1.0071                1.8815\n5   Suffolk County    1998              0.9029                1.0161              1.0071                1.8815\n6   Suffolk County    1998              0.4806                1.0161              1.0071                1.8815\n7   Suffolk County    1998              0.8702                1.0161              1.0071                1.8815\n8   Suffolk County    1998              0.4798                1.0161              1.0071                1.8815\n9   Suffolk County    1998              9.7796                1.0161              1.0071                1.8815\n10  Suffolk County    1998              0.8841                1.0161              1.0071                1.8815\n11  Suffolk County    1998              0.8118                1.0161              1.0071                1.8815\n12  Suffolk County    1998              0.8540                1.0161              1.0071                1.8815\n13  Suffolk County    1998              0.4976                1.0161              1.0071                1.8815\n14  Suffolk County    1998              0.2847                1.0161              1.0071                1.8815\n15  Suffolk County    1998              0.8697                1.0161              1.0071                1.8815\n16  Suffolk County    1998              0.9723                1.0161              1.0071                1.8815\n17  Suffolk County    1998              0.8430                1.0161              1.0071                1.8815\n18  Suffolk County    1998              0.4808                1.0161              1.0071                1.8815\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.083528,
                    "execution_time": 0.050099,
                    "compile_time": 0.000377,
                    "planning_time": 0.015894
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.139338,
                    "execution_time": 0.056976,
                    "compile_time": 0.002487,
                    "planning_time": 0.051947
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Suffolk County    1998              0.8436                1.0161              1.0071                1.8815\n1   Suffolk County    1998              0.2964                1.0161              1.0071                1.8815\n2   Suffolk County    1998              0.8127                1.0161              1.0071                1.8815\n3   Suffolk County    1998              0.2890                1.0161              1.0071                1.8815\n4   Suffolk County    1998              0.2925                1.0161              1.0071                1.8815\n5   Suffolk County    1998              0.9029                1.0161              1.0071                1.8815\n6   Suffolk County    1998              0.4806                1.0161              1.0071                1.8815\n7   Suffolk County    1998              0.8702                1.0161              1.0071                1.8815\n8   Suffolk County    1998              0.4798                1.0161              1.0071                1.8815\n9   Suffolk County    1998              9.7796                1.0161              1.0071                1.8815\n10  Suffolk County    1998              0.8841                1.0161              1.0071                1.8815\n11  Suffolk County    1998              0.8118                1.0161              1.0071                1.8815\n12  Suffolk County    1998              0.8540                1.0161              1.0071                1.8815\n13  Suffolk County    1998              0.4976                1.0161              1.0071                1.8815\n14  Suffolk County    1998              0.2847                1.0161              1.0071                1.8815\n15  Suffolk County    1998              0.8697                1.0161              1.0071                1.8815\n16  Suffolk County    1998              0.9723                1.0161              1.0071                1.8815\n17  Suffolk County    1998              0.8430                1.0161              1.0071                1.8815\n18  Suffolk County    1998              0.4808                1.0161              1.0071                1.8815\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.233351,
                    "execution_time": 5.126391,
                    "compile_time": 0.000444,
                    "planning_time": 0.03194,
                    "create_size": 330
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.759098,
                    "execution_time": 5.443212,
                    "compile_time": 0.145114,
                    "planning_time": 0.09451,
                    "create_size": 330
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*           ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Suffolk County    1998              1.4222                1.0161              1.0966                1.8815\n1     Suffolk County    1998              1.5471                1.0161              1.0966                1.8815\n2     Suffolk County    1998             17.1137                1.0161              1.0966                1.8815\n3     Suffolk County    1998              1.5220                1.0161              1.0966                1.8815\n4     Suffolk County    1998              1.4762                1.0161              1.0966                1.8815\n5     Suffolk County    1998              1.4206                1.0161              1.0966                1.8815\n6        Kent County    1998              0.6329                0.9865              1.0966                1.8941\n7        Kent County    1998              0.5903                0.9865              1.0966                1.8941\n8        Kent County    1998              0.6016                0.9865              1.0966                1.8941\n9        Kent County    1998              8.4350                0.9865              1.0966                1.8941\n10       Kent County    1998              0.6244                0.9865              1.0966                1.8941\n11       Kent County    1998              0.5983                0.9865              1.0966                1.8941\n12  Box Elder County    1998              3.1378                0.9957              1.0966                1.8825\n13  Box Elder County    1998              2.5626                0.9957              1.0966                1.8825\n14  Box Elder County    1998             29.2035                0.9957              1.0966                1.8825\n15  Box Elder County    1998              2.7229                0.9957              1.0966                1.8825\n16  Box Elder County    1998              2.8542                0.9957              1.0966                1.8825\n17  Box Elder County    1998              2.9566                0.9957              1.0966                1.8825\n18   McDowell County    1998              1.5346                1.0446              1.0966                1.8393\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.083668,
                    "execution_time": 0.050026,
                    "compile_time": 0.000345,
                    "planning_time": 0.017147
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.134949,
                    "execution_time": 0.06045,
                    "compile_time": 0.004252,
                    "planning_time": 0.052882
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*           ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Suffolk County    1998              1.4222                1.0161              1.0966                1.8815\n1     Suffolk County    1998              1.5471                1.0161              1.0966                1.8815\n2     Suffolk County    1998             17.1137                1.0161              1.0966                1.8815\n3     Suffolk County    1998              1.5220                1.0161              1.0966                1.8815\n4     Suffolk County    1998              1.4762                1.0161              1.0966                1.8815\n5     Suffolk County    1998              1.4206                1.0161              1.0966                1.8815\n6        Kent County    1998              0.6329                0.9865              1.0966                1.8941\n7        Kent County    1998              0.5903                0.9865              1.0966                1.8941\n8        Kent County    1998              0.6016                0.9865              1.0966                1.8941\n9        Kent County    1998              8.4350                0.9865              1.0966                1.8941\n10       Kent County    1998              0.6244                0.9865              1.0966                1.8941\n11       Kent County    1998              0.5983                0.9865              1.0966                1.8941\n12  Box Elder County    1998              3.1378                0.9957              1.0966                1.8825\n13  Box Elder County    1998              2.5626                0.9957              1.0966                1.8825\n14  Box Elder County    1998             29.2035                0.9957              1.0966                1.8825\n15  Box Elder County    1998              2.7229                0.9957              1.0966                1.8825\n16  Box Elder County    1998              2.8542                0.9957              1.0966                1.8825\n17  Box Elder County    1998              2.9566                0.9957              1.0966                1.8825\n18   McDowell County    1998              1.5346                1.0446              1.0966                1.8393\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.25442,
                    "execution_time": 5.142337,
                    "compile_time": 0.00046,
                    "planning_time": 0.030929,
                    "create_size": 385
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.575547,
                    "execution_time": 5.392124,
                    "compile_time": 0.000451,
                    "planning_time": 0.102293,
                    "create_size": 385
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Gunnison County    1998               2.014                1.0814              0.9363                1.7359\n1   Gunnison County    1998               2.014                1.0814              1.0076                1.7359\n2   Gunnison County    1998               2.014                1.0814              1.0015                1.7359\n3   Gunnison County    1998               2.014                1.0814              1.0137                1.7359\n4   Gunnison County    1998               2.014                1.0814              0.9905                1.7359\n5   Gunnison County    1998               2.014                1.0814              1.9812                1.7359\n6   Gunnison County    1998               2.014                1.0814              4.9701                1.7359\n7   Gunnison County    1998               2.014                1.0814              2.0205                1.7359\n8   Gunnison County    1998               2.014                1.0814              3.0071                1.7359\n9   Gunnison County    1998               2.014                1.0814              0.9940                1.7359\n10  Gunnison County    1998               2.014                1.0814              7.0663                1.7359\n11  Gunnison County    1998               2.014                1.0814              1.0705                1.7359\n12  Gunnison County    1998               2.014                1.0814              0.9638                1.7359\n13  Gunnison County    1998               2.014                1.0814              0.9875                1.7359\n14  Gunnison County    1998               2.014                1.0814              1.0022                1.7359\n15  Gunnison County    1998               2.014                1.0814              0.9610                1.7359\n16  Gunnison County    1998               2.014                1.0814              1.0034                1.7359\n17  Gunnison County    1998               2.014                1.0814              0.9373                1.7359\n18  Gunnison County    1998               2.014                1.0814              0.9196                1.7359\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.096743,
                    "execution_time": 0.057893,
                    "compile_time": 0.000501,
                    "planning_time": 0.018024
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.144423,
                    "execution_time": 0.061963,
                    "compile_time": 0.005221,
                    "planning_time": 0.054818
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Gunnison County    1998               2.014                1.0814              0.9363                1.7359\n1   Gunnison County    1998               2.014                1.0814              1.0076                1.7359\n2   Gunnison County    1998               2.014                1.0814              1.0015                1.7359\n3   Gunnison County    1998               2.014                1.0814              1.0137                1.7359\n4   Gunnison County    1998               2.014                1.0814              0.9905                1.7359\n5   Gunnison County    1998               2.014                1.0814              1.9812                1.7359\n6   Gunnison County    1998               2.014                1.0814              4.9701                1.7359\n7   Gunnison County    1998               2.014                1.0814              2.0205                1.7359\n8   Gunnison County    1998               2.014                1.0814              3.0071                1.7359\n9   Gunnison County    1998               2.014                1.0814              0.9940                1.7359\n10  Gunnison County    1998               2.014                1.0814              7.0663                1.7359\n11  Gunnison County    1998               2.014                1.0814              1.0705                1.7359\n12  Gunnison County    1998               2.014                1.0814              0.9638                1.7359\n13  Gunnison County    1998               2.014                1.0814              0.9875                1.7359\n14  Gunnison County    1998               2.014                1.0814              1.0022                1.7359\n15  Gunnison County    1998               2.014                1.0814              0.9610                1.7359\n16  Gunnison County    1998               2.014                1.0814              1.0034                1.7359\n17  Gunnison County    1998               2.014                1.0814              0.9373                1.7359\n18  Gunnison County    1998               2.014                1.0814              0.9196                1.7359\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 53.648655,
                    "execution_time": 52.96007,
                    "compile_time": 0.000726,
                    "planning_time": 0.019289,
                    "create_size": 31744
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 56.983958,
                    "execution_time": 51.833313,
                    "compile_time": 4.395956,
                    "planning_time": 0.088903,
                    "create_size": 31744
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Queens County    1998              1.0171                0.9966              3.2963                1.8984\n1   Queens County    1998              1.0171                0.9966              3.3202                1.8984\n2   Queens County    1998              1.0171                0.9966              3.3433                1.8984\n3   Queens County    1998              1.0171                0.9966              3.1956                1.8984\n4   Queens County    1998              1.0171                0.9966              3.4078                1.8984\n5   Queens County    1998              1.0171                0.9966              3.2355                1.8984\n6   Queens County    1998              1.0171                0.9966              3.0741                1.8984\n7   Queens County    1998              1.0171                0.9966              3.1778                1.8984\n8   Queens County    1998              1.0171                0.9966              3.4716                1.8984\n9   Queens County    1998              1.0171                0.9966              3.1070                1.8984\n10  Queens County    1998              1.0171                0.9966              3.3450                1.8984\n11  Queens County    1998              1.0171                0.9966              3.1534                1.8984\n12  Queens County    1998              1.0171                0.9966              3.1742                1.8984\n13  Queens County    1998              1.0171                0.9966              3.2805                1.8984\n14  Queens County    1998              1.0171                0.9966              3.4097                1.8984\n15  Queens County    1998              1.0171                0.9966              3.1625                1.8984\n16  Queens County    1998              1.0171                0.9966              3.2347                1.8984\n17  Queens County    1998              1.0171                0.9966              3.1259                1.8984\n18  Queens County    1998              1.0171                0.9966              3.0807                1.8984\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019862,
                    "execution_time": 0.009875,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003724
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060002,
                    "execution_time": 0.011541,
                    "compile_time": 0.000888,
                    "planning_time": 0.039053
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Queens County    1998              1.0171                0.9966              3.2963                1.8984\n1   Queens County    1998              1.0171                0.9966              3.3202                1.8984\n2   Queens County    1998              1.0171                0.9966              3.3433                1.8984\n3   Queens County    1998              1.0171                0.9966              3.1956                1.8984\n4   Queens County    1998              1.0171                0.9966              3.4078                1.8984\n5   Queens County    1998              1.0171                0.9966              3.2355                1.8984\n6   Queens County    1998              1.0171                0.9966              3.0741                1.8984\n7   Queens County    1998              1.0171                0.9966              3.1778                1.8984\n8   Queens County    1998              1.0171                0.9966              3.4716                1.8984\n9   Queens County    1998              1.0171                0.9966              3.1070                1.8984\n10  Queens County    1998              1.0171                0.9966              3.3450                1.8984\n11  Queens County    1998              1.0171                0.9966              3.1534                1.8984\n12  Queens County    1998              1.0171                0.9966              3.1742                1.8984\n13  Queens County    1998              1.0171                0.9966              3.2805                1.8984\n14  Queens County    1998              1.0171                0.9966              3.4097                1.8984\n15  Queens County    1998              1.0171                0.9966              3.1625                1.8984\n16  Queens County    1998              1.0171                0.9966              3.2347                1.8984\n17  Queens County    1998              1.0171                0.9966              3.1259                1.8984\n18  Queens County    1998              1.0171                0.9966              3.0807                1.8984\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS2\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS2\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n1   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n2   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n3   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n4   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n5   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n6   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n7   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n8   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n9   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n10  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n11  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n12  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n13  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n14  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n15  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n16  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n17  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n18  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030512,
                    "execution_time": 0.017084,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.005665
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.239016,
                    "execution_time": 0.02058,
                    "compile_time": 0.172706,
                    "planning_time": 0.041414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS2\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n1   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n2   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n3   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n4   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n5   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n6   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n7   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n8   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n9   Queens County    1998              1.0171                0.9966              3.2401                1.8984\n10  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n11  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n12  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n13  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n14  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n15  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n16  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n17  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n18  Queens County    1998              1.0171                0.9966              3.2401                1.8984\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.426393,
                    "execution_time": 0.10566,
                    "compile_time": 0.164845,
                    "planning_time": 0.026389,
                    "create_size": 495
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.867971,
                    "execution_time": 0.10859,
                    "compile_time": 6.535755,
                    "planning_time": 0.084776,
                    "create_size": 495
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Indiana County    1998              0.9688                1.0865              0.0778                1.8035\n1          Henrico County    1998              1.0335                1.0336              0.0756                1.8367\n2            Union County    1998              1.0190                1.0225              0.0777                1.8431\n3           Harlan County    1998              1.0458                1.0013              0.0817                1.8698\n4         Johnston County    1998              1.0422                1.0343              0.0833                1.7963\n5         Buchanan County    1998              0.9903                1.0424              0.0673                1.7976\n6        McPherson County    1998              0.9682                1.0319              0.0745                1.8597\n7          Sharkey County    1998              1.0299                1.0339              0.0590                1.8646\n8             Jack County    1998              0.9559                0.9799              0.0751                1.8341\n9           Lavaca County    1998              0.9818                1.0606              0.0897                1.8143\n10         Coahoma County    1998              1.0798                1.0815              0.0759                1.8468\n11          Skagit County    1998              1.1170                1.0364              0.0666                1.8517\n12          DeSoto County    1998              1.0279                1.0652              0.0859                1.8392\n13  Cape Girardeau County    1998              1.0028                1.0835              0.0934                1.8247\n14         Kossuth County    1998              0.8887                1.0132              0.0843                1.7986\n15           Dewey County    1998              0.9547                1.0169              0.0831                1.7943\n16         Wichita County    1998              0.9399                1.0569              0.0876                1.7827\n17          Waseca County    1998              0.9999                1.0082              0.0836                1.9233\n18          Blanco County    1998              1.1034                1.0252              0.0495                1.7889\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016995,
                    "execution_time": 0.007238,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003692
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05432,
                    "execution_time": 0.008179,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038891
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Indiana County    1998              0.9688                1.0865              0.0778                1.8035\n1          Henrico County    1998              1.0335                1.0336              0.0756                1.8367\n2            Union County    1998              1.0190                1.0225              0.0777                1.8431\n3           Harlan County    1998              1.0458                1.0013              0.0817                1.8698\n4         Johnston County    1998              1.0422                1.0343              0.0833                1.7963\n5         Buchanan County    1998              0.9903                1.0424              0.0673                1.7976\n6        McPherson County    1998              0.9682                1.0319              0.0745                1.8597\n7          Sharkey County    1998              1.0299                1.0339              0.0590                1.8646\n8             Jack County    1998              0.9559                0.9799              0.0751                1.8341\n9           Lavaca County    1998              0.9818                1.0606              0.0897                1.8143\n10         Coahoma County    1998              1.0798                1.0815              0.0759                1.8468\n11          Skagit County    1998              1.1170                1.0364              0.0666                1.8517\n12          DeSoto County    1998              1.0279                1.0652              0.0859                1.8392\n13  Cape Girardeau County    1998              1.0028                1.0835              0.0934                1.8247\n14         Kossuth County    1998              0.8887                1.0132              0.0843                1.7986\n15           Dewey County    1998              0.9547                1.0169              0.0831                1.7943\n16         Wichita County    1998              0.9399                1.0569              0.0876                1.7827\n17          Waseca County    1998              0.9999                1.0082              0.0836                1.9233\n18          Blanco County    1998              1.1034                1.0252              0.0495                1.7889\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 53.478685,
                    "execution_time": 52.831988,
                    "compile_time": 0.000432,
                    "planning_time": 0.005618,
                    "create_size": 31744
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 53.11391,
                    "execution_time": 52.390941,
                    "compile_time": 0.000421,
                    "planning_time": 0.061194,
                    "create_size": 31744
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n1   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n2   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n3   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n4   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n5   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n6   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n7   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n8   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n9   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n10  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n11  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n12  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n13  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n14  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n15  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n16  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n17  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n18  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019416,
                    "execution_time": 0.009529,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003663
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056578,
                    "execution_time": 0.011377,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038877
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n1   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n2   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n3   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n4   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n5   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n6   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n7   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n8   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n9   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n10  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n11  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n12  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n13  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n14  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n15  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n16  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n17  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n18  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.461466,
                    "execution_time": 3.832382,
                    "compile_time": 0.000433,
                    "planning_time": 0.005931,
                    "create_size": 6912
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.893162,
                    "execution_time": 6.03769,
                    "compile_time": 0.147129,
                    "planning_time": 0.068251,
                    "create_size": 6912
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n1   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n2   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n3   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n4   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n5   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n6   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n7   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n8   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n9   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n10  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n11  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n12  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n13  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n14  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n15  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n16  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n17  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n18  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018174,
                    "execution_time": 0.008242,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003605
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054936,
                    "execution_time": 0.008162,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038912
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n1   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n2   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n3   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n4   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n5   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n6   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n7   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n8   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n9   Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n10  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n11  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n12  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n13  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n14  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n15  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n16  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n17  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n18  Beckham County    1998              1.0009                0.9887              3.0718                1.9512\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and (case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end IS NOT NULL) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.217261,
                    "execution_time": 0.107214,
                    "compile_time": 0.035258,
                    "planning_time": 0.031557,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.625352,
                    "execution_time": 0.159175,
                    "compile_time": 3.331146,
                    "planning_time": 0.089742,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Rush County    1998              1.0119                0.9890              1.9561                1.9071\n1       Escambia County    1998              0.9763                1.0063              1.8930                1.8637\n2        Sherman County    1998              1.0045                0.9945              1.7881                1.8835\n3   Little River County    1998              1.0395                1.0331              1.7914                1.8050\n4          Trigg County    1998              1.0071                1.0545              1.8238                1.8125\n5       Campbell County    1998              1.0405                1.0252              1.8105                1.8528\n6      Bottineau County    1998              0.9747                1.0276              1.9539                1.8220\n7       Brantley County    1998              1.0665                1.0040              1.8672                1.8497\n8      Tillamook County    1998              1.1358                1.0135              1.8069                1.8456\n9      Lancaster County    1998              1.0695                1.0203              1.7344                1.8762\n10        Valley County    1998              1.0439                1.0332              1.9082                1.8575\n11        Asotin County    1998              0.9724                1.0102              1.9732                1.8100\n12          Real County    1998              1.0036                1.0149              1.8514                1.8056\n13      Saguache County    1998              1.0697                1.0372              1.9402                1.7729\n14        Tipton County    1998              0.9915                1.0045              1.8578                1.8745\n15       Larimer County    1998              1.1039                1.0141              1.7986                1.8317\n16       Haines Borough    1998              1.0807                1.0058              1.7695                1.8744\n17        Harvey County    1998              1.0316                1.0743              1.7227                1.8526\n18      La Salle County    1998              0.9623                1.0328              1.8714                1.8678\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018269,
                    "execution_time": 0.008231,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003753
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053933,
                    "execution_time": 0.007555,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039116
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Rush County    1998              1.0119                0.9890              1.9561                1.9071\n1       Escambia County    1998              0.9763                1.0063              1.8930                1.8637\n2        Sherman County    1998              1.0045                0.9945              1.7881                1.8835\n3   Little River County    1998              1.0395                1.0331              1.7914                1.8050\n4          Trigg County    1998              1.0071                1.0545              1.8238                1.8125\n5       Campbell County    1998              1.0405                1.0252              1.8105                1.8528\n6      Bottineau County    1998              0.9747                1.0276              1.9539                1.8220\n7       Brantley County    1998              1.0665                1.0040              1.8672                1.8497\n8      Tillamook County    1998              1.1358                1.0135              1.8069                1.8456\n9      Lancaster County    1998              1.0695                1.0203              1.7344                1.8762\n10        Valley County    1998              1.0439                1.0332              1.9082                1.8575\n11        Asotin County    1998              0.9724                1.0102              1.9732                1.8100\n12          Real County    1998              1.0036                1.0149              1.8514                1.8056\n13      Saguache County    1998              1.0697                1.0372              1.9402                1.7729\n14        Tipton County    1998              0.9915                1.0045              1.8578                1.8745\n15       Larimer County    1998              1.1039                1.0141              1.7986                1.8317\n16       Haines Borough    1998              1.0807                1.0058              1.7695                1.8744\n17        Harvey County    1998              1.0316                1.0743              1.7227                1.8526\n18      La Salle County    1998              0.9623                1.0328              1.8714                1.8678\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.174742,
                    "execution_time": 0.093881,
                    "compile_time": 0.000838,
                    "planning_time": 0.034315,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.531831,
                    "execution_time": 0.099079,
                    "compile_time": 0.289808,
                    "planning_time": 0.092727,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0              Forsyth County    1998              1.0827                1.0432              1.7673                1.8158\n1              Burnett County    1998              1.0841                1.0217              1.7743                1.8793\n2             Nicollet County    1998              1.1036                0.9874              1.6497                1.9317\n3                 Norton city    1998              1.0823                0.9670              1.9032                1.9374\n4             Cheatham County    1998              1.0437                1.0368              1.8978                1.7416\n5              Harding County    1998              1.0264                1.0244              1.7671                1.8480\n6                 Bond County    1998              1.0683                1.0286              1.8792                1.8903\n7           Sweetwater County    1998              1.0806                1.0099              1.6749                1.7991\n8               Solano County    1998              1.1019                0.9924              1.7178                1.9073\n9              Rosebud County    1998              1.1592                1.0050              1.6837                1.8915\n10              Hopewell city    1998              1.0859                1.0040              1.6667                1.8491\n11              Vernon Parish    1998              1.1919                0.9767              1.6535                1.9113\n12           Gillespie County    1998              1.1235                1.0617              1.6321                1.7754\n13  Ketchikan Gateway Borough    1998              1.1105                1.0655              1.7122                1.8357\n14              Blanco County    1998              1.1034                1.0252              1.6512                1.7889\n15           Sagadahoc County    1998              1.0597                1.0267              1.7788                1.8478\n16              Norton County    1998              1.0889                0.9949              1.7756                1.9221\n17             Warrick County    1998              1.0250                1.0216              1.8551                1.8412\n18          Falls Church city    1998              1.0347                0.9586              1.8380                1.9459\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016708,
                    "execution_time": 0.006852,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003709
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053839,
                    "execution_time": 0.007185,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038908
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0              Forsyth County    1998              1.0827                1.0432              1.7673                1.8158\n1              Burnett County    1998              1.0841                1.0217              1.7743                1.8793\n2             Nicollet County    1998              1.1036                0.9874              1.6497                1.9317\n3                 Norton city    1998              1.0823                0.9670              1.9032                1.9374\n4             Cheatham County    1998              1.0437                1.0368              1.8978                1.7416\n5              Harding County    1998              1.0264                1.0244              1.7671                1.8480\n6                 Bond County    1998              1.0683                1.0286              1.8792                1.8903\n7           Sweetwater County    1998              1.0806                1.0099              1.6749                1.7991\n8               Solano County    1998              1.1019                0.9924              1.7178                1.9073\n9              Rosebud County    1998              1.1592                1.0050              1.6837                1.8915\n10              Hopewell city    1998              1.0859                1.0040              1.6667                1.8491\n11              Vernon Parish    1998              1.1919                0.9767              1.6535                1.9113\n12           Gillespie County    1998              1.1235                1.0617              1.6321                1.7754\n13  Ketchikan Gateway Borough    1998              1.1105                1.0655              1.7122                1.8357\n14              Blanco County    1998              1.1034                1.0252              1.6512                1.7889\n15           Sagadahoc County    1998              1.0597                1.0267              1.7788                1.8478\n16              Norton County    1998              1.0889                0.9949              1.7756                1.9221\n17             Warrick County    1998              1.0250                1.0216              1.8551                1.8412\n18          Falls Church city    1998              1.0347                0.9586              1.8380                1.9459\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and (case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end) \n       > (case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end)\n    and (case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end) > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.17241,
                    "execution_time": 0.091707,
                    "compile_time": 0.000786,
                    "planning_time": 0.034233,
                    "create_size": 27
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.347277,
                    "execution_time": 0.093163,
                    "compile_time": 0.113717,
                    "planning_time": 0.09201,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Solano County    1998              1.1019                0.9924              1.7178                1.9073\n1     Stokes County    1998              1.0683                1.0163              1.7932                1.8888\n2       Yuba County    1998              1.0213                1.0186              1.8782                1.8868\n3     DeBaca County    1998              1.1935                1.0145              1.7973                1.8938\n4   Portsmouth city    1998              1.1213                1.0070              1.8343                1.9068\n5     Durham County    1998              1.1363                1.1214              1.7230                1.7409\n6    Alfalfa County    1998              1.0052                0.9804              1.8852                1.8806\n7    Gilliam County    1998              0.9920                0.9745              1.8195                1.9263\n8    Ashland County    1998              1.0281                0.9927              1.7599                1.9144\n9     Tehama County    1998              1.0412                1.0332              1.7474                1.8237\n10   Mahaska County    1998              1.1758                1.0798              1.8567                1.8597\n11    McCone County    1998              0.9985                0.9926              1.9762                1.8318\n12    Etowah County    1998              1.0849                1.0724              1.8776                1.8164\n13  Monterey County    1998              1.1355                1.0462              1.6956                1.8064\n14      Burt County    1998              1.0829                0.9613              1.8098                1.9532\n15    Zapata County    1998              1.0878                1.0634              1.8814                1.8284\n16    Gentry County    1998              1.0186                1.0132              1.9424                1.9136\n17     Texas County    1998              1.0717                1.0125              1.7419                1.8084\n18  Le Sueur County    1998              1.0062                0.9977              2.1001                1.8360\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017308,
                    "execution_time": 0.007027,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003895
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052512,
                    "execution_time": 0.007097,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039242
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Solano County    1998              1.1019                0.9924              1.7178                1.9073\n1     Stokes County    1998              1.0683                1.0163              1.7932                1.8888\n2       Yuba County    1998              1.0213                1.0186              1.8782                1.8868\n3     DeBaca County    1998              1.1935                1.0145              1.7973                1.8938\n4   Portsmouth city    1998              1.1213                1.0070              1.8343                1.9068\n5     Durham County    1998              1.1363                1.1214              1.7230                1.7409\n6    Alfalfa County    1998              1.0052                0.9804              1.8852                1.8806\n7    Gilliam County    1998              0.9920                0.9745              1.8195                1.9263\n8    Ashland County    1998              1.0281                0.9927              1.7599                1.9144\n9     Tehama County    1998              1.0412                1.0332              1.7474                1.8237\n10   Mahaska County    1998              1.1758                1.0798              1.8567                1.8597\n11    McCone County    1998              0.9985                0.9926              1.9762                1.8318\n12    Etowah County    1998              1.0849                1.0724              1.8776                1.8164\n13  Monterey County    1998              1.1355                1.0462              1.6956                1.8064\n14      Burt County    1998              1.0829                0.9613              1.8098                1.9532\n15    Zapata County    1998              1.0878                1.0634              1.8814                1.8284\n16    Gentry County    1998              1.0186                1.0132              1.9424                1.9136\n17     Texas County    1998              1.0717                1.0125              1.7419                1.8084\n18  Le Sueur County    1998              1.0062                0.9977              2.1001                1.8360\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.181551,
                    "execution_time": 0.103824,
                    "compile_time": 0.00073,
                    "planning_time": 0.035748,
                    "create_size": 999
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.38673,
                    "execution_time": 0.155372,
                    "compile_time": 0.09112,
                    "planning_time": 0.095469,
                    "create_size": 999
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Coke County    1998              1.0275                1.0162              1.9487                1.8529\n1         Valley County    1998              1.0439                1.0332              1.9082                1.8575\n2       Saguache County    1998              1.0697                1.0372              1.9402                1.7729\n3       Brantley County    1998              1.0665                1.0040              1.8672                1.8497\n4           Rush County    1998              1.0119                0.9890              1.9561                1.9071\n5        Gregory County    1998              1.0361                1.0138              1.9297                1.7728\n6      Breathitt County    1998              1.1101                1.0209              1.8998                1.8125\n7    Musselshell County    1998              1.0672                1.0334              1.9270                1.8965\n8         Jerome County    1998              1.0892                1.0496              1.9062                1.8656\n9          Mower County    1998              1.1112                0.9651              1.9084                1.8305\n10       Bossier Parish    1998              1.0585                0.9840              1.9369                1.8323\n11     Marquette County    1998              1.0434                1.0209              1.8846                1.8095\n12      Chesapeake city    1998              1.0127                0.9529              2.0099                1.8802\n13      McLennan County    1998              1.1554                0.9665              1.9096                1.8682\n14         Clare County    1998              1.0092                1.0058              1.9968                1.8751\n15        Barnes County    1998              1.0551                1.0394              1.9349                1.8571\n16          Gulf County    1998              1.0718                1.0048              1.8621                1.8613\n17    Queen Anne County    1998              1.0898                1.0528              1.9015                1.7906\n18         Irwin County    1998              1.0342                1.0118              1.8538                1.8492\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017986,
                    "execution_time": 0.007888,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003855
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054867,
                    "execution_time": 0.008448,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039223
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Coke County    1998              1.0275                1.0162              1.9487                1.8529\n1         Valley County    1998              1.0439                1.0332              1.9082                1.8575\n2       Saguache County    1998              1.0697                1.0372              1.9402                1.7729\n3       Brantley County    1998              1.0665                1.0040              1.8672                1.8497\n4           Rush County    1998              1.0119                0.9890              1.9561                1.9071\n5        Gregory County    1998              1.0361                1.0138              1.9297                1.7728\n6      Breathitt County    1998              1.1101                1.0209              1.8998                1.8125\n7    Musselshell County    1998              1.0672                1.0334              1.9270                1.8965\n8         Jerome County    1998              1.0892                1.0496              1.9062                1.8656\n9          Mower County    1998              1.1112                0.9651              1.9084                1.8305\n10       Bossier Parish    1998              1.0585                0.9840              1.9369                1.8323\n11     Marquette County    1998              1.0434                1.0209              1.8846                1.8095\n12      Chesapeake city    1998              1.0127                0.9529              2.0099                1.8802\n13      McLennan County    1998              1.1554                0.9665              1.9096                1.8682\n14         Clare County    1998              1.0092                1.0058              1.9968                1.8751\n15        Barnes County    1998              1.0551                1.0394              1.9349                1.8571\n16          Gulf County    1998              1.0718                1.0048              1.8621                1.8613\n17    Queen Anne County    1998              1.0898                1.0528              1.9015                1.7906\n18         Irwin County    1998              1.0342                1.0118              1.8538                1.8492\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"WEB_Q1_Q2_INCREASE\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   San Luis Obispo County    1998              0.9756                0.9586              1.8902                1.8215\n1             Coosa County    1998              0.9780                0.9641              1.8255                1.8151\n2            Twiggs County    1998              0.9802                0.9748              1.8922                1.8480\n3      Indian River County    1998              0.9809                0.9789              1.9626                1.8760\n4           Payette County    1998              0.9810                0.9701              1.8384                1.8306\n5          Rockwall County    1998              0.9812                0.9548              2.0474                1.9227\n6          Sterling County    1998              0.9856                0.9464              1.9884                1.8972\n7           Kanabec County    1998              0.9902                0.9700              1.8697                1.7665\n8           Kimball County    1998              0.9950                0.9840              2.0883                1.9127\n9            McCone County    1998              0.9985                0.9926              1.9762                1.8318\n10         Converse County    1998              0.9987                0.9710              1.8714                1.8335\n11             Tama County    1998              1.0013                0.9740              1.8500                1.8358\n12           Ogemaw County    1998              1.0016                0.9660              1.9292                1.8245\n13       Huntington County    1998              1.0026                1.0015              1.9027                1.8996\n14           Emmons County    1998              1.0032                0.9946              1.9858                1.8670\n15          Daggett County    1998              1.0036                0.9755              1.9213                1.8789\n16         Woodbury County    1998              1.0045                0.9828              1.9643                1.9251\n17       Vermillion County    1998              1.0051                0.9768              2.0319                1.9849\n18          Alfalfa County    1998              1.0052                0.9804              1.8852                1.8806\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019568,
                    "execution_time": 0.00933,
                    "compile_time": 7e-05,
                    "planning_time": 0.003964
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.254089,
                    "execution_time": 0.010093,
                    "compile_time": 0.198108,
                    "planning_time": 0.039297
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST"
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   San Luis Obispo County    1998              0.9756                0.9586              1.8902                1.8215\n1             Coosa County    1998              0.9780                0.9641              1.8255                1.8151\n2            Twiggs County    1998              0.9802                0.9748              1.8922                1.8480\n3      Indian River County    1998              0.9809                0.9789              1.9626                1.8760\n4           Payette County    1998              0.9810                0.9701              1.8384                1.8306\n5          Rockwall County    1998              0.9812                0.9548              2.0474                1.9227\n6          Sterling County    1998              0.9856                0.9464              1.9884                1.8972\n7           Kanabec County    1998              0.9902                0.9700              1.8697                1.7665\n8           Kimball County    1998              0.9950                0.9840              2.0883                1.9127\n9            McCone County    1998              0.9985                0.9926              1.9762                1.8318\n10         Converse County    1998              0.9987                0.9710              1.8714                1.8335\n11             Tama County    1998              1.0013                0.9740              1.8500                1.8358\n12           Ogemaw County    1998              1.0016                0.9660              1.9292                1.8245\n13       Huntington County    1998              1.0026                1.0015              1.9027                1.8996\n14           Emmons County    1998              1.0032                0.9946              1.9858                1.8670\n15          Daggett County    1998              1.0036                0.9755              1.9213                1.8789\n16         Woodbury County    1998              1.0045                0.9828              1.9643                1.9251\n17       Vermillion County    1998              1.0051                0.9768              2.0319                1.9849\n18          Alfalfa County    1998              1.0052                0.9804              1.8852                1.8806\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"WEB_Q1_Q2_INCREASE\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   San Luis Obispo County    1998              0.9756                0.9586              1.8902                1.8215\n1             Coosa County    1998              0.9780                0.9641              1.8255                1.8151\n2            Twiggs County    1998              0.9802                0.9748              1.8922                1.8480\n3      Indian River County    1998              0.9809                0.9789              1.9626                1.8760\n4           Payette County    1998              0.9810                0.9701              1.8384                1.8306\n5          Rockwall County    1998              0.9812                0.9548              2.0474                1.9227\n6          Sterling County    1998              0.9856                0.9464              1.9884                1.8972\n7           Kanabec County    1998              0.9902                0.9700              1.8697                1.7665\n8           Kimball County    1998              0.9950                0.9840              2.0883                1.9127\n9            McCone County    1998              0.9985                0.9926              1.9762                1.8318\n10         Converse County    1998              0.9987                0.9710              1.8714                1.8335\n11             Tama County    1998              1.0013                0.9740              1.8500                1.8358\n12           Ogemaw County    1998              1.0016                0.9660              1.9292                1.8245\n13       Huntington County    1998              1.0026                1.0015              1.9027                1.8996\n14           Emmons County    1998              1.0032                0.9946              1.9858                1.8670\n15          Daggett County    1998              1.0036                0.9755              1.9213                1.8789\n16         Woodbury County    1998              1.0045                0.9828              1.9643                1.9251\n17       Vermillion County    1998              1.0051                0.9768              2.0319                1.9849\n18          Alfalfa County    1998              1.0052                0.9804              1.8852                1.8806\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019386,
                    "execution_time": 0.00912,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004039
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019809,
                    "execution_time": 0.009299,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004089
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_15\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   San Luis Obispo County    1998              0.9756                0.9586              1.8902                1.8215\n1             Coosa County    1998              0.9780                0.9641              1.8255                1.8151\n2            Twiggs County    1998              0.9802                0.9748              1.8922                1.8480\n3      Indian River County    1998              0.9809                0.9789              1.9626                1.8760\n4           Payette County    1998              0.9810                0.9701              1.8384                1.8306\n5          Rockwall County    1998              0.9812                0.9548              2.0474                1.9227\n6          Sterling County    1998              0.9856                0.9464              1.9884                1.8972\n7           Kanabec County    1998              0.9902                0.9700              1.8697                1.7665\n8           Kimball County    1998              0.9950                0.9840              2.0883                1.9127\n9            McCone County    1998              0.9985                0.9926              1.9762                1.8318\n10         Converse County    1998              0.9987                0.9710              1.8714                1.8335\n11             Tama County    1998              1.0013                0.9740              1.8500                1.8358\n12           Ogemaw County    1998              1.0016                0.9660              1.9292                1.8245\n13       Huntington County    1998              1.0026                1.0015              1.9027                1.8996\n14           Emmons County    1998              1.0032                0.9946              1.9858                1.8670\n15          Daggett County    1998              1.0036                0.9755              1.9213                1.8789\n16         Woodbury County    1998              1.0045                0.9828              1.9643                1.9251\n17       Vermillion County    1998              1.0051                0.9768              2.0319                1.9849\n18          Alfalfa County    1998              1.0052                0.9804              1.8852                1.8806\n...*/"
    }
]