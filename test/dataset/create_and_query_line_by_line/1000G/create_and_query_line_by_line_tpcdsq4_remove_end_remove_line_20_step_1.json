[
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.167023,
                    "execution_time": 1.541294,
                    "compile_time": 0.000391,
                    "planning_time": 0.022939,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.186153,
                    "execution_time": 6.498163,
                    "compile_time": 0.004692,
                    "planning_time": 0.083996,
                    "create_size": 1920
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.105527,
                    "execution_time": 0.039711,
                    "compile_time": 0.000218,
                    "planning_time": 0.026543,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.169187,
                    "execution_time": 0.043348,
                    "compile_time": 0.001085,
                    "planning_time": 0.083812,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAADMLCMGAA                Juan             Miller         Juan.Miller@ydKa2KExStOag.org\n1   AAAAAAAAFMGHIIAA               Linda                           Linda.Strauss@Xgs8SackIrSN.com\n2   AAAAAAAAJNDALFAA             Michael            Camacho        Michael.Camacho@CKyNGUNkq8.com\n3   AAAAAAAACHJFFIAA              Grover            Estrada        Grover.Estrada@ZA1vtitmTjH.com\n4   AAAAAAAANCPNLAAA               Doris            Jackson                  Doris.Jackson@qj.edu\n5   AAAAAAAADBOCDDAA              Sheila            Schmitz        Sheila.Schmitz@UH4xmj7fIpE.org\n6   AAAAAAAANDHGKDAA                Lois            Fennell          Lois.Fennell@DookzJvIe54.com\n7   AAAAAAAABPFINKAA                Earl           Anderson               Earl.Anderson@5r2By.org\n8   AAAAAAAAOHIPJHAA                John             Conway         John.Conway@K7sDIX6VBtzh3.com\n9   AAAAAAAAGHLGNGAA              Jerrod              Wells            Jerrod.Wells@EnXfIlv6c.edu\n10  AAAAAAAAAMENKFAA           Frederick            Herrera        Frederick.Herrera@ETC0lfPq.edu\n11  AAAAAAAAMJCKBJAA           Christine             Putnam       Christine.Putnam@pLbA3rYvfr.edu\n12  AAAAAAAAIEMENCAA                                Rollins                                      \n13  AAAAAAAAOFBMDKAA            Carolyne            Brinson  Carolyne.Brinson@eIJl8BKEmIZFT5z.edu\n14  AAAAAAAAMPDJEKAA               Betty               Pool           Betty.Pool@QPt5OjBF2vUJ.edu\n15  AAAAAAAAEGOGCHAA             Michael             Harper     Michael.Harper@jGYqJXb2VNz9ji.edu\n16  AAAAAAAAACGBPBAA              Joseph             Flores            Joseph.Flores@Zq9r4BuP.com\n17  AAAAAAAAPCKEBJAA              Ronald          Robertson          Ronald.Robertson@larxkiz.edu\n18  AAAAAAAAEHBKEBAA                 Bob            Chapman             Bob.Chapman@gbtxd4XjQ.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 46.066821,
                    "execution_time": 45.633831,
                    "compile_time": 0.003416,
                    "planning_time": 0.323632
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 52.110525,
                    "execution_time": 47.198953,
                    "compile_time": 4.400387,
                    "planning_time": 0.404107
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAADMLCMGAA                Juan             Miller         Juan.Miller@ydKa2KExStOag.org\n1   AAAAAAAAFMGHIIAA               Linda                           Linda.Strauss@Xgs8SackIrSN.com\n2   AAAAAAAAJNDALFAA             Michael            Camacho        Michael.Camacho@CKyNGUNkq8.com\n3   AAAAAAAACHJFFIAA              Grover            Estrada        Grover.Estrada@ZA1vtitmTjH.com\n4   AAAAAAAANCPNLAAA               Doris            Jackson                  Doris.Jackson@qj.edu\n5   AAAAAAAADBOCDDAA              Sheila            Schmitz        Sheila.Schmitz@UH4xmj7fIpE.org\n6   AAAAAAAANDHGKDAA                Lois            Fennell          Lois.Fennell@DookzJvIe54.com\n7   AAAAAAAABPFINKAA                Earl           Anderson               Earl.Anderson@5r2By.org\n8   AAAAAAAAOHIPJHAA                John             Conway         John.Conway@K7sDIX6VBtzh3.com\n9   AAAAAAAAGHLGNGAA              Jerrod              Wells            Jerrod.Wells@EnXfIlv6c.edu\n10  AAAAAAAAAMENKFAA           Frederick            Herrera        Frederick.Herrera@ETC0lfPq.edu\n11  AAAAAAAAMJCKBJAA           Christine             Putnam       Christine.Putnam@pLbA3rYvfr.edu\n12  AAAAAAAAIEMENCAA                                Rollins                                      \n13  AAAAAAAAOFBMDKAA            Carolyne            Brinson  Carolyne.Brinson@eIJl8BKEmIZFT5z.edu\n14  AAAAAAAAMPDJEKAA               Betty               Pool           Betty.Pool@QPt5OjBF2vUJ.edu\n15  AAAAAAAAEGOGCHAA             Michael             Harper     Michael.Harper@jGYqJXb2VNz9ji.edu\n16  AAAAAAAAACGBPBAA              Joseph             Flores            Joseph.Flores@Zq9r4BuP.com\n17  AAAAAAAAPCKEBJAA              Ronald          Robertson          Ronald.Robertson@larxkiz.edu\n18  AAAAAAAAEHBKEBAA                 Bob            Chapman             Bob.Chapman@gbtxd4XjQ.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and (case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end) is not null\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'s' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'c' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'w' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n )\n select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.07074,
                    "execution_time": 5.002504,
                    "compile_time": 0.000926,
                    "planning_time": 3.18556,
                    "create_size": 3840
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.315399,
                    "execution_time": 5.151746,
                    "compile_time": 0.010557,
                    "planning_time": 3.413281,
                    "create_size": 3840
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125855,
                    "execution_time": 0.056897,
                    "compile_time": 0.000585,
                    "planning_time": 0.031144,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.402323,
                    "execution_time": 0.053583,
                    "compile_time": 3.217382,
                    "planning_time": 0.093313,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [customer_id, customer_first_name, customer_last_name, customer_email_address]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017421,
                    "execution_time": 0.006887,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004432
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056424,
                    "execution_time": 0.007577,
                    "compile_time": 0.001068,
                    "planning_time": 0.040748
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [customer_id, customer_first_name, customer_last_name, customer_email_address]\nIndex: []*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": null
    }
]