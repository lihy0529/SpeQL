[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and 1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and 1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query7.tpl 0.2 */ i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk\n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAEDIOCAAA    50  74.70  190.80  37.30\n1   AAAAAAAALOFAEAAA    50  75.93  183.26  37.95\n2   AAAAAAAAMHBHEAAA    50  75.28  189.33  37.16\n3   AAAAAAAAJBLBAAAA    50  76.21  190.53  38.10\n4   AAAAAAAAOLGHDAAA    50  75.98  190.92  37.90\n5   AAAAAAAAMCNEBAAA    50  75.22  191.44  37.13\n6   AAAAAAAANLHGDAAA    50  76.16  182.03  38.20\n7   AAAAAAAAKPECEAAA    50  75.22  196.99  37.99\n8   AAAAAAAALGPODAAA    49  76.22  186.41  38.03\n9   AAAAAAAACFMHDAAA    50  75.60  189.42  37.63\n10  AAAAAAAAFHOIAAAA    50  75.99  183.96  38.01\n11  AAAAAAAAFAAHEAAA    50  75.83  189.95  37.93\n12  AAAAAAAAIKCFDAAA    50  74.95  193.40  37.75\n13  AAAAAAAAKPIMBAAA    50  76.01  190.91  37.93\n14  AAAAAAAACKANBAAA    50  75.76  192.85  37.58\n15  AAAAAAAAGNCNAAAA    50  75.39  190.68  38.17\n16  AAAAAAAADMIJCAAA    49  75.40  186.66  37.82\n17  AAAAAAAAOLAMDAAA    50  75.20  190.48  37.45\n18  AAAAAAAAIKGMCAAA    50  76.43  195.88  38.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 48.31961,
                    "execution_time": 48.242455,
                    "compile_time": 0.000333,
                    "planning_time": 0.056738
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 52.981324,
                    "execution_time": 52.831264,
                    "compile_time": 0.000327,
                    "planning_time": 0.128219
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAEDIOCAAA    50  74.70  190.80  37.30\n1   AAAAAAAALOFAEAAA    50  75.93  183.26  37.95\n2   AAAAAAAAMHBHEAAA    50  75.28  189.33  37.16\n3   AAAAAAAAJBLBAAAA    50  76.21  190.53  38.10\n4   AAAAAAAAOLGHDAAA    50  75.98  190.92  37.90\n5   AAAAAAAAMCNEBAAA    50  75.22  191.44  37.13\n6   AAAAAAAANLHGDAAA    50  76.16  182.03  38.20\n7   AAAAAAAAKPECEAAA    50  75.22  196.99  37.99\n8   AAAAAAAALGPODAAA    49  76.22  186.41  38.03\n9   AAAAAAAACFMHDAAA    50  75.60  189.42  37.63\n10  AAAAAAAAFHOIAAAA    50  75.99  183.96  38.01\n11  AAAAAAAAFAAHEAAA    50  75.83  189.95  37.93\n12  AAAAAAAAIKCFDAAA    50  74.95  193.40  37.75\n13  AAAAAAAAKPIMBAAA    50  76.01  190.91  37.93\n14  AAAAAAAACKANBAAA    50  75.76  192.85  37.58\n15  AAAAAAAAGNCNAAAA    50  75.39  190.68  38.17\n16  AAAAAAAADMIJCAAA    49  75.40  186.66  37.82\n17  AAAAAAAAOLAMDAAA    50  75.20  190.48  37.45\n18  AAAAAAAAIKGMCAAA    50  76.43  195.88  38.51\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 37.878942,
                    "execution_time": 37.403267,
                    "compile_time": 0.00055,
                    "planning_time": 0.055813,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 38.583233,
                    "execution_time": 38.009306,
                    "compile_time": 0.002819,
                    "planning_time": 0.138457,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAANEEDEAAA    50  76.45  180.19  38.64\n1   AAAAAAAAAILGEAAA    51  76.95  201.64  38.13\n2   AAAAAAAAJCLCBAAA    51  75.50  160.38  37.68\n3   AAAAAAAAMBIODAAA    50  76.13  178.36  38.39\n4   AAAAAAAAACKEAAAA    49  75.49  176.50  36.91\n5   AAAAAAAAJOFHCAAA    50  76.11  178.69  37.78\n6   AAAAAAAAJHAFBAAA    50  77.84  189.14  39.54\n7   AAAAAAAANHIIEAAA    50  74.33  188.99  37.52\n8   AAAAAAAAKGEIAAAA    49  77.41  192.57  38.92\n9   AAAAAAAAKKNBDAAA    49  75.24  218.02  38.33\n10  AAAAAAAACDHGCAAA    50  77.72  223.27  38.47\n11  AAAAAAAACOLEBAAA    51  73.75  179.31  35.95\n12  AAAAAAAAHNOOBAAA    50  74.70  202.61  37.65\n13  AAAAAAAALEKMDAAA    50  74.84  194.99  37.54\n14  AAAAAAAAAKNDCAAA    50  75.77  206.41  38.58\n15  AAAAAAAAPCIGDAAA    49  74.79  155.89  36.20\n16  AAAAAAAAOHNGEAAA    50  76.89  209.76  39.29\n17  AAAAAAAABKGCDAAA    50  76.65  145.64  37.30\n18  AAAAAAAALKKMDAAA    51  77.73  176.80  37.87\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018513,
                    "execution_time": 0.008025,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.00386
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055831,
                    "execution_time": 0.008173,
                    "compile_time": 0.00122,
                    "planning_time": 0.039306
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAANEEDEAAA    50  76.45  180.19  38.64\n1   AAAAAAAAAILGEAAA    51  76.95  201.64  38.13\n2   AAAAAAAAJCLCBAAA    51  75.50  160.38  37.68\n3   AAAAAAAAMBIODAAA    50  76.13  178.36  38.39\n4   AAAAAAAAACKEAAAA    49  75.49  176.50  36.91\n5   AAAAAAAAJOFHCAAA    50  76.11  178.69  37.78\n6   AAAAAAAAJHAFBAAA    50  77.84  189.14  39.54\n7   AAAAAAAANHIIEAAA    50  74.33  188.99  37.52\n8   AAAAAAAAKGEIAAAA    49  77.41  192.57  38.92\n9   AAAAAAAAKKNBDAAA    49  75.24  218.02  38.33\n10  AAAAAAAACDHGCAAA    50  77.72  223.27  38.47\n11  AAAAAAAACOLEBAAA    51  73.75  179.31  35.95\n12  AAAAAAAAHNOOBAAA    50  74.70  202.61  37.65\n13  AAAAAAAALEKMDAAA    50  74.84  194.99  37.54\n14  AAAAAAAAAKNDCAAA    50  75.77  206.41  38.58\n15  AAAAAAAAPCIGDAAA    49  74.79  155.89  36.20\n16  AAAAAAAAOHNGEAAA    50  76.89  209.76  39.29\n17  AAAAAAAABKGCDAAA    50  76.65  145.64  37.30\n18  AAAAAAAALKKMDAAA    51  77.73  176.80  37.87\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 37.783626,
                    "execution_time": 37.279304,
                    "compile_time": 0.000582,
                    "planning_time": 0.058408,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 44.786883,
                    "execution_time": 37.982936,
                    "compile_time": 6.211829,
                    "planning_time": 0.150605,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAALBDEAAA    47  76.57  166.43  37.67\n1   AAAAAAAAFJMHBAAA    51  77.94  216.28  39.13\n2   AAAAAAAAKENCDAAA    48  71.87  146.66  35.79\n3   AAAAAAAANLCCDAAA    49  78.14  241.08  39.59\n4   AAAAAAAACBKFBAAA    48  70.20  107.98  34.79\n5   AAAAAAAAMHFJCAAA    50  77.31  148.26  35.23\n6   AAAAAAAANAKKBAAA    50  72.82  278.47  37.42\n7   AAAAAAAAJBGDAAAA    53  76.34  166.83  36.92\n8   AAAAAAAAONANDAAA    51  76.58  218.20  36.11\n9   AAAAAAAAGKKEEAAA    51  76.15  236.47  38.53\n10  AAAAAAAAMEBPAAAA    52  77.62  281.26  37.29\n11  AAAAAAAAIALNDAAA    51  73.85  159.56  36.20\n12  AAAAAAAAIACAAAAA    48  74.56  109.92  37.75\n13  AAAAAAAACKNJAAAA    52  77.11  258.16  38.36\n14  AAAAAAAACHKFEAAA    48  77.41  235.83  38.84\n15  AAAAAAAAAPOECAAA    49  72.57  209.35  34.85\n16  AAAAAAAACOFFDAAA    48  82.65  146.98  37.64\n17  AAAAAAAAKNJFDAAA    54  75.59  189.38  37.22\n18  AAAAAAAAKAJJAAAA    50  74.28  223.88  40.08\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017663,
                    "execution_time": 0.00794,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003578
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053189,
                    "execution_time": 0.007851,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.038877
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAALBDEAAA    47  76.57  166.43  37.67\n1   AAAAAAAAFJMHBAAA    51  77.94  216.28  39.13\n2   AAAAAAAAKENCDAAA    48  71.87  146.66  35.79\n3   AAAAAAAANLCCDAAA    49  78.14  241.08  39.59\n4   AAAAAAAACBKFBAAA    48  70.20  107.98  34.79\n5   AAAAAAAAMHFJCAAA    50  77.31  148.26  35.23\n6   AAAAAAAANAKKBAAA    50  72.82  278.47  37.42\n7   AAAAAAAAJBGDAAAA    53  76.34  166.83  36.92\n8   AAAAAAAAONANDAAA    51  76.58  218.20  36.11\n9   AAAAAAAAGKKEEAAA    51  76.15  236.47  38.53\n10  AAAAAAAAMEBPAAAA    52  77.62  281.26  37.29\n11  AAAAAAAAIALNDAAA    51  73.85  159.56  36.20\n12  AAAAAAAAIACAAAAA    48  74.56  109.92  37.75\n13  AAAAAAAACKNJAAAA    52  77.11  258.16  38.36\n14  AAAAAAAACHKFEAAA    48  77.41  235.83  38.84\n15  AAAAAAAAAPOECAAA    49  72.57  209.35  34.85\n16  AAAAAAAACOFFDAAA    48  82.65  146.98  37.64\n17  AAAAAAAAKNJFDAAA    54  75.59  189.38  37.22\n18  AAAAAAAAKAJJAAAA    50  74.28  223.88  40.08\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N')\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 37.869563,
                    "execution_time": 37.377891,
                    "compile_time": 0.000609,
                    "planning_time": 0.06155,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 47.945605,
                    "execution_time": 37.697824,
                    "compile_time": 9.653593,
                    "planning_time": 0.160941,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAMNLBDAAA    49  75.85  227.71  41.86\n1   AAAAAAAACEMLAAAA    51  75.94  190.17  39.93\n2   AAAAAAAAOAFBCAAA    48  70.76  106.77  37.13\n3   AAAAAAAAAEAJAAAA    49  76.28  181.14  37.45\n4   AAAAAAAAMCLNCAAA    52  80.98  304.01  41.74\n5   AAAAAAAABGIEAAAA    49  76.61  165.40  37.08\n6   AAAAAAAAEPMGAAAA    52  74.27  232.32  37.29\n7   AAAAAAAAIPNEBAAA    49  73.44  131.54  34.42\n8   AAAAAAAABOGHDAAA    47  75.53  180.49  36.20\n9   AAAAAAAAIBAEEAAA    52  73.15  167.89  36.09\n10  AAAAAAAADLAIDAAA    51  74.36  276.77  39.72\n11  AAAAAAAAHAJCEAAA    47  72.47  193.48  34.96\n12  AAAAAAAACDLMAAAA    50  78.69  143.68  40.00\n13  AAAAAAAAOCBIDAAA    48  75.08  265.20  39.78\n14  AAAAAAAAMCLGAAAA    48  74.70  200.00  35.50\n15  AAAAAAAANIBDAAAA    50  78.36  194.12  41.43\n16  AAAAAAAAPFLOBAAA    51  72.00  230.73  36.20\n17  AAAAAAAAKBPIBAAA    50  72.73  178.28  37.16\n18  AAAAAAAAOLPPDAAA    52  74.01  142.84  38.18\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017241,
                    "execution_time": 0.007364,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003689
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053149,
                    "execution_time": 0.00768,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.038953
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAMNLBDAAA    49  75.85  227.71  41.86\n1   AAAAAAAACEMLAAAA    51  75.94  190.17  39.93\n2   AAAAAAAAOAFBCAAA    48  70.76  106.77  37.13\n3   AAAAAAAAAEAJAAAA    49  76.28  181.14  37.45\n4   AAAAAAAAMCLNCAAA    52  80.98  304.01  41.74\n5   AAAAAAAABGIEAAAA    49  76.61  165.40  37.08\n6   AAAAAAAAEPMGAAAA    52  74.27  232.32  37.29\n7   AAAAAAAAIPNEBAAA    49  73.44  131.54  34.42\n8   AAAAAAAABOGHDAAA    47  75.53  180.49  36.20\n9   AAAAAAAAIBAEEAAA    52  73.15  167.89  36.09\n10  AAAAAAAADLAIDAAA    51  74.36  276.77  39.72\n11  AAAAAAAAHAJCEAAA    47  72.47  193.48  34.96\n12  AAAAAAAACDLMAAAA    50  78.69  143.68  40.00\n13  AAAAAAAAOCBIDAAA    48  75.08  265.20  39.78\n14  AAAAAAAAMCLGAAAA    48  74.70  200.00  35.50\n15  AAAAAAAANIBDAAAA    50  78.36  194.12  41.43\n16  AAAAAAAAPFLOBAAA    51  72.00  230.73  36.20\n17  AAAAAAAAKBPIBAAA    50  72.73  178.28  37.16\n18  AAAAAAAAOLPPDAAA    52  74.01  142.84  38.18\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.839662,
                    "execution_time": 1.365225,
                    "compile_time": 0.000548,
                    "planning_time": 0.058792,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.860471,
                    "execution_time": 6.289695,
                    "compile_time": 0.001781,
                    "planning_time": 0.147041,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAFHDBAAA    46  84.63  264.10  37.77\n1   AAAAAAAAGDEIBAAA    47  71.14   82.65  29.52\n2   AAAAAAAACNPBDAAA    45  77.22  192.11  43.96\n3   AAAAAAAAMDLKBAAA    52  73.61  267.85  36.64\n4   AAAAAAAALBMNDAAA    46  71.43  204.85  32.78\n5   AAAAAAAACLNLBAAA    48  66.70  172.18  31.58\n6   AAAAAAAAEACOAAAA    52  70.25  517.36  39.45\n7   AAAAAAAALKLIAAAA    43  76.44  206.60  36.82\n8   AAAAAAAAMKNIAAAA    49  75.39   56.75  38.23\n9   AAAAAAAAPFFMAAAA    50  78.28  128.45  46.95\n10  AAAAAAAAJDOJCAAA    48  76.21  188.39  37.29\n11  AAAAAAAAGOHNDAAA    54  86.45  231.12  41.80\n12  AAAAAAAACJDADAAA    49  71.20  187.41  36.51\n13  AAAAAAAAHENEAAAA    46  72.25  201.83  32.66\n14  AAAAAAAABBJCDAAA    55  74.12  108.95  39.36\n15  AAAAAAAAKHEKBAAA    53  90.87  104.16  42.14\n16  AAAAAAAABLILDAAA    50  65.04  168.26  30.03\n17  AAAAAAAAOLKCEAAA    52  74.70  318.78  35.90\n18  AAAAAAAANACHDAAA    52  83.19  169.19  40.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017567,
                    "execution_time": 0.007599,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003701
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052874,
                    "execution_time": 0.007779,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038853
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAFHDBAAA    46  84.63  264.10  37.77\n1   AAAAAAAAGDEIBAAA    47  71.14   82.65  29.52\n2   AAAAAAAACNPBDAAA    45  77.22  192.11  43.96\n3   AAAAAAAAMDLKBAAA    52  73.61  267.85  36.64\n4   AAAAAAAALBMNDAAA    46  71.43  204.85  32.78\n5   AAAAAAAACLNLBAAA    48  66.70  172.18  31.58\n6   AAAAAAAAEACOAAAA    52  70.25  517.36  39.45\n7   AAAAAAAALKLIAAAA    43  76.44  206.60  36.82\n8   AAAAAAAAMKNIAAAA    49  75.39   56.75  38.23\n9   AAAAAAAAPFFMAAAA    50  78.28  128.45  46.95\n10  AAAAAAAAJDOJCAAA    48  76.21  188.39  37.29\n11  AAAAAAAAGOHNDAAA    54  86.45  231.12  41.80\n12  AAAAAAAACJDADAAA    49  71.20  187.41  36.51\n13  AAAAAAAAHENEAAAA    46  72.25  201.83  32.66\n14  AAAAAAAABBJCDAAA    55  74.12  108.95  39.36\n15  AAAAAAAAKHEKBAAA    53  90.87  104.16  42.14\n16  AAAAAAAABLILDAAA    50  65.04  168.26  30.03\n17  AAAAAAAAOLKCEAAA    52  74.70  318.78  35.90\n18  AAAAAAAANACHDAAA    52  83.19  169.19  40.91\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAEGEBEAAA    58  78.14  183.41  43.42\n1   AAAAAAAAAPEHDAAA    46  64.46  312.15  31.80\n2   AAAAAAAAGAOPCAAA    50  72.11  207.50  43.16\n3   AAAAAAAAHBPMCAAA    50  74.25  329.87  40.05\n4   AAAAAAAAPPCFDAAA    56  86.33  203.99  45.70\n5   AAAAAAAADKEOAAAA    52  69.51  306.01  29.20\n6   AAAAAAAACIMNCAAA    57  76.26  204.50  43.96\n7   AAAAAAAACAIOCAAA    51  79.49   32.48  42.25\n8   AAAAAAAABGIHAAAA    42  77.97  386.78  34.35\n9   AAAAAAAABCMDBAAA    51  73.98   97.24  39.75\n10  AAAAAAAAGLJHEAAA    52  74.83  161.49  34.99\n11  AAAAAAAAPDFOAAAA    53  89.18  160.87  43.20\n12  AAAAAAAAPIDCDAAA    45  75.58  244.37  35.50\n13  AAAAAAAAEBHPCAAA    56  73.54  115.18  29.65\n14  AAAAAAAAMMBBDAAA    45  83.10  105.34  37.91\n15  AAAAAAAAKEMLDAAA    54  85.25  167.12  45.27\n16  AAAAAAAAKELADAAA    46  75.99  189.09  37.37\n17  AAAAAAAAFPIIEAAA    57  82.18   78.43  40.91\n18  AAAAAAAANBEMBAAA    54  84.47  101.77  34.58\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018132,
                    "execution_time": 0.008066,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003752
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052347,
                    "execution_time": 0.00762,
                    "compile_time": 5e-05,
                    "planning_time": 0.038626
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAEGEBEAAA    58  78.14  183.41  43.42\n1   AAAAAAAAAPEHDAAA    46  64.46  312.15  31.80\n2   AAAAAAAAGAOPCAAA    50  72.11  207.50  43.16\n3   AAAAAAAAHBPMCAAA    50  74.25  329.87  40.05\n4   AAAAAAAAPPCFDAAA    56  86.33  203.99  45.70\n5   AAAAAAAADKEOAAAA    52  69.51  306.01  29.20\n6   AAAAAAAACIMNCAAA    57  76.26  204.50  43.96\n7   AAAAAAAACAIOCAAA    51  79.49   32.48  42.25\n8   AAAAAAAABGIHAAAA    42  77.97  386.78  34.35\n9   AAAAAAAABCMDBAAA    51  73.98   97.24  39.75\n10  AAAAAAAAGLJHEAAA    52  74.83  161.49  34.99\n11  AAAAAAAAPDFOAAAA    53  89.18  160.87  43.20\n12  AAAAAAAAPIDCDAAA    45  75.58  244.37  35.50\n13  AAAAAAAAEBHPCAAA    56  73.54  115.18  29.65\n14  AAAAAAAAMMBBDAAA    45  83.10  105.34  37.91\n15  AAAAAAAAKEMLDAAA    54  85.25  167.12  45.27\n16  AAAAAAAAKELADAAA    46  75.99  189.09  37.37\n17  AAAAAAAAFPIIEAAA    57  82.18   78.43  40.91\n18  AAAAAAAANBEMBAAA    54  84.47  101.77  34.58\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n order by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAAAABAAA    47  91.22  124.59  45.98\n1   AAAAAAAAAAAACAAA    47  70.63  330.21  40.02\n2   AAAAAAAAAAAAEAAA    60  65.78  102.80  33.53\n3   AAAAAAAAAAABAAAA    51  81.68   25.93  43.40\n4   AAAAAAAAAAABBAAA    52  71.16  226.37  33.26\n5   AAAAAAAAAAABDAAA    49  84.74  293.56  39.45\n6   AAAAAAAAAAABEAAA    49  84.15  130.12  39.67\n7   AAAAAAAAAAACAAAA    53  79.67   99.58  43.77\n8   AAAAAAAAAAACCAAA    45  67.59   79.13  33.05\n9   AAAAAAAAAAACDAAA    41  71.56   79.47  35.02\n10  AAAAAAAAAAADBAAA    52  72.98   31.30  37.00\n11  AAAAAAAAAAADCAAA    55  69.21   79.73  38.09\n12  AAAAAAAAAAADEAAA    45  80.29  222.99  45.49\n13  AAAAAAAAAAAEAAAA    40  70.39  213.06  32.05\n14  AAAAAAAAAAAEBAAA    48  77.38  100.20  43.03\n15  AAAAAAAAAAAEDAAA    46  67.89   35.97  34.75\n16  AAAAAAAAAAAEEAAA    50  64.18  261.50  34.11\n17  AAAAAAAAAAAFAAAA    51  77.94   83.80  37.36\n18  AAAAAAAAAAAFCAAA    47  73.74  220.22  36.80\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020112,
                    "execution_time": 0.010232,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003757
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056097,
                    "execution_time": 0.00972,
                    "compile_time": 0.002075,
                    "planning_time": 0.038519
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAAAABAAA    47  91.22  124.59  45.98\n1   AAAAAAAAAAAACAAA    47  70.63  330.21  40.02\n2   AAAAAAAAAAAAEAAA    60  65.78  102.80  33.53\n3   AAAAAAAAAAABAAAA    51  81.68   25.93  43.40\n4   AAAAAAAAAAABBAAA    52  71.16  226.37  33.26\n5   AAAAAAAAAAABDAAA    49  84.74  293.56  39.45\n6   AAAAAAAAAAABEAAA    49  84.15  130.12  39.67\n7   AAAAAAAAAAACAAAA    53  79.67   99.58  43.77\n8   AAAAAAAAAAACCAAA    45  67.59   79.13  33.05\n9   AAAAAAAAAAACDAAA    41  71.56   79.47  35.02\n10  AAAAAAAAAAADBAAA    52  72.98   31.30  37.00\n11  AAAAAAAAAAADCAAA    55  69.21   79.73  38.09\n12  AAAAAAAAAAADEAAA    45  80.29  222.99  45.49\n13  AAAAAAAAAAAEAAAA    40  70.39  213.06  32.05\n14  AAAAAAAAAAAEBAAA    48  77.38  100.20  43.03\n15  AAAAAAAAAAAEDAAA    46  67.89   35.97  34.75\n16  AAAAAAAAAAAEEAAA    50  64.18  261.50  34.11\n17  AAAAAAAAAAAFAAAA    51  77.94   83.80  37.36\n18  AAAAAAAAAAAFCAAA    47  73.74  220.22  36.80\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n order by i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAAAABAAA    47  91.22  124.59  45.98\n1   AAAAAAAAAAAACAAA    47  70.63  330.21  40.02\n2   AAAAAAAAAAAAEAAA    60  65.78  102.80  33.53\n3   AAAAAAAAAAABAAAA    51  81.68   25.93  43.40\n4   AAAAAAAAAAABBAAA    52  71.16  226.37  33.26\n5   AAAAAAAAAAABDAAA    49  84.74  293.56  39.45\n6   AAAAAAAAAAABEAAA    49  84.15  130.12  39.67\n7   AAAAAAAAAAACAAAA    53  79.67   99.58  43.77\n8   AAAAAAAAAAACCAAA    45  67.59   79.13  33.05\n9   AAAAAAAAAAACDAAA    41  71.56   79.47  35.02\n10  AAAAAAAAAAADBAAA    52  72.98   31.30  37.00\n11  AAAAAAAAAAADCAAA    55  69.21   79.73  38.09\n12  AAAAAAAAAAADEAAA    45  80.29  222.99  45.49\n13  AAAAAAAAAAAEAAAA    40  70.39  213.06  32.05\n14  AAAAAAAAAAAEBAAA    48  77.38  100.20  43.03\n15  AAAAAAAAAAAEDAAA    46  67.89   35.97  34.75\n16  AAAAAAAAAAAEEAAA    50  64.18  261.50  34.11\n17  AAAAAAAAAAAFAAAA    51  77.94   83.80  37.36\n18  AAAAAAAAAAAFCAAA    47  73.74  220.22  36.80\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020448,
                    "execution_time": 0.010361,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003862
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020529,
                    "execution_time": 0.010337,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.00396
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAAAABAAA    47  91.22  124.59  45.98\n1   AAAAAAAAAAAACAAA    47  70.63  330.21  40.02\n2   AAAAAAAAAAAAEAAA    60  65.78  102.80  33.53\n3   AAAAAAAAAAABAAAA    51  81.68   25.93  43.40\n4   AAAAAAAAAAABBAAA    52  71.16  226.37  33.26\n5   AAAAAAAAAAABDAAA    49  84.74  293.56  39.45\n6   AAAAAAAAAAABEAAA    49  84.15  130.12  39.67\n7   AAAAAAAAAAACAAAA    53  79.67   99.58  43.77\n8   AAAAAAAAAAACCAAA    45  67.59   79.13  33.05\n9   AAAAAAAAAAACDAAA    41  71.56   79.47  35.02\n10  AAAAAAAAAAADBAAA    52  72.98   31.30  37.00\n11  AAAAAAAAAAADCAAA    55  69.21   79.73  38.09\n12  AAAAAAAAAAADEAAA    45  80.29  222.99  45.49\n13  AAAAAAAAAAAEAAAA    40  70.39  213.06  32.05\n14  AAAAAAAAAAAEBAAA    48  77.38  100.20  43.03\n15  AAAAAAAAAAAEDAAA    46  67.89   35.97  34.75\n16  AAAAAAAAAAAEEAAA    50  64.18  261.50  34.11\n17  AAAAAAAAAAAFAAAA    51  77.94   83.80  37.36\n18  AAAAAAAAAAAFCAAA    47  73.74  220.22  36.80\n...*/"
    }
]