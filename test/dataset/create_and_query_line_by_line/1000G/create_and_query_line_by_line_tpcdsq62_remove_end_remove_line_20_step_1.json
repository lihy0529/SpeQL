[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   '' as w_warehouse_name\n  ,'' as sm_type\n  ,'' as web_name\n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK > 30) and \n                 (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK > 60) and \n                 (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK > 90) and\n                 (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name sm_type web_name    30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                    179931546   179943783   179922578    179932385            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.444114,
                    "execution_time": 1.394667,
                    "compile_time": 0.000113,
                    "planning_time": 0.040077
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 11.239474,
                    "execution_time": 11.11962,
                    "compile_time": 0.001851,
                    "planning_time": 0.108159
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "rewrite": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
            }
        ],
        "preview": "\n/*  w_warehouse_name sm_type web_name    30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                    179931546   179943783   179922578    179932385            0*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring('unknown warehouse',1,20) as w_warehouse_name\n  ,'unknown sm_type' as sm_type\n  ,'unknown web_name' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( 'unknown warehouse' , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , 'unknown sm_type' AS \"SM_TYPE\" , 'unknown web_name' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUBSTRING ( 'unknown warehouse' FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , 'unknown sm_type' AS \"SM_TYPE\" , 'unknown web_name' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" LIMIT 21",
                "preview": "\n/*    w_warehouse_name          sm_type          web_name    30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  unknown warehouse  unknown sm_type  unknown web_name  179931546   179943783   179922578    179932385            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.439702,
                    "execution_time": 1.395636,
                    "compile_time": 0.000106,
                    "planning_time": 0.035127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.750601,
                    "execution_time": 1.398609,
                    "compile_time": 0.247891,
                    "planning_time": 0.094967
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING('unknown warehouse', 1, 20) AS \"W_WAREHOUSE_NAME\", 'unknown sm_type' AS \"SM_TYPE\", 'unknown web_name' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "rewrite": "SELECT SUBSTRING('unknown warehouse', 1, 20) AS \"W_WAREHOUSE_NAME\", 'unknown sm_type' AS \"SM_TYPE\", 'unknown web_name' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
            }
        ],
        "preview": "\n/*    w_warehouse_name          sm_type          web_name    30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  unknown warehouse  unknown sm_type  unknown web_name  179931546   179943783   179922578    179932385            0*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\ngroup by w_warehouse_name, sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere 1=1\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n   join warehouse on ws_warehouse_sk = w_warehouse_sk\n   join ship_mode on ws_ship_mode_sk = sm_ship_mode_sk\n   join web_site on ws_web_site_sk = web_site_sk\n   join date_dim on ws_ship_date_sk = d_date_sk\nwhere\n    d_month_seq between 1185 and 1185 + 11\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.092429,
                    "execution_time": 1.986923,
                    "compile_time": 0.000472,
                    "planning_time": 0.066634,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.494201,
                    "execution_time": 7.398725,
                    "compile_time": 4.884601,
                    "planning_time": 0.168318,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         OVERNIGHT   site_6    30111       30107       30190        30407            0\n1       Plain, reluctant    LIBRARY   site_5    30052       30047       29963        29717            0\n2         Quite effectiv    EXPRESS   site_7    26595       26552       26663        26616            0\n3   Empty, middle women     TWO DAY   site_8    20107       20068       19922        19852            0\n4          Therefore urg    LIBRARY   site_7    20142       20084       19865        19988            0\n5       Please central m    TWO DAY   site_8    20097       20110       20088        19930            0\n6    Conventional childr    TWO DAY   site_3    29852       29742       29782        30182            0\n7      New, net purposes   NEXT DAY   site_8    26640       26549       26668        26773            0\n8                           REGULAR   site_6    29735       30131       29961        30031            0\n9   Bad cards must make.   NEXT DAY   site_1    39489       40447       39725        40442            0\n10  Local, mass universi  OVERNIGHT   site_4    29939       29725       30005        30129            0\n11  Important issues liv    REGULAR   site_3    29795       30166       29876        29789            0\n12      National, comple   NEXT DAY   site_1    39805       40181       39597        40519            0\n13  Local, mass universi    EXPRESS   site_5    40101       39719       40101        39914            0\n14       Surprising emot    LIBRARY   site_4    29738       30418       30043        30178            0\n15           Rooms cook     LIBRARY   site_6    30241       29630       30265        29856            0\n16           Rooms cook     REGULAR             19919       19867       20077        19960            0\n17       Surprising emot    TWO DAY   site_0    29914       30093       29805        29914            0\n18       Surprising emot   NEXT DAY   site_6    40009       39911       39943        39857            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018127,
                    "execution_time": 0.00748,
                    "compile_time": 5e-05,
                    "planning_time": 0.004173
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057786,
                    "execution_time": 0.008074,
                    "compile_time": 0.001,
                    "planning_time": 0.039986
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         OVERNIGHT   site_6    30111       30107       30190        30407            0\n1       Plain, reluctant    LIBRARY   site_5    30052       30047       29963        29717            0\n2         Quite effectiv    EXPRESS   site_7    26595       26552       26663        26616            0\n3   Empty, middle women     TWO DAY   site_8    20107       20068       19922        19852            0\n4          Therefore urg    LIBRARY   site_7    20142       20084       19865        19988            0\n5       Please central m    TWO DAY   site_8    20097       20110       20088        19930            0\n6    Conventional childr    TWO DAY   site_3    29852       29742       29782        30182            0\n7      New, net purposes   NEXT DAY   site_8    26640       26549       26668        26773            0\n8                           REGULAR   site_6    29735       30131       29961        30031            0\n9   Bad cards must make.   NEXT DAY   site_1    39489       40447       39725        40442            0\n10  Local, mass universi  OVERNIGHT   site_4    29939       29725       30005        30129            0\n11  Important issues liv    REGULAR   site_3    29795       30166       29876        29789            0\n12      National, comple   NEXT DAY   site_1    39805       40181       39597        40519            0\n13  Local, mass universi    EXPRESS   site_5    40101       39719       40101        39914            0\n14       Surprising emot    LIBRARY   site_4    29738       30418       30043        30178            0\n15           Rooms cook     LIBRARY   site_6    30241       29630       30265        29856            0\n16           Rooms cook     REGULAR             19919       19867       20077        19960            0\n17       Surprising emot    TWO DAY   site_0    29914       30093       29805        29914            0\n18       Surprising emot   NEXT DAY   site_6    40009       39911       39943        39857            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\ngroup by \n   substring(w_warehouse_name,1,20),\n   sm_type,\n   web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 39.765057,
                    "execution_time": 39.648337,
                    "compile_time": 0.00048,
                    "planning_time": 0.077098,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 39.829245,
                    "execution_time": 39.63761,
                    "compile_time": 0.001567,
                    "planning_time": 0.149672,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_2\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*        w_warehouse_name    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0      New, net purposes    TWO DAY   site_4  1619676     1606848     1617942      1615302            0\n1      New, net purposes    TWO DAY   site_8  1349730     1339040     1348285      1346085            0\n2          Therefore urg   NEXT DAY   site_2  2149518     2164956     2151876      2169780            0\n3          Therefore urg   NEXT DAY   site_3  2149518     2164956     2151876      2169780            0\n4   Bad cards must make.    REGULAR   site_0  1628376     1613550     1619838      1611894            0\n5     New proceedings fo    EXPRESS   site_0  2166726     2145036     2173632      2142750            0\n6     New proceedings fo    EXPRESS   site_3  2166726     2145036     2173632      2142750            0\n7    Friendly, suitable     TWO DAY   site_1  1613286     1615440     1610208      1625766            0\n8    Friendly, suitable     TWO DAY   site_2  1613286     1615440     1610208      1625766            0\n9    Friendly, suitable     TWO DAY   site_4  1613286     1615440     1610208      1625766            0\n10   Friendly, suitable     TWO DAY   site_5  1613286     1615440     1610208      1625766            0\n11    Governments should   NEXT DAY   site_2  2165802     2152476     2160300      2146536            0\n12      Please central m  OVERNIGHT   site_4  1613460     1615872     1618908      1622844            0\n13      Please central m  OVERNIGHT   site_8  1344550     1346560     1349090      1352370            0\n14   Friendly, suitable     REGULAR   site_7  1350685     1346525     1346075      1347085            0\n15    Governments should    LIBRARY   site_0  1618890     1623678     1619130      1623540            0\n16    Governments should    LIBRARY   site_8  1349075     1353065     1349275      1352950            0\n17      Please central m    TWO DAY   site_0  1623138     1618434     1622430      1615740            0\n18      Please central m    TWO DAY            541046      539478      540810       538580            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017825,
                    "execution_time": 0.007539,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004118
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053552,
                    "execution_time": 0.007539,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.03949
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_2\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*        w_warehouse_name    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0      New, net purposes    TWO DAY   site_4  1619676     1606848     1617942      1615302            0\n1      New, net purposes    TWO DAY   site_8  1349730     1339040     1348285      1346085            0\n2          Therefore urg   NEXT DAY   site_2  2149518     2164956     2151876      2169780            0\n3          Therefore urg   NEXT DAY   site_3  2149518     2164956     2151876      2169780            0\n4   Bad cards must make.    REGULAR   site_0  1628376     1613550     1619838      1611894            0\n5     New proceedings fo    EXPRESS   site_0  2166726     2145036     2173632      2142750            0\n6     New proceedings fo    EXPRESS   site_3  2166726     2145036     2173632      2142750            0\n7    Friendly, suitable     TWO DAY   site_1  1613286     1615440     1610208      1625766            0\n8    Friendly, suitable     TWO DAY   site_2  1613286     1615440     1610208      1625766            0\n9    Friendly, suitable     TWO DAY   site_4  1613286     1615440     1610208      1625766            0\n10   Friendly, suitable     TWO DAY   site_5  1613286     1615440     1610208      1625766            0\n11    Governments should   NEXT DAY   site_2  2165802     2152476     2160300      2146536            0\n12      Please central m  OVERNIGHT   site_4  1613460     1615872     1618908      1622844            0\n13      Please central m  OVERNIGHT   site_8  1344550     1346560     1349090      1352370            0\n14   Friendly, suitable     REGULAR   site_7  1350685     1346525     1346075      1347085            0\n15    Governments should    LIBRARY   site_0  1618890     1623678     1619130      1623540            0\n16    Governments should    LIBRARY   site_8  1349075     1353065     1349275      1352950            0\n17      Please central m    TWO DAY   site_0  1623138     1618434     1622430      1615740            0\n18      Please central m    TWO DAY            541046      539478      540810       538580            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20),\n   sm_type,\n   web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            LIBRARY   site_1    30143       29689       30156        29835            0\n1            EXPRESS   site_5    40030       40521       40069        39764            0\n2            EXPRESS   site_6    39807       40377       40136        40065            0\n3            LIBRARY   site_8    20120       20011       19941        19731            0\n4            REGULAR             19831       19805       20218        20039            0\n5            REGULAR   site_0    30175       29922       29984        29918            0\n6            REGULAR   site_3    30178       29842       30111        29690            0\n7            REGULAR   site_7    19904       19904       19966        19763            0\n8            LIBRARY   site_0    30015       29912       29924        29845            0\n9            TWO DAY             19844       19973       19940        19840            0\n10           EXPRESS   site_3    40055       40407       39814        40175            0\n11         OVERNIGHT   site_0    30083       29926       30102        30147            0\n12          NEXT DAY   site_4    39664       40402       40133        40092            0\n13          NEXT DAY   site_2    39727       40070       39817        40087            0\n14          NEXT DAY   site_0    39917       40215       39574        39903            0\n15           EXPRESS             26412       26869       26503        26643            0\n16          NEXT DAY   site_6    39905       40199       39642        40138            0\n17           EXPRESS   site_1    40256       39559       39688        40196            0\n18           EXPRESS   site_8    26601       26750       26304        26584            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019172,
                    "execution_time": 0.008351,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004489
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057925,
                    "execution_time": 0.008994,
                    "compile_time": 0.002028,
                    "planning_time": 0.039759
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            LIBRARY   site_1    30143       29689       30156        29835            0\n1            EXPRESS   site_5    40030       40521       40069        39764            0\n2            EXPRESS   site_6    39807       40377       40136        40065            0\n3            LIBRARY   site_8    20120       20011       19941        19731            0\n4            REGULAR             19831       19805       20218        20039            0\n5            REGULAR   site_0    30175       29922       29984        29918            0\n6            REGULAR   site_3    30178       29842       30111        29690            0\n7            REGULAR   site_7    19904       19904       19966        19763            0\n8            LIBRARY   site_0    30015       29912       29924        29845            0\n9            TWO DAY             19844       19973       19940        19840            0\n10           EXPRESS   site_3    40055       40407       39814        40175            0\n11         OVERNIGHT   site_0    30083       29926       30102        30147            0\n12          NEXT DAY   site_4    39664       40402       40133        40092            0\n13          NEXT DAY   site_2    39727       40070       39817        40087            0\n14          NEXT DAY   site_0    39917       40215       39574        39903            0\n15           EXPRESS             26412       26869       26503        26643            0\n16          NEXT DAY   site_6    39905       40199       39642        40138            0\n17           EXPRESS   site_1    40256       39559       39688        40196            0\n18           EXPRESS   site_8    26601       26750       26304        26584            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" LIMIT 21",
                "preview": "\n/*   _col_0   sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           EXPRESS   site_6    39807       40377       40136        40065            0\n1           EXPRESS   site_5    40030       40521       40069        39764            0\n2           EXPRESS   site_3    40055       40407       39814        40175            0\n3           EXPRESS   site_8    26601       26750       26304        26584            0\n4           EXPRESS   site_7    26643       26942       26806        26670            0\n5           EXPRESS   site_1    40256       39559       39688        40196            0\n6           EXPRESS             26412       26869       26503        26643            0\n7           EXPRESS   site_0    39847       39969       39625        40131            0\n8           EXPRESS   site_2    39946       40299       40435        40211            0\n9           EXPRESS   site_4    40220       39804       40080        40017            0\n10          LIBRARY   site_2    30147       29753       30227        29938            0\n11          LIBRARY   site_8    20120       20011       19941        19731            0\n12          LIBRARY   site_0    30015       29912       29924        29845            0\n13          LIBRARY   site_7    20357       20008       19967        19836            0\n14          LIBRARY   site_6    30293       29668       29796        29813            0\n15          LIBRARY   site_1    30143       29689       30156        29835            0\n16          LIBRARY   site_3    30051       29929       30382        29832            0\n17          LIBRARY   site_4    29683       30079       29785        30143            0\n18          LIBRARY   site_5    29995       29911       29888        29868            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019065,
                    "execution_time": 0.008132,
                    "compile_time": 8e-05,
                    "planning_time": 0.004494
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056749,
                    "execution_time": 0.008948,
                    "compile_time": 0.001268,
                    "planning_time": 0.040019
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0   sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           EXPRESS   site_6    39807       40377       40136        40065            0\n1           EXPRESS   site_5    40030       40521       40069        39764            0\n2           EXPRESS   site_3    40055       40407       39814        40175            0\n3           EXPRESS   site_8    26601       26750       26304        26584            0\n4           EXPRESS   site_7    26643       26942       26806        26670            0\n5           EXPRESS   site_1    40256       39559       39688        40196            0\n6           EXPRESS             26412       26869       26503        26643            0\n7           EXPRESS   site_0    39847       39969       39625        40131            0\n8           EXPRESS   site_2    39946       40299       40435        40211            0\n9           EXPRESS   site_4    40220       39804       40080        40017            0\n10          LIBRARY   site_2    30147       29753       30227        29938            0\n11          LIBRARY   site_8    20120       20011       19941        19731            0\n12          LIBRARY   site_0    30015       29912       29924        29845            0\n13          LIBRARY   site_7    20357       20008       19967        19836            0\n14          LIBRARY   site_6    30293       29668       29796        29813            0\n15          LIBRARY   site_1    30143       29689       30156        29835            0\n16          LIBRARY   site_3    30051       29929       30382        29832            0\n17          LIBRARY   site_4    29683       30079       29785        30143            0\n18          LIBRARY   site_5    29995       29911       29888        29868            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n       ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"WEB_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0   sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           EXPRESS             26412       26869       26503        26643            0\n1           EXPRESS   site_0    39847       39969       39625        40131            0\n2           EXPRESS   site_1    40256       39559       39688        40196            0\n3           EXPRESS   site_2    39946       40299       40435        40211            0\n4           EXPRESS   site_3    40055       40407       39814        40175            0\n5           EXPRESS   site_4    40220       39804       40080        40017            0\n6           EXPRESS   site_5    40030       40521       40069        39764            0\n7           EXPRESS   site_6    39807       40377       40136        40065            0\n8           EXPRESS   site_7    26643       26942       26806        26670            0\n9           EXPRESS   site_8    26601       26750       26304        26584            0\n10          LIBRARY             19945       19793       20061        19940            0\n11          LIBRARY   site_0    30015       29912       29924        29845            0\n12          LIBRARY   site_1    30143       29689       30156        29835            0\n13          LIBRARY   site_2    30147       29753       30227        29938            0\n14          LIBRARY   site_3    30051       29929       30382        29832            0\n15          LIBRARY   site_4    29683       30079       29785        30143            0\n16          LIBRARY   site_5    29995       29911       29888        29868            0\n17          LIBRARY   site_6    30293       29668       29796        29813            0\n18          LIBRARY   site_7    20357       20008       19967        19836            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019564,
                    "execution_time": 0.008233,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.00475
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05909,
                    "execution_time": 0.010739,
                    "compile_time": 0.001206,
                    "planning_time": 0.040125
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"WEB_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0   sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           EXPRESS             26412       26869       26503        26643            0\n1           EXPRESS   site_0    39847       39969       39625        40131            0\n2           EXPRESS   site_1    40256       39559       39688        40196            0\n3           EXPRESS   site_2    39946       40299       40435        40211            0\n4           EXPRESS   site_3    40055       40407       39814        40175            0\n5           EXPRESS   site_4    40220       39804       40080        40017            0\n6           EXPRESS   site_5    40030       40521       40069        39764            0\n7           EXPRESS   site_6    39807       40377       40136        40065            0\n8           EXPRESS   site_7    26643       26942       26806        26670            0\n9           EXPRESS   site_8    26601       26750       26304        26584            0\n10          LIBRARY             19945       19793       20061        19940            0\n11          LIBRARY   site_0    30015       29912       29924        29845            0\n12          LIBRARY   site_1    30143       29689       30156        29835            0\n13          LIBRARY   site_2    30147       29753       30227        29938            0\n14          LIBRARY   site_3    30051       29929       30382        29832            0\n15          LIBRARY   site_4    29683       30079       29785        30143            0\n16          LIBRARY   site_5    29995       29911       29888        29868            0\n17          LIBRARY   site_6    30293       29668       29796        29813            0\n18          LIBRARY   site_7    20357       20008       19967        19836            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n       ,web_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"WEB_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0   sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           EXPRESS             26412       26869       26503        26643            0\n1           EXPRESS   site_0    39847       39969       39625        40131            0\n2           EXPRESS   site_1    40256       39559       39688        40196            0\n3           EXPRESS   site_2    39946       40299       40435        40211            0\n4           EXPRESS   site_3    40055       40407       39814        40175            0\n5           EXPRESS   site_4    40220       39804       40080        40017            0\n6           EXPRESS   site_5    40030       40521       40069        39764            0\n7           EXPRESS   site_6    39807       40377       40136        40065            0\n8           EXPRESS   site_7    26643       26942       26806        26670            0\n9           EXPRESS   site_8    26601       26750       26304        26584            0\n10          LIBRARY             19945       19793       20061        19940            0\n11          LIBRARY   site_0    30015       29912       29924        29845            0\n12          LIBRARY   site_1    30143       29689       30156        29835            0\n13          LIBRARY   site_2    30147       29753       30227        29938            0\n14          LIBRARY   site_3    30051       29929       30382        29832            0\n15          LIBRARY   site_4    29683       30079       29785        30143            0\n16          LIBRARY   site_5    29995       29911       29888        29868            0\n17          LIBRARY   site_6    30293       29668       29796        29813            0\n18          LIBRARY   site_7    20357       20008       19967        19836            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020693,
                    "execution_time": 0.008918,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.004948
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.02014,
                    "execution_time": 0.008598,
                    "compile_time": 8e-05,
                    "planning_time": 0.004664
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"WEB_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   _col_0   sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           EXPRESS             26412       26869       26503        26643            0\n1           EXPRESS   site_0    39847       39969       39625        40131            0\n2           EXPRESS   site_1    40256       39559       39688        40196            0\n3           EXPRESS   site_2    39946       40299       40435        40211            0\n4           EXPRESS   site_3    40055       40407       39814        40175            0\n5           EXPRESS   site_4    40220       39804       40080        40017            0\n6           EXPRESS   site_5    40030       40521       40069        39764            0\n7           EXPRESS   site_6    39807       40377       40136        40065            0\n8           EXPRESS   site_7    26643       26942       26806        26670            0\n9           EXPRESS   site_8    26601       26750       26304        26584            0\n10          LIBRARY             19945       19793       20061        19940            0\n11          LIBRARY   site_0    30015       29912       29924        29845            0\n12          LIBRARY   site_1    30143       29689       30156        29835            0\n13          LIBRARY   site_2    30147       29753       30227        29938            0\n14          LIBRARY   site_3    30051       29929       30382        29832            0\n15          LIBRARY   site_4    29683       30079       29785        30143            0\n16          LIBRARY   site_5    29995       29911       29888        29868            0\n17          LIBRARY   site_6    30293       29668       29796        29813            0\n18          LIBRARY   site_7    20357       20008       19967        19836            0\n...*/"
    }
]