[
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  c.C_CURRENT_CDEMO_SK as cd_gender,\n  c.C_CURRENT_CDEMO_SK as cd_marital_status,\n  c.C_CURRENT_CDEMO_SK as cd_education_status,\n  count(*) as cnt1,\n  c.C_CURRENT_CDEMO_SK as cd_purchase_estimate,\n  count(*) as cnt2,\n  c.C_CURRENT_CDEMO_SK as cd_credit_rating,\n  count(*) as cnt3,\n  c.C_CURRENT_CDEMO_SK as cd_dep_count,\n  count(*) as cnt4,\n  c.C_CURRENT_CDEMO_SK as cd_dep_employed_count,\n  count(*) as cnt5,\n  c.C_CURRENT_CDEMO_SK as cd_dep_college_count,\n  count(*) as cnt6\n from\n  customer c\n where\n  c.C_CURRENT_ADDR_SK IS NOT NULL and\n  exists (select *\n          from customer\n          where c.C_CUSTOMER_SK = C_CUSTOMER_SK) and\n   (exists (select *\n            from customer\n            where c.C_CUSTOMER_SK = C_CUSTOMER_SK) or \n    exists (select * \n            from customer\n            where c.C_CUSTOMER_SK = C_CUSTOMER_SK))\ngroup by c.C_CURRENT_CDEMO_SK\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_SK\" ) SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"_U_0\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) AND NOT \"C\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.483043,
                    "execution_time": 0.391788,
                    "compile_time": 0.000279,
                    "planning_time": 0.021501,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.550696,
                    "execution_time": 0.453271,
                    "compile_time": 0.000283,
                    "planning_time": 0.021729,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.188096,
                    "execution_time": 1.502127,
                    "compile_time": 0.000894,
                    "planning_time": 0.03256,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.243537,
                    "execution_time": 1.493111,
                    "compile_time": 0.000921,
                    "planning_time": 0.092799,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    cd_gender  cd_marital_status  cd_education_status  cnt1  cd_purchase_estimate  cnt2  cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0     1542691            1542691              1542691     8               1542691     8           1542691     8       1542691     8                1542691     8               1542691     8\n1      940503             940503               940503     5                940503     5            940503     5        940503     5                 940503     5                940503     5\n2      679996             679996               679996     7                679996     7            679996     7        679996     7                 679996     7                679996     7\n3      740056             740056               740056     9                740056     9            740056     9        740056     9                 740056     9                740056     9\n4      332959             332959               332959     8                332959     8            332959     8        332959     8                 332959     8                332959     8\n5      544458             544458               544458    10                544458    10            544458    10        544458    10                 544458    10                544458    10\n6      510683             510683               510683     4                510683     4            510683     4        510683     4                 510683     4                510683     4\n7      662012             662012               662012     8                662012     8            662012     8        662012     8                 662012     8                662012     8\n8     1863881            1863881              1863881     9               1863881     9           1863881     9       1863881     9                1863881     9               1863881     9\n9      920279             920279               920279     5                920279     5            920279     5        920279     5                 920279     5                920279     5\n10    1143236            1143236              1143236     4               1143236     4           1143236     4       1143236     4                1143236     4               1143236     4\n11    1764221            1764221              1764221     6               1764221     6           1764221     6       1764221     6                1764221     6               1764221     6\n12     157538             157538               157538     6                157538     6            157538     6        157538     6                 157538     6                157538     6\n13     308576             308576               308576     8                308576     8            308576     8        308576     8                 308576     8                308576     8\n14    1920111            1920111              1920111     4               1920111     4           1920111     4       1920111     4                1920111     4               1920111     4\n15    1533183            1533183              1533183    12               1533183    12           1533183    12       1533183    12                1533183    12               1533183    12\n16    1158572            1158572              1158572     9               1158572     9           1158572     9       1158572     9                1158572     9               1158572     9\n17     522424             522424               522424     5                522424     5            522424     5        522424     5                 522424     5                522424     5\n18    1047963            1047963              1047963     9               1047963     9           1047963     9       1047963     9                1047963     9               1047963     9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020169,
                    "execution_time": 0.008355,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.00489
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058204,
                    "execution_time": 0.009064,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040367
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) AND NOT \"C\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    cd_gender  cd_marital_status  cd_education_status  cnt1  cd_purchase_estimate  cnt2  cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0     1542691            1542691              1542691     8               1542691     8           1542691     8       1542691     8                1542691     8               1542691     8\n1      940503             940503               940503     5                940503     5            940503     5        940503     5                 940503     5                940503     5\n2      679996             679996               679996     7                679996     7            679996     7        679996     7                 679996     7                679996     7\n3      740056             740056               740056     9                740056     9            740056     9        740056     9                 740056     9                740056     9\n4      332959             332959               332959     8                332959     8            332959     8        332959     8                 332959     8                332959     8\n5      544458             544458               544458    10                544458    10            544458    10        544458    10                 544458    10                544458    10\n6      510683             510683               510683     4                510683     4            510683     4        510683     4                 510683     4                510683     4\n7      662012             662012               662012     8                662012     8            662012     8        662012     8                 662012     8                662012     8\n8     1863881            1863881              1863881     9               1863881     9           1863881     9       1863881     9                1863881     9               1863881     9\n9      920279             920279               920279     5                920279     5            920279     5        920279     5                 920279     5                920279     5\n10    1143236            1143236              1143236     4               1143236     4           1143236     4       1143236     4                1143236     4               1143236     4\n11    1764221            1764221              1764221     6               1764221     6           1764221     6       1764221     6                1764221     6               1764221     6\n12     157538             157538               157538     6                157538     6            157538     6        157538     6                 157538     6                157538     6\n13     308576             308576               308576     8                308576     8            308576     8        308576     8                 308576     8                308576     8\n14    1920111            1920111              1920111     4               1920111     4           1920111     4       1920111     4                1920111     4               1920111     4\n15    1533183            1533183              1533183    12               1533183    12           1533183    12       1533183    12                1533183    12               1533183    12\n16    1158572            1158572              1158572     9               1158572     9           1158572     9       1158572     9                1158572     9               1158572     9\n17     522424             522424               522424     5                522424     5            522424     5        522424     5                 522424     5                522424     5\n18    1047963            1047963              1047963     9               1047963     9           1047963     9       1047963     9                1047963     9               1047963     9\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\nfrom\n  customer c, customer_address ca, customer_demographics cd\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca.ca_county in ('Chautauqua County', 'Cherokee County', 'Bell County', 'Washington County', 'Clarke County') and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 2000 and\n                d.d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales ws, date_dim d\n            where c.c_customer_sk = ws.ws_bill_customer_sk and\n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 2000 and\n                  d.d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales cs, date_dim d\n            where c.c_customer_sk = cs.cs_ship_customer_sk and\n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 2000 and\n                  d.d_moy between 2 and 2+3))\ngroup by \n  cd_gender, \n  cd_marital_status, \n  cd_education_status, \n  cd_purchase_estimate, \n  cd_credit_rating, \n  cd_dep_count, \n  cd_dep_employed_count, \n  cd_dep_college_count \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 5 AND \"D\".\"D_MOY\" >= 2 AND \"D\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 5 AND \"D\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.216822,
                    "execution_time": 0.059015,
                    "compile_time": 0.000328,
                    "planning_time": 0.026305,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.243634,
                    "execution_time": 0.082774,
                    "compile_time": 0.00036,
                    "planning_time": 0.026878,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 12.602945,
                    "execution_time": 12.503495,
                    "compile_time": 0.000372,
                    "planning_time": 0.025038,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.378854,
                    "execution_time": 15.276122,
                    "compile_time": 0.000356,
                    "planning_time": 0.025358,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.611984,
                    "execution_time": 1.510701,
                    "compile_time": 0.000361,
                    "planning_time": 0.02628,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.688894,
                    "execution_time": 3.584544,
                    "compile_time": 0.00037,
                    "planning_time": 0.026188,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.250129,
                    "execution_time": 3.148058,
                    "compile_time": 0.000369,
                    "planning_time": 0.027105,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.937531,
                    "execution_time": 7.830139,
                    "compile_time": 0.000375,
                    "planning_time": 0.028026,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.824124,
                    "execution_time": 0.280299,
                    "compile_time": 0.000941,
                    "planning_time": 0.048284,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.900485,
                    "execution_time": 2.353815,
                    "compile_time": 0.000961,
                    "planning_time": 0.048403,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5500     1          Unknown     1             1     1                      2     1                     5     1\n1          F                 D         4 yr Degree     1                  7500     1             Good     1             3     1                      5     1                     3     1\n2          F                 S     Advanced Degree     1                 10000     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 U             College     1                  7000     1        High Risk     1             6     1                      4     1                     2     1\n4          M                 M         2 yr Degree     1                  5500     1         Low Risk     1             5     1                      0     1                     5     1\n5          M                 M             College     1                  1000     1        High Risk     1             1     1                      1     1                     2     1\n6          M                 W             Primary     1                  3500     1             Good     1             6     1                      1     1                     2     1\n7          M                 U             Unknown     1                  6000     1        High Risk     1             0     1                      3     1                     6     1\n8          M                 W             College     1                   500     1         Low Risk     1             1     1                      3     1                     5     1\n9          M                 W     Advanced Degree     1                  7500     1        High Risk     1             5     1                      6     1                     3     1\n10         F                 W           Secondary     1                 10000     1             Good     1             1     1                      2     1                     3     1\n11         F                 W     Advanced Degree     1                  1000     1        High Risk     1             6     1                      0     1                     4     1\n12         M                 M         4 yr Degree     1                  3500     1          Unknown     1             1     1                      1     1                     3     1\n13         M                 M           Secondary     1                  7500     1         Low Risk     1             4     1                      5     1                     5     1\n14         F                 M     Advanced Degree     1                  4000     1         Low Risk     1             5     1                      2     1                     4     1\n15         M                 W           Secondary     1                  6500     1             Good     1             2     1                      2     1                     3     1\n16         F                 U         4 yr Degree     2                  4000     2        High Risk     2             6     2                      4     2                     4     2\n17         M                 M         4 yr Degree     1                  2500     1             Good     1             0     1                      3     1                     5     1\n18         M                 D             College     1                  4500     1         Low Risk     1             6     1                      4     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020908,
                    "execution_time": 0.008657,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005012
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057855,
                    "execution_time": 0.008692,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040508
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5500     1          Unknown     1             1     1                      2     1                     5     1\n1          F                 D         4 yr Degree     1                  7500     1             Good     1             3     1                      5     1                     3     1\n2          F                 S     Advanced Degree     1                 10000     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 U             College     1                  7000     1        High Risk     1             6     1                      4     1                     2     1\n4          M                 M         2 yr Degree     1                  5500     1         Low Risk     1             5     1                      0     1                     5     1\n5          M                 M             College     1                  1000     1        High Risk     1             1     1                      1     1                     2     1\n6          M                 W             Primary     1                  3500     1             Good     1             6     1                      1     1                     2     1\n7          M                 U             Unknown     1                  6000     1        High Risk     1             0     1                      3     1                     6     1\n8          M                 W             College     1                   500     1         Low Risk     1             1     1                      3     1                     5     1\n9          M                 W     Advanced Degree     1                  7500     1        High Risk     1             5     1                      6     1                     3     1\n10         F                 W           Secondary     1                 10000     1             Good     1             1     1                      2     1                     3     1\n11         F                 W     Advanced Degree     1                  1000     1        High Risk     1             6     1                      0     1                     4     1\n12         M                 M         4 yr Degree     1                  3500     1          Unknown     1             1     1                      1     1                     3     1\n13         M                 M           Secondary     1                  7500     1         Low Risk     1             4     1                      5     1                     5     1\n14         F                 M     Advanced Degree     1                  4000     1         Low Risk     1             5     1                      2     1                     4     1\n15         M                 W           Secondary     1                  6500     1             Good     1             2     1                      2     1                     3     1\n16         F                 U         4 yr Degree     2                  4000     2        High Risk     2             6     2                      4     2                     4     2\n17         M                 M         4 yr Degree     1                  2500     1             Good     1             0     1                      3     1                     5     1\n18         M                 D             College     1                  4500     1         Low Risk     1             6     1                      4     1                     2     1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.218986,
                    "execution_time": 0.060494,
                    "compile_time": 0.000317,
                    "planning_time": 0.027353,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.283058,
                    "execution_time": 0.063643,
                    "compile_time": 0.000347,
                    "planning_time": 0.087786,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.335255,
                    "execution_time": 14.235519,
                    "compile_time": 0.000376,
                    "planning_time": 0.025208,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.198548,
                    "execution_time": 14.038596,
                    "compile_time": 0.000357,
                    "planning_time": 0.085318,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.500725,
                    "execution_time": 1.394698,
                    "compile_time": 0.000357,
                    "planning_time": 0.026805,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.291028,
                    "execution_time": 3.128194,
                    "compile_time": 0.000374,
                    "planning_time": 0.088171,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.214894,
                    "execution_time": 3.113374,
                    "compile_time": 0.000359,
                    "planning_time": 0.026709,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.262673,
                    "execution_time": 7.094552,
                    "compile_time": 0.000384,
                    "planning_time": 0.091774,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.82554,
                    "execution_time": 0.278021,
                    "compile_time": 0.000981,
                    "planning_time": 0.04801,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.93157,
                    "execution_time": 0.321405,
                    "compile_time": 0.000912,
                    "planning_time": 0.115646,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 W             College     1                  9500     1        High Risk     1             6     1                      0     1                     3     1\n1          M                 D           Secondary     1                  9000     1        High Risk     1             5     1                      6     1                     3     1\n2          F                 W             Unknown     1                  9000     1          Unknown     1             2     1                      1     1                     5     1\n3          M                 D           Secondary     1                  3500     1          Unknown     1             6     1                      6     1                     5     1\n4          F                 W         2 yr Degree     1                  3000     1          Unknown     1             5     1                      4     1                     6     1\n5          M                 S             College     2                  5000     2             Good     2             6     2                      4     2                     5     2\n6          F                 M             College     1                  3500     1          Unknown     1             4     1                      2     1                     3     1\n7          F                 U         4 yr Degree     1                  5500     1         Low Risk     1             2     1                      3     1                     1     1\n8          M                 M             Primary     1                  4000     1        High Risk     1             1     1                      3     1                     0     1\n9          M                 S         4 yr Degree     1                  2500     1          Unknown     1             0     1                      2     1                     4     1\n10         M                 S         4 yr Degree     1                  5000     1             Good     1             3     1                      5     1                     4     1\n11         F                 D             College     1                  7500     1        High Risk     1             3     1                      5     1                     2     1\n12         F                 W             Primary     1                  1500     1        High Risk     1             5     1                      6     1                     0     1\n13         F                 W             College     1                  9000     1          Unknown     1             3     1                      5     1                     1     1\n14         M                 W         2 yr Degree     1                  5500     1         Low Risk     1             5     1                      6     1                     6     1\n15         M                 S         2 yr Degree     1                   500     1          Unknown     1             2     1                      4     1                     5     1\n16         F                 S             Primary     1                  1000     1          Unknown     1             2     1                      6     1                     2     1\n17         M                 M           Secondary     1                  1000     1         Low Risk     1             0     1                      6     1                     2     1\n18         M                 W             Primary     1                  1500     1        High Risk     1             1     1                      2     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020426,
                    "execution_time": 0.008062,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005032
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056229,
                    "execution_time": 0.008807,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.04042
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 W             College     1                  9500     1        High Risk     1             6     1                      0     1                     3     1\n1          M                 D           Secondary     1                  9000     1        High Risk     1             5     1                      6     1                     3     1\n2          F                 W             Unknown     1                  9000     1          Unknown     1             2     1                      1     1                     5     1\n3          M                 D           Secondary     1                  3500     1          Unknown     1             6     1                      6     1                     5     1\n4          F                 W         2 yr Degree     1                  3000     1          Unknown     1             5     1                      4     1                     6     1\n5          M                 S             College     2                  5000     2             Good     2             6     2                      4     2                     5     2\n6          F                 M             College     1                  3500     1          Unknown     1             4     1                      2     1                     3     1\n7          F                 U         4 yr Degree     1                  5500     1         Low Risk     1             2     1                      3     1                     1     1\n8          M                 M             Primary     1                  4000     1        High Risk     1             1     1                      3     1                     0     1\n9          M                 S         4 yr Degree     1                  2500     1          Unknown     1             0     1                      2     1                     4     1\n10         M                 S         4 yr Degree     1                  5000     1             Good     1             3     1                      5     1                     4     1\n11         F                 D             College     1                  7500     1        High Risk     1             3     1                      5     1                     2     1\n12         F                 W             Primary     1                  1500     1        High Risk     1             5     1                      6     1                     0     1\n13         F                 W             College     1                  9000     1          Unknown     1             3     1                      5     1                     1     1\n14         M                 W         2 yr Degree     1                  5500     1         Low Risk     1             5     1                      6     1                     6     1\n15         M                 S         2 yr Degree     1                   500     1          Unknown     1             2     1                      4     1                     5     1\n16         F                 S             Primary     1                  1000     1          Unknown     1             2     1                      6     1                     2     1\n17         M                 M           Secondary     1                  1000     1         Low Risk     1             0     1                      6     1                     2     1\n18         M                 W             Primary     1                  1500     1        High Risk     1             1     1                      2     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" AS \"D_DATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DOW\" AS \"D_DOW\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DOM\" AS \"D_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.219693,
                    "execution_time": 0.077773,
                    "compile_time": 0.000325,
                    "planning_time": 0.007301,
                    "create_size": 1054
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.451788,
                    "execution_time": 0.253159,
                    "compile_time": 0.000329,
                    "planning_time": 0.062756,
                    "create_size": 992
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.332531,
                    "execution_time": 14.232222,
                    "compile_time": 0.000387,
                    "planning_time": 0.025798,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.103199,
                    "execution_time": 13.940973,
                    "compile_time": 0.000371,
                    "planning_time": 0.086473,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.491879,
                    "execution_time": 1.39009,
                    "compile_time": 0.000355,
                    "planning_time": 0.027427,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.264838,
                    "execution_time": 3.100081,
                    "compile_time": 0.000378,
                    "planning_time": 0.088941,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.186811,
                    "execution_time": 4.084564,
                    "compile_time": 0.000355,
                    "planning_time": 0.027165,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.214002,
                    "execution_time": 7.051508,
                    "compile_time": 0.000355,
                    "planning_time": 0.087777,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.827724,
                    "execution_time": 0.281003,
                    "compile_time": 0.000941,
                    "planning_time": 0.049056,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.915451,
                    "execution_time": 0.301583,
                    "compile_time": 0.000947,
                    "planning_time": 0.116641,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Unknown     1                  3500     1          Unknown     1             5     1                      0     1                     2     1\n1          M                 U             College     1                  6500     1         Low Risk     1             2     1                      6     1                     0     1\n2          M                 S             College     2                  1500     2          Unknown     2             0     2                      2     2                     5     2\n3          F                 D             College     1                  6000     1          Unknown     1             0     1                      2     1                     2     1\n4          F                 W             Unknown     1                  8500     1          Unknown     1             5     1                      0     1                     1     1\n5          M                 S     Advanced Degree     1                  8500     1         Low Risk     1             6     1                      2     1                     1     1\n6          F                 M         4 yr Degree     1                  1000     1         Low Risk     1             6     1                      6     1                     2     1\n7          F                 M     Advanced Degree     1                  1000     1             Good     1             0     1                      6     1                     1     1\n8          F                 U         2 yr Degree     1                  2500     1          Unknown     1             0     1                      5     1                     1     1\n9          F                 M             Primary     1                  1500     1          Unknown     1             2     1                      3     1                     3     1\n10         M                 W         4 yr Degree     1                  7500     1          Unknown     1             6     1                      2     1                     0     1\n11         M                 U             College     1                  7500     1         Low Risk     1             2     1                      3     1                     4     1\n12         F                 W           Secondary     1                   500     1          Unknown     1             4     1                      0     1                     0     1\n13         M                 W             Primary     1                  4500     1          Unknown     1             2     1                      1     1                     5     1\n14         M                 W     Advanced Degree     1                  9500     1          Unknown     1             4     1                      1     1                     2     1\n15         M                 D     Advanced Degree     1                  5500     1          Unknown     1             0     1                      6     1                     0     1\n16         F                 S           Secondary     1                  8500     1          Unknown     1             5     1                      4     1                     6     1\n17         M                 S             Primary     1                  8000     1        High Risk     1             6     1                      5     1                     5     1\n18         F                 S         4 yr Degree     1                 10000     1         Low Risk     1             2     1                      4     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019931,
                    "execution_time": 0.007789,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056494,
                    "execution_time": 0.008719,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.040578
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Unknown     1                  3500     1          Unknown     1             5     1                      0     1                     2     1\n1          M                 U             College     1                  6500     1         Low Risk     1             2     1                      6     1                     0     1\n2          M                 S             College     2                  1500     2          Unknown     2             0     2                      2     2                     5     2\n3          F                 D             College     1                  6000     1          Unknown     1             0     1                      2     1                     2     1\n4          F                 W             Unknown     1                  8500     1          Unknown     1             5     1                      0     1                     1     1\n5          M                 S     Advanced Degree     1                  8500     1         Low Risk     1             6     1                      2     1                     1     1\n6          F                 M         4 yr Degree     1                  1000     1         Low Risk     1             6     1                      6     1                     2     1\n7          F                 M     Advanced Degree     1                  1000     1             Good     1             0     1                      6     1                     1     1\n8          F                 U         2 yr Degree     1                  2500     1          Unknown     1             0     1                      5     1                     1     1\n9          F                 M             Primary     1                  1500     1          Unknown     1             2     1                      3     1                     3     1\n10         M                 W         4 yr Degree     1                  7500     1          Unknown     1             6     1                      2     1                     0     1\n11         M                 U             College     1                  7500     1         Low Risk     1             2     1                      3     1                     4     1\n12         F                 W           Secondary     1                   500     1          Unknown     1             4     1                      0     1                     0     1\n13         M                 W             Primary     1                  4500     1          Unknown     1             2     1                      1     1                     5     1\n14         M                 W     Advanced Degree     1                  9500     1          Unknown     1             4     1                      1     1                     2     1\n15         M                 D     Advanced Degree     1                  5500     1          Unknown     1             0     1                      6     1                     0     1\n16         F                 S           Secondary     1                  8500     1          Unknown     1             5     1                      4     1                     6     1\n17         M                 S             Primary     1                  8000     1        High Risk     1             6     1                      5     1                     5     1\n18         F                 S         4 yr Degree     1                 10000     1         Low Risk     1             2     1                      4     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Unknown     1                  3500     1          Unknown     1             5     1                      0     1                     2     1\n1          M                 U             College     1                  6500     1         Low Risk     1             2     1                      6     1                     0     1\n2          M                 S             College     2                  1500     2          Unknown     2             0     2                      2     2                     5     2\n3          F                 D             College     1                  6000     1          Unknown     1             0     1                      2     1                     2     1\n4          F                 W             Unknown     1                  8500     1          Unknown     1             5     1                      0     1                     1     1\n5          M                 S     Advanced Degree     1                  8500     1         Low Risk     1             6     1                      2     1                     1     1\n6          F                 M         4 yr Degree     1                  1000     1         Low Risk     1             6     1                      6     1                     2     1\n7          F                 M     Advanced Degree     1                  1000     1             Good     1             0     1                      6     1                     1     1\n8          F                 U         2 yr Degree     1                  2500     1          Unknown     1             0     1                      5     1                     1     1\n9          F                 M             Primary     1                  1500     1          Unknown     1             2     1                      3     1                     3     1\n10         M                 W         4 yr Degree     1                  7500     1          Unknown     1             6     1                      2     1                     0     1\n11         M                 U             College     1                  7500     1         Low Risk     1             2     1                      3     1                     4     1\n12         F                 W           Secondary     1                   500     1          Unknown     1             4     1                      0     1                     0     1\n13         M                 W             Primary     1                  4500     1          Unknown     1             2     1                      1     1                     5     1\n14         M                 W     Advanced Degree     1                  9500     1          Unknown     1             4     1                      1     1                     2     1\n15         M                 D     Advanced Degree     1                  5500     1          Unknown     1             0     1                      6     1                     0     1\n16         F                 S           Secondary     1                  8500     1          Unknown     1             5     1                      4     1                     6     1\n17         M                 S             Primary     1                  8000     1        High Risk     1             6     1                      5     1                     5     1\n18         F                 S         4 yr Degree     1                 10000     1         Low Risk     1             2     1                      4     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019688,
                    "execution_time": 0.007938,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004904
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05526,
                    "execution_time": 0.008327,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.039825
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Unknown     1                  3500     1          Unknown     1             5     1                      0     1                     2     1\n1          M                 U             College     1                  6500     1         Low Risk     1             2     1                      6     1                     0     1\n2          M                 S             College     2                  1500     2          Unknown     2             0     2                      2     2                     5     2\n3          F                 D             College     1                  6000     1          Unknown     1             0     1                      2     1                     2     1\n4          F                 W             Unknown     1                  8500     1          Unknown     1             5     1                      0     1                     1     1\n5          M                 S     Advanced Degree     1                  8500     1         Low Risk     1             6     1                      2     1                     1     1\n6          F                 M         4 yr Degree     1                  1000     1         Low Risk     1             6     1                      6     1                     2     1\n7          F                 M     Advanced Degree     1                  1000     1             Good     1             0     1                      6     1                     1     1\n8          F                 U         2 yr Degree     1                  2500     1          Unknown     1             0     1                      5     1                     1     1\n9          F                 M             Primary     1                  1500     1          Unknown     1             2     1                      3     1                     3     1\n10         M                 W         4 yr Degree     1                  7500     1          Unknown     1             6     1                      2     1                     0     1\n11         M                 U             College     1                  7500     1         Low Risk     1             2     1                      3     1                     4     1\n12         F                 W           Secondary     1                   500     1          Unknown     1             4     1                      0     1                     0     1\n13         M                 W             Primary     1                  4500     1          Unknown     1             2     1                      1     1                     5     1\n14         M                 W     Advanced Degree     1                  9500     1          Unknown     1             4     1                      1     1                     2     1\n15         M                 D     Advanced Degree     1                  5500     1          Unknown     1             0     1                      6     1                     0     1\n16         F                 S           Secondary     1                  8500     1          Unknown     1             5     1                      4     1                     6     1\n17         M                 S             Primary     1                  8000     1        High Risk     1             6     1                      5     1                     5     1\n18         F                 S         4 yr Degree     1                 10000     1         Low Risk     1             2     1                      4     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 D     Advanced Degree     1                  4500     1          Unknown     1             1     1                      1     1                     2     1\n1          F                 U             Unknown     1                  3500     1          Unknown     1             3     1                      3     1                     2     1\n2          M                 W             College     1                 10000     1        High Risk     1             1     1                      3     1                     3     1\n3          M                 S         2 yr Degree     1                  6000     1        High Risk     1             4     1                      4     1                     0     1\n4          F                 U     Advanced Degree     1                  2000     1          Unknown     1             1     1                      2     1                     1     1\n5          F                 W         4 yr Degree     1                  8500     1        High Risk     1             2     1                      2     1                     1     1\n6          F                 U     Advanced Degree     1                  4500     1        High Risk     1             3     1                      4     1                     4     1\n7          M                 U             College     1                 10000     1             Good     1             6     1                      2     1                     3     1\n8          M                 U             Unknown     1                  8000     1          Unknown     1             6     1                      2     1                     6     1\n9          F                 M         2 yr Degree     2                  8500     2             Good     2             5     2                      4     2                     1     2\n10         M                 S         4 yr Degree     1                  3500     1         Low Risk     1             5     1                      1     1                     3     1\n11         M                 D             College     1                  4000     1        High Risk     1             1     1                      2     1                     4     1\n12         F                 M         2 yr Degree     1                  4000     1          Unknown     1             4     1                      2     1                     1     1\n13         M                 M             College     1                  4000     1         Low Risk     1             0     1                      5     1                     2     1\n14         M                 M           Secondary     1                  9000     1             Good     1             3     1                      0     1                     1     1\n15         M                 U             College     1                  1500     1          Unknown     1             0     1                      0     1                     2     1\n16         F                 D             Unknown     1                  1500     1        High Risk     1             1     1                      2     1                     0     1\n17         F                 M     Advanced Degree     1                 10000     1             Good     1             5     1                      5     1                     5     1\n18         M                 D     Advanced Degree     1                 10000     1             Good     1             0     1                      2     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020613,
                    "execution_time": 0.008607,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004925
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020649,
                    "execution_time": 0.008162,
                    "compile_time": 6e-05,
                    "planning_time": 0.005235
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 D     Advanced Degree     1                  4500     1          Unknown     1             1     1                      1     1                     2     1\n1          F                 U             Unknown     1                  3500     1          Unknown     1             3     1                      3     1                     2     1\n2          M                 W             College     1                 10000     1        High Risk     1             1     1                      3     1                     3     1\n3          M                 S         2 yr Degree     1                  6000     1        High Risk     1             4     1                      4     1                     0     1\n4          F                 U     Advanced Degree     1                  2000     1          Unknown     1             1     1                      2     1                     1     1\n5          F                 W         4 yr Degree     1                  8500     1        High Risk     1             2     1                      2     1                     1     1\n6          F                 U     Advanced Degree     1                  4500     1        High Risk     1             3     1                      4     1                     4     1\n7          M                 U             College     1                 10000     1             Good     1             6     1                      2     1                     3     1\n8          M                 U             Unknown     1                  8000     1          Unknown     1             6     1                      2     1                     6     1\n9          F                 M         2 yr Degree     2                  8500     2             Good     2             5     2                      4     2                     1     2\n10         M                 S         4 yr Degree     1                  3500     1         Low Risk     1             5     1                      1     1                     3     1\n11         M                 D             College     1                  4000     1        High Risk     1             1     1                      2     1                     4     1\n12         F                 M         2 yr Degree     1                  4000     1          Unknown     1             4     1                      2     1                     1     1\n13         M                 M             College     1                  4000     1         Low Risk     1             0     1                      5     1                     2     1\n14         M                 M           Secondary     1                  9000     1             Good     1             3     1                      0     1                     1     1\n15         M                 U             College     1                  1500     1          Unknown     1             0     1                      0     1                     2     1\n16         F                 D             Unknown     1                  1500     1        High Risk     1             1     1                      2     1                     0     1\n17         F                 M     Advanced Degree     1                 10000     1             Good     1             5     1                      5     1                     5     1\n18         M                 D     Advanced Degree     1                 10000     1             Good     1             0     1                      2     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 U             Primary     1                  5000     1             Good     1             4     1                      2     1                     0     1\n1          F                 M         2 yr Degree     1                  7000     1             Good     1             5     1                      0     1                     0     1\n2          M                 S             Unknown     1                  1000     1        High Risk     1             3     1                      4     1                     5     1\n3          M                 M         4 yr Degree     1                  3500     1             Good     1             1     1                      2     1                     5     1\n4          M                 D           Secondary     1                  3500     1        High Risk     1             1     1                      5     1                     6     1\n5          F                 D             College     1                  8500     1          Unknown     1             3     1                      5     1                     4     1\n6          F                 W         2 yr Degree     1                  1000     1          Unknown     1             4     1                      1     1                     1     1\n7          F                 D           Secondary     1                 10000     1        High Risk     1             1     1                      0     1                     6     1\n8          F                 M           Secondary     1                  6000     1         Low Risk     1             6     1                      3     1                     0     1\n9          F                 W           Secondary     2                  4500     2         Low Risk     2             2     2                      6     2                     0     2\n10         M                 S             Unknown     1                  8000     1        High Risk     1             0     1                      0     1                     6     1\n11         F                 S         2 yr Degree     1                  1500     1         Low Risk     1             0     1                      0     1                     3     1\n12         M                 U         4 yr Degree     1                  4000     1          Unknown     1             5     1                      3     1                     5     1\n13         M                 M             Unknown     2                   500     2             Good     2             0     2                      2     2                     1     2\n14         M                 M             Unknown     1                  2500     1         Low Risk     1             6     1                      6     1                     5     1\n15         F                 S             College     1                  1000     1         Low Risk     1             6     1                      5     1                     2     1\n16         F                 W           Secondary     1                  8500     1         Low Risk     1             0     1                      6     1                     2     1\n17         M                 W         4 yr Degree     1                 10000     1             Good     1             1     1                      6     1                     2     1\n18         M                 S             Unknown     1                  3000     1         Low Risk     1             3     1                      0     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01954,
                    "execution_time": 0.007788,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004936
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020684,
                    "execution_time": 0.008487,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.00509
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 U             Primary     1                  5000     1             Good     1             4     1                      2     1                     0     1\n1          F                 M         2 yr Degree     1                  7000     1             Good     1             5     1                      0     1                     0     1\n2          M                 S             Unknown     1                  1000     1        High Risk     1             3     1                      4     1                     5     1\n3          M                 M         4 yr Degree     1                  3500     1             Good     1             1     1                      2     1                     5     1\n4          M                 D           Secondary     1                  3500     1        High Risk     1             1     1                      5     1                     6     1\n5          F                 D             College     1                  8500     1          Unknown     1             3     1                      5     1                     4     1\n6          F                 W         2 yr Degree     1                  1000     1          Unknown     1             4     1                      1     1                     1     1\n7          F                 D           Secondary     1                 10000     1        High Risk     1             1     1                      0     1                     6     1\n8          F                 M           Secondary     1                  6000     1         Low Risk     1             6     1                      3     1                     0     1\n9          F                 W           Secondary     2                  4500     2         Low Risk     2             2     2                      6     2                     0     2\n10         M                 S             Unknown     1                  8000     1        High Risk     1             0     1                      0     1                     6     1\n11         F                 S         2 yr Degree     1                  1500     1         Low Risk     1             0     1                      0     1                     3     1\n12         M                 U         4 yr Degree     1                  4000     1          Unknown     1             5     1                      3     1                     5     1\n13         M                 M             Unknown     2                   500     2             Good     2             0     2                      2     2                     1     2\n14         M                 M             Unknown     1                  2500     1         Low Risk     1             6     1                      6     1                     5     1\n15         F                 S             College     1                  1000     1         Low Risk     1             6     1                      5     1                     2     1\n16         F                 W           Secondary     1                  8500     1         Low Risk     1             0     1                      6     1                     2     1\n17         M                 W         4 yr Degree     1                 10000     1             Good     1             1     1                      6     1                     2     1\n18         M                 S             Unknown     1                  3000     1         Low Risk     1             3     1                      0     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 D     Advanced Degree     1                  4500     1          Unknown     1             1     1                      1     1                     2     1\n1          F                 U             Unknown     1                  3500     1          Unknown     1             3     1                      3     1                     2     1\n2          M                 W             College     1                 10000     1        High Risk     1             1     1                      3     1                     3     1\n3          M                 S         2 yr Degree     1                  6000     1        High Risk     1             4     1                      4     1                     0     1\n4          F                 U     Advanced Degree     1                  2000     1          Unknown     1             1     1                      2     1                     1     1\n5          F                 W         4 yr Degree     1                  8500     1        High Risk     1             2     1                      2     1                     1     1\n6          F                 U     Advanced Degree     1                  4500     1        High Risk     1             3     1                      4     1                     4     1\n7          M                 U             College     1                 10000     1             Good     1             6     1                      2     1                     3     1\n8          M                 U             Unknown     1                  8000     1          Unknown     1             6     1                      2     1                     6     1\n9          F                 M         2 yr Degree     2                  8500     2             Good     2             5     2                      4     2                     1     2\n10         M                 S         4 yr Degree     1                  3500     1         Low Risk     1             5     1                      1     1                     3     1\n11         M                 D             College     1                  4000     1        High Risk     1             1     1                      2     1                     4     1\n12         F                 M         2 yr Degree     1                  4000     1          Unknown     1             4     1                      2     1                     1     1\n13         M                 M             College     1                  4000     1         Low Risk     1             0     1                      5     1                     2     1\n14         M                 M           Secondary     1                  9000     1             Good     1             3     1                      0     1                     1     1\n15         M                 U             College     1                  1500     1          Unknown     1             0     1                      0     1                     2     1\n16         F                 D             Unknown     1                  1500     1        High Risk     1             1     1                      2     1                     0     1\n17         F                 M     Advanced Degree     1                 10000     1             Good     1             5     1                      5     1                     5     1\n18         M                 D     Advanced Degree     1                 10000     1             Good     1             0     1                      2     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019545,
                    "execution_time": 0.007716,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005001
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020326,
                    "execution_time": 0.008156,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005115
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 D     Advanced Degree     1                  4500     1          Unknown     1             1     1                      1     1                     2     1\n1          F                 U             Unknown     1                  3500     1          Unknown     1             3     1                      3     1                     2     1\n2          M                 W             College     1                 10000     1        High Risk     1             1     1                      3     1                     3     1\n3          M                 S         2 yr Degree     1                  6000     1        High Risk     1             4     1                      4     1                     0     1\n4          F                 U     Advanced Degree     1                  2000     1          Unknown     1             1     1                      2     1                     1     1\n5          F                 W         4 yr Degree     1                  8500     1        High Risk     1             2     1                      2     1                     1     1\n6          F                 U     Advanced Degree     1                  4500     1        High Risk     1             3     1                      4     1                     4     1\n7          M                 U             College     1                 10000     1             Good     1             6     1                      2     1                     3     1\n8          M                 U             Unknown     1                  8000     1          Unknown     1             6     1                      2     1                     6     1\n9          F                 M         2 yr Degree     2                  8500     2             Good     2             5     2                      4     2                     1     2\n10         M                 S         4 yr Degree     1                  3500     1         Low Risk     1             5     1                      1     1                     3     1\n11         M                 D             College     1                  4000     1        High Risk     1             1     1                      2     1                     4     1\n12         F                 M         2 yr Degree     1                  4000     1          Unknown     1             4     1                      2     1                     1     1\n13         M                 M             College     1                  4000     1         Low Risk     1             0     1                      5     1                     2     1\n14         M                 M           Secondary     1                  9000     1             Good     1             3     1                      0     1                     1     1\n15         M                 U             College     1                  1500     1          Unknown     1             0     1                      0     1                     2     1\n16         F                 D             Unknown     1                  1500     1        High Risk     1             1     1                      2     1                     0     1\n17         F                 M     Advanced Degree     1                 10000     1             Good     1             5     1                      5     1                     5     1\n18         M                 D     Advanced Degree     1                 10000     1             Good     1             0     1                      2     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\ncd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Unknown     1                  3500     1          Unknown     1             5     1                      0     1                     2     1\n1          M                 U             College     1                  6500     1         Low Risk     1             2     1                      6     1                     0     1\n2          M                 S             College     2                  1500     2          Unknown     2             0     2                      2     2                     5     2\n3          F                 D             College     1                  6000     1          Unknown     1             0     1                      2     1                     2     1\n4          F                 W             Unknown     1                  8500     1          Unknown     1             5     1                      0     1                     1     1\n5          M                 S     Advanced Degree     1                  8500     1         Low Risk     1             6     1                      2     1                     1     1\n6          F                 M         4 yr Degree     1                  1000     1         Low Risk     1             6     1                      6     1                     2     1\n7          F                 M     Advanced Degree     1                  1000     1             Good     1             0     1                      6     1                     1     1\n8          F                 U         2 yr Degree     1                  2500     1          Unknown     1             0     1                      5     1                     1     1\n9          F                 M             Primary     1                  1500     1          Unknown     1             2     1                      3     1                     3     1\n10         M                 W         4 yr Degree     1                  7500     1          Unknown     1             6     1                      2     1                     0     1\n11         M                 U             College     1                  7500     1         Low Risk     1             2     1                      3     1                     4     1\n12         F                 W           Secondary     1                   500     1          Unknown     1             4     1                      0     1                     0     1\n13         M                 W             Primary     1                  4500     1          Unknown     1             2     1                      1     1                     5     1\n14         M                 W     Advanced Degree     1                  9500     1          Unknown     1             4     1                      1     1                     2     1\n15         M                 D     Advanced Degree     1                  5500     1          Unknown     1             0     1                      6     1                     0     1\n16         F                 S           Secondary     1                  8500     1          Unknown     1             5     1                      4     1                     6     1\n17         M                 S             Primary     1                  8000     1        High Risk     1             6     1                      5     1                     5     1\n18         F                 S         4 yr Degree     1                 10000     1         Low Risk     1             2     1                      4     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020823,
                    "execution_time": 0.008714,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020548,
                    "execution_time": 0.008321,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005131
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Unknown     1                  3500     1          Unknown     1             5     1                      0     1                     2     1\n1          M                 U             College     1                  6500     1         Low Risk     1             2     1                      6     1                     0     1\n2          M                 S             College     2                  1500     2          Unknown     2             0     2                      2     2                     5     2\n3          F                 D             College     1                  6000     1          Unknown     1             0     1                      2     1                     2     1\n4          F                 W             Unknown     1                  8500     1          Unknown     1             5     1                      0     1                     1     1\n5          M                 S     Advanced Degree     1                  8500     1         Low Risk     1             6     1                      2     1                     1     1\n6          F                 M         4 yr Degree     1                  1000     1         Low Risk     1             6     1                      6     1                     2     1\n7          F                 M     Advanced Degree     1                  1000     1             Good     1             0     1                      6     1                     1     1\n8          F                 U         2 yr Degree     1                  2500     1          Unknown     1             0     1                      5     1                     1     1\n9          F                 M             Primary     1                  1500     1          Unknown     1             2     1                      3     1                     3     1\n10         M                 W         4 yr Degree     1                  7500     1          Unknown     1             6     1                      2     1                     0     1\n11         M                 U             College     1                  7500     1         Low Risk     1             2     1                      3     1                     4     1\n12         F                 W           Secondary     1                   500     1          Unknown     1             4     1                      0     1                     0     1\n13         M                 W             Primary     1                  4500     1          Unknown     1             2     1                      1     1                     5     1\n14         M                 W     Advanced Degree     1                  9500     1          Unknown     1             4     1                      1     1                     2     1\n15         M                 D     Advanced Degree     1                  5500     1          Unknown     1             0     1                      6     1                     0     1\n16         F                 S           Secondary     1                  8500     1          Unknown     1             5     1                      4     1                     6     1\n17         M                 S             Primary     1                  8000     1        High Risk     1             6     1                      5     1                     5     1\n18         F                 S         4 yr Degree     1                 10000     1         Low Risk     1             2     1                      4     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W     Advanced Degree     1                  7000     1          Unknown     1             3     1                      4     1                     6     1\n1          F                 U         2 yr Degree     1                  4000     1        High Risk     1             6     1                      0     1                     0     1\n2          M                 M             Unknown     1                  2000     1         Low Risk     1             0     1                      3     1                     3     1\n3          M                 S         2 yr Degree     2                  8500     2             Good     2             2     2                      3     2                     6     2\n4          F                 U         4 yr Degree     1                  2000     1        High Risk     1             1     1                      3     1                     3     1\n5          F                 D     Advanced Degree     1                  3500     1          Unknown     1             5     1                      3     1                     4     1\n6          F                 D     Advanced Degree     1                  7000     1          Unknown     1             4     1                      6     1                     3     1\n7          M                 S             College     1                  1500     1             Good     1             6     1                      3     1                     6     1\n8          F                 S         2 yr Degree     1                  5500     1          Unknown     1             0     1                      0     1                     3     1\n9          M                 W     Advanced Degree     1                  6500     1        High Risk     1             1     1                      5     1                     2     1\n10         M                 M             Unknown     1                  7500     1          Unknown     1             6     1                      1     1                     0     1\n11         M                 S             Unknown     1                  3000     1         Low Risk     1             4     1                      0     1                     2     1\n12         F                 D             Primary     1                  4000     1        High Risk     1             4     1                      4     1                     2     1\n13         M                 W         2 yr Degree     1                  1500     1         Low Risk     1             0     1                      5     1                     1     1\n14         F                 U         4 yr Degree     1                  4000     1          Unknown     1             5     1                      3     1                     5     1\n15         F                 S           Secondary     1                  9500     1          Unknown     1             3     1                      5     1                     6     1\n16         F                 W             Unknown     1                  6500     1         Low Risk     1             4     1                      6     1                     6     1\n17         M                 S             Unknown     1                  9000     1        High Risk     1             4     1                      4     1                     4     1\n18         F                 W         2 yr Degree     1                  8000     1        High Risk     1             4     1                      2     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019743,
                    "execution_time": 0.007866,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005017
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020128,
                    "execution_time": 0.008073,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.00512
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W     Advanced Degree     1                  7000     1          Unknown     1             3     1                      4     1                     6     1\n1          F                 U         2 yr Degree     1                  4000     1        High Risk     1             6     1                      0     1                     0     1\n2          M                 M             Unknown     1                  2000     1         Low Risk     1             0     1                      3     1                     3     1\n3          M                 S         2 yr Degree     2                  8500     2             Good     2             2     2                      3     2                     6     2\n4          F                 U         4 yr Degree     1                  2000     1        High Risk     1             1     1                      3     1                     3     1\n5          F                 D     Advanced Degree     1                  3500     1          Unknown     1             5     1                      3     1                     4     1\n6          F                 D     Advanced Degree     1                  7000     1          Unknown     1             4     1                      6     1                     3     1\n7          M                 S             College     1                  1500     1             Good     1             6     1                      3     1                     6     1\n8          F                 S         2 yr Degree     1                  5500     1          Unknown     1             0     1                      0     1                     3     1\n9          M                 W     Advanced Degree     1                  6500     1        High Risk     1             1     1                      5     1                     2     1\n10         M                 M             Unknown     1                  7500     1          Unknown     1             6     1                      1     1                     0     1\n11         M                 S             Unknown     1                  3000     1         Low Risk     1             4     1                      0     1                     2     1\n12         F                 D             Primary     1                  4000     1        High Risk     1             4     1                      4     1                     2     1\n13         M                 W         2 yr Degree     1                  1500     1         Low Risk     1             0     1                      5     1                     1     1\n14         F                 U         4 yr Degree     1                  4000     1          Unknown     1             5     1                      3     1                     5     1\n15         F                 S           Secondary     1                  9500     1          Unknown     1             3     1                      5     1                     6     1\n16         F                 W             Unknown     1                  6500     1         Low Risk     1             4     1                      6     1                     6     1\n17         M                 S             Unknown     1                  9000     1        High Risk     1             4     1                      4     1                     4     1\n18         F                 W         2 yr Degree     1                  8000     1        High Risk     1             4     1                      2     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 W             Unknown     1                  4500     1          Unknown     1             1     1                      0     1                     0     1\n1          F                 D     Advanced Degree     1                  3000     1             Good     1             5     1                      3     1                     2     1\n2          F                 M             Unknown     1                  9500     1          Unknown     1             4     1                      5     1                     0     1\n3          F                 S         2 yr Degree     1                  3500     1         Low Risk     1             5     1                      6     1                     3     1\n4          F                 M         2 yr Degree     2                  2500     2          Unknown     2             0     2                      6     2                     2     2\n5          F                 M     Advanced Degree     1                  7500     1          Unknown     1             3     1                      1     1                     3     1\n6          F                 W           Secondary     1                  4000     1          Unknown     1             0     1                      3     1                     1     1\n7          F                 U           Secondary     1                  9500     1             Good     1             0     1                      6     1                     4     1\n8          F                 U           Secondary     1                  6000     1          Unknown     1             4     1                      2     1                     6     1\n9          F                 W     Advanced Degree     1                  3000     1        High Risk     1             5     1                      1     1                     4     1\n10         F                 S             Primary     2                  6500     2             Good     2             0     2                      1     2                     2     2\n11         F                 M           Secondary     1                  8500     1         Low Risk     1             5     1                      1     1                     2     1\n12         F                 D             Unknown     1                  5500     1          Unknown     1             2     1                      5     1                     1     1\n13         F                 U         2 yr Degree     1                  4000     1        High Risk     1             6     1                      0     1                     0     1\n14         F                 M     Advanced Degree     1                  4500     1         Low Risk     1             2     1                      0     1                     3     1\n15         F                 W         4 yr Degree     1                  5500     1        High Risk     1             0     1                      6     1                     3     1\n16         F                 W             Primary     1                  4000     1        High Risk     1             5     1                      4     1                     0     1\n17         F                 U         4 yr Degree     1                  2000     1        High Risk     1             1     1                      3     1                     3     1\n18         F                 W             College     1                  4500     1         Low Risk     1             4     1                      6     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024264,
                    "execution_time": 0.011995,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.005252
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.062145,
                    "execution_time": 0.012944,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.040196
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 W             Unknown     1                  4500     1          Unknown     1             1     1                      0     1                     0     1\n1          F                 D     Advanced Degree     1                  3000     1             Good     1             5     1                      3     1                     2     1\n2          F                 M             Unknown     1                  9500     1          Unknown     1             4     1                      5     1                     0     1\n3          F                 S         2 yr Degree     1                  3500     1         Low Risk     1             5     1                      6     1                     3     1\n4          F                 M         2 yr Degree     2                  2500     2          Unknown     2             0     2                      6     2                     2     2\n5          F                 M     Advanced Degree     1                  7500     1          Unknown     1             3     1                      1     1                     3     1\n6          F                 W           Secondary     1                  4000     1          Unknown     1             0     1                      3     1                     1     1\n7          F                 U           Secondary     1                  9500     1             Good     1             0     1                      6     1                     4     1\n8          F                 U           Secondary     1                  6000     1          Unknown     1             4     1                      2     1                     6     1\n9          F                 W     Advanced Degree     1                  3000     1        High Risk     1             5     1                      1     1                     4     1\n10         F                 S             Primary     2                  6500     2             Good     2             0     2                      1     2                     2     2\n11         F                 M           Secondary     1                  8500     1         Low Risk     1             5     1                      1     1                     2     1\n12         F                 D             Unknown     1                  5500     1          Unknown     1             2     1                      5     1                     1     1\n13         F                 U         2 yr Degree     1                  4000     1        High Risk     1             6     1                      0     1                     0     1\n14         F                 M     Advanced Degree     1                  4500     1         Low Risk     1             2     1                      0     1                     3     1\n15         F                 W         4 yr Degree     1                  5500     1        High Risk     1             0     1                      6     1                     3     1\n16         F                 W             Primary     1                  4000     1        High Risk     1             5     1                      4     1                     0     1\n17         F                 U         4 yr Degree     1                  2000     1        High Risk     1             1     1                      3     1                     3     1\n18         F                 W             College     1                  4500     1         Low Risk     1             4     1                      6     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  3000     1        High Risk     1             2     1                      2     1                     2     1\n1          F                 D         4 yr Degree     1                  6500     1        High Risk     1             6     1                      4     1                     5     1\n2          F                 D         2 yr Degree     1                  4500     1         Low Risk     1             0     1                      4     1                     0     1\n3          F                 D             College     1                  3000     1         Low Risk     1             6     1                      6     1                     6     1\n4          F                 D         4 yr Degree     1                  8000     1          Unknown     1             3     1                      2     1                     6     1\n5          F                 D         2 yr Degree     1                  3500     1        High Risk     1             6     1                      2     1                     2     1\n6          F                 D             College     1                  6000     1             Good     1             0     1                      4     1                     5     1\n7          F                 D             Unknown     1                  6000     1             Good     1             6     1                      0     1                     2     1\n8          F                 D             College     1                  4000     1             Good     1             5     1                      6     1                     4     1\n9          F                 D     Advanced Degree     1                  1000     1             Good     1             2     1                      4     1                     4     1\n10         F                 D         4 yr Degree     1                  1500     1          Unknown     1             4     1                      2     1                     1     1\n11         F                 D         2 yr Degree     1                  2500     1          Unknown     1             6     1                      4     1                     2     1\n12         F                 D           Secondary     2                  5500     2         Low Risk     2             3     2                      3     2                     2     2\n13         F                 D           Secondary     1                  4500     1          Unknown     1             0     1                      6     1                     2     1\n14         F                 D             College     1                  5000     1          Unknown     1             4     1                      3     1                     0     1\n15         F                 D         2 yr Degree     1                  5000     1          Unknown     1             5     1                      5     1                     4     1\n16         F                 D           Secondary     1                  9500     1             Good     1             5     1                      6     1                     2     1\n17         F                 D             Unknown     1                  7500     1        High Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                   500     1        High Risk     1             0     1                      2     1                     5     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025713,
                    "execution_time": 0.013081,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.005463
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060742,
                    "execution_time": 0.0126,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.040718
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  3000     1        High Risk     1             2     1                      2     1                     2     1\n1          F                 D         4 yr Degree     1                  6500     1        High Risk     1             6     1                      4     1                     5     1\n2          F                 D         2 yr Degree     1                  4500     1         Low Risk     1             0     1                      4     1                     0     1\n3          F                 D             College     1                  3000     1         Low Risk     1             6     1                      6     1                     6     1\n4          F                 D         4 yr Degree     1                  8000     1          Unknown     1             3     1                      2     1                     6     1\n5          F                 D         2 yr Degree     1                  3500     1        High Risk     1             6     1                      2     1                     2     1\n6          F                 D             College     1                  6000     1             Good     1             0     1                      4     1                     5     1\n7          F                 D             Unknown     1                  6000     1             Good     1             6     1                      0     1                     2     1\n8          F                 D             College     1                  4000     1             Good     1             5     1                      6     1                     4     1\n9          F                 D     Advanced Degree     1                  1000     1             Good     1             2     1                      4     1                     4     1\n10         F                 D         4 yr Degree     1                  1500     1          Unknown     1             4     1                      2     1                     1     1\n11         F                 D         2 yr Degree     1                  2500     1          Unknown     1             6     1                      4     1                     2     1\n12         F                 D           Secondary     2                  5500     2         Low Risk     2             3     2                      3     2                     2     2\n13         F                 D           Secondary     1                  4500     1          Unknown     1             0     1                      6     1                     2     1\n14         F                 D             College     1                  5000     1          Unknown     1             4     1                      3     1                     0     1\n15         F                 D         2 yr Degree     1                  5000     1          Unknown     1             5     1                      5     1                     4     1\n16         F                 D           Secondary     1                  9500     1             Good     1             5     1                      6     1                     2     1\n17         F                 D             Unknown     1                  7500     1        High Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                   500     1        High Risk     1             0     1                      2     1                     5     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  7500     1        High Risk     1             0     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                  3000     1             Good     1             1     1                      4     1                     6     1\n2          F                 D         2 yr Degree     1                  8000     1         Low Risk     1             6     1                      6     1                     5     1\n3          F                 D         2 yr Degree     1                 10000     1        High Risk     1             5     1                      6     1                     1     1\n4          F                 D         2 yr Degree     1                  6500     1         Low Risk     1             0     1                      2     1                     4     1\n5          F                 D         2 yr Degree     1                  8000     1             Good     1             4     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                  9500     1         Low Risk     1             2     1                      3     1                     3     1\n7          F                 D         2 yr Degree     1                  5000     1          Unknown     1             3     1                      6     1                     2     1\n8          F                 D         2 yr Degree     1                  2000     1          Unknown     1             0     1                      5     1                     6     1\n9          F                 D         2 yr Degree     1                  3000     1             Good     1             6     1                      2     1                     0     1\n10         F                 D         2 yr Degree     1                  6500     1        High Risk     1             2     1                      2     1                     5     1\n11         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      6     1                     2     1\n12         F                 D         2 yr Degree     1                 10000     1             Good     1             5     1                      3     1                     6     1\n13         F                 D         2 yr Degree     1                  4000     1        High Risk     1             2     1                      5     1                     0     1\n14         F                 D         2 yr Degree     1                 10000     1          Unknown     1             2     1                      3     1                     2     1\n15         F                 D         2 yr Degree     2                  3000     2          Unknown     2             1     2                      6     2                     3     2\n16         F                 D         2 yr Degree     1                  7500     1         Low Risk     1             3     1                      0     1                     3     1\n17         F                 D         2 yr Degree     1                  5000     1          Unknown     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                   500     1        High Risk     1             0     1                      2     1                     5     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024566,
                    "execution_time": 0.012108,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.00544
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060612,
                    "execution_time": 0.012702,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.040626
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  7500     1        High Risk     1             0     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                  3000     1             Good     1             1     1                      4     1                     6     1\n2          F                 D         2 yr Degree     1                  8000     1         Low Risk     1             6     1                      6     1                     5     1\n3          F                 D         2 yr Degree     1                 10000     1        High Risk     1             5     1                      6     1                     1     1\n4          F                 D         2 yr Degree     1                  6500     1         Low Risk     1             0     1                      2     1                     4     1\n5          F                 D         2 yr Degree     1                  8000     1             Good     1             4     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                  9500     1         Low Risk     1             2     1                      3     1                     3     1\n7          F                 D         2 yr Degree     1                  5000     1          Unknown     1             3     1                      6     1                     2     1\n8          F                 D         2 yr Degree     1                  2000     1          Unknown     1             0     1                      5     1                     6     1\n9          F                 D         2 yr Degree     1                  3000     1             Good     1             6     1                      2     1                     0     1\n10         F                 D         2 yr Degree     1                  6500     1        High Risk     1             2     1                      2     1                     5     1\n11         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      6     1                     2     1\n12         F                 D         2 yr Degree     1                 10000     1             Good     1             5     1                      3     1                     6     1\n13         F                 D         2 yr Degree     1                  4000     1        High Risk     1             2     1                      5     1                     0     1\n14         F                 D         2 yr Degree     1                 10000     1          Unknown     1             2     1                      3     1                     2     1\n15         F                 D         2 yr Degree     2                  3000     2          Unknown     2             1     2                      6     2                     3     2\n16         F                 D         2 yr Degree     1                  7500     1         Low Risk     1             3     1                      0     1                     3     1\n17         F                 D         2 yr Degree     1                  5000     1          Unknown     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                   500     1        High Risk     1             0     1                      2     1                     5     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             5     1                      5     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      6     1                     2     1\n2          F                 D         2 yr Degree     1                   500     1          Unknown     1             3     1                      3     1                     4     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     3     1\n4          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     3     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      6     1                     5     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      3     1                     3     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      4     1                     1     1\n8          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      2     1                     6     1\n9          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     5     1\n10         F                 D         2 yr Degree     1                   500     1        High Risk     1             3     1                      6     1                     2     1\n11         F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      6     1                     0     1\n12         F                 D         2 yr Degree     1                   500     1         Low Risk     1             2     1                      6     1                     5     1\n13         F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      1     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     0     1\n15         F                 D         2 yr Degree     2                   500     2        High Risk     2             3     2                      1     2                     6     2\n16         F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n17         F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      5     1                     3     1\n18         F                 D         2 yr Degree     1                   500     1        High Risk     1             0     1                      2     1                     5     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024823,
                    "execution_time": 0.012073,
                    "compile_time": 9e-05,
                    "planning_time": 0.005579
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060645,
                    "execution_time": 0.012336,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.040774
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             5     1                      5     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      6     1                     2     1\n2          F                 D         2 yr Degree     1                   500     1          Unknown     1             3     1                      3     1                     4     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     3     1\n4          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     3     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      6     1                     5     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      3     1                     3     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      4     1                     1     1\n8          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      2     1                     6     1\n9          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     5     1\n10         F                 D         2 yr Degree     1                   500     1        High Risk     1             3     1                      6     1                     2     1\n11         F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      6     1                     0     1\n12         F                 D         2 yr Degree     1                   500     1         Low Risk     1             2     1                      6     1                     5     1\n13         F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      1     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     0     1\n15         F                 D         2 yr Degree     2                   500     2        High Risk     2             3     2                      1     2                     6     2\n16         F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n17         F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      5     1                     3     1\n18         F                 D         2 yr Degree     1                   500     1        High Risk     1             0     1                      2     1                     5     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n1          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      3     1                     3     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      6     1                     5     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      1     1                     5     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     3     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      4     1                     1     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n9          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n10         F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     2     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      0     1                     6     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      5     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n15         F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n16         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025611,
                    "execution_time": 0.012908,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.005624
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060395,
                    "execution_time": 0.012271,
                    "compile_time": 0.000104,
                    "planning_time": 0.040828
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n1          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      3     1                     3     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      6     1                     5     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      1     1                     5     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     3     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      4     1                     1     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n9          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n10         F                 D         2 yr Degree     1                   500     1             Good     1             4     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     2     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      0     1                     6     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             6     1                      5     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n15         F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n16         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) as cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n9          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n10         F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n14         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n17         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024824,
                    "execution_time": 0.011862,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.005812
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060934,
                    "execution_time": 0.012424,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.041033
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n9          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n10         F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n14         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n17         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      3     1                     2     1\n...*/"
    },
    {
        "input": "select /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.C_CURRENT_ADDR_SK = ca.CA_ADDRESS_SK and\n  ca.CA_COUNTY in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd.CD_DEMO_SK = c.C_CURRENT_CDEMO_SK and \n  exists (select *\n          from store_sales ss, date_dim dd\n          where c.C_CUSTOMER_SK = ss.SS_CUSTOMER_SK and\n                ss.SS_SOLD_DATE_SK = dd.D_DATE_SK and\n                dd.D_YEAR = 2000 and\n                dd.D_MOY between 2 and 2+3) and\n   (exists (select *\n            from web_sales ws, date_dim dd\n            where c.C_CUSTOMER_SK = ws.WS_BILL_CUSTOMER_SK and\n                  ws.WS_SOLD_DATE_SK = dd.D_DATE_SK and\n                  dd.D_YEAR = 2000 and\n                  dd.D_MOY between 2 and 2+3) or \n    exists (select * \n            from catalog_sales cs, date_dim dd\n            where c.C_CUSTOMER_SK = cs.CS_SHIP_CUSTOMER_SK and\n                  cs.CS_SOLD_DATE_SK = dd.D_DATE_SK and\n                  dd.D_YEAR = 2000 and\n                  dd.D_MOY between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DD\" AS ( SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 5 AND \"DD\".\"D_MOY\" >= 2 AND \"DD\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DD\" AS \"DD\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DD\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 5 AND \"DD\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.221129,
                    "execution_time": 0.060482,
                    "compile_time": 0.000351,
                    "planning_time": 0.027866,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.295,
                    "execution_time": 0.074243,
                    "compile_time": 0.000344,
                    "planning_time": 0.086601,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.33654,
                    "execution_time": 14.237744,
                    "compile_time": 0.000369,
                    "planning_time": 0.024348,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.566398,
                    "execution_time": 14.399722,
                    "compile_time": 0.000383,
                    "planning_time": 0.086841,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.503359,
                    "execution_time": 1.402017,
                    "compile_time": 0.00036,
                    "planning_time": 0.027127,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.246191,
                    "execution_time": 3.082072,
                    "compile_time": 0.00037,
                    "planning_time": 0.088331,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.261183,
                    "execution_time": 7.157604,
                    "compile_time": 0.000375,
                    "planning_time": 0.027171,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.240252,
                    "execution_time": 7.074187,
                    "compile_time": 0.000382,
                    "planning_time": 0.090693,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ON \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ON \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.824891,
                    "execution_time": 0.276859,
                    "compile_time": 0.000967,
                    "planning_time": 0.050615,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.928234,
                    "execution_time": 0.302795,
                    "compile_time": 0.000974,
                    "planning_time": 0.127632,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n9          F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n10         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n14         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      0     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025632,
                    "execution_time": 0.012094,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.006117
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061313,
                    "execution_time": 0.012369,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.041676
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ON \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ON \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n9          F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n10         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n14         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      0     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n9          F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n10         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n14         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      0     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025576,
                    "execution_time": 0.012199,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.00602
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061861,
                    "execution_time": 0.013078,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.041297
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n9          F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n10         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n14         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      0     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n9          F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n10         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n14         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      0     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0262,
                    "execution_time": 0.012271,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.026,
                    "execution_time": 0.012165,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.006303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      0     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      2     1                     3     1\n2          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      3     1                     1     1\n4          F                 D         2 yr Degree     1                   500     1             Good     1             0     1                      5     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     4     1\n8          F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      2     1                     6     1\n9          F                 D         2 yr Degree     2                   500     2             Good     2             1     2                      5     2                     0     2\n10         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      5     1                     5     1\n12         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     0     1\n13         F                 D         2 yr Degree     1                   500     1             Good     1             1     1                      6     1                     1     1\n14         F                 D         2 yr Degree     2                   500     2             Good     2             2     2                      0     2                     1     2\n15         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      0     1                     3     1\n16         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n18         F                 D         2 yr Degree     1                   500     1             Good     1             3     1                      0     1                     3     1\n...*/"
    }
]