[
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,ss_store_sk as s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) as sumsales\n            from store_sales, date_dim, store, item\n       where ss_sold_date_sk = d_date_sk\n          and ss_item_sk = i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, ss_store_sk)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category\n  union all\n  select null as i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results)\n\nselect  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n     from results_rollup) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , SS_STORE_SK AS S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , SS_STORE_SK ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS_ROLLUP ) AS FINAL_RESULTS LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM RESULTS_ROLLUP LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,SS_STORE_SK as s_store_id\n                  ,sum(coalesce(SS_SALES_PRICE*SS_QUANTITY,0)) as sumsales\n            from store_sales ,date_dim ,store ,item\n       where  SS_SOLD_DATE_SK=d_date_sk\n          and SS_ITEM_SK=i_item_sk\n          and SS_STORE_SK = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, SS_STORE_SK)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category\n  union all\n  select null as i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n        from results_rollup) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , SS_STORE_SK AS S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , SS_STORE_SK ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS_ROLLUP ) AS SUBQUERY LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n/*CURSOR_IDENTIFIER*/, s_store_id, sumsales\n        from results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , S_STORE_ID , SUMSALES FROM RESULTS_ROLLUP ) AS SUBQUERY LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n/*CURSOR_IDENTIFIER*/, s_store_id, sumsales\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS_ROLLUP ) AS SUBQUERY LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n/*CURSOR_IDENTIFIER*/, sumsales\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS_ROLLUP ) AS SUBQUERY LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS_ROLLUP ) AS SUBQUERY LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS SUBQUERY LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST , D_MOY NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST , D_MOY NULLS FIRST , S_STORE_ID NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST , D_MOY NULLS FIRST , S_STORE_ID NULLS FIRST , SUMSALES NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST , \"DW2\".\"RK\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST , D_MOY NULLS FIRST , S_STORE_ID NULLS FIRST , SUMSALES NULLS FIRST , RK NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST , \"DW2\".\"RK\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST , D_MOY NULLS FIRST , S_STORE_ID NULLS FIRST , SUMSALES NULLS FIRST , RK NULLS FIRST LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    }
]