[
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n join item on sr_item_sk = i_item_sk\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n join item on cr_item_sk = i_item_sk\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n join item on wr_item_sk = i_item_sk\n join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n/*CURSOR_IDENTIFIER*/ \ngroup by i_item_id)\nselect * from sr_items \njoin cr_items on sr_items.item_id = cr_items.item_id\njoin wr_items on cr_items.item_id = wr_items.item_id;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.105743,
                    "execution_time": 0.041715,
                    "compile_time": 0.000221,
                    "planning_time": 0.024629,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.1654,
                    "execution_time": 0.040233,
                    "compile_time": 0.000228,
                    "planning_time": 0.084159,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.281963,
                    "execution_time": 0.116473,
                    "compile_time": 0.000232,
                    "planning_time": 0.023311,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.344332,
                    "execution_time": 0.116756,
                    "compile_time": 0.000228,
                    "planning_time": 0.083852,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081937,
                    "execution_time": 0.030961,
                    "compile_time": 0.00027,
                    "planning_time": 0.024958,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.309886,
                    "execution_time": 0.031246,
                    "compile_time": 0.162732,
                    "planning_time": 0.086883,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096933,
                    "execution_time": 0.041,
                    "compile_time": 0.00032,
                    "planning_time": 0.029562,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.159797,
                    "execution_time": 0.04182,
                    "compile_time": 0.001279,
                    "planning_time": 0.088464,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.304606,
                    "execution_time": 0.14232,
                    "compile_time": 0.000492,
                    "planning_time": 0.032415,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.200418,
                    "execution_time": 1.145729,
                    "compile_time": 4.821719,
                    "planning_time": 0.097462,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.09555,
                    "execution_time": 0.041391,
                    "compile_time": 0.000286,
                    "planning_time": 0.027542,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.159363,
                    "execution_time": 0.041438,
                    "compile_time": 0.00029,
                    "planning_time": 0.091239,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.288517,
                    "execution_time": 0.125466,
                    "compile_time": 0.00051,
                    "planning_time": 0.035803,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.962153,
                    "execution_time": 0.172101,
                    "compile_time": 4.56627,
                    "planning_time": 0.094772,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095856,
                    "execution_time": 0.041779,
                    "compile_time": 0.000314,
                    "planning_time": 0.026901,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155655,
                    "execution_time": 0.040764,
                    "compile_time": 0.000303,
                    "planning_time": 0.088018,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.23353,
                    "execution_time": 0.088445,
                    "compile_time": 0.000435,
                    "planning_time": 0.033272,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.139816,
                    "execution_time": 0.611633,
                    "compile_time": 3.312341,
                    "planning_time": 0.094091,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.437747,
                    "execution_time": 0.11029,
                    "compile_time": 0.058044,
                    "planning_time": 0.006554,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.116949,
                    "execution_time": 0.117893,
                    "compile_time": 6.664506,
                    "planning_time": 0.062149,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_10\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAAEPFPBAAA          195  AAAAAAAAEPFPBAAA          133  AAAAAAAAEPFPBAAA           38\n1   AAAAAAAACJPNBAAA          295  AAAAAAAACJPNBAAA          192  AAAAAAAACJPNBAAA           92\n2   AAAAAAAAIBKKCAAA          393  AAAAAAAAIBKKCAAA          284  AAAAAAAAIBKKCAAA          231\n3   AAAAAAAABACEAAAA          350  AAAAAAAABACEAAAA          283  AAAAAAAABACEAAAA           46\n4   AAAAAAAAACFKCAAA          432  AAAAAAAAACFKCAAA          226  AAAAAAAAACFKCAAA           84\n5   AAAAAAAAGFHOAAAA          428  AAAAAAAAGFHOAAAA          114  AAAAAAAAGFHOAAAA          144\n6   AAAAAAAABNBGBAAA          185  AAAAAAAABNBGBAAA          154  AAAAAAAABNBGBAAA           19\n7   AAAAAAAACAPDAAAA          405  AAAAAAAACAPDAAAA           33  AAAAAAAACAPDAAAA          174\n8   AAAAAAAAGMFMCAAA          609  AAAAAAAAGMFMCAAA          125  AAAAAAAAGMFMCAAA           54\n9   AAAAAAAAMEFFDAAA          522  AAAAAAAAMEFFDAAA          135  AAAAAAAAMEFFDAAA           82\n10  AAAAAAAAIHGJBAAA          327  AAAAAAAAIHGJBAAA          180  AAAAAAAAIHGJBAAA           11\n11  AAAAAAAAGOPGAAAA          240  AAAAAAAAGOPGAAAA          212  AAAAAAAAGOPGAAAA           31\n12  AAAAAAAAGHOEBAAA          601  AAAAAAAAGHOEBAAA          129  AAAAAAAAGHOEBAAA           69\n13  AAAAAAAAMJBGEAAA          263  AAAAAAAAMJBGEAAA           63  AAAAAAAAMJBGEAAA           22\n14  AAAAAAAAALBDCAAA          347  AAAAAAAAALBDCAAA          180  AAAAAAAAALBDCAAA           91\n15  AAAAAAAACEMNDAAA          578  AAAAAAAACEMNDAAA           37  AAAAAAAACEMNDAAA           10\n16  AAAAAAAAOAOKDAAA          564  AAAAAAAAOAOKDAAA          175  AAAAAAAAOAOKDAAA          212\n17  AAAAAAAAGFDOBAAA          490  AAAAAAAAGFDOBAAA          161  AAAAAAAAGFDOBAAA          178\n18  AAAAAAAACEMCCAAA          476  AAAAAAAACEMCCAAA           21  AAAAAAAACEMCCAAA           53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017304,
                    "execution_time": 0.007363,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003752
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05766,
                    "execution_time": 0.008362,
                    "compile_time": 0.001026,
                    "planning_time": 0.039358
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_10\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAAEPFPBAAA          195  AAAAAAAAEPFPBAAA          133  AAAAAAAAEPFPBAAA           38\n1   AAAAAAAACJPNBAAA          295  AAAAAAAACJPNBAAA          192  AAAAAAAACJPNBAAA           92\n2   AAAAAAAAIBKKCAAA          393  AAAAAAAAIBKKCAAA          284  AAAAAAAAIBKKCAAA          231\n3   AAAAAAAABACEAAAA          350  AAAAAAAABACEAAAA          283  AAAAAAAABACEAAAA           46\n4   AAAAAAAAACFKCAAA          432  AAAAAAAAACFKCAAA          226  AAAAAAAAACFKCAAA           84\n5   AAAAAAAAGFHOAAAA          428  AAAAAAAAGFHOAAAA          114  AAAAAAAAGFHOAAAA          144\n6   AAAAAAAABNBGBAAA          185  AAAAAAAABNBGBAAA          154  AAAAAAAABNBGBAAA           19\n7   AAAAAAAACAPDAAAA          405  AAAAAAAACAPDAAAA           33  AAAAAAAACAPDAAAA          174\n8   AAAAAAAAGMFMCAAA          609  AAAAAAAAGMFMCAAA          125  AAAAAAAAGMFMCAAA           54\n9   AAAAAAAAMEFFDAAA          522  AAAAAAAAMEFFDAAA          135  AAAAAAAAMEFFDAAA           82\n10  AAAAAAAAIHGJBAAA          327  AAAAAAAAIHGJBAAA          180  AAAAAAAAIHGJBAAA           11\n11  AAAAAAAAGOPGAAAA          240  AAAAAAAAGOPGAAAA          212  AAAAAAAAGOPGAAAA           31\n12  AAAAAAAAGHOEBAAA          601  AAAAAAAAGHOEBAAA          129  AAAAAAAAGHOEBAAA           69\n13  AAAAAAAAMJBGEAAA          263  AAAAAAAAMJBGEAAA           63  AAAAAAAAMJBGEAAA           22\n14  AAAAAAAAALBDCAAA          347  AAAAAAAAALBDCAAA          180  AAAAAAAAALBDCAAA           91\n15  AAAAAAAACEMNDAAA          578  AAAAAAAACEMNDAAA           37  AAAAAAAACEMNDAAA           10\n16  AAAAAAAAOAOKDAAA          564  AAAAAAAAOAOKDAAA          175  AAAAAAAAOAOKDAAA          212\n17  AAAAAAAAGFDOBAAA          490  AAAAAAAAGFDOBAAA          161  AAAAAAAAGFDOBAAA          178\n18  AAAAAAAACEMCCAAA          476  AAAAAAAACEMCCAAA           21  AAAAAAAACEMCCAAA           53\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\nselect *\nfrom sr_items\njoin cr_items on sr_items.item_id = cr_items.item_id\njoin wr_items on sr_items.item_id = wr_items.item_id;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.381967,
                    "execution_time": 0.109291,
                    "compile_time": 0.00029,
                    "planning_time": 0.00603,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.483161,
                    "execution_time": 0.113068,
                    "compile_time": 0.015577,
                    "planning_time": 0.068582,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAALFCKDAAA          451  AAAAAAAALFCKDAAA          139  AAAAAAAALFCKDAAA          230\n1   AAAAAAAAMMDPBAAA          251  AAAAAAAAMMDPBAAA          406  AAAAAAAAMMDPBAAA           30\n2   AAAAAAAAKJIHEAAA          497  AAAAAAAAKJIHEAAA           81  AAAAAAAAKJIHEAAA           30\n3   AAAAAAAAAKEMCAAA          472  AAAAAAAAAKEMCAAA          279  AAAAAAAAAKEMCAAA           12\n4   AAAAAAAAINDEDAAA          351  AAAAAAAAINDEDAAA           48  AAAAAAAAINDEDAAA           37\n5   AAAAAAAAEOBBDAAA          465  AAAAAAAAEOBBDAAA          359  AAAAAAAAEOBBDAAA           76\n6   AAAAAAAAKKENAAAA          636  AAAAAAAAKKENAAAA          253  AAAAAAAAKKENAAAA           93\n7   AAAAAAAAAADFAAAA          353  AAAAAAAAAADFAAAA          119  AAAAAAAAAADFAAAA           90\n8   AAAAAAAAKLMGCAAA          484  AAAAAAAAKLMGCAAA          121  AAAAAAAAKLMGCAAA           25\n9   AAAAAAAAABCFCAAA          324  AAAAAAAAABCFCAAA          218  AAAAAAAAABCFCAAA           65\n10  AAAAAAAAIODHDAAA          410  AAAAAAAAIODHDAAA          158  AAAAAAAAIODHDAAA           36\n11  AAAAAAAAJBBHEAAA          360  AAAAAAAAJBBHEAAA           40  AAAAAAAAJBBHEAAA           73\n12  AAAAAAAAMNADEAAA          520  AAAAAAAAMNADEAAA          101  AAAAAAAAMNADEAAA           71\n13  AAAAAAAAELIMCAAA          289  AAAAAAAAELIMCAAA          300  AAAAAAAAELIMCAAA           32\n14  AAAAAAAAMOEGCAAA          358  AAAAAAAAMOEGCAAA          193  AAAAAAAAMOEGCAAA            5\n15  AAAAAAAACPJCAAAA          507  AAAAAAAACPJCAAAA          114  AAAAAAAACPJCAAAA          158\n16  AAAAAAAALPHLCAAA          497  AAAAAAAALPHLCAAA          115  AAAAAAAALPHLCAAA           58\n17  AAAAAAAAFLHGCAAA          366  AAAAAAAAFLHGCAAA           90  AAAAAAAAFLHGCAAA           65\n18  AAAAAAAAMOIBAAAA          436  AAAAAAAAMOIBAAAA           16  AAAAAAAAMOIBAAAA            4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018402,
                    "execution_time": 0.008118,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003663
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052501,
                    "execution_time": 0.007738,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038526
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAALFCKDAAA          451  AAAAAAAALFCKDAAA          139  AAAAAAAALFCKDAAA          230\n1   AAAAAAAAMMDPBAAA          251  AAAAAAAAMMDPBAAA          406  AAAAAAAAMMDPBAAA           30\n2   AAAAAAAAKJIHEAAA          497  AAAAAAAAKJIHEAAA           81  AAAAAAAAKJIHEAAA           30\n3   AAAAAAAAAKEMCAAA          472  AAAAAAAAAKEMCAAA          279  AAAAAAAAAKEMCAAA           12\n4   AAAAAAAAINDEDAAA          351  AAAAAAAAINDEDAAA           48  AAAAAAAAINDEDAAA           37\n5   AAAAAAAAEOBBDAAA          465  AAAAAAAAEOBBDAAA          359  AAAAAAAAEOBBDAAA           76\n6   AAAAAAAAKKENAAAA          636  AAAAAAAAKKENAAAA          253  AAAAAAAAKKENAAAA           93\n7   AAAAAAAAAADFAAAA          353  AAAAAAAAAADFAAAA          119  AAAAAAAAAADFAAAA           90\n8   AAAAAAAAKLMGCAAA          484  AAAAAAAAKLMGCAAA          121  AAAAAAAAKLMGCAAA           25\n9   AAAAAAAAABCFCAAA          324  AAAAAAAAABCFCAAA          218  AAAAAAAAABCFCAAA           65\n10  AAAAAAAAIODHDAAA          410  AAAAAAAAIODHDAAA          158  AAAAAAAAIODHDAAA           36\n11  AAAAAAAAJBBHEAAA          360  AAAAAAAAJBBHEAAA           40  AAAAAAAAJBBHEAAA           73\n12  AAAAAAAAMNADEAAA          520  AAAAAAAAMNADEAAA          101  AAAAAAAAMNADEAAA           71\n13  AAAAAAAAELIMCAAA          289  AAAAAAAAELIMCAAA          300  AAAAAAAAELIMCAAA           32\n14  AAAAAAAAMOEGCAAA          358  AAAAAAAAMOEGCAAA          193  AAAAAAAAMOEGCAAA            5\n15  AAAAAAAACPJCAAAA          507  AAAAAAAACPJCAAAA          114  AAAAAAAACPJCAAAA          158\n16  AAAAAAAALPHLCAAA          497  AAAAAAAALPHLCAAA          115  AAAAAAAALPHLCAAA           58\n17  AAAAAAAAFLHGCAAA          366  AAAAAAAAFLHGCAAA           90  AAAAAAAAFLHGCAAA           65\n18  AAAAAAAAMOIBAAAA          436  AAAAAAAAMOIBAAAA           16  AAAAAAAAMOIBAAAA            4\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n join item on sr_item_sk = i_item_sk\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n join item on cr_item_sk = i_item_sk\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n join item on wr_item_sk = i_item_sk\n join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n/*CURSOR_IDENTIFIER*/\n group by i_item_id)\nselect sr_items.item_id, sr_item_qty, cr_item_qty, wr_item_qty\nfrom sr_items\nfull outer join cr_items on sr_items.item_id = cr_items.item_id\nfull outer join wr_items on sr_items.item_id = wr_items.item_id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" FULL JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" FULL JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.222082,
                    "execution_time": 0.058823,
                    "compile_time": 0.000228,
                    "planning_time": 0.003377,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.281472,
                    "execution_time": 0.0585,
                    "compile_time": 0.002414,
                    "planning_time": 0.057495,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAEPFPBAAA          195          133           38\n1   AAAAAAAACJPNBAAA          295          192           92\n2   AAAAAAAAIBKKCAAA          393          284          231\n3   AAAAAAAABACEAAAA          350          283           46\n4   AAAAAAAAACFKCAAA          432          226           84\n5   AAAAAAAAGFHOAAAA          428          114          144\n6   AAAAAAAABNBGBAAA          185          154           19\n7   AAAAAAAACAPDAAAA          405           33          174\n8   AAAAAAAAGMFMCAAA          609          125           54\n9   AAAAAAAAMEFFDAAA          522          135           82\n10  AAAAAAAAIHGJBAAA          327          180           11\n11  AAAAAAAAGOPGAAAA          240          212           31\n12  AAAAAAAAGHOEBAAA          601          129           69\n13  AAAAAAAAMJBGEAAA          263           63           22\n14  AAAAAAAAALBDCAAA          347          180           91\n15  AAAAAAAACEMNDAAA          578           37           10\n16  AAAAAAAAOAOKDAAA          564          175          212\n17  AAAAAAAAGFDOBAAA          490          161          178\n18  AAAAAAAACEMCCAAA          476           21           53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016663,
                    "execution_time": 0.007321,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003398
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055759,
                    "execution_time": 0.007617,
                    "compile_time": 0.000992,
                    "planning_time": 0.038612
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAEPFPBAAA          195          133           38\n1   AAAAAAAACJPNBAAA          295          192           92\n2   AAAAAAAAIBKKCAAA          393          284          231\n3   AAAAAAAABACEAAAA          350          283           46\n4   AAAAAAAAACFKCAAA          432          226           84\n5   AAAAAAAAGFHOAAAA          428          114          144\n6   AAAAAAAABNBGBAAA          185          154           19\n7   AAAAAAAACAPDAAAA          405           33          174\n8   AAAAAAAAGMFMCAAA          609          125           54\n9   AAAAAAAAMEFFDAAA          522          135           82\n10  AAAAAAAAIHGJBAAA          327          180           11\n11  AAAAAAAAGOPGAAAA          240          212           31\n12  AAAAAAAAGHOEBAAA          601          129           69\n13  AAAAAAAAMJBGEAAA          263           63           22\n14  AAAAAAAAALBDCAAA          347          180           91\n15  AAAAAAAACEMNDAAA          578           37           10\n16  AAAAAAAAOAOKDAAA          564          175          212\n17  AAAAAAAAGFDOBAAA          490          161          178\n18  AAAAAAAACEMCCAAA          476           21           53\n...*/"
    },
    {
        "input": "with /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\nselect \n    coalesce(sr_items.item_id, cr_items.item_id, wr_items.item_id) as item_id,\n    coalesce(sr_item_qty, 0) as sr_item_qty, \n    coalesce(cr_item_qty, 0) as cr_item_qty, \n    coalesce(wr_item_qty, 0) as wr_item_qty\nfrom sr_items\nfull outer join cr_items on sr_items.item_id = cr_items.item_id\nfull outer join wr_items on coalesce(sr_items.item_id, cr_items.item_id) = wr_items.item_id;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT COALESCE ( \"SR_ITEMS\".\"ITEM_ID\" , \"CR_ITEMS\".\"ITEM_ID\" , \"WR_ITEMS\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SR_ITEMS\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"CR_ITEMS\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"WR_ITEMS\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" FULL JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" FULL JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"WR_ITEMS\".\"ITEM_ID\" = COALESCE ( \"SR_ITEMS\".\"ITEM_ID\" , \"CR_ITEMS\".\"ITEM_ID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" = COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.276926,
                    "execution_time": 0.083535,
                    "compile_time": 0.000349,
                    "planning_time": 0.007651,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.476175,
                    "execution_time": 0.096354,
                    "compile_time": 0.123409,
                    "planning_time": 0.067415,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAKKKKDAAA          604           23           72\n1   AAAAAAAAHACLCAAA          355           77            4\n2   AAAAAAAAGHADAAAA          247          240           88\n3   AAAAAAAAAJLGCAAA          246          176            0\n4   AAAAAAAAANGGDAAA          229           54           51\n5   AAAAAAAAFDPODAAA          417          138           67\n6   AAAAAAAAMOCMAAAA          134          234           31\n7   AAAAAAAAGHBBEAAA          209           47           22\n8   AAAAAAAACPIMBAAA          393          394           65\n9   AAAAAAAANALFCAAA          339          291           67\n10  AAAAAAAALDLNCAAA          303           99           79\n11  AAAAAAAADLHDEAAA          482          176          128\n12  AAAAAAAAANLPCAAA          449          174           98\n13  AAAAAAAAAFAGDAAA          666          176           26\n14  AAAAAAAAFBCODAAA          331          220           81\n15  AAAAAAAAMMNCEAAA          439          166           51\n16  AAAAAAAAGAGCAAAA          298          146           12\n17  AAAAAAAAALAFDAAA          563           88           55\n18  AAAAAAAALLJGDAAA          271          228           90\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017361,
                    "execution_time": 0.00792,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003464
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055321,
                    "execution_time": 0.00819,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038583
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" = COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAKKKKDAAA          604           23           72\n1   AAAAAAAAHACLCAAA          355           77            4\n2   AAAAAAAAGHADAAAA          247          240           88\n3   AAAAAAAAAJLGCAAA          246          176            0\n4   AAAAAAAAANGGDAAA          229           54           51\n5   AAAAAAAAFDPODAAA          417          138           67\n6   AAAAAAAAMOCMAAAA          134          234           31\n7   AAAAAAAAGHBBEAAA          209           47           22\n8   AAAAAAAACPIMBAAA          393          394           65\n9   AAAAAAAANALFCAAA          339          291           67\n10  AAAAAAAALDLNCAAA          303           99           79\n11  AAAAAAAADLHDEAAA          482          176          128\n12  AAAAAAAAANLPCAAA          449          174           98\n13  AAAAAAAAAFAGDAAA          666          176           26\n14  AAAAAAAAFBCODAAA          331          220           81\n15  AAAAAAAAMMNCEAAA          439          166           51\n16  AAAAAAAAGAGCAAAA          298          146           12\n17  AAAAAAAAALAFDAAA          563           88           55\n18  AAAAAAAALLJGDAAA          271          228           90\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n      join item on sr_item_sk = i_item_sk\n      join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n      join item on cr_item_sk = i_item_sk\n      join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n      join item on wr_item_sk = i_item_sk\n      join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id)\nselect sr_items.item_id, sr_items.sr_item_qty, cr_items.cr_item_qty, wr_items.wr_item_qty\nfrom sr_items\nleft join cr_items on sr_items.item_id = cr_items.item_id\nleft join wr_items on sr_items.item_id = wr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" LEFT JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAMCCKDAAA          460          220           14\n1   AAAAAAAALEDFCAAA          334          149           98\n2   AAAAAAAAHAJJDAAA          313          101           86\n3   AAAAAAAAEIEPAAAA          408          354           11\n4   AAAAAAAAEJINDAAA          180          240           35\n5   AAAAAAAACEOAAAAA          387           91          128\n6   AAAAAAAAAEEGDAAA          412          201           84\n7   AAAAAAAANMPMDAAA          301           80           65\n8   AAAAAAAAPKBCAAAA          517          239           48\n9   AAAAAAAAHJLGBAAA          430           46          283\n10  AAAAAAAAALHABAAA          215          253           15\n11  AAAAAAAAOHNNAAAA          408          158           60\n12  AAAAAAAAGDFLAAAA          382           53           39\n13  AAAAAAAAGEKBEAAA          516           12          133\n14  AAAAAAAAGMDDCAAA          515          121           14\n15  AAAAAAAAADDNAAAA          462          272           53\n16  AAAAAAAAJANOBAAA          427          160            1\n17  AAAAAAAAADMBEAAA          232          223           29\n18  AAAAAAAAIKPJCAAA          458          184          153\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016978,
                    "execution_time": 0.007844,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003248
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052181,
                    "execution_time": 0.007585,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038469
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAMCCKDAAA          460          220           14\n1   AAAAAAAALEDFCAAA          334          149           98\n2   AAAAAAAAHAJJDAAA          313          101           86\n3   AAAAAAAAEIEPAAAA          408          354           11\n4   AAAAAAAAEJINDAAA          180          240           35\n5   AAAAAAAACEOAAAAA          387           91          128\n6   AAAAAAAAAEEGDAAA          412          201           84\n7   AAAAAAAANMPMDAAA          301           80           65\n8   AAAAAAAAPKBCAAAA          517          239           48\n9   AAAAAAAAHJLGBAAA          430           46          283\n10  AAAAAAAAALHABAAA          215          253           15\n11  AAAAAAAAOHNNAAAA          408          158           60\n12  AAAAAAAAGDFLAAAA          382           53           39\n13  AAAAAAAAGEKBEAAA          516           12          133\n14  AAAAAAAAGMDDCAAA          515          121           14\n15  AAAAAAAAADDNAAAA          462          272           53\n16  AAAAAAAAJANOBAAA          427          160            1\n17  AAAAAAAAADMBEAAA          232          223           29\n18  AAAAAAAAIKPJCAAA          458          184          153\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(coalesce(sr_item_qty, 0)+coalesce(cr_item_qty, 0)+coalesce(wr_item_qty, 0))/3.0 * 100 as sr_dev\nfrom sr_items\nleft join cr_items on sr_items.item_id = cr_items.item_id\nleft join wr_items on sr_items.item_id = wr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SR_ITEMS\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"CR_ITEMS\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"WR_ITEMS\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" LEFT JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.263336,
                    "execution_time": 0.079382,
                    "compile_time": 0.000334,
                    "planning_time": 0.008321,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.426219,
                    "execution_time": 0.081981,
                    "compile_time": 0.112793,
                    "planning_time": 0.063527,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_DEV\" AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev\n0   AAAAAAAAHJMFEAAA          525     0.0\n1   AAAAAAAAGPEHDAAA          521     0.0\n2   AAAAAAAADCIADAAA          186     0.0\n3   AAAAAAAAKANMCAAA          590     0.0\n4   AAAAAAAAHCOGCAAA          450     0.0\n5   AAAAAAAAPFEHAAAA          425     0.0\n6   AAAAAAAAOMBMBAAA          372     0.0\n7   AAAAAAAADOKAEAAA          414     0.0\n8   AAAAAAAAABHPDAAA          501     0.0\n9   AAAAAAAAGDIAAAAA          493     0.0\n10  AAAAAAAAEDHHEAAA          454     0.0\n11  AAAAAAAAPMEJAAAA          405     0.0\n12  AAAAAAAANNGCDAAA          381     0.0\n13  AAAAAAAAGFHODAAA          292     0.0\n14  AAAAAAAAIDIMDAAA          150     0.0\n15  AAAAAAAAAJMABAAA          379     0.0\n16  AAAAAAAAFLNFAAAA          316     0.0\n17  AAAAAAAAFDCLBAAA          374     0.0\n18  AAAAAAAACAECDAAA          303     0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017127,
                    "execution_time": 0.007351,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003491
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.196714,
                    "execution_time": 0.008212,
                    "compile_time": 0.140807,
                    "planning_time": 0.038831
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_DEV\" AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev\n0   AAAAAAAAHJMFEAAA          525     0.0\n1   AAAAAAAAGPEHDAAA          521     0.0\n2   AAAAAAAADCIADAAA          186     0.0\n3   AAAAAAAAKANMCAAA          590     0.0\n4   AAAAAAAAHCOGCAAA          450     0.0\n5   AAAAAAAAPFEHAAAA          425     0.0\n6   AAAAAAAAOMBMBAAA          372     0.0\n7   AAAAAAAADOKAEAAA          414     0.0\n8   AAAAAAAAABHPDAAA          501     0.0\n9   AAAAAAAAGDIAAAAA          493     0.0\n10  AAAAAAAAEDHHEAAA          454     0.0\n11  AAAAAAAAPMEJAAAA          405     0.0\n12  AAAAAAAANNGCDAAA          381     0.0\n13  AAAAAAAAGFHODAAA          292     0.0\n14  AAAAAAAAIDIMDAAA          150     0.0\n15  AAAAAAAAAJMABAAA          379     0.0\n16  AAAAAAAAFLNFAAAA          316     0.0\n17  AAAAAAAAFDCLBAAA          374     0.0\n18  AAAAAAAACAECDAAA          303     0.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_items.sr_item_qty\n       ,sr_items.sr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_items.cr_item_qty\n       ,cr_items.cr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_items.wr_item_qty\n       ,wr_items.wr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 average\n from sr_items\n      , cr_items\n      , wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106722,
                    "execution_time": 0.048747,
                    "compile_time": 0.000227,
                    "planning_time": 0.002764,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.169459,
                    "execution_time": 0.050319,
                    "compile_time": 0.001196,
                    "planning_time": 0.057346,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.102908,
                    "execution_time": 0.046906,
                    "compile_time": 0.000258,
                    "planning_time": 0.003036,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.1635,
                    "execution_time": 0.048941,
                    "compile_time": 0.000242,
                    "planning_time": 0.058504,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAHJMFEAAA          525     0.0          355     0.0           33     0.0  304.3333\n1   AAAAAAAAGPEHDAAA          521     0.0          355     0.0           33     0.0  303.0000\n2   AAAAAAAADCIADAAA          186     0.0          355     0.0           33     0.0  191.3333\n3   AAAAAAAAKANMCAAA          590     0.0          355     0.0           33     0.0  326.0000\n4   AAAAAAAAHCOGCAAA          450     0.0          355     0.0           33     0.0  279.3333\n5   AAAAAAAAPFEHAAAA          425     0.0          355     0.0           33     0.0  271.0000\n6   AAAAAAAAOMBMBAAA          372     0.0          355     0.0           33     0.0  253.3333\n7   AAAAAAAADOKAEAAA          414     0.0          355     0.0           33     0.0  267.3333\n8   AAAAAAAAABHPDAAA          501     0.0          355     0.0           33     0.0  296.3333\n9   AAAAAAAAGDIAAAAA          493     0.0          355     0.0           33     0.0  293.6666\n10  AAAAAAAAEDHHEAAA          454     0.0          355     0.0           33     0.0  280.6666\n11  AAAAAAAAPMEJAAAA          405     0.0          355     0.0           33     0.0  264.3333\n12  AAAAAAAANNGCDAAA          381     0.0          355     0.0           33     0.0  256.3333\n13  AAAAAAAAGFHODAAA          292     0.0          355     0.0           33     0.0  226.6666\n14  AAAAAAAAIDIMDAAA          150     0.0          355     0.0           33     0.0  179.3333\n15  AAAAAAAAAJMABAAA          379     0.0          355     0.0           33     0.0  255.6666\n16  AAAAAAAAFLNFAAAA          316     0.0          355     0.0           33     0.0  234.6666\n17  AAAAAAAAFDCLBAAA          374     0.0          355     0.0           33     0.0  254.0000\n18  AAAAAAAACAECDAAA          303     0.0          355     0.0           33     0.0  230.3333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.079818,
                    "execution_time": 0.034477,
                    "compile_time": 0.034601,
                    "planning_time": 0.008872
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.163328,
                    "execution_time": 0.067591,
                    "compile_time": 3.079507,
                    "planning_time": 0.044659
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAHJMFEAAA          525     0.0          355     0.0           33     0.0  304.3333\n1   AAAAAAAAGPEHDAAA          521     0.0          355     0.0           33     0.0  303.0000\n2   AAAAAAAADCIADAAA          186     0.0          355     0.0           33     0.0  191.3333\n3   AAAAAAAAKANMCAAA          590     0.0          355     0.0           33     0.0  326.0000\n4   AAAAAAAAHCOGCAAA          450     0.0          355     0.0           33     0.0  279.3333\n5   AAAAAAAAPFEHAAAA          425     0.0          355     0.0           33     0.0  271.0000\n6   AAAAAAAAOMBMBAAA          372     0.0          355     0.0           33     0.0  253.3333\n7   AAAAAAAADOKAEAAA          414     0.0          355     0.0           33     0.0  267.3333\n8   AAAAAAAAABHPDAAA          501     0.0          355     0.0           33     0.0  296.3333\n9   AAAAAAAAGDIAAAAA          493     0.0          355     0.0           33     0.0  293.6666\n10  AAAAAAAAEDHHEAAA          454     0.0          355     0.0           33     0.0  280.6666\n11  AAAAAAAAPMEJAAAA          405     0.0          355     0.0           33     0.0  264.3333\n12  AAAAAAAANNGCDAAA          381     0.0          355     0.0           33     0.0  256.3333\n13  AAAAAAAAGFHODAAA          292     0.0          355     0.0           33     0.0  226.6666\n14  AAAAAAAAIDIMDAAA          150     0.0          355     0.0           33     0.0  179.3333\n15  AAAAAAAAAJMABAAA          379     0.0          355     0.0           33     0.0  255.6666\n16  AAAAAAAAFLNFAAAA          316     0.0          355     0.0           33     0.0  234.6666\n17  AAAAAAAAFDCLBAAA          374     0.0          355     0.0           33     0.0  254.0000\n18  AAAAAAAACAECDAAA          303     0.0          355     0.0           33     0.0  230.3333\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAIJMLDAAA          412     0.0          236     0.0          116     0.0  254.6666\n1   AAAAAAAAJDJJBAAA          479     0.0          236     0.0          116     0.0  277.0000\n2   AAAAAAAAMCLFEAAA          594     0.0          236     0.0          116     0.0  315.3333\n3   AAAAAAAAILKEBAAA          348     0.0          236     0.0          116     0.0  233.3333\n4   AAAAAAAAIIJAEAAA          403     0.0          236     0.0          116     0.0  251.6666\n5   AAAAAAAAIFFLDAAA          400     0.0          236     0.0          116     0.0  250.6666\n6   AAAAAAAAHNHGBAAA          585     0.0          236     0.0          116     0.0  312.3333\n7   AAAAAAAAKHJHBAAA          189     0.0          236     0.0          116     0.0  180.3333\n8   AAAAAAAADLAIDAAA          389     0.0          236     0.0          116     0.0  247.0000\n9   AAAAAAAAODCADAAA          834     0.0          236     0.0          116     0.0  395.3333\n10  AAAAAAAALHBAAAAA          385     0.0          236     0.0          116     0.0  245.6666\n11  AAAAAAAACJECCAAA          558     0.0          236     0.0          116     0.0  303.3333\n12  AAAAAAAAKIPBAAAA          450     0.0          236     0.0          116     0.0  267.3333\n13  AAAAAAAADOPJCAAA          211     0.0          236     0.0          116     0.0  187.6666\n14  AAAAAAAAMIPPCAAA          510     0.0          236     0.0          116     0.0  287.3333\n15  AAAAAAAAACJFEAAA          460     0.0          236     0.0          116     0.0  270.6666\n16  AAAAAAAAOONMAAAA          249     0.0          236     0.0          116     0.0  200.3333\n17  AAAAAAAAGFPHBAAA          559     0.0          236     0.0          116     0.0  303.6666\n18  AAAAAAAAEHAPAAAA          438     0.0          236     0.0          116     0.0  263.3333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044582,
                    "execution_time": 0.027284,
                    "compile_time": 0.000139,
                    "planning_time": 0.00839
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.140029,
                    "execution_time": 0.029996,
                    "compile_time": 0.089574,
                    "planning_time": 0.008555
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAIJMLDAAA          412     0.0          236     0.0          116     0.0  254.6666\n1   AAAAAAAAJDJJBAAA          479     0.0          236     0.0          116     0.0  277.0000\n2   AAAAAAAAMCLFEAAA          594     0.0          236     0.0          116     0.0  315.3333\n3   AAAAAAAAILKEBAAA          348     0.0          236     0.0          116     0.0  233.3333\n4   AAAAAAAAIIJAEAAA          403     0.0          236     0.0          116     0.0  251.6666\n5   AAAAAAAAIFFLDAAA          400     0.0          236     0.0          116     0.0  250.6666\n6   AAAAAAAAHNHGBAAA          585     0.0          236     0.0          116     0.0  312.3333\n7   AAAAAAAAKHJHBAAA          189     0.0          236     0.0          116     0.0  180.3333\n8   AAAAAAAADLAIDAAA          389     0.0          236     0.0          116     0.0  247.0000\n9   AAAAAAAAODCADAAA          834     0.0          236     0.0          116     0.0  395.3333\n10  AAAAAAAALHBAAAAA          385     0.0          236     0.0          116     0.0  245.6666\n11  AAAAAAAACJECCAAA          558     0.0          236     0.0          116     0.0  303.3333\n12  AAAAAAAAKIPBAAAA          450     0.0          236     0.0          116     0.0  267.3333\n13  AAAAAAAADOPJCAAA          211     0.0          236     0.0          116     0.0  187.6666\n14  AAAAAAAAMIPPCAAA          510     0.0          236     0.0          116     0.0  287.3333\n15  AAAAAAAAACJFEAAA          460     0.0          236     0.0          116     0.0  270.6666\n16  AAAAAAAAOONMAAAA          249     0.0          236     0.0          116     0.0  200.3333\n17  AAAAAAAAGFPHBAAA          559     0.0          236     0.0          116     0.0  303.6666\n18  AAAAAAAAEHAPAAAA          438     0.0          236     0.0          116     0.0  263.3333\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAIIDBAAA          349     0.0          355     0.0           33     0.0  245.6666\n1   AAAAAAAAHPPGDAAA          156     0.0          355     0.0           33     0.0  181.3333\n2   AAAAAAAAKIDICAAA          257     0.0          355     0.0           33     0.0  215.0000\n3   AAAAAAAACGILBAAA          215     0.0          355     0.0           33     0.0  201.0000\n4   AAAAAAAAFFPGDAAA          514     0.0          355     0.0           33     0.0  300.6666\n5   AAAAAAAAMILFBAAA          462     0.0          355     0.0           33     0.0  283.3333\n6   AAAAAAAAGHCEEAAA          408     0.0          355     0.0           33     0.0  265.3333\n7   AAAAAAAAAEDBCAAA          480     0.0          355     0.0           33     0.0  289.3333\n8   AAAAAAAAADBBDAAA          429     0.0          355     0.0           33     0.0  272.3333\n9   AAAAAAAALMCKCAAA          298     0.0          355     0.0           33     0.0  228.6666\n10  AAAAAAAAHLHIEAAA          512     0.0          355     0.0           33     0.0  300.0000\n11  AAAAAAAAOKAJCAAA          361     0.0          355     0.0           33     0.0  249.6666\n12  AAAAAAAAGEPFBAAA          254     0.0          355     0.0           33     0.0  214.0000\n13  AAAAAAAAABNBEAAA          435     0.0          355     0.0           33     0.0  274.3333\n14  AAAAAAAAEMABAAAA          316     0.0          355     0.0           33     0.0  234.6666\n15  AAAAAAAADKAKCAAA          483     0.0          355     0.0           33     0.0  290.3333\n16  AAAAAAAANDFOCAAA          407     0.0          355     0.0           33     0.0  265.0000\n17  AAAAAAAANIOACAAA          684     0.0          355     0.0           33     0.0  357.3333\n18  AAAAAAAAAKDADAAA          197     0.0          355     0.0           33     0.0  195.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044581,
                    "execution_time": 0.027089,
                    "compile_time": 0.00015,
                    "planning_time": 0.008529
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.046695,
                    "execution_time": 0.028604,
                    "compile_time": 0.000138,
                    "planning_time": 0.008561
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAIIDBAAA          349     0.0          355     0.0           33     0.0  245.6666\n1   AAAAAAAAHPPGDAAA          156     0.0          355     0.0           33     0.0  181.3333\n2   AAAAAAAAKIDICAAA          257     0.0          355     0.0           33     0.0  215.0000\n3   AAAAAAAACGILBAAA          215     0.0          355     0.0           33     0.0  201.0000\n4   AAAAAAAAFFPGDAAA          514     0.0          355     0.0           33     0.0  300.6666\n5   AAAAAAAAMILFBAAA          462     0.0          355     0.0           33     0.0  283.3333\n6   AAAAAAAAGHCEEAAA          408     0.0          355     0.0           33     0.0  265.3333\n7   AAAAAAAAAEDBCAAA          480     0.0          355     0.0           33     0.0  289.3333\n8   AAAAAAAAADBBDAAA          429     0.0          355     0.0           33     0.0  272.3333\n9   AAAAAAAALMCKCAAA          298     0.0          355     0.0           33     0.0  228.6666\n10  AAAAAAAAHLHIEAAA          512     0.0          355     0.0           33     0.0  300.0000\n11  AAAAAAAAOKAJCAAA          361     0.0          355     0.0           33     0.0  249.6666\n12  AAAAAAAAGEPFBAAA          254     0.0          355     0.0           33     0.0  214.0000\n13  AAAAAAAAABNBEAAA          435     0.0          355     0.0           33     0.0  274.3333\n14  AAAAAAAAEMABAAAA          316     0.0          355     0.0           33     0.0  234.6666\n15  AAAAAAAADKAKCAAA          483     0.0          355     0.0           33     0.0  290.3333\n16  AAAAAAAANDFOCAAA          407     0.0          355     0.0           33     0.0  265.0000\n17  AAAAAAAANIOACAAA          684     0.0          355     0.0           33     0.0  357.3333\n18  AAAAAAAAAKDADAAA          197     0.0          355     0.0           33     0.0  195.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAACPBKBAAA          278     0.0           66     0.0           54     0.0  132.6666\n1   AAAAAAAACPBKBAAA          278     0.0           66     0.0           11     0.0  118.3333\n2   AAAAAAAACPBKBAAA          278     0.0           66     0.0           12     0.0  118.6666\n3   AAAAAAAACPBKBAAA          278     0.0           66     0.0          131     0.0  158.3333\n4   AAAAAAAACPBKBAAA          278     0.0           66     0.0           54     0.0  132.6666\n5   AAAAAAAACPBKBAAA          278     0.0           66     0.0          175     0.0  173.0000\n6   AAAAAAAACPBKBAAA          278     0.0           66     0.0          105     0.0  149.6666\n7   AAAAAAAACPBKBAAA          278     0.0           66     0.0           70     0.0  138.0000\n8   AAAAAAAACPBKBAAA          278     0.0           66     0.0           16     0.0  120.0000\n9   AAAAAAAACPBKBAAA          278     0.0           66     0.0            1     0.0  115.0000\n10  AAAAAAAACPBKBAAA          278     0.0           66     0.0           35     0.0  126.3333\n11  AAAAAAAACPBKBAAA          278     0.0           66     0.0           86     0.0  143.3333\n12  AAAAAAAACPBKBAAA          278     0.0           66     0.0           99     0.0  147.6666\n13  AAAAAAAACPBKBAAA          278     0.0           66     0.0           23     0.0  122.3333\n14  AAAAAAAACPBKBAAA          278     0.0           66     0.0           23     0.0  122.3333\n15  AAAAAAAACPBKBAAA          278     0.0           66     0.0           73     0.0  139.0000\n16  AAAAAAAACPBKBAAA          278     0.0           66     0.0          120     0.0  154.6666\n17  AAAAAAAACPBKBAAA          278     0.0           66     0.0          110     0.0  151.3333\n18  AAAAAAAACPBKBAAA          278     0.0           66     0.0          133     0.0  159.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043383,
                    "execution_time": 0.024052,
                    "compile_time": 0.000135,
                    "planning_time": 0.008921
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.12324,
                    "execution_time": 0.063285,
                    "compile_time": 0.001314,
                    "planning_time": 0.045004
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAACPBKBAAA          278     0.0           66     0.0           54     0.0  132.6666\n1   AAAAAAAACPBKBAAA          278     0.0           66     0.0           11     0.0  118.3333\n2   AAAAAAAACPBKBAAA          278     0.0           66     0.0           12     0.0  118.6666\n3   AAAAAAAACPBKBAAA          278     0.0           66     0.0          131     0.0  158.3333\n4   AAAAAAAACPBKBAAA          278     0.0           66     0.0           54     0.0  132.6666\n5   AAAAAAAACPBKBAAA          278     0.0           66     0.0          175     0.0  173.0000\n6   AAAAAAAACPBKBAAA          278     0.0           66     0.0          105     0.0  149.6666\n7   AAAAAAAACPBKBAAA          278     0.0           66     0.0           70     0.0  138.0000\n8   AAAAAAAACPBKBAAA          278     0.0           66     0.0           16     0.0  120.0000\n9   AAAAAAAACPBKBAAA          278     0.0           66     0.0            1     0.0  115.0000\n10  AAAAAAAACPBKBAAA          278     0.0           66     0.0           35     0.0  126.3333\n11  AAAAAAAACPBKBAAA          278     0.0           66     0.0           86     0.0  143.3333\n12  AAAAAAAACPBKBAAA          278     0.0           66     0.0           99     0.0  147.6666\n13  AAAAAAAACPBKBAAA          278     0.0           66     0.0           23     0.0  122.3333\n14  AAAAAAAACPBKBAAA          278     0.0           66     0.0           23     0.0  122.3333\n15  AAAAAAAACPBKBAAA          278     0.0           66     0.0           73     0.0  139.0000\n16  AAAAAAAACPBKBAAA          278     0.0           66     0.0          120     0.0  154.6666\n17  AAAAAAAACPBKBAAA          278     0.0           66     0.0          110     0.0  151.3333\n18  AAAAAAAACPBKBAAA          278     0.0           66     0.0          133     0.0  159.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.655304,
                    "execution_time": 0.146159,
                    "compile_time": 0.147416,
                    "planning_time": 0.009127,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.601837,
                    "execution_time": 0.256747,
                    "compile_time": 9.954911,
                    "planning_time": 0.069092,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAALFCKDAAA          451     0.0          139     0.0          230     0.0  273.3333\n1   AAAAAAAAMMDPBAAA          251     0.0          406     0.0           30     0.0  229.0000\n2   AAAAAAAAKJIHEAAA          497     0.0           81     0.0           30     0.0  202.6666\n3   AAAAAAAAAKEMCAAA          472     0.0          279     0.0           12     0.0  254.3333\n4   AAAAAAAAINDEDAAA          351     0.0           48     0.0           37     0.0  145.3333\n5   AAAAAAAAEOBBDAAA          465     0.0          359     0.0           76     0.0  300.0000\n6   AAAAAAAAKKENAAAA          636     0.0          253     0.0           93     0.0  327.3333\n7   AAAAAAAAAADFAAAA          353     0.0          119     0.0           90     0.0  187.3333\n8   AAAAAAAAKLMGCAAA          484     0.0          121     0.0           25     0.0  210.0000\n9   AAAAAAAAABCFCAAA          324     0.0          218     0.0           65     0.0  202.3333\n10  AAAAAAAAIODHDAAA          410     0.0          158     0.0           36     0.0  201.3333\n11  AAAAAAAAJBBHEAAA          360     0.0           40     0.0           73     0.0  157.6666\n12  AAAAAAAAMNADEAAA          520     0.0          101     0.0           71     0.0  230.6666\n13  AAAAAAAAELIMCAAA          289     0.0          300     0.0           32     0.0  207.0000\n14  AAAAAAAAMOEGCAAA          358     0.0          193     0.0            5     0.0  185.3333\n15  AAAAAAAACPJCAAAA          507     0.0          114     0.0          158     0.0  259.6666\n16  AAAAAAAALPHLCAAA          497     0.0          115     0.0           58     0.0  223.3333\n17  AAAAAAAAFLHGCAAA          366     0.0           90     0.0           65     0.0  173.6666\n18  AAAAAAAAMOIBAAAA          436     0.0           16     0.0            4     0.0  152.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017662,
                    "execution_time": 0.007458,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003963
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.224846,
                    "execution_time": 0.008487,
                    "compile_time": 0.168583,
                    "planning_time": 0.039644
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAALFCKDAAA          451     0.0          139     0.0          230     0.0  273.3333\n1   AAAAAAAAMMDPBAAA          251     0.0          406     0.0           30     0.0  229.0000\n2   AAAAAAAAKJIHEAAA          497     0.0           81     0.0           30     0.0  202.6666\n3   AAAAAAAAAKEMCAAA          472     0.0          279     0.0           12     0.0  254.3333\n4   AAAAAAAAINDEDAAA          351     0.0           48     0.0           37     0.0  145.3333\n5   AAAAAAAAEOBBDAAA          465     0.0          359     0.0           76     0.0  300.0000\n6   AAAAAAAAKKENAAAA          636     0.0          253     0.0           93     0.0  327.3333\n7   AAAAAAAAAADFAAAA          353     0.0          119     0.0           90     0.0  187.3333\n8   AAAAAAAAKLMGCAAA          484     0.0          121     0.0           25     0.0  210.0000\n9   AAAAAAAAABCFCAAA          324     0.0          218     0.0           65     0.0  202.3333\n10  AAAAAAAAIODHDAAA          410     0.0          158     0.0           36     0.0  201.3333\n11  AAAAAAAAJBBHEAAA          360     0.0           40     0.0           73     0.0  157.6666\n12  AAAAAAAAMNADEAAA          520     0.0          101     0.0           71     0.0  230.6666\n13  AAAAAAAAELIMCAAA          289     0.0          300     0.0           32     0.0  207.0000\n14  AAAAAAAAMOEGCAAA          358     0.0          193     0.0            5     0.0  185.3333\n15  AAAAAAAACPJCAAAA          507     0.0          114     0.0          158     0.0  259.6666\n16  AAAAAAAALPHLCAAA          497     0.0          115     0.0           58     0.0  223.3333\n17  AAAAAAAAFLHGCAAA          366     0.0           90     0.0           65     0.0  173.6666\n18  AAAAAAAAMOIBAAAA          436     0.0           16     0.0            4     0.0  152.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAABAAA          393     0.0           69     0.0          106     0.0  189.3333\n1   AAAAAAAAAAAACAAA          479     0.0          133     0.0           17     0.0  209.6666\n2   AAAAAAAAAAAAEAAA          266     0.0          144     0.0            8     0.0  139.3333\n3   AAAAAAAAAAABAAAA          371     0.0          149     0.0           51     0.0  190.3333\n4   AAAAAAAAAAABBAAA          448     0.0          151     0.0           32     0.0  210.3333\n5   AAAAAAAAAAABDAAA          419     0.0          156     0.0           61     0.0  212.0000\n6   AAAAAAAAAAABEAAA          419     0.0           71     0.0           90     0.0  193.3333\n7   AAAAAAAAAAACAAAA          265     0.0          214     0.0            1     0.0  160.0000\n8   AAAAAAAAAAACCAAA          676     0.0          117     0.0           25     0.0  272.6666\n9   AAAAAAAAAAACDAAA          336     0.0          201     0.0          116     0.0  217.6666\n10  AAAAAAAAAAADEAAA          546     0.0          152     0.0            4     0.0  234.0000\n11  AAAAAAAAAAAEAAAA          398     0.0           70     0.0           36     0.0  168.0000\n12  AAAAAAAAAAAEBAAA          438     0.0          109     0.0          126     0.0  224.3333\n13  AAAAAAAAAAAEDAAA          417     0.0           87     0.0           33     0.0  179.0000\n14  AAAAAAAAAAAEEAAA          494     0.0          180     0.0          119     0.0  264.3333\n15  AAAAAAAAAAAFAAAA          345     0.0          269     0.0           26     0.0  213.3333\n16  AAAAAAAAAAAFDAAA          275     0.0          305     0.0          112     0.0  230.6666\n17  AAAAAAAAAAAGBAAA          194     0.0          134     0.0          188     0.0  172.0000\n18  AAAAAAAAAAAGCAAA          361     0.0          358     0.0           85     0.0  268.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021253,
                    "execution_time": 0.010721,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004145
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059984,
                    "execution_time": 0.011127,
                    "compile_time": 0.001971,
                    "planning_time": 0.039565
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAABAAA          393     0.0           69     0.0          106     0.0  189.3333\n1   AAAAAAAAAAAACAAA          479     0.0          133     0.0           17     0.0  209.6666\n2   AAAAAAAAAAAAEAAA          266     0.0          144     0.0            8     0.0  139.3333\n3   AAAAAAAAAAABAAAA          371     0.0          149     0.0           51     0.0  190.3333\n4   AAAAAAAAAAABBAAA          448     0.0          151     0.0           32     0.0  210.3333\n5   AAAAAAAAAAABDAAA          419     0.0          156     0.0           61     0.0  212.0000\n6   AAAAAAAAAAABEAAA          419     0.0           71     0.0           90     0.0  193.3333\n7   AAAAAAAAAAACAAAA          265     0.0          214     0.0            1     0.0  160.0000\n8   AAAAAAAAAAACCAAA          676     0.0          117     0.0           25     0.0  272.6666\n9   AAAAAAAAAAACDAAA          336     0.0          201     0.0          116     0.0  217.6666\n10  AAAAAAAAAAADEAAA          546     0.0          152     0.0            4     0.0  234.0000\n11  AAAAAAAAAAAEAAAA          398     0.0           70     0.0           36     0.0  168.0000\n12  AAAAAAAAAAAEBAAA          438     0.0          109     0.0          126     0.0  224.3333\n13  AAAAAAAAAAAEDAAA          417     0.0           87     0.0           33     0.0  179.0000\n14  AAAAAAAAAAAEEAAA          494     0.0          180     0.0          119     0.0  264.3333\n15  AAAAAAAAAAAFAAAA          345     0.0          269     0.0           26     0.0  213.3333\n16  AAAAAAAAAAAFDAAA          275     0.0          305     0.0          112     0.0  230.6666\n17  AAAAAAAAAAAGBAAA          194     0.0          134     0.0          188     0.0  172.0000\n18  AAAAAAAAAAAGCAAA          361     0.0          358     0.0           85     0.0  268.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n         ,sr_item_qty\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" , \"SR_ITEM_QTY\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAABAAA          393     0.0           69     0.0          106     0.0  189.3333\n1   AAAAAAAAAAAACAAA          479     0.0          133     0.0           17     0.0  209.6666\n2   AAAAAAAAAAAAEAAA          266     0.0          144     0.0            8     0.0  139.3333\n3   AAAAAAAAAAABAAAA          371     0.0          149     0.0           51     0.0  190.3333\n4   AAAAAAAAAAABBAAA          448     0.0          151     0.0           32     0.0  210.3333\n5   AAAAAAAAAAABDAAA          419     0.0          156     0.0           61     0.0  212.0000\n6   AAAAAAAAAAABEAAA          419     0.0           71     0.0           90     0.0  193.3333\n7   AAAAAAAAAAACAAAA          265     0.0          214     0.0            1     0.0  160.0000\n8   AAAAAAAAAAACCAAA          676     0.0          117     0.0           25     0.0  272.6666\n9   AAAAAAAAAAACDAAA          336     0.0          201     0.0          116     0.0  217.6666\n10  AAAAAAAAAAADEAAA          546     0.0          152     0.0            4     0.0  234.0000\n11  AAAAAAAAAAAEAAAA          398     0.0           70     0.0           36     0.0  168.0000\n12  AAAAAAAAAAAEBAAA          438     0.0          109     0.0          126     0.0  224.3333\n13  AAAAAAAAAAAEDAAA          417     0.0           87     0.0           33     0.0  179.0000\n14  AAAAAAAAAAAEEAAA          494     0.0          180     0.0          119     0.0  264.3333\n15  AAAAAAAAAAAFAAAA          345     0.0          269     0.0           26     0.0  213.3333\n16  AAAAAAAAAAAFDAAA          275     0.0          305     0.0          112     0.0  230.6666\n17  AAAAAAAAAAAGBAAA          194     0.0          134     0.0          188     0.0  172.0000\n18  AAAAAAAAAAAGCAAA          361     0.0          358     0.0           85     0.0  268.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021532,
                    "execution_time": 0.010775,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.00429
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.172357,
                    "execution_time": 0.010317,
                    "compile_time": 0.115921,
                    "planning_time": 0.039558
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAABAAA          393     0.0           69     0.0          106     0.0  189.3333\n1   AAAAAAAAAAAACAAA          479     0.0          133     0.0           17     0.0  209.6666\n2   AAAAAAAAAAAAEAAA          266     0.0          144     0.0            8     0.0  139.3333\n3   AAAAAAAAAAABAAAA          371     0.0          149     0.0           51     0.0  190.3333\n4   AAAAAAAAAAABBAAA          448     0.0          151     0.0           32     0.0  210.3333\n5   AAAAAAAAAAABDAAA          419     0.0          156     0.0           61     0.0  212.0000\n6   AAAAAAAAAAABEAAA          419     0.0           71     0.0           90     0.0  193.3333\n7   AAAAAAAAAAACAAAA          265     0.0          214     0.0            1     0.0  160.0000\n8   AAAAAAAAAAACCAAA          676     0.0          117     0.0           25     0.0  272.6666\n9   AAAAAAAAAAACDAAA          336     0.0          201     0.0          116     0.0  217.6666\n10  AAAAAAAAAAADEAAA          546     0.0          152     0.0            4     0.0  234.0000\n11  AAAAAAAAAAAEAAAA          398     0.0           70     0.0           36     0.0  168.0000\n12  AAAAAAAAAAAEBAAA          438     0.0          109     0.0          126     0.0  224.3333\n13  AAAAAAAAAAAEDAAA          417     0.0           87     0.0           33     0.0  179.0000\n14  AAAAAAAAAAAEEAAA          494     0.0          180     0.0          119     0.0  264.3333\n15  AAAAAAAAAAAFAAAA          345     0.0          269     0.0           26     0.0  213.3333\n16  AAAAAAAAAAAFDAAA          275     0.0          305     0.0          112     0.0  230.6666\n17  AAAAAAAAAAAGBAAA          194     0.0          134     0.0          188     0.0  172.0000\n18  AAAAAAAAAAAGCAAA          361     0.0          358     0.0           85     0.0  268.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n         ,sr_item_qty\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" , \"SR_ITEM_QTY\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAABAAA          393     0.0           69     0.0          106     0.0  189.3333\n1   AAAAAAAAAAAACAAA          479     0.0          133     0.0           17     0.0  209.6666\n2   AAAAAAAAAAAAEAAA          266     0.0          144     0.0            8     0.0  139.3333\n3   AAAAAAAAAAABAAAA          371     0.0          149     0.0           51     0.0  190.3333\n4   AAAAAAAAAAABBAAA          448     0.0          151     0.0           32     0.0  210.3333\n5   AAAAAAAAAAABDAAA          419     0.0          156     0.0           61     0.0  212.0000\n6   AAAAAAAAAAABEAAA          419     0.0           71     0.0           90     0.0  193.3333\n7   AAAAAAAAAAACAAAA          265     0.0          214     0.0            1     0.0  160.0000\n8   AAAAAAAAAAACCAAA          676     0.0          117     0.0           25     0.0  272.6666\n9   AAAAAAAAAAACDAAA          336     0.0          201     0.0          116     0.0  217.6666\n10  AAAAAAAAAAADEAAA          546     0.0          152     0.0            4     0.0  234.0000\n11  AAAAAAAAAAAEAAAA          398     0.0           70     0.0           36     0.0  168.0000\n12  AAAAAAAAAAAEBAAA          438     0.0          109     0.0          126     0.0  224.3333\n13  AAAAAAAAAAAEDAAA          417     0.0           87     0.0           33     0.0  179.0000\n14  AAAAAAAAAAAEEAAA          494     0.0          180     0.0          119     0.0  264.3333\n15  AAAAAAAAAAAFAAAA          345     0.0          269     0.0           26     0.0  213.3333\n16  AAAAAAAAAAAFDAAA          275     0.0          305     0.0          112     0.0  230.6666\n17  AAAAAAAAAAAGBAAA          194     0.0          134     0.0          188     0.0  172.0000\n18  AAAAAAAAAAAGCAAA          361     0.0          358     0.0           85     0.0  268.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021229,
                    "execution_time": 0.010451,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004315
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022137,
                    "execution_time": 0.011085,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004439
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAABAAA          393     0.0           69     0.0          106     0.0  189.3333\n1   AAAAAAAAAAAACAAA          479     0.0          133     0.0           17     0.0  209.6666\n2   AAAAAAAAAAAAEAAA          266     0.0          144     0.0            8     0.0  139.3333\n3   AAAAAAAAAAABAAAA          371     0.0          149     0.0           51     0.0  190.3333\n4   AAAAAAAAAAABBAAA          448     0.0          151     0.0           32     0.0  210.3333\n5   AAAAAAAAAAABDAAA          419     0.0          156     0.0           61     0.0  212.0000\n6   AAAAAAAAAAABEAAA          419     0.0           71     0.0           90     0.0  193.3333\n7   AAAAAAAAAAACAAAA          265     0.0          214     0.0            1     0.0  160.0000\n8   AAAAAAAAAAACCAAA          676     0.0          117     0.0           25     0.0  272.6666\n9   AAAAAAAAAAACDAAA          336     0.0          201     0.0          116     0.0  217.6666\n10  AAAAAAAAAAADEAAA          546     0.0          152     0.0            4     0.0  234.0000\n11  AAAAAAAAAAAEAAAA          398     0.0           70     0.0           36     0.0  168.0000\n12  AAAAAAAAAAAEBAAA          438     0.0          109     0.0          126     0.0  224.3333\n13  AAAAAAAAAAAEDAAA          417     0.0           87     0.0           33     0.0  179.0000\n14  AAAAAAAAAAAEEAAA          494     0.0          180     0.0          119     0.0  264.3333\n15  AAAAAAAAAAAFAAAA          345     0.0          269     0.0           26     0.0  213.3333\n16  AAAAAAAAAAAFDAAA          275     0.0          305     0.0          112     0.0  230.6666\n17  AAAAAAAAAAAGBAAA          194     0.0          134     0.0          188     0.0  172.0000\n18  AAAAAAAAAAAGCAAA          361     0.0          358     0.0           85     0.0  268.0000\n...*/"
    }
]