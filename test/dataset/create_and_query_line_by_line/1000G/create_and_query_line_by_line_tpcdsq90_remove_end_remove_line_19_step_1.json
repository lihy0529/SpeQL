[
    {
        "input": "-- start template query90.tpl query 40 in stream 0\n/*CURSOR_IDENTIFIER*/ SELECT 1",
        "optimize": [
            "SELECT 1 AS \"1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT 1 AS \"1\" LIMIT 21",
                "preview": "\n/*   1\n0  1*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.732471,
                    "execution_time": 0.472667,
                    "compile_time": 0.000357,
                    "planning_time": 0.077517
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.734824,
                    "execution_time": 0.47668,
                    "compile_time": 0.000377,
                    "planning_time": 0.07645
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 1 AS \"1\"",
                "rewrite": "SELECT 1 AS \"1\""
            }
        ],
        "preview": "\n/*   1\n0  1*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(1 as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       ) as subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, 1 as pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n) as derived_table /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH DERIVED_TABLE AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH DERIVED_TABLE AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\"",
                "rewrite": "WITH DERIVED_TABLE AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) as amc, count(*) as pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n/*CURSOR_IDENTIFIER*/) t",
        "optimize": [
            "WITH \"T\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"T\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"T\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.46559,
                    "execution_time": 2.387886,
                    "compile_time": 0.00044,
                    "planning_time": 0.045957,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.660315,
                    "execution_time": 10.498979,
                    "compile_time": 0.001549,
                    "planning_time": 0.123062,
                    "create_size": 5
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0          1.0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017168,
                    "execution_time": 0.007423,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003636
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054706,
                    "execution_time": 0.007503,
                    "compile_time": 0.000973,
                    "planning_time": 0.039132
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0          1.0*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n/*CURSOR_IDENTIFIER*/ ) t",
        "optimize": [
            "WITH \"T\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"T\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"T\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS \"AMC\" , \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.091933,
                    "execution_time": 0.039472,
                    "compile_time": 0.000275,
                    "planning_time": 0.027185,
                    "create_size": 65
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.360523,
                    "execution_time": 0.040471,
                    "compile_time": 0.203241,
                    "planning_time": 0.088244,
                    "create_size": 60
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016805,
                    "execution_time": 0.007182,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.00355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054158,
                    "execution_time": 0.007343,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.03891
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n/*CURSOR_IDENTIFIER*/ ) t",
        "optimize": [
            "WITH \"T\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"T\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"T\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS \"AMC\" , \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.390522,
                    "execution_time": 0.291177,
                    "compile_time": 0.000343,
                    "planning_time": 0.029073,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.491119,
                    "execution_time": 0.321424,
                    "compile_time": 0.002015,
                    "planning_time": 0.094401,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017385,
                    "execution_time": 0.00748,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003618
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054814,
                    "execution_time": 0.00774,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039137
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from (\n       select count(*) as amc, count(*) as pmc \n       from household_demographics, web_page\n       where web_page.wp_web_page_sk is not null\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200\n     ) at\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND NOT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" IS NULL WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"AT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND NOT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" IS NULL WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093058,
                    "execution_time": 0.035941,
                    "compile_time": 0.000332,
                    "planning_time": 0.030155,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.296926,
                    "execution_time": 0.169321,
                    "compile_time": 0.002194,
                    "planning_time": 0.096382,
                    "create_size": 5
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0          1.0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016795,
                    "execution_time": 0.00736,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003265
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053679,
                    "execution_time": 0.007562,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039315
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0          1.0*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n/*CURSOR_IDENTIFIER*/ )  pmc",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.916022,
                    "execution_time": 6.8322,
                    "compile_time": 0.000389,
                    "planning_time": 0.036042,
                    "create_size": 3713
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.120327,
                    "execution_time": 6.965151,
                    "compile_time": 0.001278,
                    "planning_time": 0.102235,
                    "create_size": 3713
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT COUNT ( * ) AS \"PMC\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.061778,
                    "execution_time": 0.033519,
                    "compile_time": 0.000301,
                    "planning_time": 0.002762,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.119006,
                    "execution_time": 0.033167,
                    "compile_time": 0.000291,
                    "planning_time": 0.058811,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_6\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 23.557528,
                    "execution_time": 23.35699,
                    "compile_time": 0.000323,
                    "planning_time": 0.004148,
                    "create_size": 6273
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 24.879599,
                    "execution_time": 24.615328,
                    "compile_time": 0.002259,
                    "planning_time": 0.061762,
                    "create_size": 6273
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0   719685438.0\n1   719685438.0\n2   719685438.0\n3   719685438.0\n4   719685438.0\n5   719685438.0\n6   719685438.0\n7   719685438.0\n8   719685438.0\n9   719685438.0\n10  719685438.0\n11  719685438.0\n12  719685438.0\n13  719685438.0\n14  719685438.0\n15  719685438.0\n16  719685438.0\n17  719685438.0\n18  719685438.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016781,
                    "execution_time": 0.00766,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003076
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056174,
                    "execution_time": 0.007831,
                    "compile_time": 0.000977,
                    "planning_time": 0.038706
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_6\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0   719685438.0\n1   719685438.0\n2   719685438.0\n3   719685438.0\n4   719685438.0\n5   719685438.0\n6   719685438.0\n7   719685438.0\n8   719685438.0\n9   719685438.0\n10  719685438.0\n11  719685438.0\n12  719685438.0\n13  719685438.0\n14  719685438.0\n15  719685438.0\n16  719685438.0\n17  719685438.0\n18  719685438.0\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\"",
                "rewrite": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\nand ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 19 and 19+1\n         and household_demographics.hd_dep_count = 5\n         and web_page.wp_char_count between 5201 and 5500) bt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"BT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 5 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 20 AND \"TIME_DIM\".\"T_HOUR\" >= 19 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5500 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5201 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"BT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"BT\" AS \"BT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.261145,
                    "execution_time": 11.063353,
                    "compile_time": 0.000283,
                    "planning_time": 0.034815,
                    "create_size": 10496
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.444901,
                    "execution_time": 11.187245,
                    "compile_time": 0.000263,
                    "planning_time": 0.092404,
                    "create_size": 10496
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.761556,
                    "execution_time": 0.688372,
                    "compile_time": 0.000466,
                    "planning_time": 0.040062,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.845135,
                    "execution_time": 0.691463,
                    "compile_time": 0.004617,
                    "planning_time": 0.116389,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 5 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 20 AND \"TIME_DIM\".\"T_HOUR\" >= 19 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5500 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5201 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.782803,
                    "execution_time": 0.713407,
                    "compile_time": 0.000463,
                    "planning_time": 0.0368,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.860625,
                    "execution_time": 0.712269,
                    "compile_time": 0.001617,
                    "planning_time": 0.112635,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_10\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071492,
                    "execution_time": 0.044709,
                    "compile_time": 0.000284,
                    "planning_time": 0.004321,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.131775,
                    "execution_time": 0.044944,
                    "compile_time": 0.000281,
                    "planning_time": 0.062636,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.377487*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016194,
                    "execution_time": 0.007357,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003071
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052397,
                    "execution_time": 0.007706,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038695
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_10\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.377487*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\"",
                "rewrite": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.478991,
                    "execution_time": 2.411702,
                    "compile_time": 0.000404,
                    "planning_time": 0.036062,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.563727,
                    "execution_time": 2.416359,
                    "compile_time": 0.001512,
                    "planning_time": 0.110796,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_12\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071882,
                    "execution_time": 0.045144,
                    "compile_time": 0.000269,
                    "planning_time": 0.00439,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.131813,
                    "execution_time": 0.04421,
                    "compile_time": 0.000282,
                    "planning_time": 0.064894,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.000171*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015237,
                    "execution_time": 0.006657,
                    "compile_time": 4e-05,
                    "planning_time": 0.002931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051228,
                    "execution_time": 0.00705,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038365
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_12\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.000171*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"_Q_0\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"PMC\" AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.088407,
                    "execution_time": 0.038874,
                    "compile_time": 0.000293,
                    "planning_time": 0.024806,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.152803,
                    "execution_time": 0.039237,
                    "compile_time": 0.000276,
                    "planning_time": 0.086373,
                    "create_size": 64
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_14\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.07334,
                    "execution_time": 0.043688,
                    "compile_time": 0.000282,
                    "planning_time": 0.00436,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.136261,
                    "execution_time": 0.044632,
                    "compile_time": 0.001129,
                    "planning_time": 0.062808,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0      0.000171\n1      0.000171\n2      0.000171\n3      0.000171\n4      0.000171\n5      0.000171\n6      0.000171\n7      0.000171\n8      0.000171\n9      0.000171\n10     0.000171\n11     0.000171\n12     0.000171\n13     0.000171\n14     0.000171\n15     0.000171\n16     0.000171\n17     0.000171\n18     0.000171\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016003,
                    "execution_time": 0.006926,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.003021
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051347,
                    "execution_time": 0.007554,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.038072
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_14\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0      0.000171\n1      0.000171\n2      0.000171\n3      0.000171\n4      0.000171\n5      0.000171\n6      0.000171\n7      0.000171\n8      0.000171\n9      0.000171\n10     0.000171\n11     0.000171\n12     0.000171\n13     0.000171\n14     0.000171\n15     0.000171\n16     0.000171\n17     0.000171\n18     0.000171\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.077863,
                    "execution_time": 0.031278,
                    "compile_time": 0.000221,
                    "planning_time": 0.023103,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.25716,
                    "execution_time": 0.030879,
                    "compile_time": 0.114574,
                    "planning_time": 0.08535,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.700952,
                    "execution_time": 0.634272,
                    "compile_time": 0.000451,
                    "planning_time": 0.03475,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.783242,
                    "execution_time": 0.645878,
                    "compile_time": 0.001566,
                    "planning_time": 0.101358,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.130559,
                    "execution_time": 1.059165,
                    "compile_time": 0.000428,
                    "planning_time": 0.040351,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.333974,
                    "execution_time": 1.065182,
                    "compile_time": 0.12954,
                    "planning_time": 0.104217,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_17\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_18\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.070878,
                    "execution_time": 0.043629,
                    "compile_time": 0.000284,
                    "planning_time": 0.004364,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.129217,
                    "execution_time": 0.044691,
                    "compile_time": 0.000323,
                    "planning_time": 0.061632,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.011362*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015741,
                    "execution_time": 0.006863,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003101
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051866,
                    "execution_time": 0.007551,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038331
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_17\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_18\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.011362*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) pt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PT\" AS \"PT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080452,
                    "execution_time": 0.030347,
                    "compile_time": 0.000282,
                    "planning_time": 0.025579,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.35142,
                    "execution_time": 0.03168,
                    "compile_time": 0.203782,
                    "planning_time": 0.087826,
                    "create_size": 5
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.713401,
                    "execution_time": 0.650958,
                    "compile_time": 0.000541,
                    "planning_time": 0.030056,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.776616,
                    "execution_time": 0.649965,
                    "compile_time": 0.001607,
                    "planning_time": 0.09122,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.961896,
                    "execution_time": 0.899909,
                    "compile_time": 0.000451,
                    "planning_time": 0.030212,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.034475,
                    "execution_time": 0.909256,
                    "compile_time": 0.000509,
                    "planning_time": 0.090165,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_22\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071659,
                    "execution_time": 0.043911,
                    "compile_time": 0.000298,
                    "planning_time": 0.00435,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.130262,
                    "execution_time": 0.044171,
                    "compile_time": 0.000276,
                    "planning_time": 0.063024,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.532325*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017208,
                    "execution_time": 0.007393,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002958
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051681,
                    "execution_time": 0.007328,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038424
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_22\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.532325*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PT\" AS \"PT\" ORDER BY \"AM_PM_RATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"AM_PM_RATIO\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.532325*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016863,
                    "execution_time": 0.007783,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003246
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054519,
                    "execution_time": 0.00785,
                    "compile_time": 0.001781,
                    "planning_time": 0.038391
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_22\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"AM_PM_RATIO\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"AM_PM_RATIO\" NULLS LAST"
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.532325*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PT\" AS \"PT\" ORDER BY \"AM_PM_RATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"AM_PM_RATIO\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.532325*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016438,
                    "execution_time": 0.007636,
                    "compile_time": 9e-05,
                    "planning_time": 0.003234
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01648,
                    "execution_time": 0.007525,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.003285
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_22\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"AM_PM_RATIO\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"AM_PM_RATIO\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.532325*/"
    }
]