[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.597415,
                    "execution_time": 2.451407,
                    "compile_time": 0.000726,
                    "planning_time": 0.098378,
                    "create_size": 343
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 21.44359,
                    "execution_time": 10.242644,
                    "compile_time": 11.456656,
                    "planning_time": 0.095936,
                    "create_size": 343
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0           it is a girl      49  1250.11   49.94\n1              reason 50      50  1250.21   49.24\n2              reason 39      50  1224.28   51.26\n3              reason 49      50  1192.23   51.04\n4              reason 60      50  1216.11   51.32\n5            Lost my job      51  1247.05   49.19\n6    Package was damaged      50  1266.68   49.06\n7              reason 31      50  1280.51   50.08\n8   Did not get it on ti      49  1232.98   51.18\n9        Stopped working      51  1255.83   50.83\n10  Did not like the mod      49  1241.14   48.96\n11             reason 41      50  1184.38   50.55\n12             reason 55      50  1225.83   50.02\n13             reason 57      50  1140.17   49.56\n14             reason 32      50  1241.01   51.10\n15  Found a better exten      50  1211.15   50.22\n16             reason 37      49  1200.12   49.02\n17             reason 33      50  1235.40   49.70\n18             reason 28      50  1237.01   50.40\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017278,
                    "execution_time": 0.007274,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003682
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05662,
                    "execution_time": 0.00753,
                    "compile_time": 0.000955,
                    "planning_time": 0.039315
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0           it is a girl      49  1250.11   49.94\n1              reason 50      50  1250.21   49.24\n2              reason 39      50  1224.28   51.26\n3              reason 49      50  1192.23   51.04\n4              reason 60      50  1216.11   51.32\n5            Lost my job      51  1247.05   49.19\n6    Package was damaged      50  1266.68   49.06\n7              reason 31      50  1280.51   50.08\n8   Did not get it on ti      49  1232.98   51.18\n9        Stopped working      51  1255.83   50.83\n10  Did not like the mod      49  1241.14   48.96\n11             reason 41      50  1184.38   50.55\n12             reason 55      50  1225.83   50.02\n13             reason 57      50  1140.17   49.56\n14             reason 32      50  1241.01   51.10\n15  Found a better exten      50  1211.15   50.22\n16             reason 37      49  1200.12   49.02\n17             reason 33      50  1235.40   49.70\n18             reason 28      50  1237.01   50.40\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */ substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.666839,
                    "execution_time": 2.51538,
                    "compile_time": 0.000772,
                    "planning_time": 0.101815,
                    "create_size": 343
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.747356,
                    "execution_time": 4.39403,
                    "compile_time": 5.093653,
                    "planning_time": 0.200757,
                    "create_size": 343
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 41      20  383.23   52.16\n1              reason 57      17  305.59   45.41\n2              reason 39      27  478.71   41.14\n3              reason 28      20  655.29   45.07\n4              reason 60      27  462.00   47.00\n5    Package was damaged      28  436.07   48.77\n6              reason 31      36  709.84   45.64\n7            Lost my job      28  612.40   52.24\n8              reason 50      31  272.86   56.40\n9              reason 33      38  666.01   51.84\n10             reason 49      38  878.19   61.12\n11             reason 24      21  395.13   52.70\n12             reason 54      33  457.76   55.15\n13             reason 51      38  791.12   54.87\n14  Did not like the mod      25  698.92   62.27\n15  Did not get it on ti      29  695.07   54.76\n16       Stopped working      33  324.78   68.03\n17             reason 55      23  769.57   51.27\n18          it is a girl      21  337.87   51.63\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017392,
                    "execution_time": 0.007375,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003622
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052831,
                    "execution_time": 0.007445,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039067
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 41      20  383.23   52.16\n1              reason 57      17  305.59   45.41\n2              reason 39      27  478.71   41.14\n3              reason 28      20  655.29   45.07\n4              reason 60      27  462.00   47.00\n5    Package was damaged      28  436.07   48.77\n6              reason 31      36  709.84   45.64\n7            Lost my job      28  612.40   52.24\n8              reason 50      31  272.86   56.40\n9              reason 33      38  666.01   51.84\n10             reason 49      38  878.19   61.12\n11             reason 24      21  395.13   52.70\n12             reason 54      33  457.76   55.15\n13             reason 51      38  791.12   54.87\n14  Did not like the mod      25  698.92   62.27\n15  Did not get it on ti      29  695.07   54.76\n16       Stopped working      33  324.78   68.03\n17             reason 55      23  769.57   51.27\n18          it is a girl      21  337.87   51.63\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 52      23  361.15   57.47\n1              reason 27      25  530.07   59.12\n2   Found a better price      20  347.10   52.63\n3              reason 42      16  260.91   48.25\n4              reason 48      34  547.23   52.25\n5              reason 35      21  681.42   45.50\n6              reason 58      27  464.79   53.54\n7              reason 46      26  784.25   39.51\n8              reason 25      28  685.60   49.29\n9          Parts missing      23  453.61   46.41\n10  unauthoized purchase      27  648.70   49.90\n11             reason 38      17  424.82   53.87\n12    duplicate purchase      24  264.99   42.58\n13             reason 56      24  664.70   55.02\n14  Does not work with a      36  864.71   41.98\n15             reason 44      33  810.27   60.54\n16  Not working any more      25  622.00   53.35\n17  No service location       20  691.59   61.60\n18             reason 34      29  569.96   56.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016928,
                    "execution_time": 0.007122,
                    "compile_time": 5e-05,
                    "planning_time": 0.003551
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0523,
                    "execution_time": 0.007222,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.038766
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 52      23  361.15   57.47\n1              reason 27      25  530.07   59.12\n2   Found a better price      20  347.10   52.63\n3              reason 42      16  260.91   48.25\n4              reason 48      34  547.23   52.25\n5              reason 35      21  681.42   45.50\n6              reason 58      27  464.79   53.54\n7              reason 46      26  784.25   39.51\n8              reason 25      28  685.60   49.29\n9          Parts missing      23  453.61   46.41\n10  unauthoized purchase      27  648.70   49.90\n11             reason 38      17  424.82   53.87\n12    duplicate purchase      24  264.99   42.58\n13             reason 56      24  664.70   55.02\n14  Does not work with a      36  864.71   41.98\n15             reason 44      33  810.27   60.54\n16  Not working any more      25  622.00   53.35\n17  No service location       20  691.59   61.60\n18             reason 34      29  569.96   56.66\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.614948,
                    "execution_time": 2.463339,
                    "compile_time": 0.000765,
                    "planning_time": 0.101849,
                    "create_size": 343
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.661772,
                    "execution_time": 2.464867,
                    "compile_time": 4.940626,
                    "planning_time": 0.20173,
                    "create_size": 343
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0   Did not like the mod      84  610.86   53.50\n1        Stopped working      76  564.61   54.29\n2           it is a girl      88  605.83   55.99\n3   Found a better exten      81  632.42   49.54\n4              reason 32      69  270.80   55.55\n5              reason 33      68  434.46   57.21\n6   Did not like the war      77  669.13   57.81\n7            Did not fit      77  496.59   50.44\n8              reason 59      71  466.72   55.29\n9            Lost my job      70  531.02   59.01\n10             reason 31      71  878.29   51.39\n11   Package was damaged      72  380.22   48.52\n12             reason 55      69  884.97   52.54\n13  Did not get it on ti      79  953.08   51.74\n14             reason 41      71  481.01   59.66\n15             reason 57      69  338.50   64.06\n16             reason 39      78  721.70   34.29\n17             reason 28      62  399.26   55.65\n18             reason 49      74  972.94   49.26\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017179,
                    "execution_time": 0.007182,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003687
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053028,
                    "execution_time": 0.007354,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039112
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0   Did not like the mod      84  610.86   53.50\n1        Stopped working      76  564.61   54.29\n2           it is a girl      88  605.83   55.99\n3   Found a better exten      81  632.42   49.54\n4              reason 32      69  270.80   55.55\n5              reason 33      68  434.46   57.21\n6   Did not like the war      77  669.13   57.81\n7            Did not fit      77  496.59   50.44\n8              reason 59      71  466.72   55.29\n9            Lost my job      70  531.02   59.01\n10             reason 31      71  878.29   51.39\n11   Package was damaged      72  380.22   48.52\n12             reason 55      69  884.97   52.54\n13  Did not get it on ti      79  953.08   51.74\n14             reason 41      71  481.01   59.66\n15             reason 57      69  338.50   64.06\n16             reason 39      78  721.70   34.29\n17             reason 28      62  399.26   55.65\n18             reason 49      74  972.94   49.26\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0   Not working any more      25  622.00   53.35\n1          Parts missing      23  453.61   46.41\n2              reason 38      17  424.82   53.87\n3           its is a boy      24  360.29   46.93\n4   Not the product that      24  541.20   46.35\n5              reason 44      33  810.27   60.54\n6              reason 26      43  977.38   55.16\n7              reason 47      18  298.55   40.50\n8              reason 62      24  444.78   49.91\n9   No service location       20  691.59   61.60\n10             reason 34      29  569.96   56.66\n11             reason 61      20  403.28   35.20\n12             reason 23      35  438.33   49.22\n13             reason 53      25  628.42   53.66\n14  Did not like the mak      19  264.46   53.85\n15             reason 40      22  415.24   44.12\n16             reason 52      23  361.15   57.47\n17             reason 65      18  453.39   47.22\n18         Gift exchange      35  714.81   58.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016867,
                    "execution_time": 0.007236,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003595
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018371,
                    "execution_time": 0.007943,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.003765
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0   Not working any more      25  622.00   53.35\n1          Parts missing      23  453.61   46.41\n2              reason 38      17  424.82   53.87\n3           its is a boy      24  360.29   46.93\n4   Not the product that      24  541.20   46.35\n5              reason 44      33  810.27   60.54\n6              reason 26      43  977.38   55.16\n7              reason 47      18  298.55   40.50\n8              reason 62      24  444.78   49.91\n9   No service location       20  691.59   61.60\n10             reason 34      29  569.96   56.66\n11             reason 61      20  403.28   35.20\n12             reason 23      35  438.33   49.22\n13             reason 53      25  628.42   53.66\n14  Did not like the mak      19  264.46   53.85\n15             reason 40      22  415.24   44.12\n16             reason 52      23  361.15   57.47\n17             reason 65      18  453.39   47.22\n18         Gift exchange      35  714.81   58.91\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 37      34  668.39   50.73\n1              reason 28      20  655.29   45.07\n2              reason 64      22  569.63   49.87\n3              reason 29      28  742.41   56.34\n4    Package was damaged      28  436.07   48.77\n5              reason 31      36  709.84   45.64\n6            Lost my job      28  612.40   52.24\n7              reason 55      23  769.57   51.27\n8   Did not like the mod      25  698.92   62.27\n9              reason 32      21  299.29   57.25\n10  Found a better exten      29  514.60   47.08\n11             reason 50      31  272.86   56.40\n12             reason 39      27  478.71   41.14\n13  Did not like the war      30  629.36   47.85\n14           Did not fit      27  407.32   52.13\n15             reason 59      32  450.40   44.00\n16             reason 51      38  791.12   54.87\n17  Did not get it on ti      29  695.07   54.76\n18       Stopped working      33  324.78   68.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017059,
                    "execution_time": 0.007257,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003517
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017533,
                    "execution_time": 0.007703,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003463
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 37      34  668.39   50.73\n1              reason 28      20  655.29   45.07\n2              reason 64      22  569.63   49.87\n3              reason 29      28  742.41   56.34\n4    Package was damaged      28  436.07   48.77\n5              reason 31      36  709.84   45.64\n6            Lost my job      28  612.40   52.24\n7              reason 55      23  769.57   51.27\n8   Did not like the mod      25  698.92   62.27\n9              reason 32      21  299.29   57.25\n10  Found a better exten      29  514.60   47.08\n11             reason 50      31  272.86   56.40\n12             reason 39      27  478.71   41.14\n13  Did not like the war      30  629.36   47.85\n14           Did not fit      27  407.32   52.13\n15             reason 59      32  450.40   44.00\n16             reason 51      38  791.12   54.87\n17  Did not get it on ti      29  695.07   54.76\n18       Stopped working      33  324.78   68.03\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'CA', 'FL')\n     and ws_net_profit between 200 and 400  \n    )\n   )\n/*CURSOR_IDENTIFIER*/\ngroup by substring(r_reason_desc,1,20)",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NY' , 'CA' , 'FL' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NY' , 'CA' , 'FL' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.69051,
                    "execution_time": 2.536181,
                    "compile_time": 0.000786,
                    "planning_time": 0.104386,
                    "create_size": 343
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.813659,
                    "execution_time": 2.520524,
                    "compile_time": 5.03561,
                    "planning_time": 0.203082,
                    "create_size": 343
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0        Stopped working      31  371.54   63.21\n1           it is a girl      25  512.58   49.32\n2              reason 39      30  541.54   44.98\n3              reason 28      27  651.75   46.12\n4              reason 49      36  816.59   58.29\n5              reason 24      22  402.82   51.48\n6              reason 54      38  674.08   46.65\n7              reason 50      31  355.25   59.00\n8              reason 37      33  594.36   48.02\n9   Did not like the war      31  651.45   47.62\n10             reason 64      22  628.56   53.41\n11             reason 29      28  707.79   54.55\n12             reason 31      37  640.68   46.47\n13   Package was damaged      25  391.10   45.85\n14           Lost my job      27  610.52   52.37\n15  Did not like the mod      25  698.88   53.98\n16  Did not get it on ti      28  663.25   52.18\n17             reason 55      21  639.65   52.88\n18             reason 41      24  373.10   50.44\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017302,
                    "execution_time": 0.007301,
                    "compile_time": 5e-05,
                    "planning_time": 0.003772
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053537,
                    "execution_time": 0.007544,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039532
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('NY', 'CA', 'FL') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0        Stopped working      31  371.54   63.21\n1           it is a girl      25  512.58   49.32\n2              reason 39      30  541.54   44.98\n3              reason 28      27  651.75   46.12\n4              reason 49      36  816.59   58.29\n5              reason 24      22  402.82   51.48\n6              reason 54      38  674.08   46.65\n7              reason 50      31  355.25   59.00\n8              reason 37      33  594.36   48.02\n9   Did not like the war      31  651.45   47.62\n10             reason 64      22  628.56   53.41\n11             reason 29      28  707.79   54.55\n12             reason 31      37  640.68   46.47\n13   Package was damaged      25  391.10   45.85\n14           Lost my job      27  610.52   52.37\n15  Did not like the mod      25  698.88   53.98\n16  Did not get it on ti      28  663.25   52.18\n17             reason 55      21  639.65   52.88\n18             reason 41      24  373.10   50.44\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity) as avg_quantity\n       ,avg(wr_refunded_cash) as avg_refunded_cash\n       ,avg(wr_fee) as avg_fee\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n   )\n   )\nGROUP BY substring(r_reason_desc,1,20) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"AVG_QUANTITY\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"AVG_REFUNDED_CASH\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"AVG_QUANTITY\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"AVG_REFUNDED_CASH\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.684092,
                    "execution_time": 2.527554,
                    "compile_time": 0.000769,
                    "planning_time": 0.10606,
                    "create_size": 343
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.85478,
                    "execution_time": 2.535271,
                    "compile_time": 5.060552,
                    "planning_time": 0.206172,
                    "create_size": 343
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUANTITY\" AS \"AVG_QUANTITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_REFUNDED_CASH\" AS \"AVG_REFUNDED_CASH\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_FEE\" AS \"AVG_FEE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0  avg_quantity  avg_refunded_cash  avg_fee\n0   Did not get it on ti            47            1144.08    50.06\n1           it is a girl            46            1175.98    54.99\n2              reason 50            52            1382.82    49.89\n3              reason 37            52            1172.08    47.23\n4              reason 28            48            1353.85    50.22\n5            Did not fit            43            1045.98    49.02\n6              reason 59            43             966.93    49.32\n7              reason 31            48            1210.78    48.08\n8            Lost my job            51            1136.77    46.22\n9    Package was damaged            45            1043.98    51.61\n10  Did not like the mod            46            1149.99    49.16\n11             reason 55            49            1137.80    53.54\n12       Stopped working            50            1325.64    47.88\n13             reason 41            49             994.79    54.72\n14             reason 32            47            1113.43    50.56\n15  Found a better exten            44            1018.83    51.19\n16             reason 33            48            1096.55    47.09\n17             reason 60            45            1171.10    49.69\n18             reason 64            44             994.66    50.14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01732,
                    "execution_time": 0.007205,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003705
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.06539,
                    "execution_time": 0.007722,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.039423
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"AVG_QUANTITY\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"AVG_REFUNDED_CASH\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM')) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUANTITY\" AS \"AVG_QUANTITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_REFUNDED_CASH\" AS \"AVG_REFUNDED_CASH\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_FEE\" AS \"AVG_FEE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0  avg_quantity  avg_refunded_cash  avg_fee\n0   Did not get it on ti            47            1144.08    50.06\n1           it is a girl            46            1175.98    54.99\n2              reason 50            52            1382.82    49.89\n3              reason 37            52            1172.08    47.23\n4              reason 28            48            1353.85    50.22\n5            Did not fit            43            1045.98    49.02\n6              reason 59            43             966.93    49.32\n7              reason 31            48            1210.78    48.08\n8            Lost my job            51            1136.77    46.22\n9    Package was damaged            45            1043.98    51.61\n10  Did not like the mod            46            1149.99    49.16\n11             reason 55            49            1137.80    53.54\n12       Stopped working            50            1325.64    47.88\n13             reason 41            49             994.79    54.72\n14             reason 32            47            1113.43    50.56\n15  Found a better exten            44            1018.83    51.19\n16             reason 33            48            1096.55    47.09\n17             reason 60            45            1171.10    49.69\n18             reason 64            44             994.66    50.14\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n   )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.676591,
                    "execution_time": 2.520639,
                    "compile_time": 0.000806,
                    "planning_time": 0.105052,
                    "create_size": 343
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.651113,
                    "execution_time": 2.539759,
                    "compile_time": 4.857399,
                    "planning_time": 0.200677,
                    "create_size": 343
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"REASON_DESC\" AS \"REASON_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1  _col_2  _col_3\n0              reason 44      30  683.21   54.60\n1              reason 26      38  918.33   54.57\n2              reason 62      23  563.34   50.17\n3              reason 47      19  318.24   40.12\n4              reason 61      22  359.48   39.16\n5              reason 38      22  441.94   54.74\n6     duplicate purchase      25  265.40   42.93\n7              reason 56      26  565.97   51.07\n8   Does not work with a      35  734.45   43.10\n9   Not working any more      29  647.97   50.50\n10             reason 34      30  732.57   55.44\n11  No service location       19  728.41   55.82\n12             reason 45      27  351.74   39.99\n13             reason 23      34  612.40   51.34\n14             reason 53      25  606.13   50.90\n15  Did not like the mak      21  346.27   53.19\n16             reason 40      24  419.29   47.69\n17             reason 63      22  545.53   51.21\n18             reason 27      26  466.22   56.92\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017222,
                    "execution_time": 0.007207,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003695
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053428,
                    "execution_time": 0.007779,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039199
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"REASON_DESC\" AS \"REASON_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1  _col_2  _col_3\n0              reason 44      30  683.21   54.60\n1              reason 26      38  918.33   54.57\n2              reason 62      23  563.34   50.17\n3              reason 47      19  318.24   40.12\n4              reason 61      22  359.48   39.16\n5              reason 38      22  441.94   54.74\n6     duplicate purchase      25  265.40   42.93\n7              reason 56      26  565.97   51.07\n8   Does not work with a      35  734.45   43.10\n9   Not working any more      29  647.97   50.50\n10             reason 34      30  732.57   55.44\n11  No service location       19  728.41   55.82\n12             reason 45      27  351.74   39.99\n13             reason 23      34  612.40   51.34\n14             reason 53      25  606.13   50.90\n15  Did not like the mak      21  346.27   53.19\n16             reason 40      24  419.29   47.69\n17             reason 63      22  545.53   51.21\n18             reason 27      26  466.22   56.92\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1  _col_2  _col_3\n0        Stopped working      29  513.29   59.84\n1              reason 57      21  304.04   44.49\n2              reason 50      29  381.05   59.16\n3              reason 39      27  574.79   43.60\n4              reason 28      18  529.23   43.53\n5            Did not fit      23  354.33   49.00\n6              reason 59      27  356.69   47.36\n7              reason 31      31  623.57   43.18\n8            Lost my job      30  616.80   51.12\n9    Package was damaged      29  428.02   51.19\n10             reason 55      26  732.45   55.46\n11  Did not get it on ti      27  779.53   51.20\n12  Did not like the mod      25  643.99   56.30\n13             reason 41      26  435.24   52.12\n14          it is a girl      26  602.74   49.81\n15             reason 37      34  648.04   53.44\n16             reason 33      27  497.97   44.54\n17             reason 60      25  494.14   48.00\n18             reason 64      27  743.74   52.47\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017757,
                    "execution_time": 0.00743,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003808
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052623,
                    "execution_time": 0.00744,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038932
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1  _col_2  _col_3\n0        Stopped working      29  513.29   59.84\n1              reason 57      21  304.04   44.49\n2              reason 50      29  381.05   59.16\n3              reason 39      27  574.79   43.60\n4              reason 28      18  529.23   43.53\n5            Did not fit      23  354.33   49.00\n6              reason 59      27  356.69   47.36\n7              reason 31      31  623.57   43.18\n8            Lost my job      30  616.80   51.12\n9    Package was damaged      29  428.02   51.19\n10             reason 55      26  732.45   55.46\n11  Did not get it on ti      27  779.53   51.20\n12  Did not like the mod      25  643.99   56.30\n13             reason 41      26  435.24   52.12\n14          it is a girl      26  602.74   49.81\n15             reason 37      34  648.04   53.44\n16             reason 33      27  497.97   44.54\n17             reason 60      25  494.14   48.00\n18             reason 64      27  743.74   52.47\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1  _col_2  _col_3\n0              reason 42      14  223.68   49.16\n1              reason 48      36  586.49   48.10\n2              reason 25      26  575.09   48.12\n3              reason 46      25  707.60   41.46\n4              reason 45      27  351.74   39.99\n5              reason 23      34  612.40   51.34\n6              reason 53      25  606.13   50.90\n7             Wrong size      24  422.56   52.05\n8   Not the product that      22  438.67   46.14\n9              reason 27      26  466.22   56.92\n10  Found a better price      19  346.98   49.45\n11  Does not work with a      35  734.45   43.10\n12             reason 44      30  683.21   54.60\n13             reason 26      38  918.33   54.57\n14             reason 34      30  732.57   55.44\n15  No service location       19  728.41   55.82\n16         Parts missing      22  456.44   49.91\n17  unauthoized purchase      24  491.27   48.34\n18          its is a boy      21  347.04   48.16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018373,
                    "execution_time": 0.007501,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.003637
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017418,
                    "execution_time": 0.007345,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003673
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1  _col_2  _col_3\n0              reason 42      14  223.68   49.16\n1              reason 48      36  586.49   48.10\n2              reason 25      26  575.09   48.12\n3              reason 46      25  707.60   41.46\n4              reason 45      27  351.74   39.99\n5              reason 23      34  612.40   51.34\n6              reason 53      25  606.13   50.90\n7             Wrong size      24  422.56   52.05\n8   Not the product that      22  438.67   46.14\n9              reason 27      26  466.22   56.92\n10  Found a better price      19  346.98   49.45\n11  Does not work with a      35  734.45   43.10\n12             reason 44      30  683.21   54.60\n13             reason 26      38  918.33   54.57\n14             reason 34      30  732.57   55.44\n15  No service location       19  728.41   55.82\n16         Parts missing      22  456.44   49.91\n17  unauthoized purchase      24  491.27   48.34\n18          its is a boy      21  347.04   48.16\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.678913,
                    "execution_time": 2.52082,
                    "compile_time": 0.00079,
                    "planning_time": 0.106464,
                    "create_size": 56
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.805681,
                    "execution_time": 2.516036,
                    "compile_time": 5.035975,
                    "planning_time": 0.201756,
                    "create_size": 56
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 46      25  707.60   41.46\n1              reason 27      26  466.22   56.92\n2   unauthoized purchase      24  491.27   48.34\n3           its is a boy      21  347.04   48.16\n4              reason 25      26  575.09   48.12\n5              reason 42      14  223.68   49.16\n6   Did not like the war      26  483.62   52.45\n7          Parts missing      22  456.44   49.91\n8              reason 48      36  586.49   48.10\n9              reason 52      22  474.57   53.96\n10             reason 26      38  918.33   54.57\n11             reason 62      23  563.34   50.17\n12  Not working any more      29  647.97   50.50\n13             reason 40      24  419.29   47.69\n14             reason 61      22  359.48   39.16\n15             reason 47      19  318.24   40.12\n16             reason 38      22  441.94   54.74\n17             reason 63      22  545.53   51.21\n18  Did not like the mod      25  643.99   56.30\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017102,
                    "execution_time": 0.00708,
                    "compile_time": 5e-05,
                    "planning_time": 0.003691
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055894,
                    "execution_time": 0.007761,
                    "compile_time": 5e-05,
                    "planning_time": 0.039117
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0              reason 46      25  707.60   41.46\n1              reason 27      26  466.22   56.92\n2   unauthoized purchase      24  491.27   48.34\n3           its is a boy      21  347.04   48.16\n4              reason 25      26  575.09   48.12\n5              reason 42      14  223.68   49.16\n6   Did not like the war      26  483.62   52.45\n7          Parts missing      22  456.44   49.91\n8              reason 48      36  586.49   48.10\n9              reason 52      22  474.57   53.96\n10             reason 26      38  918.33   54.57\n11             reason 62      23  563.34   50.17\n12  Not working any more      29  647.97   50.50\n13             reason 40      24  419.29   47.69\n14             reason 61      22  359.48   39.16\n15             reason 47      19  318.24   40.12\n16             reason 38      22  441.94   54.74\n17             reason 63      22  545.53   51.21\n18  Did not like the mod      25  643.99   56.30\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018056,
                    "execution_time": 0.007838,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.003822
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.201422,
                    "execution_time": 0.008367,
                    "compile_time": 0.145911,
                    "planning_time": 0.038989
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019354,
                    "execution_time": 0.008785,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.003947
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055369,
                    "execution_time": 0.008705,
                    "compile_time": 0.001223,
                    "planning_time": 0.039102
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01809,
                    "execution_time": 0.007993,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003918
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.468062,
                    "execution_time": 0.009384,
                    "compile_time": 0.419344,
                    "planning_time": 0.039218
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" , \"_COL_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018155,
                    "execution_time": 0.008073,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.195079,
                    "execution_time": 0.008053,
                    "compile_time": 0.141553,
                    "planning_time": 0.039149
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST, \"_COL_3\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" , \"_COL_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019192,
                    "execution_time": 0.008821,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004074
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018831,
                    "execution_time": 0.008289,
                    "compile_time": 7e-05,
                    "planning_time": 0.004113
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST, \"_COL_3\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1  _col_2  _col_3\n0            Did not fit      23  354.33   49.00\n1   Did not get it on ti      27  779.53   51.20\n2   Did not like the col      19  474.31   54.05\n3   Did not like the mak      21  346.27   53.19\n4   Did not like the mod      25  643.99   56.30\n5   Did not like the war      26  483.62   52.45\n6   Does not work with a      35  734.45   43.10\n7   Found a better exten      27  552.58   47.80\n8   Found a better price      19  346.98   49.45\n9          Gift exchange      33  687.40   58.08\n10           Lost my job      30  616.80   51.12\n11  No service location       19  728.41   55.82\n12  Not the product that      22  438.67   46.14\n13  Not working any more      29  647.97   50.50\n14   Package was damaged      29  428.02   51.19\n15         Parts missing      22  456.44   49.91\n16       Stopped working      29  513.29   59.84\n17            Wrong size      24  422.56   52.05\n18    duplicate purchase      25  265.40   42.93\n...*/"
    }
]