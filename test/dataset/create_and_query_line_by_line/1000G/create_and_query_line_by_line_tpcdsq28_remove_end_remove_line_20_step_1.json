[
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20) B4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.688471,
                    "execution_time": 9.61711,
                    "compile_time": 0.000401,
                    "planning_time": 0.038984,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 26.147409,
                    "execution_time": 26.005369,
                    "compile_time": 0.006096,
                    "planning_time": 0.092641,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.640298,
                    "execution_time": 4.571939,
                    "compile_time": 0.000391,
                    "planning_time": 0.036624,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.301151,
                    "execution_time": 7.167604,
                    "compile_time": 0.00153,
                    "planning_time": 0.099455,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.640008,
                    "execution_time": 4.579158,
                    "compile_time": 0.000411,
                    "planning_time": 0.028499,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.747124,
                    "execution_time": 4.622912,
                    "compile_time": 0.001523,
                    "planning_time": 0.089392,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.591342,
                    "execution_time": 1.535826,
                    "compile_time": 0.000385,
                    "planning_time": 0.025127,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.710599,
                    "execution_time": 1.591846,
                    "compile_time": 0.001526,
                    "planning_time": 0.085823,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.097549,
                    "execution_time": 0.060771,
                    "compile_time": 0.000387,
                    "planning_time": 0.008003,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.163074,
                    "execution_time": 0.062551,
                    "compile_time": 0.006044,
                    "planning_time": 0.064067,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd  b4_lp     b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  75.74  134297343    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018841,
                    "execution_time": 0.007265,
                    "compile_time": 5e-05,
                    "planning_time": 0.004709
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056246,
                    "execution_time": 0.007566,
                    "compile_time": 0.001017,
                    "planning_time": 0.040037
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd  b4_lp     b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  75.74  134297343    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"_Q_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"_Q_0\".\"B4_LP\" AS \"B4_LP\" , \"_Q_0\".\"B4_CNT\" AS \"B4_CNT\" , \"_Q_0\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"_Q_0\" AS \"_Q_0\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.750519,
                    "execution_time": 1.694151,
                    "compile_time": 0.00038,
                    "planning_time": 0.026105,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.818316,
                    "execution_time": 1.695438,
                    "compile_time": 0.001614,
                    "planning_time": 0.088736,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.064224,
                    "execution_time": 0.036419,
                    "compile_time": 0.000252,
                    "planning_time": 0.00305,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.128863,
                    "execution_time": 0.036144,
                    "compile_time": 0.001154,
                    "planning_time": 0.063786,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.064964,
                    "execution_time": 0.036307,
                    "compile_time": 0.00025,
                    "planning_time": 0.003268,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.119839,
                    "execution_time": 0.035544,
                    "compile_time": 0.000237,
                    "planning_time": 0.05916,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095261,
                    "execution_time": 0.060123,
                    "compile_time": 0.000371,
                    "planning_time": 0.007748,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155154,
                    "execution_time": 0.062215,
                    "compile_time": 0.001505,
                    "planning_time": 0.064259,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  108.87  167910181     1001*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018648,
                    "execution_time": 0.007269,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004698
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055376,
                    "execution_time": 0.007872,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040608
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  108.87  167910181     1001*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10)\n          or ss_coupon_amt between 2440 and 2440+1000\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"_Q_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_QUANTITY\" <= 20 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_QUANTITY\" <= 20 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"_Q_0\".\"B4_LP\" AS \"B4_LP\" , \"_Q_0\".\"B4_CNT\" AS \"B4_CNT\" , \"_Q_0\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"_Q_0\" AS \"_Q_0\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.383461,
                    "execution_time": 8.324218,
                    "compile_time": 0.000405,
                    "planning_time": 0.028173,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.48469,
                    "execution_time": 8.362231,
                    "compile_time": 0.001534,
                    "planning_time": 0.089008,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096116,
                    "execution_time": 0.0605,
                    "compile_time": 0.00039,
                    "planning_time": 0.007865,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155199,
                    "execution_time": 0.062003,
                    "compile_time": 0.000379,
                    "planning_time": 0.065514,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd  b4_lp      b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  75.22  2658572751    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02004,
                    "execution_time": 0.008255,
                    "compile_time": 5e-05,
                    "planning_time": 0.004844
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055453,
                    "execution_time": 0.007903,
                    "compile_time": 5e-05,
                    "planning_time": 0.040581
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd  b4_lp      b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  75.22  2658572751    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.195067,
                    "execution_time": 5.114817,
                    "compile_time": 0.000443,
                    "planning_time": 0.048256,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.082765,
                    "execution_time": 4.957694,
                    "compile_time": 0.001483,
                    "planning_time": 0.091071,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.098136,
                    "execution_time": 0.061007,
                    "compile_time": 0.000433,
                    "planning_time": 0.007967,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155232,
                    "execution_time": 0.061882,
                    "compile_time": 0.000411,
                    "planning_time": 0.064537,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02091,
                    "execution_time": 0.008089,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005724
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055306,
                    "execution_time": 0.007564,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040646
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            /*CURSOR_IDENTIFIER*/\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 120 and 120+10\n          or ss_coupon_amt between 3000 and 3000+1000\n          or ss_wholesale_cost between 75 and 75+20)) B5\n",
        "optimize": [
            "SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.347422,
                    "execution_time": 5.291357,
                    "compile_time": 0.0003,
                    "planning_time": 0.029083,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.371788,
                    "execution_time": 5.245211,
                    "compile_time": 0.001477,
                    "planning_time": 0.096847,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"B5_LP\" AS \"B5_LP\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    b5_lp\n0  127.21*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015212,
                    "execution_time": 0.006901,
                    "compile_time": 4e-05,
                    "planning_time": 0.002821
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05137,
                    "execution_time": 0.007549,
                    "compile_time": 4e-05,
                    "planning_time": 0.037992
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE (\"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"B5_LP\" AS \"B5_LP\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    b5_lp\n0  127.21*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25) B5  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.06331,
                    "execution_time": 0.035991,
                    "compile_time": 0.000237,
                    "planning_time": 0.003166,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.124198,
                    "execution_time": 0.037493,
                    "compile_time": 0.000237,
                    "planning_time": 0.062053,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.596089,
                    "execution_time": 1.538429,
                    "compile_time": 0.000402,
                    "planning_time": 0.02695,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.841916,
                    "execution_time": 1.723732,
                    "compile_time": 0.000435,
                    "planning_time": 0.086618,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.108046,
                    "execution_time": 0.069919,
                    "compile_time": 0.000433,
                    "planning_time": 0.009586,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.171696,
                    "execution_time": 0.069786,
                    "compile_time": 0.003616,
                    "planning_time": 0.066813,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  75.74  134267388    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020318,
                    "execution_time": 0.007973,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005321
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057663,
                    "execution_time": 0.007506,
                    "compile_time": 0.001001,
                    "planning_time": 0.041229
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  75.74  134267388    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 90 and 90+10\n          or ss_coupon_amt between 5000 and 5000+1000\n          or ss_wholesale_cost between 12 and 12+20)) B5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 100 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 90 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 32 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 12 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 100 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 90 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 32 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 12 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.857734,
                    "execution_time": 4.798752,
                    "compile_time": 0.0004,
                    "planning_time": 0.028096,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.101666,
                    "execution_time": 3.977664,
                    "compile_time": 0.0004,
                    "planning_time": 0.091174,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106757,
                    "execution_time": 0.068039,
                    "compile_time": 0.000427,
                    "planning_time": 0.009538,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.174195,
                    "execution_time": 0.068733,
                    "compile_time": 0.000426,
                    "planning_time": 0.075182,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  49.11  181121890     6121*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019348,
                    "execution_time": 0.007269,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005208
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0561,
                    "execution_time": 0.00794,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.04101
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  49.11  181121890     6121*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n) B5 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.111129,
                    "execution_time": 6.054416,
                    "compile_time": 0.000391,
                    "planning_time": 0.026666,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.214702,
                    "execution_time": 6.086523,
                    "compile_time": 0.001362,
                    "planning_time": 0.095996,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.107464,
                    "execution_time": 0.069585,
                    "compile_time": 0.000422,
                    "planning_time": 0.00955,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.169329,
                    "execution_time": 0.069488,
                    "compile_time": 0.00043,
                    "planning_time": 0.069708,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp      b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  75.74  2750390979    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020435,
                    "execution_time": 0.007987,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005496
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.066779,
                    "execution_time": 0.007575,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.040996
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp      b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  75.74  2750390979    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n) B5/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 10295 and 10295+1000\n          or ss_wholesale_cost between 85 and 85+20)\n/*CURSOR_IDENTIFIER*/\n      ) B5",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 11295 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 10295 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 105 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 85 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 11295 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 10295 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 105 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 85 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.63647,
                    "execution_time": 7.57181,
                    "compile_time": 0.000389,
                    "planning_time": 0.032576,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.237378,
                    "execution_time": 6.899323,
                    "compile_time": 0.214116,
                    "planning_time": 0.091568,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106573,
                    "execution_time": 0.068003,
                    "compile_time": 0.000437,
                    "planning_time": 0.009185,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.163811,
                    "execution_time": 0.068852,
                    "compile_time": 0.000407,
                    "planning_time": 0.066,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd   b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  139.66  105776170    11336*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019834,
                    "execution_time": 0.007851,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005096
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055448,
                    "execution_time": 0.007571,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040851
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd   b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  139.66  105776170    11336*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000)) B5 -- Added missing closing parenthesis\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.774358,
                    "execution_time": 2.716647,
                    "compile_time": 0.00042,
                    "planning_time": 0.026481,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.92727,
                    "execution_time": 3.664366,
                    "compile_time": 0.13954,
                    "planning_time": 0.090913,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106309,
                    "execution_time": 0.068044,
                    "compile_time": 0.000424,
                    "planning_time": 0.009272,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.164779,
                    "execution_time": 0.068757,
                    "compile_time": 0.000415,
                    "planning_time": 0.066836,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd   b5_lp    b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  153.91  18565650    13946*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019333,
                    "execution_time": 0.007476,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004936
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055458,
                    "execution_time": 0.007693,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.0406
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd   b5_lp    b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  153.91  18565650    13946*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.389718,
                    "execution_time": 4.327461,
                    "compile_time": 0.000398,
                    "planning_time": 0.031195,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.40032,
                    "execution_time": 4.277574,
                    "compile_time": 0.001484,
                    "planning_time": 0.089248,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.107396,
                    "execution_time": 0.069331,
                    "compile_time": 0.000423,
                    "planning_time": 0.009415,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.171368,
                    "execution_time": 0.068991,
                    "compile_time": 0.000428,
                    "planning_time": 0.073046,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019558,
                    "execution_time": 0.007367,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005251
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056003,
                    "execution_time": 0.007921,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040865
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 200 and 200+10\n          or ss_coupon_amt between 1500 and 1500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_28\" AS SELECT \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063124,
                    "execution_time": 0.036257,
                    "compile_time": 0.000231,
                    "planning_time": 0.003068,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.121369,
                    "execution_time": 0.037964,
                    "compile_time": 0.000233,
                    "planning_time": 0.058962,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_29\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.027202,
                    "execution_time": 3.967452,
                    "compile_time": 0.000406,
                    "planning_time": 0.028198,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.992249,
                    "execution_time": 3.86866,
                    "compile_time": 0.000411,
                    "planning_time": 0.090464,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_30\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.118466,
                    "execution_time": 0.07643,
                    "compile_time": 0.000463,
                    "planning_time": 0.011371,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.182483,
                    "execution_time": 0.07655,
                    "compile_time": 0.004178,
                    "planning_time": 0.069025,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  32.31  164718148    18834*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020681,
                    "execution_time": 0.007738,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005636
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058071,
                    "execution_time": 0.007493,
                    "compile_time": 0.001177,
                    "planning_time": 0.041249
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  32.31  164718148    18834*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 80 and 80+10\n          or ss_coupon_amt between 1000 and 1000+1000\n          or ss_wholesale_cost between 5 and 5+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 90 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 80 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 25 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 5 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_31\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 90 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 80 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 25 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 5 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.634541,
                    "execution_time": 4.574894,
                    "compile_time": 0.0004,
                    "planning_time": 0.028514,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.880163,
                    "execution_time": 4.578073,
                    "compile_time": 0.171747,
                    "planning_time": 0.097377,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_32\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.12047,
                    "execution_time": 0.077371,
                    "compile_time": 0.000484,
                    "planning_time": 0.011366,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.178305,
                    "execution_time": 0.077114,
                    "compile_time": 0.000486,
                    "planning_time": 0.069152,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_32\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  41.85  225886343    19336*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02023,
                    "execution_time": 0.007273,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005758
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056581,
                    "execution_time": 0.007943,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.041284
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_32\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  41.85  225886343    19336*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 10 and 10+10\n          or ss_coupon_amt between 2500 and 2500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 20 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 10 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_33\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 20 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 10 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.371984,
                    "execution_time": 4.311584,
                    "compile_time": 0.000404,
                    "planning_time": 0.029278,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.566833,
                    "execution_time": 4.316027,
                    "compile_time": 0.123273,
                    "planning_time": 0.094644,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_34\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117074,
                    "execution_time": 0.075291,
                    "compile_time": 0.000458,
                    "planning_time": 0.011234,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.178637,
                    "execution_time": 0.077982,
                    "compile_time": 0.00048,
                    "planning_time": 0.069144,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  28.15  186795281    15718*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02044,
                    "execution_time": 0.007691,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005577
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056774,
                    "execution_time": 0.008005,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.041484
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  28.15  186795281    15718*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n/*CURSOR_IDENTIFIER*/\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 200 and 200+10\n          or ss_coupon_amt between 1500 and 1500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6",
        "optimize": [
            "SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_29\" LIMIT 21",
                "preview": "\n/*   b6_lp     b6_cnt  b6_cntd\n0  32.31  164718148    18834*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015827,
                    "execution_time": 0.007149,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.002987
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.301018,
                    "execution_time": 0.007689,
                    "compile_time": 0.248629,
                    "planning_time": 0.037889
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_LP\", COUNT(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_CNT\", COUNT(DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE (\"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_29\""
            }
        ],
        "preview": "\n/*   b6_lp     b6_cnt  b6_cntd\n0  32.31  164718148    18834*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n/*CURSOR_IDENTIFIER*/\n      ) B6",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_35\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.596468,
                    "execution_time": 1.537143,
                    "compile_time": 0.000398,
                    "planning_time": 0.028466,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.835686,
                    "execution_time": 1.705852,
                    "compile_time": 0.000398,
                    "planning_time": 0.087722,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_36\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120638,
                    "execution_time": 0.080653,
                    "compile_time": 0.000478,
                    "planning_time": 0.011407,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.179912,
                    "execution_time": 0.081967,
                    "compile_time": 0.000496,
                    "planning_time": 0.069143,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  75.74  134277890    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020019,
                    "execution_time": 0.007131,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005694
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05693,
                    "execution_time": 0.007773,
                    "compile_time": 6e-05,
                    "planning_time": 0.041592
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  75.74  134277890    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 5000 and 5000+1000\n          or ss_wholesale_cost between 25 and 25+20)\n/*CURSOR_IDENTIFIER*/\n      ) B6",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 45 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 25 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_37\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 45 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 25 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.154625,
                    "execution_time": 4.091232,
                    "compile_time": 0.000412,
                    "planning_time": 0.031336,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.141699,
                    "execution_time": 4.017254,
                    "compile_time": 0.001528,
                    "planning_time": 0.090159,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_38\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_37\" AS \"SPEQLITE_TEMP_TABLE_37\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117765,
                    "execution_time": 0.074751,
                    "compile_time": 0.000479,
                    "planning_time": 0.011682,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.180822,
                    "execution_time": 0.079444,
                    "compile_time": 0.000481,
                    "planning_time": 0.069599,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_38\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_38\" AS \"SPEQLITE_TEMP_TABLE_38\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236   55.5  195936915     6789*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020267,
                    "execution_time": 0.007251,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.00576
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057599,
                    "execution_time": 0.008164,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.042139
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_37\" AS \"SPEQLITE_TEMP_TABLE_37\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_38\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_38\" AS \"SPEQLITE_TEMP_TABLE_38\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236   55.5  195936915     6789*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n           ,count(ss_list_price) B1_CNT\n           ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n           ,count(ss_list_price) B2_CNT\n           ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n           ,count(ss_list_price) B3_CNT\n           ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n           ,count(ss_list_price) B4_CNT\n           ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n           ,count(ss_list_price) B5_CNT\n           ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n           ,count(ss_list_price) B6_CNT\n           ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_39\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.554495,
                    "execution_time": 4.492109,
                    "compile_time": 0.000398,
                    "planning_time": 0.030865,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.686243,
                    "execution_time": 4.561203,
                    "compile_time": 0.000406,
                    "planning_time": 0.091733,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_40\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_39\" AS \"SPEQLITE_TEMP_TABLE_39\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119555,
                    "execution_time": 0.077038,
                    "compile_time": 0.000462,
                    "planning_time": 0.011333,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.197494,
                    "execution_time": 0.084437,
                    "compile_time": 0.000455,
                    "planning_time": 0.070269,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_40\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_40\" AS \"SPEQLITE_TEMP_TABLE_40\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  40.28  217632318    14826*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019788,
                    "execution_time": 0.007123,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005622
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056969,
                    "execution_time": 0.007888,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.041587
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_39\" AS \"SPEQLITE_TEMP_TABLE_39\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_40\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_40\" AS \"SPEQLITE_TEMP_TABLE_40\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  40.28  217632318    14826*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 7 and 7+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_41\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.391825,
                    "execution_time": 4.332772,
                    "compile_time": 0.000399,
                    "planning_time": 0.027716,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.463438,
                    "execution_time": 4.338623,
                    "compile_time": 0.000406,
                    "planning_time": 0.091292,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_42\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.121983,
                    "execution_time": 0.080333,
                    "compile_time": 0.000461,
                    "planning_time": 0.011193,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.178253,
                    "execution_time": 0.077749,
                    "compile_time": 0.000456,
                    "planning_time": 0.069656,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_42\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_42\" AS \"SPEQLITE_TEMP_TABLE_42\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  36.95  217645653    14591*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019579,
                    "execution_time": 0.007141,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005483
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055209,
                    "execution_time": 0.007339,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040852
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_42\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_42\" AS \"SPEQLITE_TEMP_TABLE_42\""
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  36.95  217645653    14591*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 7 and 7+20)) B6\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\" LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_43\" AS SELECT \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063449,
                    "execution_time": 0.035801,
                    "compile_time": 0.000237,
                    "planning_time": 0.003169,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.128718,
                    "execution_time": 0.041392,
                    "compile_time": 0.000242,
                    "planning_time": 0.062354,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_44\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_43\" AS \"SPEQLITE_TEMP_TABLE_43\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119184,
                    "execution_time": 0.076587,
                    "compile_time": 0.000481,
                    "planning_time": 0.011429,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.196842,
                    "execution_time": 0.077742,
                    "compile_time": 0.000498,
                    "planning_time": 0.087531,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_44\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_44\" AS \"SPEQLITE_TEMP_TABLE_44\" LIMIT 21",
                "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  36.95  217645653    14591*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020275,
                    "execution_time": 0.00738,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005738
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05669,
                    "execution_time": 0.007575,
                    "compile_time": 6e-05,
                    "planning_time": 0.041635
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_43\" AS \"SPEQLITE_TEMP_TABLE_43\" LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_44\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_44\" AS \"SPEQLITE_TEMP_TABLE_44\" LIMIT 100"
            }
        ],
        "preview": "\n/*   b1_lp    b1_cnt  b1_cntd  b2_lp    b2_cnt  b2_cntd  b3_lp     b3_cnt  b3_cntd   b4_lp     b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd  b6_lp     b6_cnt  b6_cntd\n0  54.48  36226309     7967  30.62  72332817     6384  59.85  100618214     6678  111.97  125814692    13051  35.84  152606940    18236  36.95  217645653    14591*/"
    }
]