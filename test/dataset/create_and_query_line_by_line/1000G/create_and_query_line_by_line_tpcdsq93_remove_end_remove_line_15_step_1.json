[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*SS_SALES_PRICE\n                                                            else (ss_quantity*SS_SALES_PRICE) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n            ) /*CURSOR_IDENTIFIER*/\n      ) as sales\n      group by ss_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LIMIT 21",
                "preview": "\n/*    ss_item_sk  ss_ticket_number  ss_customer_sk  act_sales\n0        13684         224559050         3582130     588.24\n1        13684         224559050         3582130     402.48\n2        13684         224559050         3582130     804.96\n3        13684         224559050         3582130     247.68\n4        13684         224559050         3582130     309.60\n5        13684         224559050         3582130     464.40\n6        13684         224559050         3582130     650.16\n7        13684         224559050         3582130      92.88\n8        13684         224559050         3582130     216.72\n9        13684         224559050         3582130    1176.48\n10       13684         224559050         3582130    1114.56\n11       13684         224559050         3582130   -1362.24\n12       13684         224559050         3582130    -835.92\n13       13684         224559050         3582130    -433.44\n14       13684         224559050         3582130   -1176.48\n15       13684         224559050         3582130     650.16\n16       13684         224559050         3582130    1176.48\n17       13684         224559050         3582130     650.16\n18       13684         224559050         3582130     247.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 27.540137,
                    "execution_time": 27.494096,
                    "compile_time": 0.000143,
                    "planning_time": 0.034872
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 31.862016,
                    "execution_time": 29.10348,
                    "compile_time": 2.633397,
                    "planning_time": 0.099282
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\", \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\""
            }
        ],
        "preview": "\n/*    ss_item_sk  ss_ticket_number  ss_customer_sk  act_sales\n0        13684         224559050         3582130     588.24\n1        13684         224559050         3582130     402.48\n2        13684         224559050         3582130     804.96\n3        13684         224559050         3582130     247.68\n4        13684         224559050         3582130     309.60\n5        13684         224559050         3582130     464.40\n6        13684         224559050         3582130     650.16\n7        13684         224559050         3582130      92.88\n8        13684         224559050         3582130     216.72\n9        13684         224559050         3582130    1176.48\n10       13684         224559050         3582130    1114.56\n11       13684         224559050         3582130   -1362.24\n12       13684         224559050         3582130    -835.92\n13       13684         224559050         3582130    -433.44\n14       13684         224559050         3582130   -1176.48\n15       13684         224559050         3582130     650.16\n16       13684         224559050         3582130    1176.48\n17       13684         224559050         3582130     650.16\n18       13684         224559050         3582130     247.68\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*SS_SALES_PRICE\n                                                            else (ss_quantity*SS_SALES_PRICE) end act_sales\n            from store_sales left outer join store_returns on (SR_ITEM_SK = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n           ) derived_table1\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,ss_quantity\n                  ,ss_sales_price\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n            ) as sales_data\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n/*CURSOR_IDENTIFIER*/\n            ) as sales_data\n      group by ss_customer_sk\n",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\ngroup by ss_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 26.933375,
                    "execution_time": 26.652506,
                    "compile_time": 0.000459,
                    "planning_time": 0.050681,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.549099,
                    "execution_time": 29.174575,
                    "compile_time": 0.003696,
                    "planning_time": 0.132306,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0          8253069   2113.59\n1          8772387     12.92\n2          3618057    249.16\n3          3227720    287.56\n4          4202970    289.39\n5           510139   1371.48\n6         11245765      0.00\n7          2829658    191.22\n8         10500685     59.36\n9          2964488     94.86\n10         8147868    497.28\n11          772565   1095.25\n12         4964887   1410.57\n13         2020018   1196.21\n14         7417180      2.98\n15        11241991   1179.52\n16         9586909   1018.75\n17         6330459    123.12\n18         3505392   1338.75\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017557,
                    "execution_time": 0.007069,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003257
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054474,
                    "execution_time": 0.008153,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038659
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0          8253069   2113.59\n1          8772387     12.92\n2          3618057    249.16\n3          3227720    287.56\n4          4202970    289.39\n5           510139   1371.48\n6         11245765      0.00\n7          2829658    191.22\n8         10500685     59.36\n9          2964488     94.86\n10         8147868    497.28\n11          772565   1095.25\n12         4964887   1410.57\n13         2020018   1196.21\n14         7417180      2.98\n15        11241991   1179.52\n16         9586909   1018.75\n17         6330459    123.12\n18         3505392   1338.75\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0          2837301   1202.02\n1          9943475   2492.32\n2          5176529     18.57\n3          8507922    395.25\n4          3317882   1442.28\n5         10317425    230.64\n6          1153131      0.00\n7          9210893    117.09\n8          1231034     22.15\n9          6978918    239.58\n10         7258702    383.76\n11         5038533   5179.85\n12          432711    196.65\n13         2019525    382.13\n14         9273964    459.40\n15        11660837     12.96\n16         8008827   2352.45\n17        11612332       NaN\n18        10771706    409.40\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017057,
                    "execution_time": 0.007975,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003162
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051813,
                    "execution_time": 0.007475,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0          2837301   1202.02\n1          9943475   2492.32\n2          5176529     18.57\n3          8507922    395.25\n4          3317882   1442.28\n5         10317425    230.64\n6          1153131      0.00\n7          9210893    117.09\n8          1231034     22.15\n9          6978918    239.58\n10         7258702    383.76\n11         5038533   5179.85\n12          432711    196.65\n13         2019525    382.13\n14         9273964    459.40\n15        11660837     12.96\n16         8008827   2352.45\n17        11612332       NaN\n18        10771706    409.40\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n      order by sumsales, ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"SUMSALES\" , \"SS_CUSTOMER_SK\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0               60       0.0\n1               81       0.0\n2              256       0.0\n3              345       0.0\n4              362       0.0\n5              372       0.0\n6              425       0.0\n7              548       0.0\n8              642       0.0\n9              684       0.0\n10             775       0.0\n11             794       0.0\n12             852       0.0\n13             896       0.0\n14             917       0.0\n15             968       0.0\n16            1026       0.0\n17            1079       0.0\n18            1166       0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020827,
                    "execution_time": 0.011252,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003531
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.240826,
                    "execution_time": 0.011805,
                    "compile_time": 0.181643,
                    "planning_time": 0.039731
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST, \"SS_CUSTOMER_SK\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST"
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0               60       0.0\n1               81       0.0\n2              256       0.0\n3              345       0.0\n4              362       0.0\n5              372       0.0\n6              425       0.0\n7              548       0.0\n8              642       0.0\n9              684       0.0\n10             775       0.0\n11             794       0.0\n12             852       0.0\n13             896       0.0\n14             917       0.0\n15             968       0.0\n16            1026       0.0\n17            1079       0.0\n18            1166       0.0\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n      order by sumsales, ss_customer_sk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"SUMSALES\" , \"SS_CUSTOMER_SK\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0               60       0.0\n1               81       0.0\n2              256       0.0\n3              345       0.0\n4              362       0.0\n5              372       0.0\n6              425       0.0\n7              548       0.0\n8              642       0.0\n9              684       0.0\n10             775       0.0\n11             794       0.0\n12             852       0.0\n13             896       0.0\n14             917       0.0\n15             968       0.0\n16            1026       0.0\n17            1079       0.0\n18            1166       0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020582,
                    "execution_time": 0.011238,
                    "compile_time": 6.7e-05,
                    "planning_time": 0.003447
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021403,
                    "execution_time": 0.011955,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003473
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST, \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0               60       0.0\n1               81       0.0\n2              256       0.0\n3              345       0.0\n4              362       0.0\n5              372       0.0\n6              425       0.0\n7              548       0.0\n8              642       0.0\n9              684       0.0\n10             775       0.0\n11             794       0.0\n12             852       0.0\n13             896       0.0\n14             917       0.0\n15             968       0.0\n16            1026       0.0\n17            1079       0.0\n18            1166       0.0\n...*/"
    }
]