[
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_firstyear.customer_id, t_s_firstyear.customer_first_name, t_s_firstyear.customer_last_name\n from year_total t_s_firstyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.146577,
                    "execution_time": 0.76902,
                    "compile_time": 0.000268,
                    "planning_time": 0.025044,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.411746,
                    "execution_time": 1.734635,
                    "compile_time": 0.236433,
                    "planning_time": 0.087448,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08232,
                    "execution_time": 0.032087,
                    "compile_time": 0.000243,
                    "planning_time": 0.025939,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.291127,
                    "execution_time": 0.03191,
                    "compile_time": 0.143794,
                    "planning_time": 0.08864,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 28.068085,
                    "execution_time": 27.692496,
                    "compile_time": 0.000848,
                    "planning_time": 0.044275,
                    "create_size": 2304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 28.352292,
                    "execution_time": 27.893545,
                    "compile_time": 0.009393,
                    "planning_time": 0.127998,
                    "create_size": 2304
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAFHPIIKAA             Darrell              Chang\n1   AAAAAAAAHLLFOAAA                Rose             Austin\n2   AAAAAAAAMGPGEKAA            Veronica              Boyce\n3   AAAAAAAAGBEDCLAA           Frederick             Spears\n4   AAAAAAAAJFFCOCAA             Daniela              Green\n5   AAAAAAAAIBEEBEAA                Jane              Lilly\n6   AAAAAAAAACEAEEAA             Jeffrey             Molina\n7   AAAAAAAAJMKAOBAA               Henry             Willis\n8   AAAAAAAAJNCIFIAA             Michael             Benson\n9   AAAAAAAAMICLDHAA                                       \n10  AAAAAAAAIGPBDEAA             Matthew             Pruitt\n11  AAAAAAAAMDJBJHAA           Charlotte              Pitts\n12  AAAAAAAAGFHHBKAA               Paula             Strunk\n13  AAAAAAAAODMHEFAA                Dino                   \n14  AAAAAAAABHMFGBAA               James             Farrar\n15  AAAAAAAALOHKECAA               Clint               Ryan\n16  AAAAAAAAAEDCEIAA                Suzy            Wheeler\n17  AAAAAAAADJFFBIAA               Ester            Sanchez\n18  AAAAAAAALGJAJIAA              Denise             Wilson\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017958,
                    "execution_time": 0.007764,
                    "compile_time": 5e-05,
                    "planning_time": 0.003795
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057105,
                    "execution_time": 0.00793,
                    "compile_time": 0.001063,
                    "planning_time": 0.039334
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\"",
                "rewrite": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAFHPIIKAA             Darrell              Chang\n1   AAAAAAAAHLLFOAAA                Rose             Austin\n2   AAAAAAAAMGPGEKAA            Veronica              Boyce\n3   AAAAAAAAGBEDCLAA           Frederick             Spears\n4   AAAAAAAAJFFCOCAA             Daniela              Green\n5   AAAAAAAAIBEEBEAA                Jane              Lilly\n6   AAAAAAAAACEAEEAA             Jeffrey             Molina\n7   AAAAAAAAJMKAOBAA               Henry             Willis\n8   AAAAAAAAJNCIFIAA             Michael             Benson\n9   AAAAAAAAMICLDHAA                                       \n10  AAAAAAAAIGPBDEAA             Matthew             Pruitt\n11  AAAAAAAAMDJBJHAA           Charlotte              Pitts\n12  AAAAAAAAGFHHBKAA               Paula             Strunk\n13  AAAAAAAAODMHEFAA                Dino                   \n14  AAAAAAAABHMFGBAA               James             Farrar\n15  AAAAAAAALOHKECAA               Clint               Ryan\n16  AAAAAAAAAEDCEIAA                Suzy            Wheeler\n17  AAAAAAAADJFFBIAA               Ester            Sanchez\n18  AAAAAAAALGJAJIAA              Denise             Wilson\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNGMHJAA               Sofia             Perron\n1   AAAAAAAAPNGMHJAA               Sofia             Perron\n2   AAAAAAAAPNGMHJAA               Sofia             Perron\n3   AAAAAAAAPNGMHJAA               Sofia             Perron\n4   AAAAAAAAPNGMHJAA               Sofia             Perron\n5   AAAAAAAAPNGMHJAA               Sofia             Perron\n6   AAAAAAAAPNGMHJAA               Sofia             Perron\n7   AAAAAAAAPNGMHJAA               Sofia             Perron\n8   AAAAAAAAPNGMHJAA               Sofia             Perron\n9   AAAAAAAAPNGMHJAA               Sofia             Perron\n10  AAAAAAAAPNGMHJAA               Sofia             Perron\n11  AAAAAAAAPNGMHJAA               Sofia             Perron\n12  AAAAAAAAPNGMHJAA               Sofia             Perron\n13  AAAAAAAAPNGMHJAA               Sofia             Perron\n14  AAAAAAAAPNGMHJAA               Sofia             Perron\n15  AAAAAAAAPNGMHJAA               Sofia             Perron\n16  AAAAAAAAPNGMHJAA               Sofia             Perron\n17  AAAAAAAAPNGMHJAA               Sofia             Perron\n18  AAAAAAAAPNGMHJAA               Sofia             Perron\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.200892,
                    "execution_time": 0.189002,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.004573
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.241464,
                    "execution_time": 0.187233,
                    "compile_time": 0.001037,
                    "planning_time": 0.040097
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNGMHJAA               Sofia             Perron\n1   AAAAAAAAPNGMHJAA               Sofia             Perron\n2   AAAAAAAAPNGMHJAA               Sofia             Perron\n3   AAAAAAAAPNGMHJAA               Sofia             Perron\n4   AAAAAAAAPNGMHJAA               Sofia             Perron\n5   AAAAAAAAPNGMHJAA               Sofia             Perron\n6   AAAAAAAAPNGMHJAA               Sofia             Perron\n7   AAAAAAAAPNGMHJAA               Sofia             Perron\n8   AAAAAAAAPNGMHJAA               Sofia             Perron\n9   AAAAAAAAPNGMHJAA               Sofia             Perron\n10  AAAAAAAAPNGMHJAA               Sofia             Perron\n11  AAAAAAAAPNGMHJAA               Sofia             Perron\n12  AAAAAAAAPNGMHJAA               Sofia             Perron\n13  AAAAAAAAPNGMHJAA               Sofia             Perron\n14  AAAAAAAAPNGMHJAA               Sofia             Perron\n15  AAAAAAAAPNGMHJAA               Sofia             Perron\n16  AAAAAAAAPNGMHJAA               Sofia             Perron\n17  AAAAAAAAPNGMHJAA               Sofia             Perron\n18  AAAAAAAAPNGMHJAA               Sofia             Perron\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNGMHJAA               Sofia             Perron\n1   AAAAAAAAPNGMHJAA               Sofia             Perron\n2   AAAAAAAAPNGMHJAA               Sofia             Perron\n3   AAAAAAAAPNGMHJAA               Sofia             Perron\n4   AAAAAAAAPNGMHJAA               Sofia             Perron\n5   AAAAAAAAPNGMHJAA               Sofia             Perron\n6   AAAAAAAAPNGMHJAA               Sofia             Perron\n7   AAAAAAAAPNGMHJAA               Sofia             Perron\n8   AAAAAAAAPNGMHJAA               Sofia             Perron\n9   AAAAAAAAPNGMHJAA               Sofia             Perron\n10  AAAAAAAAPNGMHJAA               Sofia             Perron\n11  AAAAAAAAPNGMHJAA               Sofia             Perron\n12  AAAAAAAAPNGMHJAA               Sofia             Perron\n13  AAAAAAAAPNGMHJAA               Sofia             Perron\n14  AAAAAAAAPNGMHJAA               Sofia             Perron\n15  AAAAAAAAPNGMHJAA               Sofia             Perron\n16  AAAAAAAAPNGMHJAA               Sofia             Perron\n17  AAAAAAAAPNGMHJAA               Sofia             Perron\n18  AAAAAAAAPNGMHJAA               Sofia             Perron\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.391939,
                    "execution_time": 0.37747,
                    "compile_time": 0.000158,
                    "planning_time": 0.005202
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.5312,
                    "execution_time": 0.36227,
                    "compile_time": 0.285815,
                    "planning_time": 0.040434
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNGMHJAA               Sofia             Perron\n1   AAAAAAAAPNGMHJAA               Sofia             Perron\n2   AAAAAAAAPNGMHJAA               Sofia             Perron\n3   AAAAAAAAPNGMHJAA               Sofia             Perron\n4   AAAAAAAAPNGMHJAA               Sofia             Perron\n5   AAAAAAAAPNGMHJAA               Sofia             Perron\n6   AAAAAAAAPNGMHJAA               Sofia             Perron\n7   AAAAAAAAPNGMHJAA               Sofia             Perron\n8   AAAAAAAAPNGMHJAA               Sofia             Perron\n9   AAAAAAAAPNGMHJAA               Sofia             Perron\n10  AAAAAAAAPNGMHJAA               Sofia             Perron\n11  AAAAAAAAPNGMHJAA               Sofia             Perron\n12  AAAAAAAAPNGMHJAA               Sofia             Perron\n13  AAAAAAAAPNGMHJAA               Sofia             Perron\n14  AAAAAAAAPNGMHJAA               Sofia             Perron\n15  AAAAAAAAPNGMHJAA               Sofia             Perron\n16  AAAAAAAAPNGMHJAA               Sofia             Perron\n17  AAAAAAAAPNGMHJAA               Sofia             Perron\n18  AAAAAAAAPNGMHJAA               Sofia             Perron\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n1   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n2   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n3   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n4   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n5   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n6   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n7   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n8   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n9   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n10  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n11  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n12  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n13  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n14  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n15  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n16  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n17  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n18  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.565556,
                    "execution_time": 0.55029,
                    "compile_time": 0.00023,
                    "planning_time": 0.006069
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.627805,
                    "execution_time": 0.536446,
                    "compile_time": 0.214849,
                    "planning_time": 0.041975
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n1   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n2   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n3   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n4   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n5   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n6   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n7   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n8   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n9   AAAAAAAAAMMAEBAA              Evelyn              Hayes\n10  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n11  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n12  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n13  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n14  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n15  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n16  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n17  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n18  AAAAAAAAAMMAEBAA              Evelyn              Hayes\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACCGHJDAA           Charlotte             Miller\n1   AAAAAAAACCGHJDAA           Charlotte             Miller\n2   AAAAAAAACCGHJDAA           Charlotte             Miller\n3   AAAAAAAACCGHJDAA           Charlotte             Miller\n4   AAAAAAAACCGHJDAA           Charlotte             Miller\n5   AAAAAAAACCGHJDAA           Charlotte             Miller\n6   AAAAAAAACCGHJDAA           Charlotte             Miller\n7   AAAAAAAACCGHJDAA           Charlotte             Miller\n8   AAAAAAAACCGHJDAA           Charlotte             Miller\n9   AAAAAAAACCGHJDAA           Charlotte             Miller\n10  AAAAAAAACCGHJDAA           Charlotte             Miller\n11  AAAAAAAACCGHJDAA           Charlotte             Miller\n12  AAAAAAAACCGHJDAA           Charlotte             Miller\n13  AAAAAAAACCGHJDAA           Charlotte             Miller\n14  AAAAAAAACCGHJDAA           Charlotte             Miller\n15  AAAAAAAACCGHJDAA           Charlotte             Miller\n16  AAAAAAAACCGHJDAA           Charlotte             Miller\n17  AAAAAAAACCGHJDAA           Charlotte             Miller\n18  AAAAAAAACCGHJDAA           Charlotte             Miller\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.007883,
                    "execution_time": 1.986324,
                    "compile_time": 0.000287,
                    "planning_time": 0.007507
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.308578,
                    "execution_time": 2.060031,
                    "compile_time": 4.186417,
                    "planning_time": 0.043878
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACCGHJDAA           Charlotte             Miller\n1   AAAAAAAACCGHJDAA           Charlotte             Miller\n2   AAAAAAAACCGHJDAA           Charlotte             Miller\n3   AAAAAAAACCGHJDAA           Charlotte             Miller\n4   AAAAAAAACCGHJDAA           Charlotte             Miller\n5   AAAAAAAACCGHJDAA           Charlotte             Miller\n6   AAAAAAAACCGHJDAA           Charlotte             Miller\n7   AAAAAAAACCGHJDAA           Charlotte             Miller\n8   AAAAAAAACCGHJDAA           Charlotte             Miller\n9   AAAAAAAACCGHJDAA           Charlotte             Miller\n10  AAAAAAAACCGHJDAA           Charlotte             Miller\n11  AAAAAAAACCGHJDAA           Charlotte             Miller\n12  AAAAAAAACCGHJDAA           Charlotte             Miller\n13  AAAAAAAACCGHJDAA           Charlotte             Miller\n14  AAAAAAAACCGHJDAA           Charlotte             Miller\n15  AAAAAAAACCGHJDAA           Charlotte             Miller\n16  AAAAAAAACCGHJDAA           Charlotte             Miller\n17  AAAAAAAACCGHJDAA           Charlotte             Miller\n18  AAAAAAAACCGHJDAA           Charlotte             Miller\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 28.211671,
                    "execution_time": 27.798838,
                    "compile_time": 0.000763,
                    "planning_time": 0.048272,
                    "create_size": 2560
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 28.630644,
                    "execution_time": 28.125217,
                    "compile_time": 0.004786,
                    "planning_time": 0.137177,
                    "create_size": 2560
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACKHNMDAA              Thomas             Gaines\n1   AAAAAAAACKHNMDAA              Thomas             Gaines\n2   AAAAAAAACKHNMDAA              Thomas             Gaines\n3   AAAAAAAACKHNMDAA              Thomas             Gaines\n4   AAAAAAAACKHNMDAA              Thomas             Gaines\n5   AAAAAAAACKHNMDAA              Thomas             Gaines\n6   AAAAAAAACKHNMDAA              Thomas             Gaines\n7   AAAAAAAACKHNMDAA              Thomas             Gaines\n8   AAAAAAAACKHNMDAA              Thomas             Gaines\n9   AAAAAAAACKHNMDAA              Thomas             Gaines\n10  AAAAAAAACKHNMDAA              Thomas             Gaines\n11  AAAAAAAACKHNMDAA              Thomas             Gaines\n12  AAAAAAAACKHNMDAA              Thomas             Gaines\n13  AAAAAAAACKHNMDAA              Thomas             Gaines\n14  AAAAAAAACKHNMDAA              Thomas             Gaines\n15  AAAAAAAACKHNMDAA              Thomas             Gaines\n16  AAAAAAAACKHNMDAA              Thomas             Gaines\n17  AAAAAAAACKHNMDAA              Thomas             Gaines\n18  AAAAAAAACKHNMDAA              Thomas             Gaines\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.846239,
                    "execution_time": 1.822013,
                    "compile_time": 0.000349,
                    "planning_time": 0.008764
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.100978,
                    "execution_time": 2.036925,
                    "compile_time": 0.000355,
                    "planning_time": 0.04455
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACKHNMDAA              Thomas             Gaines\n1   AAAAAAAACKHNMDAA              Thomas             Gaines\n2   AAAAAAAACKHNMDAA              Thomas             Gaines\n3   AAAAAAAACKHNMDAA              Thomas             Gaines\n4   AAAAAAAACKHNMDAA              Thomas             Gaines\n5   AAAAAAAACKHNMDAA              Thomas             Gaines\n6   AAAAAAAACKHNMDAA              Thomas             Gaines\n7   AAAAAAAACKHNMDAA              Thomas             Gaines\n8   AAAAAAAACKHNMDAA              Thomas             Gaines\n9   AAAAAAAACKHNMDAA              Thomas             Gaines\n10  AAAAAAAACKHNMDAA              Thomas             Gaines\n11  AAAAAAAACKHNMDAA              Thomas             Gaines\n12  AAAAAAAACKHNMDAA              Thomas             Gaines\n13  AAAAAAAACKHNMDAA              Thomas             Gaines\n14  AAAAAAAACKHNMDAA              Thomas             Gaines\n15  AAAAAAAACKHNMDAA              Thomas             Gaines\n16  AAAAAAAACKHNMDAA              Thomas             Gaines\n17  AAAAAAAACKHNMDAA              Thomas             Gaines\n18  AAAAAAAACKHNMDAA              Thomas             Gaines\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 22.893437,
                    "execution_time": 22.548573,
                    "compile_time": 0.000828,
                    "planning_time": 0.008911,
                    "create_size": 17304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 31.950632,
                    "execution_time": 21.174219,
                    "compile_time": 10.349017,
                    "planning_time": 0.067618,
                    "create_size": 17304
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABDHKPHAA            Margaret             Morgan\n1   AAAAAAAABDHKPHAA            Margaret             Morgan\n2   AAAAAAAABDHKPHAA            Margaret             Morgan\n3   AAAAAAAABDHKPHAA            Margaret             Morgan\n4   AAAAAAAABDHKPHAA            Margaret             Morgan\n5   AAAAAAAABDHKPHAA            Margaret             Morgan\n6   AAAAAAAANGNCMIAA             Donovan             Skaggs\n7   AAAAAAAANGNCMIAA             Donovan             Skaggs\n8   AAAAAAAANGNCMIAA             Donovan             Skaggs\n9   AAAAAAAANGNCMIAA             Donovan             Skaggs\n10  AAAAAAAANGNCMIAA             Donovan             Skaggs\n11  AAAAAAAANGNCMIAA             Donovan             Skaggs\n12  AAAAAAAANGNCMIAA             Donovan             Skaggs\n13  AAAAAAAANGNCMIAA             Donovan             Skaggs\n14  AAAAAAAANGNCMIAA             Donovan             Skaggs\n15  AAAAAAAANGNCMIAA             Donovan             Skaggs\n16  AAAAAAAANGNCMIAA             Donovan             Skaggs\n17  AAAAAAAANGNCMIAA             Donovan             Skaggs\n18  AAAAAAAANGNCMIAA             Donovan             Skaggs\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0177,
                    "execution_time": 0.007882,
                    "compile_time": 5e-05,
                    "planning_time": 0.003572
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056849,
                    "execution_time": 0.00923,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038875
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABDHKPHAA            Margaret             Morgan\n1   AAAAAAAABDHKPHAA            Margaret             Morgan\n2   AAAAAAAABDHKPHAA            Margaret             Morgan\n3   AAAAAAAABDHKPHAA            Margaret             Morgan\n4   AAAAAAAABDHKPHAA            Margaret             Morgan\n5   AAAAAAAABDHKPHAA            Margaret             Morgan\n6   AAAAAAAANGNCMIAA             Donovan             Skaggs\n7   AAAAAAAANGNCMIAA             Donovan             Skaggs\n8   AAAAAAAANGNCMIAA             Donovan             Skaggs\n9   AAAAAAAANGNCMIAA             Donovan             Skaggs\n10  AAAAAAAANGNCMIAA             Donovan             Skaggs\n11  AAAAAAAANGNCMIAA             Donovan             Skaggs\n12  AAAAAAAANGNCMIAA             Donovan             Skaggs\n13  AAAAAAAANGNCMIAA             Donovan             Skaggs\n14  AAAAAAAANGNCMIAA             Donovan             Skaggs\n15  AAAAAAAANGNCMIAA             Donovan             Skaggs\n16  AAAAAAAANGNCMIAA             Donovan             Skaggs\n17  AAAAAAAANGNCMIAA             Donovan             Skaggs\n18  AAAAAAAANGNCMIAA             Donovan             Skaggs\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAFICHNGAA              Tyrone              White\n1   AAAAAAAAFICHNGAA              Tyrone              White\n2   AAAAAAAAFICHNGAA              Tyrone              White\n3   AAAAAAAAFICHNGAA              Tyrone              White\n4   AAAAAAAAFICHNGAA              Tyrone              White\n5   AAAAAAAAFICHNGAA              Tyrone              White\n6   AAAAAAAAFICHNGAA              Tyrone              White\n7   AAAAAAAAFICHNGAA              Tyrone              White\n8   AAAAAAAAFICHNGAA              Tyrone              White\n9   AAAAAAAAFICHNGAA              Tyrone              White\n10  AAAAAAAAFICHNGAA              Tyrone              White\n11  AAAAAAAAFICHNGAA              Tyrone              White\n12  AAAAAAAAFICHNGAA              Tyrone              White\n13  AAAAAAAAFICHNGAA              Tyrone              White\n14  AAAAAAAAFICHNGAA              Tyrone              White\n15  AAAAAAAAFICHNGAA              Tyrone              White\n16  AAAAAAAAFICHNGAA              Tyrone              White\n17  AAAAAAAAFICHNGAA              Tyrone              White\n18  AAAAAAAAFICHNGAA              Tyrone              White\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.117145,
                    "execution_time": 0.104071,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.005303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.172988,
                    "execution_time": 0.110492,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.040758
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAFICHNGAA              Tyrone              White\n1   AAAAAAAAFICHNGAA              Tyrone              White\n2   AAAAAAAAFICHNGAA              Tyrone              White\n3   AAAAAAAAFICHNGAA              Tyrone              White\n4   AAAAAAAAFICHNGAA              Tyrone              White\n5   AAAAAAAAFICHNGAA              Tyrone              White\n6   AAAAAAAAFICHNGAA              Tyrone              White\n7   AAAAAAAAFICHNGAA              Tyrone              White\n8   AAAAAAAAFICHNGAA              Tyrone              White\n9   AAAAAAAAFICHNGAA              Tyrone              White\n10  AAAAAAAAFICHNGAA              Tyrone              White\n11  AAAAAAAAFICHNGAA              Tyrone              White\n12  AAAAAAAAFICHNGAA              Tyrone              White\n13  AAAAAAAAFICHNGAA              Tyrone              White\n14  AAAAAAAAFICHNGAA              Tyrone              White\n15  AAAAAAAAFICHNGAA              Tyrone              White\n16  AAAAAAAAFICHNGAA              Tyrone              White\n17  AAAAAAAAFICHNGAA              Tyrone              White\n18  AAAAAAAAFICHNGAA              Tyrone              White\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAHFCLICAA            Brittany              Bates\n1   AAAAAAAAHFCLICAA            Brittany              Bates\n2   AAAAAAAAHFCLICAA            Brittany              Bates\n3   AAAAAAAAHFCLICAA            Brittany              Bates\n4   AAAAAAAAHFCLICAA            Brittany              Bates\n5   AAAAAAAAHFCLICAA            Brittany              Bates\n6   AAAAAAAAHFCLICAA            Brittany              Bates\n7   AAAAAAAAHFCLICAA            Brittany              Bates\n8   AAAAAAAAHFCLICAA            Brittany              Bates\n9   AAAAAAAAHFCLICAA            Brittany              Bates\n10  AAAAAAAAHFCLICAA            Brittany              Bates\n11  AAAAAAAAHFCLICAA            Brittany              Bates\n12  AAAAAAAAHFCLICAA            Brittany              Bates\n13  AAAAAAAAHFCLICAA            Brittany              Bates\n14  AAAAAAAAHFCLICAA            Brittany              Bates\n15  AAAAAAAAHFCLICAA            Brittany              Bates\n16  AAAAAAAAIDNCCEAA               Roger           Delacruz\n17  AAAAAAAAIDNCCEAA               Roger           Delacruz\n18  AAAAAAAAIDNCCEAA               Roger           Delacruz\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 51.481637,
                    "execution_time": 51.465639,
                    "compile_time": 0.000165,
                    "planning_time": 0.006675
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 54.757822,
                    "execution_time": 54.692359,
                    "compile_time": 0.001053,
                    "planning_time": 0.042465
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAHFCLICAA            Brittany              Bates\n1   AAAAAAAAHFCLICAA            Brittany              Bates\n2   AAAAAAAAHFCLICAA            Brittany              Bates\n3   AAAAAAAAHFCLICAA            Brittany              Bates\n4   AAAAAAAAHFCLICAA            Brittany              Bates\n5   AAAAAAAAHFCLICAA            Brittany              Bates\n6   AAAAAAAAHFCLICAA            Brittany              Bates\n7   AAAAAAAAHFCLICAA            Brittany              Bates\n8   AAAAAAAAHFCLICAA            Brittany              Bates\n9   AAAAAAAAHFCLICAA            Brittany              Bates\n10  AAAAAAAAHFCLICAA            Brittany              Bates\n11  AAAAAAAAHFCLICAA            Brittany              Bates\n12  AAAAAAAAHFCLICAA            Brittany              Bates\n13  AAAAAAAAHFCLICAA            Brittany              Bates\n14  AAAAAAAAHFCLICAA            Brittany              Bates\n15  AAAAAAAAHFCLICAA            Brittany              Bates\n16  AAAAAAAAIDNCCEAA               Roger           Delacruz\n17  AAAAAAAAIDNCCEAA               Roger           Delacruz\n18  AAAAAAAAIDNCCEAA               Roger           Delacruz\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 28.221042,
                    "execution_time": 27.781253,
                    "compile_time": 0.000885,
                    "planning_time": 0.043276,
                    "create_size": 2816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 29.15893,
                    "execution_time": 28.558476,
                    "compile_time": 0.006092,
                    "planning_time": 0.194955,
                    "create_size": 2816
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.925893,
                    "execution_time": 3.603326,
                    "compile_time": 0.000667,
                    "planning_time": 0.010919,
                    "create_size": 2432
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.619493,
                    "execution_time": 3.610385,
                    "compile_time": 4.60949,
                    "planning_time": 0.069228,
                    "create_size": 2432
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAADGJDNFAA            Kimberly                   \n1   AAAAAAAADGJDNFAA            Kimberly                   \n2   AAAAAAAADGJDNFAA            Kimberly                   \n3   AAAAAAAADGJDNFAA            Kimberly                   \n4   AAAAAAAACMMFLDAA               Jason              Green\n5   AAAAAAAAMIGKMBAA                John              Adams\n6   AAAAAAAABAAICBAA              Raquel           Matthews\n7   AAAAAAAABAAICBAA              Raquel           Matthews\n8   AAAAAAAABAAICBAA              Raquel           Matthews\n9   AAAAAAAABAAICBAA              Raquel           Matthews\n10  AAAAAAAAHJPKADAA                Jane               Wise\n11  AAAAAAAABDJPLBAA                Anna          Mcpherson\n12  AAAAAAAABDJPLBAA                Anna          Mcpherson\n13  AAAAAAAABDJPLBAA                Anna          Mcpherson\n14  AAAAAAAABDJPLBAA                Anna          Mcpherson\n15  AAAAAAAAEHFLGLAA              Johnny              Duong\n16  AAAAAAAAEHFLGLAA              Johnny              Duong\n17  AAAAAAAAEHFLGLAA              Johnny              Duong\n18  AAAAAAAAEHFLGLAA              Johnny              Duong\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017117,
                    "execution_time": 0.007484,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003576
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056155,
                    "execution_time": 0.008456,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039076
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAADGJDNFAA            Kimberly                   \n1   AAAAAAAADGJDNFAA            Kimberly                   \n2   AAAAAAAADGJDNFAA            Kimberly                   \n3   AAAAAAAADGJDNFAA            Kimberly                   \n4   AAAAAAAACMMFLDAA               Jason              Green\n5   AAAAAAAAMIGKMBAA                John              Adams\n6   AAAAAAAABAAICBAA              Raquel           Matthews\n7   AAAAAAAABAAICBAA              Raquel           Matthews\n8   AAAAAAAABAAICBAA              Raquel           Matthews\n9   AAAAAAAABAAICBAA              Raquel           Matthews\n10  AAAAAAAAHJPKADAA                Jane               Wise\n11  AAAAAAAABDJPLBAA                Anna          Mcpherson\n12  AAAAAAAABDJPLBAA                Anna          Mcpherson\n13  AAAAAAAABDJPLBAA                Anna          Mcpherson\n14  AAAAAAAABDJPLBAA                Anna          Mcpherson\n15  AAAAAAAAEHFLGLAA              Johnny              Duong\n16  AAAAAAAAEHFLGLAA              Johnny              Duong\n17  AAAAAAAAEHFLGLAA              Johnny              Duong\n18  AAAAAAAAEHFLGLAA              Johnny              Duong\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACEFGCHAA               Janet              Owens\n1   AAAAAAAACEFGCHAA               Janet              Owens\n2   AAAAAAAACEFGCHAA               Janet              Owens\n3   AAAAAAAACEFGCHAA               Janet              Owens\n4   AAAAAAAAKDPLCBAA             Rosella             Thomas\n5   AAAAAAAAJOHPMCAA               Scott               Hook\n6   AAAAAAAALGKMBIAA              Jordan           Morrison\n7   AAAAAAAACDCFHBAA           Elizabeth            Shipman\n8   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n9   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n10  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n11  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n12  AAAAAAAAJELNCHAA               James             Kinsey\n13  AAAAAAAAPOPPIEAA              Joseph             Torres\n14  AAAAAAAADIJIFJAA               James             Maurer\n15  AAAAAAAADIJIFJAA               James             Maurer\n16  AAAAAAAADIJIFJAA               James             Maurer\n17  AAAAAAAADIJIFJAA               James             Maurer\n18  AAAAAAAAPBINALAA              Thomas             Ladner\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.725398,
                    "execution_time": 2.712389,
                    "compile_time": 0.036156,
                    "planning_time": 0.005228
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.160898,
                    "execution_time": 2.686736,
                    "compile_time": 3.078335,
                    "planning_time": 0.040498
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACEFGCHAA               Janet              Owens\n1   AAAAAAAACEFGCHAA               Janet              Owens\n2   AAAAAAAACEFGCHAA               Janet              Owens\n3   AAAAAAAACEFGCHAA               Janet              Owens\n4   AAAAAAAAKDPLCBAA             Rosella             Thomas\n5   AAAAAAAAJOHPMCAA               Scott               Hook\n6   AAAAAAAALGKMBIAA              Jordan           Morrison\n7   AAAAAAAACDCFHBAA           Elizabeth            Shipman\n8   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n9   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n10  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n11  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n12  AAAAAAAAJELNCHAA               James             Kinsey\n13  AAAAAAAAPOPPIEAA              Joseph             Torres\n14  AAAAAAAADIJIFJAA               James             Maurer\n15  AAAAAAAADIJIFJAA               James             Maurer\n16  AAAAAAAADIJIFJAA               James             Maurer\n17  AAAAAAAADIJIFJAA               James             Maurer\n18  AAAAAAAAPBINALAA              Thomas             Ladner\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACEFGCHAA               Janet              Owens\n1   AAAAAAAACEFGCHAA               Janet              Owens\n2   AAAAAAAACEFGCHAA               Janet              Owens\n3   AAAAAAAACEFGCHAA               Janet              Owens\n4   AAAAAAAAKDPLCBAA             Rosella             Thomas\n5   AAAAAAAAJOHPMCAA               Scott               Hook\n6   AAAAAAAALGKMBIAA              Jordan           Morrison\n7   AAAAAAAACDCFHBAA           Elizabeth            Shipman\n8   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n9   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n10  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n11  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n12  AAAAAAAAJELNCHAA               James             Kinsey\n13  AAAAAAAAPOPPIEAA              Joseph             Torres\n14  AAAAAAAADIJIFJAA               James             Maurer\n15  AAAAAAAADIJIFJAA               James             Maurer\n16  AAAAAAAADIJIFJAA               James             Maurer\n17  AAAAAAAADIJIFJAA               James             Maurer\n18  AAAAAAAAPBINALAA              Thomas             Ladner\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.573591,
                    "execution_time": 2.558736,
                    "compile_time": 0.000151,
                    "planning_time": 0.006256
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.86086,
                    "execution_time": 2.569944,
                    "compile_time": 0.307444,
                    "planning_time": 0.041781
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACEFGCHAA               Janet              Owens\n1   AAAAAAAACEFGCHAA               Janet              Owens\n2   AAAAAAAACEFGCHAA               Janet              Owens\n3   AAAAAAAACEFGCHAA               Janet              Owens\n4   AAAAAAAAKDPLCBAA             Rosella             Thomas\n5   AAAAAAAAJOHPMCAA               Scott               Hook\n6   AAAAAAAALGKMBIAA              Jordan           Morrison\n7   AAAAAAAACDCFHBAA           Elizabeth            Shipman\n8   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n9   AAAAAAAAHNBJKCAA             Kenneth            Navarro\n10  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n11  AAAAAAAAHNBJKCAA             Kenneth            Navarro\n12  AAAAAAAAJELNCHAA               James             Kinsey\n13  AAAAAAAAPOPPIEAA              Joseph             Torres\n14  AAAAAAAADIJIFJAA               James             Maurer\n15  AAAAAAAADIJIFJAA               James             Maurer\n16  AAAAAAAADIJIFJAA               James             Maurer\n17  AAAAAAAADIJIFJAA               James             Maurer\n18  AAAAAAAAPBINALAA              Thomas             Ladner\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAADJGPPBAA               Susan             Schwab\n1   AAAAAAAADJGPPBAA               Susan             Schwab\n2   AAAAAAAADJGPPBAA               Susan             Schwab\n3   AAAAAAAADJGPPBAA               Susan             Schwab\n4   AAAAAAAADJGPPBAA               Susan             Schwab\n5   AAAAAAAADJGPPBAA               Susan             Schwab\n6   AAAAAAAADJGPPBAA               Susan             Schwab\n7   AAAAAAAADJGPPBAA               Susan             Schwab\n8   AAAAAAAADJGPPBAA               Susan             Schwab\n9   AAAAAAAADJGPPBAA               Susan             Schwab\n10  AAAAAAAADJGPPBAA               Susan             Schwab\n11  AAAAAAAADJGPPBAA               Susan             Schwab\n12  AAAAAAAADJGPPBAA               Susan             Schwab\n13  AAAAAAAADJGPPBAA               Susan             Schwab\n14  AAAAAAAADJGPPBAA               Susan             Schwab\n15  AAAAAAAADJGPPBAA               Susan             Schwab\n16  AAAAAAAADJGPPBAA               Susan             Schwab\n17  AAAAAAAADJGPPBAA               Susan             Schwab\n18  AAAAAAAADJGPPBAA               Susan             Schwab\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.559427,
                    "execution_time": 0.540142,
                    "compile_time": 0.00021,
                    "planning_time": 0.008067
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.83416,
                    "execution_time": 0.538861,
                    "compile_time": 0.224382,
                    "planning_time": 0.044657
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAADJGPPBAA               Susan             Schwab\n1   AAAAAAAADJGPPBAA               Susan             Schwab\n2   AAAAAAAADJGPPBAA               Susan             Schwab\n3   AAAAAAAADJGPPBAA               Susan             Schwab\n4   AAAAAAAADJGPPBAA               Susan             Schwab\n5   AAAAAAAADJGPPBAA               Susan             Schwab\n6   AAAAAAAADJGPPBAA               Susan             Schwab\n7   AAAAAAAADJGPPBAA               Susan             Schwab\n8   AAAAAAAADJGPPBAA               Susan             Schwab\n9   AAAAAAAADJGPPBAA               Susan             Schwab\n10  AAAAAAAADJGPPBAA               Susan             Schwab\n11  AAAAAAAADJGPPBAA               Susan             Schwab\n12  AAAAAAAADJGPPBAA               Susan             Schwab\n13  AAAAAAAADJGPPBAA               Susan             Schwab\n14  AAAAAAAADJGPPBAA               Susan             Schwab\n15  AAAAAAAADJGPPBAA               Susan             Schwab\n16  AAAAAAAADJGPPBAA               Susan             Schwab\n17  AAAAAAAADJGPPBAA               Susan             Schwab\n18  AAAAAAAADJGPPBAA               Susan             Schwab\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 29.710124,
                    "execution_time": 29.134735,
                    "compile_time": 0.000871,
                    "planning_time": 0.052467,
                    "create_size": 3200
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 40.418879,
                    "execution_time": 39.770678,
                    "compile_time": 0.006796,
                    "planning_time": 0.123855,
                    "create_size": 3200
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.462735,
                    "execution_time": 1.148869,
                    "compile_time": 0.000642,
                    "planning_time": 0.013057,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.06248,
                    "execution_time": 1.148682,
                    "compile_time": 3.536135,
                    "planning_time": 0.069338,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABOLFHJAA             Deborah               Gray\n1   AAAAAAAAFDHLKAAA               Sarah          Edmondson\n2   AAAAAAAALBFGEKAA                Faye              Ellis\n3   AAAAAAAAOMHHCEAA               Erica              Parks\n4   AAAAAAAACBDMDBAA                 Amy               Baca\n5   AAAAAAAAEGAFJFAA               Edith             Sutton\n6   AAAAAAAAJPCBPKAA              Harlan            Orlando\n7   AAAAAAAAJMOKGJAA             Richard            Sanders\n8   AAAAAAAAEMMFNFAA                                       \n9   AAAAAAAABEOEAEAA               Paula          Robertson\n10  AAAAAAAAMAAMDEAA                John           Richards\n11  AAAAAAAAPOCHEEAA            Margaret              Tapia\n12  AAAAAAAALGOGALAA               David           Burnside\n13  AAAAAAAAMJHBCJAA                                Delgado\n14  AAAAAAAALBLBFCAA              Claude          Carpenter\n15  AAAAAAAANKGLECAA              Gladys               Seay\n16  AAAAAAAAJKIDFCAA            Kathleen               Ford\n17  AAAAAAAAALCHAJAA             Stephen            Negrete\n18  AAAAAAAADJMLEBAA         Christopher             Greene\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01691,
                    "execution_time": 0.007536,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.00343
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054501,
                    "execution_time": 0.008262,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038552
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABOLFHJAA             Deborah               Gray\n1   AAAAAAAAFDHLKAAA               Sarah          Edmondson\n2   AAAAAAAALBFGEKAA                Faye              Ellis\n3   AAAAAAAAOMHHCEAA               Erica              Parks\n4   AAAAAAAACBDMDBAA                 Amy               Baca\n5   AAAAAAAAEGAFJFAA               Edith             Sutton\n6   AAAAAAAAJPCBPKAA              Harlan            Orlando\n7   AAAAAAAAJMOKGJAA             Richard            Sanders\n8   AAAAAAAAEMMFNFAA                                       \n9   AAAAAAAABEOEAEAA               Paula          Robertson\n10  AAAAAAAAMAAMDEAA                John           Richards\n11  AAAAAAAAPOCHEEAA            Margaret              Tapia\n12  AAAAAAAALGOGALAA               David           Burnside\n13  AAAAAAAAMJHBCJAA                                Delgado\n14  AAAAAAAALBLBFCAA              Claude          Carpenter\n15  AAAAAAAANKGLECAA              Gladys               Seay\n16  AAAAAAAAJKIDFCAA            Kathleen               Ford\n17  AAAAAAAAALCHAJAA             Stephen            Negrete\n18  AAAAAAAADJMLEBAA         Christopher             Greene\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAIKCPEDAA                Ruth            Wallace\n1   AAAAAAAADMHPCLAA               Lloyd           Pederson\n2   AAAAAAAANMECFHAA             Kenneth            Masters\n3   AAAAAAAAIKCPJBAA              Sallie             Thomas\n4   AAAAAAAAINIEGAAA               Avery               Wolf\n5   AAAAAAAAKKAHMAAA             Dorothy             Mcghee\n6   AAAAAAAAIEMNKEAA           Elizabeth               Wick\n7   AAAAAAAAJODAMAAA                John              Davis\n8   AAAAAAAAEAKDKJAA               Frank            Tillman\n9   AAAAAAAAMMKAEGAA              Donald            Simpson\n10  AAAAAAAAFADFBEAA               Shawn            Parsons\n11  AAAAAAAAJOHBNGAA             Cynthia              Busch\n12  AAAAAAAACIGPICAA            Virginia             Dalton\n13  AAAAAAAAELMMNDAA                                       \n14  AAAAAAAAKOGFEFAA                                       \n15  AAAAAAAAAIDCLEAA               Cecil              Green\n16  AAAAAAAAFPCPJGAA               Agnes               King\n17  AAAAAAAAKIIFLDAA             Valerie               Shaw\n18  AAAAAAAAGDNCNDAA              Robert            Frazier\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.315261,
                    "execution_time": 0.282876,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.005125
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.323047,
                    "execution_time": 0.271333,
                    "compile_time": 0.120375,
                    "planning_time": 0.0403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAIKCPEDAA                Ruth            Wallace\n1   AAAAAAAADMHPCLAA               Lloyd           Pederson\n2   AAAAAAAANMECFHAA             Kenneth            Masters\n3   AAAAAAAAIKCPJBAA              Sallie             Thomas\n4   AAAAAAAAINIEGAAA               Avery               Wolf\n5   AAAAAAAAKKAHMAAA             Dorothy             Mcghee\n6   AAAAAAAAIEMNKEAA           Elizabeth               Wick\n7   AAAAAAAAJODAMAAA                John              Davis\n8   AAAAAAAAEAKDKJAA               Frank            Tillman\n9   AAAAAAAAMMKAEGAA              Donald            Simpson\n10  AAAAAAAAFADFBEAA               Shawn            Parsons\n11  AAAAAAAAJOHBNGAA             Cynthia              Busch\n12  AAAAAAAACIGPICAA            Virginia             Dalton\n13  AAAAAAAAELMMNDAA                                       \n14  AAAAAAAAKOGFEFAA                                       \n15  AAAAAAAAAIDCLEAA               Cecil              Green\n16  AAAAAAAAFPCPJGAA               Agnes               King\n17  AAAAAAAAKIIFLDAA             Valerie               Shaw\n18  AAAAAAAAGDNCNDAA              Robert            Frazier\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0 end > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.671168,
                    "execution_time": 1.349371,
                    "compile_time": 0.000674,
                    "planning_time": 0.01451,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.885379,
                    "execution_time": 1.498085,
                    "compile_time": 0.00624,
                    "planning_time": 0.07093,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAALAPFPIAA              Sophie                Day\n1   AAAAAAAAEFFNIFAA              Judith               Kolb\n2   AAAAAAAABJNNOGAA               Ethel              Boyce\n3   AAAAAAAANENANBAA              Philip              Reyes\n4   AAAAAAAAFMIMBGAA             Jeffrey              Slade\n5   AAAAAAAAFCBJPKAA              Joshua               Rose\n6   AAAAAAAABBNACFAA               Renee            Coulter\n7   AAAAAAAAPGHIDCAA              Howard              Moran\n8   AAAAAAAAJHMICJAA              Sheila            Johnson\n9   AAAAAAAABBEIMGAA               James               Swan\n10  AAAAAAAACOEDOFAA                                       \n11  AAAAAAAACHBGBFAA               Peter         Strickland\n12  AAAAAAAAPCAPNAAA              Albert           Anderson\n13  AAAAAAAABJAALKAA              Shanna             Snyder\n14  AAAAAAAAJCNBJGAA              Darwin            Johnson\n15  AAAAAAAADGKELEAA         Christopher                   \n16  AAAAAAAABPFEGDAA            Margaret             Taylor\n17  AAAAAAAAJJADEKAA              Ernest             Taylor\n18  AAAAAAAAPLLEOFAA                Cara             Hammer\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016624,
                    "execution_time": 0.007296,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003263
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054272,
                    "execution_time": 0.00757,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038435
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAALAPFPIAA              Sophie                Day\n1   AAAAAAAAEFFNIFAA              Judith               Kolb\n2   AAAAAAAABJNNOGAA               Ethel              Boyce\n3   AAAAAAAANENANBAA              Philip              Reyes\n4   AAAAAAAAFMIMBGAA             Jeffrey              Slade\n5   AAAAAAAAFCBJPKAA              Joshua               Rose\n6   AAAAAAAABBNACFAA               Renee            Coulter\n7   AAAAAAAAPGHIDCAA              Howard              Moran\n8   AAAAAAAAJHMICJAA              Sheila            Johnson\n9   AAAAAAAABBEIMGAA               James               Swan\n10  AAAAAAAACOEDOFAA                                       \n11  AAAAAAAACHBGBFAA               Peter         Strickland\n12  AAAAAAAAPCAPNAAA              Albert           Anderson\n13  AAAAAAAABJAALKAA              Shanna             Snyder\n14  AAAAAAAAJCNBJGAA              Darwin            Johnson\n15  AAAAAAAADGKELEAA         Christopher                   \n16  AAAAAAAABPFEGDAA            Margaret             Taylor\n17  AAAAAAAAJJADEKAA              Ernest             Taylor\n18  AAAAAAAAPLLEOFAA                Cara             Hammer\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.507898,
                    "execution_time": 1.190156,
                    "compile_time": 0.00068,
                    "planning_time": 0.015552,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.105626,
                    "execution_time": 1.211297,
                    "compile_time": 3.510273,
                    "planning_time": 0.072655,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKEIBBKAA             Michael             Chavez\n1   AAAAAAAAIOGPAIAA             William             Norris\n2   AAAAAAAAKDHDNGAA               Laura             Leslie\n3   AAAAAAAAIPDDHKAA              Lorene             Horton\n4   AAAAAAAAOONNMAAA              Minnie            Simmons\n5   AAAAAAAABJPAFEAA                Paul             Buxton\n6   AAAAAAAALGONAIAA                 Ray           Robinson\n7   AAAAAAAALGOPDKAA          Marguerite         Richardson\n8   AAAAAAAALKPFOBAA            Michelle             Miller\n9   AAAAAAAAFMEIOAAA               Erica           Fletcher\n10  AAAAAAAAKBADDIAA              Robert              Finch\n11  AAAAAAAAJJIEAHAA             Michael             Wilson\n12  AAAAAAAACKBCOCAA               Vicky            Ramirez\n13  AAAAAAAAJMICCLAA                                       \n14  AAAAAAAADFGGNBAA              Robert               Wall\n15  AAAAAAAAGLKGNEAA             Maribel            Ramirez\n16  AAAAAAAABCDFJFAA             Richard             Wagner\n17  AAAAAAAAMJJGJBAA         Christopher           Guerrero\n18  AAAAAAAALNLGBLAA               Karen              Mabry\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016831,
                    "execution_time": 0.007536,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053778,
                    "execution_time": 0.007616,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038632
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKEIBBKAA             Michael             Chavez\n1   AAAAAAAAIOGPAIAA             William             Norris\n2   AAAAAAAAKDHDNGAA               Laura             Leslie\n3   AAAAAAAAIPDDHKAA              Lorene             Horton\n4   AAAAAAAAOONNMAAA              Minnie            Simmons\n5   AAAAAAAABJPAFEAA                Paul             Buxton\n6   AAAAAAAALGONAIAA                 Ray           Robinson\n7   AAAAAAAALGOPDKAA          Marguerite         Richardson\n8   AAAAAAAALKPFOBAA            Michelle             Miller\n9   AAAAAAAAFMEIOAAA               Erica           Fletcher\n10  AAAAAAAAKBADDIAA              Robert              Finch\n11  AAAAAAAAJJIEAHAA             Michael             Wilson\n12  AAAAAAAACKBCOCAA               Vicky            Ramirez\n13  AAAAAAAAJMICCLAA                                       \n14  AAAAAAAADFGGNBAA              Robert               Wall\n15  AAAAAAAAGLKGNEAA             Maribel            Ramirez\n16  AAAAAAAABCDFJFAA             Richard             Wagner\n17  AAAAAAAAMJJGJBAA         Christopher           Guerrero\n18  AAAAAAAALNLGBLAA               Karen              Mabry\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER_LAST_NAME\" , \"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAACNAAA                                       \n1   AAAAAAAAAAAEABAA                                       \n2   AAAAAAAAAAAEAHAA                                       \n3   AAAAAAAAAAAGBKAA                                       \n4   AAAAAAAAAAAHLHAA                                       \n5   AAAAAAAAAAANKJAA                                       \n6   AAAAAAAAAAAOPAAA                                       \n7   AAAAAAAAAAAPOBAA                                       \n8   AAAAAAAAAAAPPBAA                                       \n9   AAAAAAAAAABBFBAA                                       \n10  AAAAAAAAAABBJHAA                                       \n11  AAAAAAAAAABBMFAA                                       \n12  AAAAAAAAAABBNJAA                                       \n13  AAAAAAAAAABCNIAA                                       \n14  AAAAAAAAAABEHGAA                                       \n15  AAAAAAAAAABLKEAA                                       \n16  AAAAAAAAAABLMCAA                                       \n17  AAAAAAAAAABMEGAA                                       \n18  AAAAAAAAAACADIAA                                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031734,
                    "execution_time": 0.021855,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003631
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.215562,
                    "execution_time": 0.021619,
                    "compile_time": 0.148213,
                    "planning_time": 0.038967
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAACNAAA                                       \n1   AAAAAAAAAAAEABAA                                       \n2   AAAAAAAAAAAEAHAA                                       \n3   AAAAAAAAAAAGBKAA                                       \n4   AAAAAAAAAAAHLHAA                                       \n5   AAAAAAAAAAANKJAA                                       \n6   AAAAAAAAAAAOPAAA                                       \n7   AAAAAAAAAAAPOBAA                                       \n8   AAAAAAAAAAAPPBAA                                       \n9   AAAAAAAAAABBFBAA                                       \n10  AAAAAAAAAABBJHAA                                       \n11  AAAAAAAAAABBMFAA                                       \n12  AAAAAAAAAABBNJAA                                       \n13  AAAAAAAAAABCNIAA                                       \n14  AAAAAAAAAABEHGAA                                       \n15  AAAAAAAAAABLKEAA                                       \n16  AAAAAAAAAABLMCAA                                       \n17  AAAAAAAAAABMEGAA                                       \n18  AAAAAAAAAACADIAA                                       \n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER_LAST_NAME\" , \"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAACNAAA                                       \n1   AAAAAAAAAAAEABAA                                       \n2   AAAAAAAAAAAEAHAA                                       \n3   AAAAAAAAAAAGBKAA                                       \n4   AAAAAAAAAAAHLHAA                                       \n5   AAAAAAAAAAANKJAA                                       \n6   AAAAAAAAAAAOPAAA                                       \n7   AAAAAAAAAAAPOBAA                                       \n8   AAAAAAAAAAAPPBAA                                       \n9   AAAAAAAAAABBFBAA                                       \n10  AAAAAAAAAABBJHAA                                       \n11  AAAAAAAAAABBMFAA                                       \n12  AAAAAAAAAABBNJAA                                       \n13  AAAAAAAAAABCNIAA                                       \n14  AAAAAAAAAABEHGAA                                       \n15  AAAAAAAAAABLKEAA                                       \n16  AAAAAAAAAABLMCAA                                       \n17  AAAAAAAAAABMEGAA                                       \n18  AAAAAAAAAACADIAA                                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030608,
                    "execution_time": 0.021026,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003669
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.03105,
                    "execution_time": 0.021051,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003837
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAACNAAA                                       \n1   AAAAAAAAAAAEABAA                                       \n2   AAAAAAAAAAAEAHAA                                       \n3   AAAAAAAAAAAGBKAA                                       \n4   AAAAAAAAAAAHLHAA                                       \n5   AAAAAAAAAAANKJAA                                       \n6   AAAAAAAAAAAOPAAA                                       \n7   AAAAAAAAAAAPOBAA                                       \n8   AAAAAAAAAAAPPBAA                                       \n9   AAAAAAAAAABBFBAA                                       \n10  AAAAAAAAAABBJHAA                                       \n11  AAAAAAAAAABBMFAA                                       \n12  AAAAAAAAAABBNJAA                                       \n13  AAAAAAAAAABCNIAA                                       \n14  AAAAAAAAAABEHGAA                                       \n15  AAAAAAAAAABLKEAA                                       \n16  AAAAAAAAAABLMCAA                                       \n17  AAAAAAAAAABMEGAA                                       \n18  AAAAAAAAAACADIAA                                       \n...*/"
    }
]