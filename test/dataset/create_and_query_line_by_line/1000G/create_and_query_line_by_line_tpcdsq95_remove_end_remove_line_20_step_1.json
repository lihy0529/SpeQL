[
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.WS_ORDER_NUMBER, ws1.WS_WAREHOUSE_SK as wh1, ws2.WS_WAREHOUSE_SK as wh2\n from web_sales ws1, web_sales ws2\n where ws1.WS_ORDER_NUMBER = ws2.WS_ORDER_NUMBER\n   and ws1.WS_WAREHOUSE_SK <> ws2.WS_WAREHOUSE_SK)\n select  \n   count(distinct ws1.WS_ORDER_NUMBER) as \"order count\"\n  ,sum(ws1.WS_EXT_SHIP_COST) as \"total shipping cost\"\n  ,sum(ws1.WS_NET_PROFIT) as \"total net profit\"\nfrom web_sales ws1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0     60000000         9.176938e+11     -1.838548e+11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 4.240074,
                    "execution_time": 4.198434,
                    "compile_time": 0.000126,
                    "planning_time": 0.031989
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.380384,
                    "execution_time": 4.33752,
                    "compile_time": 0.000129,
                    "planning_time": 0.033192
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\"",
                "rewrite": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\""
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0     60000000         9.176938e+11     -1.838548e+11*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_wh.ws_order_number) as \"order count\"\n  ,sum((select ws_ext_ship_cost from web_sales where ws_order_number = ws_wh.ws_order_number limit 1)) as \"total shipping cost\"\n  ,sum((select ws_net_profit from web_sales where ws_order_number = ws_wh.ws_order_number limit 1)) as \"total net profit\"\nfrom ws_wh\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( ( SELECT \"WEB_SALES\".\"WS_EXT_SHIP_COST\" AS \"WS_EXT_SHIP_COST\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1 ) ) AS \"TOTAL SHIPPING COST\" , SUM ( ( SELECT \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"WS_NET_PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1 ) ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( ( SELECT \"WEB_SALES\".\"WS_EXT_SHIP_COST\" AS \"WS_EXT_SHIP_COST\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1 ) ) AS \"TOTAL SHIPPING COST\" , SUM ( ( SELECT \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"WS_NET_PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1 ) ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\"",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM((SELECT \"WEB_SALES\".\"WS_EXT_SHIP_COST\" AS \"WS_EXT_SHIP_COST\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1)) AS \"TOTAL SHIPPING COST\", SUM((SELECT \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"WS_NET_PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1)) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( ( SELECT \"WEB_SALES\".\"WS_EXT_SHIP_COST\" AS \"WS_EXT_SHIP_COST\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1 ) ) AS \"TOTAL SHIPPING COST\" , SUM ( ( SELECT \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"WS_NET_PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LIMIT 1 ) ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0     60000000         9.176938e+11     -1.838548e+11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 4.238964,
                    "execution_time": 4.196829,
                    "compile_time": 0.000131,
                    "planning_time": 0.032644
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.360619,
                    "execution_time": 4.318912,
                    "compile_time": 0.000111,
                    "planning_time": 0.031954
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\"",
                "rewrite": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\""
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0     60000000         9.176938e+11     -1.838548e+11*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and '2002-03-31' \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2002-03-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2002-03-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2002-03-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2002-03-31' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2002-03-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0      5571407         1.600648e+12     -3.210841e+11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 4.096442,
                    "execution_time": 4.026376,
                    "compile_time": 0.000268,
                    "planning_time": 0.054256
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.543532,
                    "execution_time": 5.382638,
                    "compile_time": 0.000297,
                    "planning_time": 0.142501
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0      5571407         1.600648e+12     -3.210841e+11*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0       171907         4.941691e+10     -9.761686e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.417961,
                    "execution_time": 0.346802,
                    "compile_time": 0.000282,
                    "planning_time": 0.055295
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.50447,
                    "execution_time": 0.351473,
                    "compile_time": 0.000283,
                    "planning_time": 0.134547
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0       171907         4.941691e+10     -9.761686e+09*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0       171907         9.150803e+08     -1.807141e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.275401,
                    "execution_time": 0.203116,
                    "compile_time": 0.000283,
                    "planning_time": 0.055991
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.072995,
                    "execution_time": 0.921085,
                    "compile_time": 0.000287,
                    "planning_time": 0.13415
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0       171907         9.150803e+08     -1.807141e+08*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.281107,
                    "execution_time": 0.208376,
                    "compile_time": 0.000287,
                    "planning_time": 0.056234
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.460811,
                    "execution_time": 0.210432,
                    "compile_time": 0.09765,
                    "planning_time": 0.134745
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2002-03-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number from ws_wh\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" GROUP BY \"WS1\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"WS_ORDER_NUMBER\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" GROUP BY \"WS1\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 43.131289,
                    "execution_time": 43.022902,
                    "compile_time": 0.000349,
                    "planning_time": 0.033532,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 47.119714,
                    "execution_time": 42.552924,
                    "compile_time": 4.388691,
                    "planning_time": 0.09844,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN ( SELECT WS_ORDER_NUMBER FROM WS_WH ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.224895,
                    "execution_time": 1.120385,
                    "compile_time": 0.000501,
                    "planning_time": 0.080103
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.358661,
                    "execution_time": 1.703642,
                    "compile_time": 7.475684,
                    "planning_time": 0.150656
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n                            from ws_wh)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" GROUP BY \"WS1\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"WS_ORDER_NUMBER\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN ( SELECT WS_ORDER_NUMBER FROM WS_WH ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.22967,
                    "execution_time": 1.133157,
                    "compile_time": 0.000492,
                    "planning_time": 0.071939
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.221002,
                    "execution_time": 1.126084,
                    "compile_time": 0.0005,
                    "planning_time": 0.070492
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.WS_WAREHOUSE_SK as wh1,ws2.WS_WAREHOUSE_SK as wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.WS_WAREHOUSE_SK <> ws2.WS_WAREHOUSE_SK)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim dd\n  ,customer_address ca\n  ,web_site ws\nwhere\n    dd.d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.WS_SHIP_DATE_SK = dd.d_date_sk\nand ws1.WS_SHIP_ADDR_SK = ca.ca_address_sk\nand ca.ca_state = 'IA'\nand ws1.WS_WEB_SITE_SK = ws.web_site_sk\nand ws.web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n                            from ws_wh)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" GROUP BY \"WS1\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"CA\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CA\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DD\" ON \"DD\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DD\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DD\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WS\" ON \"WS\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WS\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"WS_ORDER_NUMBER\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM AS DD , CUSTOMER_ADDRESS AS CA , WEB_SITE AS WS WHERE DD.D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = DD.D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA.CA_ADDRESS_SK AND CA.CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WS.WEB_SITE_SK AND WS.WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN ( SELECT WS_ORDER_NUMBER FROM WS_WH ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.230747,
                    "execution_time": 1.135867,
                    "compile_time": 0.000486,
                    "planning_time": 0.070495
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.307125,
                    "execution_time": 1.130784,
                    "compile_time": 0.000493,
                    "planning_time": 0.151515
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"CA\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CA\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DD\" ON \"DD\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DD\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DD\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WS\" ON \"WS\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WS\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        62619         1.015444e+08      -20632197.93*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n                            from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n                            from web_returns,ws_wh\n                            where wr_order_number = ws_wh.ws_order_number)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WS_WH\" AS ( SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" ) , \"_U_0\" AS ( SELECT \"WS_WH\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WS_WH\" AS \"WS_WH\" GROUP BY \"WS_WH\".\"WS_ORDER_NUMBER\" ) , \"_U_1\" AS ( SELECT \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" AS \"WR_ORDER_NUMBER\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"WS_WH\" AS \"WS_WH\" ON \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WS_WH\".\"WS_ORDER_NUMBER\" GROUP BY \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"WR_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"WS_ORDER_NUMBER\" IS NULL AND NOT \"_U_1\".\"WR_ORDER_NUMBER\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.937216,
                    "execution_time": 0.864276,
                    "compile_time": 0.000243,
                    "planning_time": 0.003124,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.163807,
                    "execution_time": 0.853755,
                    "compile_time": 0.178476,
                    "planning_time": 0.060036,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.455297,
                    "execution_time": 1.38025,
                    "compile_time": 0.000254,
                    "planning_time": 0.003419,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.686062,
                    "execution_time": 1.380066,
                    "compile_time": 0.138411,
                    "planning_time": 0.094399,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" AS \"WR_ORDER_NUMBER\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"SPEQLITE_TEMP_TABLE_2\".\"WS_ORDER_NUMBER\" GROUP BY \"WEB_RETURNS\".\"WR_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.762474,
                    "execution_time": 1.66066,
                    "compile_time": 0.000351,
                    "planning_time": 0.027452,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.003719,
                    "execution_time": 1.702296,
                    "compile_time": 0.13205,
                    "planning_time": 0.092097,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN ( SELECT WS_ORDER_NUMBER FROM WS_WH ) AND WS1.WS_ORDER_NUMBER IN ( SELECT WR_ORDER_NUMBER FROM WEB_RETURNS , WS_WH WHERE WR_ORDER_NUMBER = WS_WH.WS_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        45209          74038821.84      -15387408.02*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.270603,
                    "execution_time": 1.151431,
                    "compile_time": 0.000543,
                    "planning_time": 0.093463
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.454499,
                    "execution_time": 1.145852,
                    "compile_time": 0.102629,
                    "planning_time": 0.179089
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"WR_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_3\".\"WS_ORDER_NUMBER\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"WR_ORDER_NUMBER\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        45209          74038821.84      -15387408.02*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n                            from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n                            from web_returns,ws_wh\n                            where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WS_WH\" AS ( SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" ) , \"_U_0\" AS ( SELECT \"WS_WH\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WS_WH\" AS \"WS_WH\" GROUP BY \"WS_WH\".\"WS_ORDER_NUMBER\" ) , \"_U_1\" AS ( SELECT \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" AS \"WR_ORDER_NUMBER\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"WS_WH\" AS \"WS_WH\" ON \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WS_WH\".\"WS_ORDER_NUMBER\" GROUP BY \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"WR_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"WS_ORDER_NUMBER\" IS NULL AND NOT \"_U_1\".\"WR_ORDER_NUMBER\" IS NULL ORDER BY COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN ( SELECT WS_ORDER_NUMBER FROM WS_WH ) AND WS1.WS_ORDER_NUMBER IN ( SELECT WR_ORDER_NUMBER FROM WEB_RETURNS , WS_WH WHERE WR_ORDER_NUMBER = WS_WH.WS_ORDER_NUMBER ) ORDER BY COUNT ( DISTINCT WS_ORDER_NUMBER ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        45209          74038821.84      -15387408.02*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.260755,
                    "execution_time": 1.141933,
                    "compile_time": 0.000531,
                    "planning_time": 0.093436
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.343261,
                    "execution_time": 1.141717,
                    "compile_time": 0.000535,
                    "planning_time": 0.175684
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"WR_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_3\".\"WS_ORDER_NUMBER\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"WR_ORDER_NUMBER\" IS NULL ORDER BY COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        45209          74038821.84      -15387408.02*/"
    },
    {
        "input": "-- start template query95.tpl query 43 in stream 0\nwith /* TPC-DS query95.tpl 0.43 */ ws_wh as\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\n from web_sales ws1,web_sales ws2\n where ws1.ws_order_number = ws2.ws_order_number\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-3-01' and \n           dateadd(day,60,cast('2002-3-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'IA'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand ws1.ws_order_number in (select ws_order_number\n                            from ws_wh)\nand ws1.ws_order_number in (select wr_order_number\n                            from web_returns,ws_wh\n                            where wr_order_number = ws_wh.ws_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WS_WH\" AS ( SELECT \"WS1\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"WEB_SALES\" AS \"WS2\" ON \"WS1\".\"WS_ORDER_NUMBER\" = \"WS2\".\"WS_ORDER_NUMBER\" AND \"WS1\".\"WS_WAREHOUSE_SK\" <> \"WS2\".\"WS_WAREHOUSE_SK\" ) , \"_U_0\" AS ( SELECT \"WS_WH\".\"WS_ORDER_NUMBER\" AS \"WS_ORDER_NUMBER\" FROM \"WS_WH\" AS \"WS_WH\" GROUP BY \"WS_WH\".\"WS_ORDER_NUMBER\" ) , \"_U_1\" AS ( SELECT \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" AS \"WR_ORDER_NUMBER\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"WS_WH\" AS \"WS_WH\" ON \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WS_WH\".\"WS_ORDER_NUMBER\" GROUP BY \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"WR_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"WS_ORDER_NUMBER\" IS NULL AND NOT \"_U_1\".\"WR_ORDER_NUMBER\" IS NULL ORDER BY COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH WS_WH AS ( SELECT WS1.WS_ORDER_NUMBER , WS1.WS_WAREHOUSE_SK AS WH1 , WS2.WS_WAREHOUSE_SK AS WH2 FROM WEB_SALES AS WS1 , WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2002-03-01' AND DATEADD ( DAY , 60 , CAST ( '2002-03-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'IA' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN ( SELECT WS_ORDER_NUMBER FROM WS_WH ) AND WS1.WS_ORDER_NUMBER IN ( SELECT WR_ORDER_NUMBER FROM WEB_RETURNS , WS_WH WHERE WR_ORDER_NUMBER = WS_WH.WS_ORDER_NUMBER ) ORDER BY COUNT ( DISTINCT WS_ORDER_NUMBER ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        45209          74038821.84      -15387408.02*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.267206,
                    "execution_time": 1.146293,
                    "compile_time": 0.000556,
                    "planning_time": 0.095235
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.264585,
                    "execution_time": 1.147862,
                    "compile_time": 0.000556,
                    "planning_time": 0.091025
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"WS_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"WR_ORDER_NUMBER\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'IA' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2002-03-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_3\".\"WS_ORDER_NUMBER\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"WR_ORDER_NUMBER\" IS NULL ORDER BY COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        45209          74038821.84      -15387408.02*/"
    }
]