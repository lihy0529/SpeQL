[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk \ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk\n/*CURSOR_IDENTIFIER*/\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) \ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 20.667459,
                    "execution_time": 20.108254,
                    "compile_time": 0.000643,
                    "planning_time": 0.05513,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 20.124414,
                    "execution_time": 19.46247,
                    "compile_time": 0.000666,
                    "planning_time": 0.136109,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                      science                                          6       0.42             260.41\n1                  accessories                                          3     237.42             260.41\n2              dvd/vcr players                                          3      47.32             260.41\n3               athletic shoes                                          1      17.85             260.41\n4                        pants                                          6       4.49             260.41\n5                   basketball                                          7       9.40             260.41\n6                      earings                                          4      10.79             260.41\n7                          pop                                          3     115.17             260.41\n8               sports-apparel                                          6      35.59             260.41\n9                      bedding                                         12      14.31             260.41\n10                  basketball                                          3      31.91             260.41\n11                         pop                                          6      19.44             260.41\n12                 televisions                                          3      58.96             260.41\n13                    diamonds                                          1      62.92             260.41\n14                      estate                                          2       1.32             260.41\n15                    monitors                                          3      22.59             260.41\n16              sports-apparel                                          8     163.99             260.41\n17                    athletic                                          6     101.71             260.41\n18                  mattresses                                          1      50.68             260.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018599,
                    "execution_time": 0.00777,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004341
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057492,
                    "execution_time": 0.008387,
                    "compile_time": 5e-05,
                    "planning_time": 0.040006
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                      science                                          6       0.42             260.41\n1                  accessories                                          3     237.42             260.41\n2              dvd/vcr players                                          3      47.32             260.41\n3               athletic shoes                                          1      17.85             260.41\n4                        pants                                          6       4.49             260.41\n5                   basketball                                          7       9.40             260.41\n6                      earings                                          4      10.79             260.41\n7                          pop                                          3     115.17             260.41\n8               sports-apparel                                          6      35.59             260.41\n9                      bedding                                         12      14.31             260.41\n10                  basketball                                          3      31.91             260.41\n11                         pop                                          6      19.44             260.41\n12                 televisions                                          3      58.96             260.41\n13                    diamonds                                          1      62.92             260.41\n14                      estate                                          2       1.32             260.41\n15                    monitors                                          3      22.59             260.41\n16              sports-apparel                                          8     163.99             260.41\n17                    athletic                                          6     101.71             260.41\n18                  mattresses                                          1      50.68             260.41\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n      i_category in ('Shoes','Men','Music')\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.087595,
                    "execution_time": 4.984061,
                    "compile_time": 0.000578,
                    "planning_time": 0.056907,
                    "create_size": 176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.126614,
                    "execution_time": 4.940034,
                    "compile_time": 0.000551,
                    "planning_time": 0.1362,
                    "create_size": 176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel                 able        Unknown     12    9298.01            5785.64\n1         Men     accessories                 able        Unknown     10    3362.83            5785.64\n2         Men  sports-apparel                 able        Unknown      2    2970.97            5785.64\n3         Men     accessories                 able        Unknown     11    5465.68            5785.64\n4         Men  sports-apparel                 able        Unknown      1    3643.97            5785.64\n5         Men     accessories                 able        Unknown      1    2204.00            5785.64\n6         Men                                 able        Unknown     11   21586.32            5785.64\n7         Men  sports-apparel                 able        Unknown     11    9483.18            5785.64\n8         Men           pants                 able        Unknown     11    6479.86            5785.64\n9         Men           pants                 able        Unknown      3    1442.60            5785.64\n10        Men                                 able        Unknown      3    5734.93            5785.64\n11        Men          shirts                 able        Unknown      3    4747.65            5785.64\n12        Men          shirts                 able        Unknown      5    5357.63            5785.64\n13        Men  sports-apparel                 able        Unknown      5    2382.89            5785.64\n14        Men           pants                 able        Unknown      7    1550.14            5785.64\n15        Men                                 able        Unknown      7    6548.43            5785.64\n16        Men           pants                 able        Unknown      4    1343.71            5785.64\n17        Men          shirts                 able        Unknown      4    4703.61            5785.64\n18        Men     accessories                 able        Unknown      2    1483.59            5785.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020926,
                    "execution_time": 0.008088,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.004564
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057346,
                    "execution_time": 0.007394,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.04044
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel                 able        Unknown     12    9298.01            5785.64\n1         Men     accessories                 able        Unknown     10    3362.83            5785.64\n2         Men  sports-apparel                 able        Unknown      2    2970.97            5785.64\n3         Men     accessories                 able        Unknown     11    5465.68            5785.64\n4         Men  sports-apparel                 able        Unknown      1    3643.97            5785.64\n5         Men     accessories                 able        Unknown      1    2204.00            5785.64\n6         Men                                 able        Unknown     11   21586.32            5785.64\n7         Men  sports-apparel                 able        Unknown     11    9483.18            5785.64\n8         Men           pants                 able        Unknown     11    6479.86            5785.64\n9         Men           pants                 able        Unknown      3    1442.60            5785.64\n10        Men                                 able        Unknown      3    5734.93            5785.64\n11        Men          shirts                 able        Unknown      3    4747.65            5785.64\n12        Men          shirts                 able        Unknown      5    5357.63            5785.64\n13        Men  sports-apparel                 able        Unknown      5    2382.89            5785.64\n14        Men           pants                 able        Unknown      7    1550.14            5785.64\n15        Men                                 able        Unknown      7    6548.43            5785.64\n16        Men           pants                 able        Unknown      4    1343.71            5785.64\n17        Men          shirts                 able        Unknown      4    4703.61            5785.64\n18        Men     accessories                 able        Unknown      2    1483.59            5785.64\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical'))\n          )\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n) /* Added the missing closing parenthesis and GROUP BY clause for the outer select subquery */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.749409,
                    "execution_time": 1.656943,
                    "compile_time": 0.000582,
                    "planning_time": 0.061009,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.896836,
                    "execution_time": 1.712997,
                    "compile_time": 0.000585,
                    "planning_time": 0.147571,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy   sum_sales  avg_monthly_sales\n0         Men  sports-apparel                                                      3      400.38             316.71\n1         Men  sports-apparel                                                      6      124.00             316.71\n2         Men  sports-apparel                                                      8      371.19             316.71\n3         Men  sports-apparel                                                      1      109.50             316.71\n4         Men  sports-apparel                                                     10      332.82             316.71\n5         Men  sports-apparel                                                     12      757.01             316.71\n6         Men  sports-apparel                                                      7       38.09             316.71\n7         Men  sports-apparel                                                      2       37.56             316.71\n8         Men  sports-apparel                                                      9      342.93             316.71\n9         Men  sports-apparel                                                      5      282.13             316.71\n10        Men  sports-apparel                                                     11      688.21             316.71\n11        Men  sports-apparel                              ese                     6       75.22             112.51\n12        Men  sports-apparel                              ese                     9      284.48             112.51\n13        Men  sports-apparel                              ese                     1       45.25             112.51\n14        Men  sports-apparel                              ese                     3      125.65             112.51\n15        Men  sports-apparel                              ese                     2      146.10             112.51\n16        Men  sports-apparel                              ese                    12       18.34             112.51\n17        Men  sports-apparel                              ese                    10      120.43             112.51\n18        Men  sports-apparel                              ese                     8       63.34             112.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018068,
                    "execution_time": 0.00731,
                    "compile_time": 5e-05,
                    "planning_time": 0.00425
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057164,
                    "execution_time": 0.008015,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040101
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy   sum_sales  avg_monthly_sales\n0         Men  sports-apparel                                                      3      400.38             316.71\n1         Men  sports-apparel                                                      6      124.00             316.71\n2         Men  sports-apparel                                                      8      371.19             316.71\n3         Men  sports-apparel                                                      1      109.50             316.71\n4         Men  sports-apparel                                                     10      332.82             316.71\n5         Men  sports-apparel                                                     12      757.01             316.71\n6         Men  sports-apparel                                                      7       38.09             316.71\n7         Men  sports-apparel                                                      2       37.56             316.71\n8         Men  sports-apparel                                                      9      342.93             316.71\n9         Men  sports-apparel                                                      5      282.13             316.71\n10        Men  sports-apparel                                                     11      688.21             316.71\n11        Men  sports-apparel                              ese                     6       75.22             112.51\n12        Men  sports-apparel                              ese                     9      284.48             112.51\n13        Men  sports-apparel                              ese                     1       45.25             112.51\n14        Men  sports-apparel                              ese                     3      125.65             112.51\n15        Men  sports-apparel                              ese                     2      146.10             112.51\n16        Men  sports-apparel                              ese                    12       18.34             112.51\n17        Men  sports-apparel                              ese                    10      120.43             112.51\n18        Men  sports-apparel                              ese                     8       63.34             112.51\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n) /* Added closing parenthesis for the inner subquery */\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n\n) /* Removed redundant parentheses and fixed grouping position */\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   i_category    i_class             i_brand s_store_name s_company_name  d_moy   sum_sales  avg_monthly_sales\n0       Music  classical  edu packscholar #1         eing        Unknown     11  7347208.72         3831352.46\n1       Music  classical  edu packscholar #1         eing        Unknown      3  2190208.07         3831352.46\n2       Music  classical  edu packscholar #1         eing        Unknown      8  4945797.37         3831352.46\n3       Music  classical  edu packscholar #1         eing        Unknown      7  2247892.75         3831352.46\n4       Music  classical  edu packscholar #2         eing        Unknown      1  1336687.57         1913869.50\n5       Music  classical  edu packscholar #2         eing        Unknown     10  2555065.98         1913869.50\n6       Music  classical  edu packscholar #2         eing        Unknown      3  1110238.40         1913869.50\n7       Music  classical  edu packscholar #2         eing        Unknown     12  3854473.85         1913869.50\n8       Music  classical  edu packscholar #2         eing        Unknown      7  1145188.12         1913869.50\n9       Music  classical  edu packscholar #2         eing        Unknown      2  1022413.25         1913869.50\n10      Music  classical  edu packscholar #2         eing        Unknown      5  1134555.82         1913869.50\n11      Music  classical  edu packscholar #2         eing        Unknown      8  2464036.26         1913869.50\n12      Music  classical  edu packscholar #2         eing        Unknown      4  1092646.16         1913869.50\n13      Music  classical  edu packscholar #2         eing        Unknown      9  2464474.26         1913869.50\n14      Music  classical  edu packscholar #2         eing        Unknown      6  1091970.94         1913869.50\n15      Music  classical  edu packscholar #2         eing        Unknown     11  3694683.39         1913869.50\n16      Shoes       kids                            ation        Unknown      5      608.83            1507.39\n17      Shoes       kids                            ation        Unknown      2      965.32            1507.39\n18      Shoes       kids                            ation        Unknown     12     3242.73            1507.39\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018731,
                    "execution_time": 0.007797,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004302
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019053,
                    "execution_time": 0.007743,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004477
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   i_category    i_class             i_brand s_store_name s_company_name  d_moy   sum_sales  avg_monthly_sales\n0       Music  classical  edu packscholar #1         eing        Unknown     11  7347208.72         3831352.46\n1       Music  classical  edu packscholar #1         eing        Unknown      3  2190208.07         3831352.46\n2       Music  classical  edu packscholar #1         eing        Unknown      8  4945797.37         3831352.46\n3       Music  classical  edu packscholar #1         eing        Unknown      7  2247892.75         3831352.46\n4       Music  classical  edu packscholar #2         eing        Unknown      1  1336687.57         1913869.50\n5       Music  classical  edu packscholar #2         eing        Unknown     10  2555065.98         1913869.50\n6       Music  classical  edu packscholar #2         eing        Unknown      3  1110238.40         1913869.50\n7       Music  classical  edu packscholar #2         eing        Unknown     12  3854473.85         1913869.50\n8       Music  classical  edu packscholar #2         eing        Unknown      7  1145188.12         1913869.50\n9       Music  classical  edu packscholar #2         eing        Unknown      2  1022413.25         1913869.50\n10      Music  classical  edu packscholar #2         eing        Unknown      5  1134555.82         1913869.50\n11      Music  classical  edu packscholar #2         eing        Unknown      8  2464036.26         1913869.50\n12      Music  classical  edu packscholar #2         eing        Unknown      4  1092646.16         1913869.50\n13      Music  classical  edu packscholar #2         eing        Unknown      9  2464474.26         1913869.50\n14      Music  classical  edu packscholar #2         eing        Unknown      6  1091970.94         1913869.50\n15      Music  classical  edu packscholar #2         eing        Unknown     11  3694683.39         1913869.50\n16      Shoes       kids                            ation        Unknown      5      608.83            1507.39\n17      Shoes       kids                            ation        Unknown      2      965.32            1507.39\n18      Shoes       kids                            ation        Unknown     12     3242.73            1507.39\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\ns_store_name, s_company_name, d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\n/*CURSOR_IDENTIFIER*/\ngroup by i_category, i_class, i_brand,\ns_store_name, s_company_name, d_moy\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.503425,
                    "execution_time": 6.237107,
                    "compile_time": 0.000651,
                    "planning_time": 0.064825,
                    "create_size": 1012
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.327037,
                    "execution_time": 6.206019,
                    "compile_time": 3.773148,
                    "planning_time": 0.142697,
                    "create_size": 1012
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category      i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  disk drives  amalgamalgamalg #1         able        Unknown     11  170119.83           87958.11\n1   Electronics  disk drives  amalgamalgamalg #1         able        Unknown     10  115921.00           87958.11\n2   Electronics  disk drives  amalgamalgamalg #1         able        Unknown     12  176067.14           87958.11\n3   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      6   49159.38           87958.11\n4   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      7   52697.39           87958.11\n5   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      8  108823.29           87958.11\n6   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      1   64302.82           87958.11\n7   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      3   51957.21           87958.11\n8   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      2   47368.65           87958.11\n9   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      5   54291.52           87958.11\n10  Electronics  disk drives  amalgamalgamalg #1         able        Unknown      9  110633.78           87958.11\n11  Electronics  disk drives  amalgamalgamalg #1         able        Unknown      4   54155.35           87958.11\n12  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown     10  118412.80           87499.79\n13  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      8  114226.50           87499.79\n14  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown     11  170440.94           87499.79\n15  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown     12  175395.80           87499.79\n16  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      3   51537.23           87499.79\n17  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      1   58009.53           87499.79\n18  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      2   45820.25           87499.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019171,
                    "execution_time": 0.007977,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004448
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05731,
                    "execution_time": 0.007657,
                    "compile_time": 5e-05,
                    "planning_time": 0.040449
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category      i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  disk drives  amalgamalgamalg #1         able        Unknown     11  170119.83           87958.11\n1   Electronics  disk drives  amalgamalgamalg #1         able        Unknown     10  115921.00           87958.11\n2   Electronics  disk drives  amalgamalgamalg #1         able        Unknown     12  176067.14           87958.11\n3   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      6   49159.38           87958.11\n4   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      7   52697.39           87958.11\n5   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      8  108823.29           87958.11\n6   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      1   64302.82           87958.11\n7   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      3   51957.21           87958.11\n8   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      2   47368.65           87958.11\n9   Electronics  disk drives  amalgamalgamalg #1         able        Unknown      5   54291.52           87958.11\n10  Electronics  disk drives  amalgamalgamalg #1         able        Unknown      9  110633.78           87958.11\n11  Electronics  disk drives  amalgamalgamalg #1         able        Unknown      4   54155.35           87958.11\n12  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown     10  118412.80           87499.79\n13  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      8  114226.50           87499.79\n14  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown     11  170440.94           87499.79\n15  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown     12  175395.80           87499.79\n16  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      3   51537.23           87499.79\n17  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      1   58009.53           87499.79\n18  Electronics  disk drives  amalgamalgamalg #1          bar        Unknown      2   45820.25           87499.79\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics           karoke                  ese        Unknown      9    2179.52            3696.68\n1   Electronics          musical                  ese        Unknown      9    4335.39            3696.68\n2   Electronics           karoke                  ese        Unknown      1    1281.26            3696.68\n3   Electronics          musical                  ese        Unknown      1    2519.94            3696.68\n4   Electronics          musical                  ese        Unknown      2    1543.93            3696.68\n5   Electronics         scanners                  ese        Unknown      3    2049.60            3696.68\n6   Electronics      televisions                  ese        Unknown      1    1173.55            3696.68\n7   Electronics          musical                  ese        Unknown      4    2089.02            3696.68\n8   Electronics           karoke                  ese        Unknown      2     516.45            3696.68\n9   Electronics      televisions                  ese        Unknown     12    3249.26            3696.68\n10  Electronics          musical                  ese        Unknown      5    2014.56            3696.68\n11  Electronics                                   ese        Unknown      2    5761.99            3696.68\n12  Electronics         scanners                  ese        Unknown      2    2000.74            3696.68\n13  Electronics      televisions                  ese        Unknown      6    1162.58            3696.68\n14  Electronics           karoke                  ese        Unknown      4     985.66            3696.68\n15  Electronics           karoke                  ese        Unknown     12    3105.19            3696.68\n16  Electronics  dvd/vcr players                  ese        Unknown      5    1223.86            3696.68\n17  Electronics                                   ese        Unknown      5    7796.95            3696.68\n18  Electronics           karoke                  ese        Unknown      5     700.91            3696.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019549,
                    "execution_time": 0.00823,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018886,
                    "execution_time": 0.007588,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004557
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics           karoke                  ese        Unknown      9    2179.52            3696.68\n1   Electronics          musical                  ese        Unknown      9    4335.39            3696.68\n2   Electronics           karoke                  ese        Unknown      1    1281.26            3696.68\n3   Electronics          musical                  ese        Unknown      1    2519.94            3696.68\n4   Electronics          musical                  ese        Unknown      2    1543.93            3696.68\n5   Electronics         scanners                  ese        Unknown      3    2049.60            3696.68\n6   Electronics      televisions                  ese        Unknown      1    1173.55            3696.68\n7   Electronics          musical                  ese        Unknown      4    2089.02            3696.68\n8   Electronics           karoke                  ese        Unknown      2     516.45            3696.68\n9   Electronics      televisions                  ese        Unknown     12    3249.26            3696.68\n10  Electronics          musical                  ese        Unknown      5    2014.56            3696.68\n11  Electronics                                   ese        Unknown      2    5761.99            3696.68\n12  Electronics         scanners                  ese        Unknown      2    2000.74            3696.68\n13  Electronics      televisions                  ese        Unknown      6    1162.58            3696.68\n14  Electronics           karoke                  ese        Unknown      4     985.66            3696.68\n15  Electronics           karoke                  ese        Unknown     12    3105.19            3696.68\n16  Electronics  dvd/vcr players                  ese        Unknown      5    1223.86            3696.68\n17  Electronics                                   ese        Unknown      5    7796.95            3696.68\n18  Electronics           karoke                  ese        Unknown      5     700.91            3696.68\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics          musical                 eing        Unknown     11    5476.11            3591.47\n1   Electronics           karoke                 eing        Unknown     10    1726.50            3591.47\n2   Electronics           karoke                 eing        Unknown     11    2531.32            3591.47\n3   Electronics  dvd/vcr players                 eing        Unknown     10    1915.62            3591.47\n4   Electronics          musical                 eing        Unknown     10    4376.11            3591.47\n5   Electronics                                  eing        Unknown     10   15634.69            3591.47\n6   Electronics         scanners                 eing        Unknown     10    3730.50            3591.47\n7   Electronics           karoke                 eing        Unknown      6     599.66            3591.47\n8   Electronics  dvd/vcr players                 eing        Unknown     12    3041.03            3591.47\n9   Electronics          musical                 eing        Unknown     12    5902.73            3591.47\n10  Electronics         scanners                 eing        Unknown      7    1706.34            3591.47\n11  Electronics      televisions                 eing        Unknown     10    1327.76            3591.47\n12  Electronics      televisions                 eing        Unknown     11    2631.48            3591.47\n13  Electronics          musical                 eing        Unknown      6    2123.67            3591.47\n14  Electronics      televisions                 eing        Unknown      7    1239.65            3591.47\n15  Electronics  dvd/vcr players                 eing        Unknown      7    1136.92            3591.47\n16  Electronics          musical                 eing        Unknown      7    1688.47            3591.47\n17  Electronics  dvd/vcr players                 eing        Unknown      9    1337.40            3591.47\n18  Electronics         scanners                 eing        Unknown      9    3491.26            3591.47\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018979,
                    "execution_time": 0.007772,
                    "compile_time": 6.7e-05,
                    "planning_time": 0.004441
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01916,
                    "execution_time": 0.007803,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004464
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics          musical                 eing        Unknown     11    5476.11            3591.47\n1   Electronics           karoke                 eing        Unknown     10    1726.50            3591.47\n2   Electronics           karoke                 eing        Unknown     11    2531.32            3591.47\n3   Electronics  dvd/vcr players                 eing        Unknown     10    1915.62            3591.47\n4   Electronics          musical                 eing        Unknown     10    4376.11            3591.47\n5   Electronics                                  eing        Unknown     10   15634.69            3591.47\n6   Electronics         scanners                 eing        Unknown     10    3730.50            3591.47\n7   Electronics           karoke                 eing        Unknown      6     599.66            3591.47\n8   Electronics  dvd/vcr players                 eing        Unknown     12    3041.03            3591.47\n9   Electronics          musical                 eing        Unknown     12    5902.73            3591.47\n10  Electronics         scanners                 eing        Unknown      7    1706.34            3591.47\n11  Electronics      televisions                 eing        Unknown     10    1327.76            3591.47\n12  Electronics      televisions                 eing        Unknown     11    2631.48            3591.47\n13  Electronics          musical                 eing        Unknown      6    2123.67            3591.47\n14  Electronics      televisions                 eing        Unknown      7    1239.65            3591.47\n15  Electronics  dvd/vcr players                 eing        Unknown      7    1136.92            3591.47\n16  Electronics          musical                 eing        Unknown      7    1688.47            3591.47\n17  Electronics  dvd/vcr players                 eing        Unknown      9    1337.40            3591.47\n18  Electronics         scanners                 eing        Unknown      9    3491.26            3591.47\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.278892,
                    "execution_time": 0.072415,
                    "compile_time": 0.000274,
                    "planning_time": 0.00659,
                    "create_size": 1034
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.3534,
                    "execution_time": 0.081042,
                    "compile_time": 0.000293,
                    "planning_time": 0.067371,
                    "create_size": 1034
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category          i_class               i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics           stereo  exportiamalgamalg #9        cally        Unknown     12  136283.64           65695.85\n1   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      6   39732.06           65695.85\n2   Electronics           stereo  exportiamalgamalg #9        cally        Unknown     10   87855.96           65695.85\n3   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      7   38178.13           65695.85\n4   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      9   80122.28           65695.85\n5   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      3   38747.55           65695.85\n6   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      1   47046.87           65695.85\n7   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      4   38398.99           65695.85\n8   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      2   34891.24           65695.85\n9   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      5   40925.00           65695.85\n10  Electronics           stereo  exportiamalgamalg #9        cally        Unknown      8   84692.45           65695.85\n11  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown     10  106197.56           82150.29\n12  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown     11  158954.51           82150.29\n13  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      6   45795.81           82150.29\n14  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown     12  171382.72           82150.29\n15  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      8  106160.59           82150.29\n16  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      9  109458.04           82150.29\n17  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      2   42842.00           82150.29\n18  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      3   45683.82           82150.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018819,
                    "execution_time": 0.007491,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.00453
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058034,
                    "execution_time": 0.008132,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040631
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category          i_class               i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics           stereo  exportiamalgamalg #9        cally        Unknown     12  136283.64           65695.85\n1   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      6   39732.06           65695.85\n2   Electronics           stereo  exportiamalgamalg #9        cally        Unknown     10   87855.96           65695.85\n3   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      7   38178.13           65695.85\n4   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      9   80122.28           65695.85\n5   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      3   38747.55           65695.85\n6   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      1   47046.87           65695.85\n7   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      4   38398.99           65695.85\n8   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      2   34891.24           65695.85\n9   Electronics           stereo  exportiamalgamalg #9        cally        Unknown      5   40925.00           65695.85\n10  Electronics           stereo  exportiamalgamalg #9        cally        Unknown      8   84692.45           65695.85\n11  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown     10  106197.56           82150.29\n12  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown     11  158954.51           82150.29\n13  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      6   45795.81           82150.29\n14  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown     12  171382.72           82150.29\n15  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      8  106160.59           82150.29\n16  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      9  109458.04           82150.29\n17  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      2   42842.00           82150.29\n18  Electronics  dvd/vcr players   exportiunivamalg #1          ese        Unknown      3   45683.82           82150.29\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"S_STORE_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.278049,
                    "execution_time": 0.071259,
                    "compile_time": 0.000274,
                    "planning_time": 0.00438,
                    "create_size": 1034
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.354798,
                    "execution_time": 0.089946,
                    "compile_time": 0.000279,
                    "planning_time": 0.061424,
                    "create_size": 1045
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.298763,
                    "execution_time": 0.090011,
                    "compile_time": 0.000275,
                    "planning_time": 0.006628,
                    "create_size": 1034
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.359052,
                    "execution_time": 0.092509,
                    "compile_time": 0.000279,
                    "planning_time": 0.064229,
                    "create_size": 1023
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown      1    1406.58         1886277.60\n1       Women          exportiamalg #1         able        Unknown      4    1748.00         1886277.60\n2       Women          exportiamalg #1         able        Unknown      2    1790.58         1886277.60\n3       Women          exportiamalg #1         able        Unknown      3    1995.39         1886277.60\n4       Women          exportiamalg #1         able        Unknown      5    2072.19         1886277.60\n5       Women          exportiamalg #1         able        Unknown      7    2146.01         1886277.60\n6       Women          exportiamalg #1          bar        Unknown      2    1428.05         1885555.21\n7       Women          exportiamalg #1          bar        Unknown      6    1539.19         1885555.21\n8       Women          exportiamalg #1          bar        Unknown      4    1585.60         1885555.21\n9       Women          exportiamalg #1          bar        Unknown      7    1603.23         1885555.21\n10      Women          exportiamalg #1          bar        Unknown      5    1605.85         1885555.21\n11      Women          exportiamalg #1          bar        Unknown      3    1637.66         1885555.21\n12      Women          exportiamalg #1         able        Unknown      6    2429.86         1886277.60\n13      Women          exportiamalg #1         able        Unknown      8    2699.79         1886277.60\n14      Women          exportiamalg #1         able        Unknown     10    2724.92         1886277.60\n15      Women          exportiamalg #1          bar        Unknown      1    2237.15         1885555.21\n16      Women          exportiamalg #1         able        Unknown      9    3382.34         1886277.60\n17      Women          exportiamalg #1          bar        Unknown      8    3386.23         1885555.21\n18      Women          exportiamalg #1          bar        Unknown      9    3842.47         1885555.21\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024845,
                    "execution_time": 0.010431,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.006857
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.236136,
                    "execution_time": 0.010594,
                    "compile_time": 0.172534,
                    "planning_time": 0.042806
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown      1    1406.58         1886277.60\n1       Women          exportiamalg #1         able        Unknown      4    1748.00         1886277.60\n2       Women          exportiamalg #1         able        Unknown      2    1790.58         1886277.60\n3       Women          exportiamalg #1         able        Unknown      3    1995.39         1886277.60\n4       Women          exportiamalg #1         able        Unknown      5    2072.19         1886277.60\n5       Women          exportiamalg #1         able        Unknown      7    2146.01         1886277.60\n6       Women          exportiamalg #1          bar        Unknown      2    1428.05         1885555.21\n7       Women          exportiamalg #1          bar        Unknown      6    1539.19         1885555.21\n8       Women          exportiamalg #1          bar        Unknown      4    1585.60         1885555.21\n9       Women          exportiamalg #1          bar        Unknown      7    1603.23         1885555.21\n10      Women          exportiamalg #1          bar        Unknown      5    1605.85         1885555.21\n11      Women          exportiamalg #1          bar        Unknown      3    1637.66         1885555.21\n12      Women          exportiamalg #1         able        Unknown      6    2429.86         1886277.60\n13      Women          exportiamalg #1         able        Unknown      8    2699.79         1886277.60\n14      Women          exportiamalg #1         able        Unknown     10    2724.92         1886277.60\n15      Women          exportiamalg #1          bar        Unknown      1    2237.15         1885555.21\n16      Women          exportiamalg #1         able        Unknown      9    3382.34         1886277.60\n17      Women          exportiamalg #1          bar        Unknown      8    3386.23         1885555.21\n18      Women          exportiamalg #1          bar        Unknown      9    3842.47         1885555.21\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown      1    1406.58         1886277.60\n1       Women          exportiamalg #1         able        Unknown      4    1748.00         1886277.60\n2       Women          exportiamalg #1         able        Unknown      2    1790.58         1886277.60\n3       Women          exportiamalg #1         able        Unknown      3    1995.39         1886277.60\n4       Women          exportiamalg #1         able        Unknown      5    2072.19         1886277.60\n5       Women          exportiamalg #1         able        Unknown      7    2146.01         1886277.60\n6       Women          exportiamalg #1          bar        Unknown      2    1428.05         1885555.21\n7       Women          exportiamalg #1          bar        Unknown      6    1539.19         1885555.21\n8       Women          exportiamalg #1          bar        Unknown      4    1585.60         1885555.21\n9       Women          exportiamalg #1          bar        Unknown      7    1603.23         1885555.21\n10      Women          exportiamalg #1          bar        Unknown      5    1605.85         1885555.21\n11      Women          exportiamalg #1          bar        Unknown      3    1637.66         1885555.21\n12      Women          exportiamalg #1         able        Unknown      6    2429.86         1886277.60\n13      Women          exportiamalg #1         able        Unknown      8    2699.79         1886277.60\n14      Women          exportiamalg #1         able        Unknown     10    2724.92         1886277.60\n15      Women          exportiamalg #1          bar        Unknown      1    2237.15         1885555.21\n16      Women          exportiamalg #1         able        Unknown      9    3382.34         1886277.60\n17      Women          exportiamalg #1          bar        Unknown      8    3386.23         1885555.21\n18      Women          exportiamalg #1          bar        Unknown      9    3842.47         1885555.21\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024806,
                    "execution_time": 0.010327,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.006826
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.025598,
                    "execution_time": 0.011111,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.006762
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown      1    1406.58         1886277.60\n1       Women          exportiamalg #1         able        Unknown      4    1748.00         1886277.60\n2       Women          exportiamalg #1         able        Unknown      2    1790.58         1886277.60\n3       Women          exportiamalg #1         able        Unknown      3    1995.39         1886277.60\n4       Women          exportiamalg #1         able        Unknown      5    2072.19         1886277.60\n5       Women          exportiamalg #1         able        Unknown      7    2146.01         1886277.60\n6       Women          exportiamalg #1          bar        Unknown      2    1428.05         1885555.21\n7       Women          exportiamalg #1          bar        Unknown      6    1539.19         1885555.21\n8       Women          exportiamalg #1          bar        Unknown      4    1585.60         1885555.21\n9       Women          exportiamalg #1          bar        Unknown      7    1603.23         1885555.21\n10      Women          exportiamalg #1          bar        Unknown      5    1605.85         1885555.21\n11      Women          exportiamalg #1          bar        Unknown      3    1637.66         1885555.21\n12      Women          exportiamalg #1         able        Unknown      6    2429.86         1886277.60\n13      Women          exportiamalg #1         able        Unknown      8    2699.79         1886277.60\n14      Women          exportiamalg #1         able        Unknown     10    2724.92         1886277.60\n15      Women          exportiamalg #1          bar        Unknown      1    2237.15         1885555.21\n16      Women          exportiamalg #1         able        Unknown      9    3382.34         1886277.60\n17      Women          exportiamalg #1          bar        Unknown      8    3386.23         1885555.21\n18      Women          exportiamalg #1          bar        Unknown      9    3842.47         1885555.21\n...*/"
    }
]