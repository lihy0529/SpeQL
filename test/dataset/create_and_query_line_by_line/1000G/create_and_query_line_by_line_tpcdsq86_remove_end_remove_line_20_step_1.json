[
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,(select d_date_sk, d_month_seq from date_dim) d1\n   ,(select i_item_sk, i_category, i_class from item) i\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i.i_item_sk  = ws_item_sk\n group by i_category,i_class\n )\nselect * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1216 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1216 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.467383,
                    "execution_time": 1.386296,
                    "compile_time": 0.000446,
                    "planning_time": 0.046287,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.153413,
                    "execution_time": 2.985581,
                    "compile_time": 0.004382,
                    "planning_time": 0.123789,
                    "create_size": 64
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category         i_class  g_category  g_class\n0   2.151016e+09      Jewelry           rings           0        0\n1   8.345784e+09          Men     accessories           0        0\n2   2.057675e+09       Sports      basketball           0        0\n3   8.220069e+09          Men  sports-apparel           0        0\n4   8.442420e+09     Children         infants           0        0\n5   2.104301e+09       Sports        football           0        0\n6   2.083763e+09       Sports            guns           0        0\n7   8.344780e+09     Children        toddlers           0        0\n8   2.035547e+09       Sports  athletic shoes           0        0\n9   2.069239e+09        Books         romance           0        0\n10  2.074995e+09       Sports         fitness           0        0\n11  2.089117e+09  Electronics          memory           0        0\n12  1.980375e+09  Electronics         cameras           0        0\n13  2.153766e+09       Sports          optics           0        0\n14  1.959346e+09         Home       wallpaper           0        0\n15  2.153402e+09         Home         bedding           0        0\n16  1.984205e+09         Home        lighting           0        0\n17  2.012730e+09         Home       glassware           0        0\n18  2.058041e+09  Electronics        personal           0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017472,
                    "execution_time": 0.007039,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.003733
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055904,
                    "execution_time": 0.007339,
                    "compile_time": 0.000984,
                    "planning_time": 0.039458
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*       total_sum   i_category         i_class  g_category  g_class\n0   2.151016e+09      Jewelry           rings           0        0\n1   8.345784e+09          Men     accessories           0        0\n2   2.057675e+09       Sports      basketball           0        0\n3   8.220069e+09          Men  sports-apparel           0        0\n4   8.442420e+09     Children         infants           0        0\n5   2.104301e+09       Sports        football           0        0\n6   2.083763e+09       Sports            guns           0        0\n7   8.344780e+09     Children        toddlers           0        0\n8   2.035547e+09       Sports  athletic shoes           0        0\n9   2.069239e+09        Books         romance           0        0\n10  2.074995e+09       Sports         fitness           0        0\n11  2.089117e+09  Electronics          memory           0        0\n12  1.980375e+09  Electronics         cameras           0        0\n13  2.153766e+09       Sports          optics           0        0\n14  1.959346e+09         Home       wallpaper           0        0\n15  2.153402e+09         Home         bedding           0        0\n16  1.984205e+09         Home        lighting           0        0\n17  2.012730e+09         Home       glassware           0        0\n18  2.058041e+09  Electronics        personal           0        0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) \nselect * from results\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.242333,
                    "execution_time": 1.159558,
                    "compile_time": 0.000445,
                    "planning_time": 0.048348,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.323955,
                    "execution_time": 1.156509,
                    "compile_time": 0.000448,
                    "planning_time": 0.121734,
                    "create_size": 64
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class\n0   1.988227e+09  Electronics       automotive           0        0\n1   2.029451e+09      Jewelry        bracelets           0        0\n2   1.967683e+09         Home       mattresses           0        0\n3   8.199687e+09        Shoes           womens           0        0\n4   1.946677e+09  Electronics         wireless           0        0\n5   8.250210e+09        Women       fragrances           0        0\n6   2.088001e+09         Home         bathroom           0        0\n7   2.006824e+09  Electronics           stereo           0        0\n8   2.013937e+09      Jewelry           birdal           0        0\n9   1.960854e+09      Jewelry    semi-precious           0        0\n10  3.631564e+07        Shoes                            0        0\n11  5.779007e+06                     classical           0        0\n12  1.626802e+07                      swimwear           0        0\n13  2.208010e+06                entertainments           0        0\n14  2.106308e+06                 semi-precious           0        0\n15  1.239964e+07                       infants           0        0\n16  4.506582e+06                      diamonds           0        0\n17  6.389286e+06                          rock           0        0\n18  6.773774e+06                     bracelets           0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018121,
                    "execution_time": 0.007636,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003879
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053442,
                    "execution_time": 0.007722,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039307
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class\n0   1.988227e+09  Electronics       automotive           0        0\n1   2.029451e+09      Jewelry        bracelets           0        0\n2   1.967683e+09         Home       mattresses           0        0\n3   8.199687e+09        Shoes           womens           0        0\n4   1.946677e+09  Electronics         wireless           0        0\n5   8.250210e+09        Women       fragrances           0        0\n6   2.088001e+09         Home         bathroom           0        0\n7   2.006824e+09  Electronics           stereo           0        0\n8   2.013937e+09      Jewelry           birdal           0        0\n9   1.960854e+09      Jewelry    semi-precious           0        0\n10  3.631564e+07        Shoes                            0        0\n11  5.779007e+06                     classical           0        0\n12  1.626802e+07                      swimwear           0        0\n13  2.208010e+06                entertainments           0        0\n14  2.106308e+06                 semi-precious           0        0\n15  1.239964e+07                       infants           0        0\n16  4.506582e+06                      diamonds           0        0\n17  6.389286e+06                          rock           0        0\n18  6.773774e+06                     bracelets           0        0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n)\nselect * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.080516e+09        Books           sports           0        0             0\n1   2.055839e+09         Home  curtains/drapes           0        0             0\n2   8.229874e+09          Men           shirts           0        0             0\n3   2.046789e+09        Books           travel           0        0             0\n4   1.952329e+09        Books          science           0        0             0\n5   1.971367e+09      Jewelry         diamonds           0        0             0\n6   2.006419e+09       Sports          sailing           0        0             0\n7   2.169908e+09  Electronics      televisions           0        0             0\n8   2.011555e+09        Books             arts           0        0             0\n9   1.133214e+07                      toddlers           0        0             0\n10  3.582156e+07  Electronics                            0        0             0\n11  1.487804e+07                    fragrances           0        0             0\n12  5.867972e+06                   televisions           0        0             0\n13  2.284712e+06                        tables           0        0             0\n14  4.471817e+05                          golf           0        0             0\n15  8.380284e+09        Music        classical           0        0             0\n16  2.055514e+09         Home        furniture           0        0             0\n17  2.066851e+09        Books      home repair           0        0             0\n18  2.119601e+09  Electronics         monitors           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017659,
                    "execution_time": 0.007262,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003903
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.340174,
                    "execution_time": 0.007316,
                    "compile_time": 0.286878,
                    "planning_time": 0.039336
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.080516e+09        Books           sports           0        0             0\n1   2.055839e+09         Home  curtains/drapes           0        0             0\n2   8.229874e+09          Men           shirts           0        0             0\n3   2.046789e+09        Books           travel           0        0             0\n4   1.952329e+09        Books          science           0        0             0\n5   1.971367e+09      Jewelry         diamonds           0        0             0\n6   2.006419e+09       Sports          sailing           0        0             0\n7   2.169908e+09  Electronics      televisions           0        0             0\n8   2.011555e+09        Books             arts           0        0             0\n9   1.133214e+07                      toddlers           0        0             0\n10  3.582156e+07  Electronics                            0        0             0\n11  1.487804e+07                    fragrances           0        0             0\n12  5.867972e+06                   televisions           0        0             0\n13  2.284712e+06                        tables           0        0             0\n14  4.471817e+05                          golf           0        0             0\n15  8.380284e+09        Music        classical           0        0             0\n16  2.055514e+09         Home        furniture           0        0             0\n17  2.066851e+09        Books      home repair           0        0             0\n18  2.119601e+09  Electronics         monitors           0        0             0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n)\nselect * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085354,
                    "execution_time": 0.049488,
                    "compile_time": 0.00041,
                    "planning_time": 0.007389,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.143754,
                    "execution_time": 0.057948,
                    "compile_time": 0.005827,
                    "planning_time": 0.048901,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.080516e+09        Books        sports           0        0             0\n1   2.046789e+09        Books        travel           0        0             0\n2   3.582156e+07  Electronics                         0        0             0\n3   2.119333e+09      Jewelry    mens watch           0        0             0\n4   4.574681e+05                   football           0        0             0\n5   2.151016e+09      Jewelry         rings           0        0             0\n6   2.153766e+09       Sports        optics           0        0             0\n7   1.984205e+09         Home      lighting           0        0             0\n8   5.492468e+06                    history           0        0             0\n9   1.141317e+07                       mens           0        0             0\n10  3.813596e+06                      decor           0        0             0\n11  2.602853e+06                  computers           0        0             0\n12  8.380284e+09        Music     classical           0        0             0\n13  2.066851e+09        Books   home repair           0        0             0\n14  2.119601e+09  Electronics      monitors           0        0             0\n15  1.953060e+09        Books     computers           0        0             0\n16  1.660998e+06                 mattresses           0        0             0\n17  5.321887e+05                     karoke           0        0             0\n18  1.943620e+09      Jewelry       earings           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017721,
                    "execution_time": 0.007146,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004047
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057041,
                    "execution_time": 0.007165,
                    "compile_time": 0.001216,
                    "planning_time": 0.039783
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.080516e+09        Books        sports           0        0             0\n1   2.046789e+09        Books        travel           0        0             0\n2   3.582156e+07  Electronics                         0        0             0\n3   2.119333e+09      Jewelry    mens watch           0        0             0\n4   4.574681e+05                   football           0        0             0\n5   2.151016e+09      Jewelry         rings           0        0             0\n6   2.153766e+09       Sports        optics           0        0             0\n7   1.984205e+09         Home      lighting           0        0             0\n8   5.492468e+06                    history           0        0             0\n9   1.141317e+07                       mens           0        0             0\n10  3.813596e+06                      decor           0        0             0\n11  2.602853e+06                  computers           0        0             0\n12  8.380284e+09        Music     classical           0        0             0\n13  2.066851e+09        Books   home repair           0        0             0\n14  2.119601e+09  Electronics      monitors           0        0             0\n15  1.953060e+09        Books     computers           0        0             0\n16  1.660998e+06                 mattresses           0        0             0\n17  5.321887e+05                     karoke           0        0             0\n18  1.943620e+09      Jewelry       earings           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n/*CURSOR_IDENTIFIER*/\nselect * from results_rollup",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101414,
                    "execution_time": 0.056608,
                    "compile_time": 0.000539,
                    "planning_time": 0.010455,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.150074,
                    "execution_time": 0.05934,
                    "compile_time": 0.002394,
                    "planning_time": 0.052209,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.119333e+09      Jewelry    mens watch           0        0             0\n1   4.574681e+05                   football           0        0             0\n2   2.080516e+09        Books        sports           0        0             0\n3   2.046789e+09        Books        travel           0        0             0\n4   3.582156e+07  Electronics                         0        0             0\n5   8.380284e+09        Music     classical           0        0             0\n6   2.066851e+09        Books   home repair           0        0             0\n7   2.119601e+09  Electronics      monitors           0        0             0\n8   1.953060e+09        Books     computers           0        0             0\n9   1.660998e+06                 mattresses           0        0             0\n10  5.321887e+05                     karoke           0        0             0\n11  2.151016e+09      Jewelry         rings           0        0             0\n12  2.153766e+09       Sports        optics           0        0             0\n13  1.984205e+09         Home      lighting           0        0             0\n14  5.492468e+06                    history           0        0             0\n15  1.141317e+07                       mens           0        0             0\n16  3.813596e+06                      decor           0        0             0\n17  2.602853e+06                  computers           0        0             0\n18  1.943620e+09      Jewelry       earings           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018683,
                    "execution_time": 0.007776,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004126
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055455,
                    "execution_time": 0.007322,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039787
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.119333e+09      Jewelry    mens watch           0        0             0\n1   4.574681e+05                   football           0        0             0\n2   2.080516e+09        Books        sports           0        0             0\n3   2.046789e+09        Books        travel           0        0             0\n4   3.582156e+07  Electronics                         0        0             0\n5   8.380284e+09        Music     classical           0        0             0\n6   2.066851e+09        Books   home repair           0        0             0\n7   2.119601e+09  Electronics      monitors           0        0             0\n8   1.953060e+09        Books     computers           0        0             0\n9   1.660998e+06                 mattresses           0        0             0\n10  5.321887e+05                     karoke           0        0             0\n11  2.151016e+09      Jewelry         rings           0        0             0\n12  2.153766e+09       Sports        optics           0        0             0\n13  1.984205e+09         Home      lighting           0        0             0\n14  5.492468e+06                    history           0        0             0\n15  1.141317e+07                       mens           0        0             0\n16  3.813596e+06                      decor           0        0             0\n17  2.602853e+06                  computers           0        0             0\n18  1.943620e+09      Jewelry       earings           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.119333e+09      Jewelry    mens watch           0        0             0\n1   4.574681e+05                   football           0        0             0\n2   2.080516e+09        Books        sports           0        0             0\n3   2.046789e+09        Books        travel           0        0             0\n4   3.582156e+07  Electronics                         0        0             0\n5   8.380284e+09        Music     classical           0        0             0\n6   2.066851e+09        Books   home repair           0        0             0\n7   2.119601e+09  Electronics      monitors           0        0             0\n8   1.953060e+09        Books     computers           0        0             0\n9   1.660998e+06                 mattresses           0        0             0\n10  5.321887e+05                     karoke           0        0             0\n11  2.151016e+09      Jewelry         rings           0        0             0\n12  2.153766e+09       Sports        optics           0        0             0\n13  1.984205e+09         Home      lighting           0        0             0\n14  5.492468e+06                    history           0        0             0\n15  1.141317e+07                       mens           0        0             0\n16  3.813596e+06                      decor           0        0             0\n17  2.602853e+06                  computers           0        0             0\n18  1.943620e+09      Jewelry       earings           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017797,
                    "execution_time": 0.00725,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004004
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017797,
                    "execution_time": 0.007245,
                    "compile_time": 5e-05,
                    "planning_time": 0.004049
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.119333e+09      Jewelry    mens watch           0        0             0\n1   4.574681e+05                   football           0        0             0\n2   2.080516e+09        Books        sports           0        0             0\n3   2.046789e+09        Books        travel           0        0             0\n4   3.582156e+07  Electronics                         0        0             0\n5   8.380284e+09        Music     classical           0        0             0\n6   2.066851e+09        Books   home repair           0        0             0\n7   2.119601e+09  Electronics      monitors           0        0             0\n8   1.953060e+09        Books     computers           0        0             0\n9   1.660998e+06                 mattresses           0        0             0\n10  5.321887e+05                     karoke           0        0             0\n11  2.151016e+09      Jewelry         rings           0        0             0\n12  2.153766e+09       Sports        optics           0        0             0\n13  1.984205e+09         Home      lighting           0        0             0\n14  5.492468e+06                    history           0        0             0\n15  1.141317e+07                       mens           0        0             0\n16  3.813596e+06                      decor           0        0             0\n17  2.602853e+06                  computers           0        0             0\n18  1.943620e+09      Jewelry       earings           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category       i_class  lochierarchy\n0   2.119333e+09      Jewelry    mens watch             0\n1   4.574681e+05                   football             0\n2   2.080516e+09        Books        sports             0\n3   2.046789e+09        Books        travel             0\n4   3.582156e+07  Electronics                           0\n5   8.380284e+09        Music     classical             0\n6   2.066851e+09        Books   home repair             0\n7   2.119601e+09  Electronics      monitors             0\n8   1.953060e+09        Books     computers             0\n9   1.660998e+06                 mattresses             0\n10  5.321887e+05                     karoke             0\n11  2.151016e+09      Jewelry         rings             0\n12  2.153766e+09       Sports        optics             0\n13  1.984205e+09         Home      lighting             0\n14  5.492468e+06                    history             0\n15  1.141317e+07                       mens             0\n16  3.813596e+06                      decor             0\n17  2.602853e+06                  computers             0\n18  1.943620e+09      Jewelry       earings             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017245,
                    "execution_time": 0.00709,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003738
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.345798,
                    "execution_time": 0.007505,
                    "compile_time": 0.29142,
                    "planning_time": 0.038885
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category       i_class  lochierarchy\n0   2.119333e+09      Jewelry    mens watch             0\n1   4.574681e+05                   football             0\n2   2.080516e+09        Books        sports             0\n3   2.046789e+09        Books        travel             0\n4   3.582156e+07  Electronics                           0\n5   8.380284e+09        Music     classical             0\n6   2.066851e+09        Books   home repair             0\n7   2.119601e+09  Electronics      monitors             0\n8   1.953060e+09        Books     computers             0\n9   1.660998e+06                 mattresses             0\n10  5.321887e+05                     karoke             0\n11  2.151016e+09      Jewelry         rings             0\n12  2.153766e+09       Sports        optics             0\n13  1.984205e+09         Home      lighting             0\n14  5.492468e+06                    history             0\n15  1.141317e+07                       mens             0\n16  3.813596e+06                      decor             0\n17  2.602853e+06                  computers             0\n18  1.943620e+09      Jewelry       earings             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (order by total_sum desc) as total_rank\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup;",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  total_rank\n0   3.294638e+11         None         None             2           1\n1   3.325262e+10       Sports         None             1           2\n2   3.315059e+10        Women         None             1           3\n3   3.312029e+10     Children         None             1           4\n4   3.293265e+10        Music         None             1           5\n5   3.279758e+10        Books         None             1           6\n6   3.272964e+10          Men         None             1           7\n7   3.271529e+10        Shoes         None             1           8\n8   3.268876e+10  Electronics         None             1           9\n9   3.263979e+10         Home         None             1          10\n10  3.263888e+10      Jewelry         None             1          11\n11  8.442420e+09     Children      infants             0          12\n12  8.399044e+09        Women    maternity             0          13\n13  8.380284e+09        Music    classical             0          14\n14  8.345784e+09          Men  accessories             0          15\n15  8.344780e+09     Children     toddlers             0          16\n16  8.251046e+09        Shoes     athletic             0          17\n17  8.250210e+09        Women   fragrances             0          18\n18  8.240148e+09        Women     swimwear             0          19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020845,
                    "execution_time": 0.009379,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.004274
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061606,
                    "execution_time": 0.010165,
                    "compile_time": 0.002538,
                    "planning_time": 0.039819
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  total_rank\n0   3.294638e+11         None         None             2           1\n1   3.325262e+10       Sports         None             1           2\n2   3.315059e+10        Women         None             1           3\n3   3.312029e+10     Children         None             1           4\n4   3.293265e+10        Music         None             1           5\n5   3.279758e+10        Books         None             1           6\n6   3.272964e+10          Men         None             1           7\n7   3.271529e+10        Shoes         None             1           8\n8   3.268876e+10  Electronics         None             1           9\n9   3.263979e+10         Home         None             1          10\n10  3.263888e+10      Jewelry         None             1          11\n11  8.442420e+09     Children      infants             0          12\n12  8.399044e+09        Women    maternity             0          13\n13  8.380284e+09        Music    classical             0          14\n14  8.345784e+09          Men  accessories             0          15\n15  8.344780e+09     Children     toddlers             0          16\n16  8.251046e+09        Shoes     athletic             0          17\n17  8.250210e+09        Women   fragrances             0          18\n18  8.240148e+09        Women     swimwear             0          19\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim as d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\nresults_rollup as\n( select total_sum, i_category, i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum, i_category, i_class, lochierarchy \n   ,rank() over (\n    partition by lochierarchy\n    order by total_sum desc) as rnk\n from results_rollup\n /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rnk\n0   3.325262e+10       Sports         None             1    1\n1   3.315059e+10        Women         None             1    2\n2   3.312029e+10     Children         None             1    3\n3   3.293265e+10        Music         None             1    4\n4   3.279758e+10        Books         None             1    5\n5   3.272964e+10          Men         None             1    6\n6   3.271529e+10        Shoes         None             1    7\n7   3.268876e+10  Electronics         None             1    8\n8   3.263979e+10         Home         None             1    9\n9   3.263888e+10      Jewelry         None             1   10\n10  7.977467e+08                      None             1   11\n11  8.442420e+09     Children      infants             0    1\n12  8.399044e+09        Women    maternity             0    2\n13  8.380284e+09        Music    classical             0    3\n14  8.345784e+09          Men  accessories             0    4\n15  8.344780e+09     Children     toddlers             0    5\n16  8.251046e+09        Shoes     athletic             0    6\n17  8.250210e+09        Women   fragrances             0    7\n18  8.240148e+09        Women     swimwear             0    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021119,
                    "execution_time": 0.009484,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.004429
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060534,
                    "execution_time": 0.009319,
                    "compile_time": 0.002473,
                    "planning_time": 0.039756
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rnk\n0   3.325262e+10       Sports         None             1    1\n1   3.315059e+10        Women         None             1    2\n2   3.312029e+10     Children         None             1    3\n3   3.293265e+10        Music         None             1    4\n4   3.279758e+10        Books         None             1    5\n5   3.272964e+10          Men         None             1    6\n6   3.271529e+10        Shoes         None             1    7\n7   3.268876e+10  Electronics         None             1    8\n8   3.263979e+10         Home         None             1    9\n9   3.263888e+10      Jewelry         None             1   10\n10  7.977467e+08                      None             1   11\n11  8.442420e+09     Children      infants             0    1\n12  8.399044e+09        Women    maternity             0    2\n13  8.380284e+09        Music    classical             0    3\n14  8.345784e+09          Men  accessories             0    4\n15  8.344780e+09     Children     toddlers             0    5\n16  8.251046e+09        Shoes     athletic             0    6\n17  8.250210e+09        Women   fragrances             0    7\n18  8.240148e+09        Women     swimwear             0    8\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category else NULL end\n ) as rank_value /*CURSOR_IDENTIFIER*/\n from results_rollup",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*      total_sum i_category      i_class  lochierarchy  rank_value\n0     457468.12                football             0           1\n1    1660997.51              mattresses             0           1\n2     532188.67                  karoke             0           1\n3    5492468.08                 history             0           1\n4   11413166.02                    mens             0           1\n5    3813595.70                   decor             0           1\n6    2602852.99               computers             0           1\n7    4536464.78                    rugs             0           1\n8    2163851.82                lighting             0           1\n9    4506582.31                diamonds             0           1\n10   1461174.95              mens watch             0           1\n11   2123036.76                  stereo             0           1\n12    447181.72                    golf             0           1\n13  12282132.84                 dresses             0           1\n14   1791998.15                 romance             0           1\n15   3864437.37                  custom             0           1\n16   1647107.18                  tennis             0           1\n17   3725469.10                business             0           1\n18   6117608.60             disk drives             0           1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022753,
                    "execution_time": 0.009494,
                    "compile_time": 0.000105,
                    "planning_time": 0.005071
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061077,
                    "execution_time": 0.009882,
                    "compile_time": 0.002029,
                    "planning_time": 0.040424
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*      total_sum i_category      i_class  lochierarchy  rank_value\n0     457468.12                football             0           1\n1    1660997.51              mattresses             0           1\n2     532188.67                  karoke             0           1\n3    5492468.08                 history             0           1\n4   11413166.02                    mens             0           1\n5    3813595.70                   decor             0           1\n6    2602852.99               computers             0           1\n7    4536464.78                    rugs             0           1\n8    2163851.82                lighting             0           1\n9    4506582.31                diamonds             0           1\n10   1461174.95              mens watch             0           1\n11   2123036.76                  stereo             0           1\n12    447181.72                    golf             0           1\n13  12282132.84                 dresses             0           1\n14   1791998.15                 romance             0           1\n15   3864437.37                  custom             0           1\n16   1647107.18                  tennis             0           1\n17   3725469.10                business             0           1\n18   6117608.60             disk drives             0           1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum i_category         i_class  lochierarchy  rank_within_parent\n0   2.161381e+09      Books         history             0                   1\n1   2.105183e+09      Books         fiction             0                   2\n2   2.080516e+09      Books          sports             0                   3\n3   2.072733e+09      Books         cooking             0                   4\n4   2.070195e+09      Books       reference             0                   5\n5   2.069239e+09      Books         romance             0                   6\n6   2.066851e+09      Books     home repair             0                   7\n7   2.046789e+09      Books          travel             0                   8\n8   2.043051e+09      Books  entertainments             0                   9\n9   2.041352e+09      Books       self-help             0                  10\n10  2.040483e+09      Books        business             0                  11\n11  2.040225e+09      Books       parenting             0                  12\n12  2.011555e+09      Books            arts             0                  13\n13  1.994478e+09      Books         mystery             0                  14\n14  1.953060e+09      Books       computers             0                  15\n15  1.952329e+09      Books         science             0                  16\n16  4.816391e+07      Books                             0                  17\n17  2.291636e+09    Jewelry   jewelry boxes             0                   1\n18  2.151016e+09    Jewelry           rings             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023522,
                    "execution_time": 0.009863,
                    "compile_time": 0.000109,
                    "planning_time": 0.005258
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.198574,
                    "execution_time": 0.009687,
                    "compile_time": 0.146743,
                    "planning_time": 0.040497
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum i_category         i_class  lochierarchy  rank_within_parent\n0   2.161381e+09      Books         history             0                   1\n1   2.105183e+09      Books         fiction             0                   2\n2   2.080516e+09      Books          sports             0                   3\n3   2.072733e+09      Books         cooking             0                   4\n4   2.070195e+09      Books       reference             0                   5\n5   2.069239e+09      Books         romance             0                   6\n6   2.066851e+09      Books     home repair             0                   7\n7   2.046789e+09      Books          travel             0                   8\n8   2.043051e+09      Books  entertainments             0                   9\n9   2.041352e+09      Books       self-help             0                  10\n10  2.040483e+09      Books        business             0                  11\n11  2.040225e+09      Books       parenting             0                  12\n12  2.011555e+09      Books            arts             0                  13\n13  1.994478e+09      Books         mystery             0                  14\n14  1.953060e+09      Books       computers             0                  15\n15  1.952329e+09      Books         science             0                  16\n16  4.816391e+07      Books                             0                  17\n17  2.291636e+09    Jewelry   jewelry boxes             0                   1\n18  2.151016e+09    Jewelry           rings             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum i_category         i_class  lochierarchy  rank_within_parent\n0   2.161381e+09      Books         history             0                   1\n1   2.105183e+09      Books         fiction             0                   2\n2   2.080516e+09      Books          sports             0                   3\n3   2.072733e+09      Books         cooking             0                   4\n4   2.070195e+09      Books       reference             0                   5\n5   2.069239e+09      Books         romance             0                   6\n6   2.066851e+09      Books     home repair             0                   7\n7   2.046789e+09      Books          travel             0                   8\n8   2.043051e+09      Books  entertainments             0                   9\n9   2.041352e+09      Books       self-help             0                  10\n10  2.040483e+09      Books        business             0                  11\n11  2.040225e+09      Books       parenting             0                  12\n12  2.011555e+09      Books            arts             0                  13\n13  1.994478e+09      Books         mystery             0                  14\n14  1.953060e+09      Books       computers             0                  15\n15  1.952329e+09      Books         science             0                  16\n16  4.816391e+07      Books                             0                  17\n17  2.291636e+09    Jewelry   jewelry boxes             0                   1\n18  2.151016e+09    Jewelry           rings             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022394,
                    "execution_time": 0.00939,
                    "compile_time": 0.000103,
                    "planning_time": 0.005107
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023329,
                    "execution_time": 0.01003,
                    "compile_time": 0.000102,
                    "planning_time": 0.005122
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum i_category         i_class  lochierarchy  rank_within_parent\n0   2.161381e+09      Books         history             0                   1\n1   2.105183e+09      Books         fiction             0                   2\n2   2.080516e+09      Books          sports             0                   3\n3   2.072733e+09      Books         cooking             0                   4\n4   2.070195e+09      Books       reference             0                   5\n5   2.069239e+09      Books         romance             0                   6\n6   2.066851e+09      Books     home repair             0                   7\n7   2.046789e+09      Books          travel             0                   8\n8   2.043051e+09      Books  entertainments             0                   9\n9   2.041352e+09      Books       self-help             0                  10\n10  2.040483e+09      Books        business             0                  11\n11  2.040225e+09      Books       parenting             0                  12\n12  2.011555e+09      Books            arts             0                  13\n13  1.994478e+09      Books         mystery             0                  14\n14  1.953060e+09      Books       computers             0                  15\n15  1.952329e+09      Books         science             0                  16\n16  4.816391e+07      Books                             0                  17\n17  2.291636e+09    Jewelry   jewelry boxes             0                   1\n18  2.151016e+09    Jewelry           rings             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by total_sum desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None         None             2                   1\n1   3.325262e+10       Sports         None             1                   1\n2   3.315059e+10        Women         None             1                   2\n3   3.312029e+10     Children         None             1                   3\n4   3.293265e+10        Music         None             1                   4\n5   3.279758e+10        Books         None             1                   5\n6   3.272964e+10          Men         None             1                   6\n7   3.271529e+10        Shoes         None             1                   7\n8   3.268876e+10  Electronics         None             1                   8\n9   3.263979e+10         Home         None             1                   9\n10  3.263888e+10      Jewelry         None             1                  10\n11  8.442420e+09     Children      infants             0                   1\n12  8.399044e+09        Women    maternity             0                   1\n13  8.380284e+09        Music    classical             0                   1\n14  8.345784e+09          Men  accessories             0                   1\n15  8.344780e+09     Children     toddlers             0                   2\n16  8.251046e+09        Shoes     athletic             0                   1\n17  8.250210e+09        Women   fragrances             0                   2\n18  8.240148e+09        Women     swimwear             0                   3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026076,
                    "execution_time": 0.012172,
                    "compile_time": 0.000133,
                    "planning_time": 0.005204
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.153774,
                    "execution_time": 0.01048,
                    "compile_time": 0.099415,
                    "planning_time": 0.040622
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None         None             2                   1\n1   3.325262e+10       Sports         None             1                   1\n2   3.315059e+10        Women         None             1                   2\n3   3.312029e+10     Children         None             1                   3\n4   3.293265e+10        Music         None             1                   4\n5   3.279758e+10        Books         None             1                   5\n6   3.272964e+10          Men         None             1                   6\n7   3.271529e+10        Shoes         None             1                   7\n8   3.268876e+10  Electronics         None             1                   8\n9   3.263979e+10         Home         None             1                   9\n10  3.263888e+10      Jewelry         None             1                  10\n11  8.442420e+09     Children      infants             0                   1\n12  8.399044e+09        Women    maternity             0                   1\n13  8.380284e+09        Music    classical             0                   1\n14  8.345784e+09          Men  accessories             0                   1\n15  8.344780e+09     Children     toddlers             0                   2\n16  8.251046e+09        Shoes     athletic             0                   1\n17  8.250210e+09        Women   fragrances             0                   2\n18  8.240148e+09        Women     swimwear             0                   3\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.315059e+10        Women        None             1                   2\n2   3.312029e+10     Children        None             1                   3\n3   3.293265e+10        Music        None             1                   4\n4   3.279758e+10        Books        None             1                   5\n5   3.272964e+10          Men        None             1                   6\n6   3.271529e+10        Shoes        None             1                   7\n7   3.268876e+10  Electronics        None             1                   8\n8   3.263979e+10         Home        None             1                   9\n9   3.263888e+10      Jewelry        None             1                  10\n10  7.977467e+08                     None             1                  11\n11  3.325262e+10       Sports        None             1                   1\n12  8.240148e+09        Women    swimwear             0                   3\n13  2.153402e+09         Home     bedding             0                   2\n14  8.217883e+09        Women     dresses             0                   4\n15  2.092593e+09         Home    flatware             0                   3\n16  4.330439e+07        Women                         0                   5\n17  2.088001e+09         Home    bathroom             0                   4\n18  8.250210e+09        Women  fragrances             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024011,
                    "execution_time": 0.010592,
                    "compile_time": 0.000134,
                    "planning_time": 0.005075
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.223562,
                    "execution_time": 0.011596,
                    "compile_time": 0.169643,
                    "planning_time": 0.04074
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.315059e+10        Women        None             1                   2\n2   3.312029e+10     Children        None             1                   3\n3   3.293265e+10        Music        None             1                   4\n4   3.279758e+10        Books        None             1                   5\n5   3.272964e+10          Men        None             1                   6\n6   3.271529e+10        Shoes        None             1                   7\n7   3.268876e+10  Electronics        None             1                   8\n8   3.263979e+10         Home        None             1                   9\n9   3.263888e+10      Jewelry        None             1                  10\n10  7.977467e+08                     None             1                  11\n11  3.325262e+10       Sports        None             1                   1\n12  8.240148e+09        Women    swimwear             0                   3\n13  2.153402e+09         Home     bedding             0                   2\n14  8.217883e+09        Women     dresses             0                   4\n15  2.092593e+09         Home    flatware             0                   3\n16  4.330439e+07        Women                         0                   5\n17  2.088001e+09         Home    bathroom             0                   4\n18  8.250210e+09        Women  fragrances             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim d1\n   ,item i\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i.i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.241373,
                    "execution_time": 1.16201,
                    "compile_time": 0.000422,
                    "planning_time": 0.04578,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.562547,
                    "execution_time": 1.40716,
                    "compile_time": 0.000449,
                    "planning_time": 0.120725,
                    "create_size": 64
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103691,
                    "execution_time": 0.058832,
                    "compile_time": 0.000533,
                    "planning_time": 0.010578,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.146263,
                    "execution_time": 0.05871,
                    "compile_time": 0.000531,
                    "planning_time": 0.05271,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.315059e+10        Women        None             1                   2\n2   3.312029e+10     Children        None             1                   3\n3   3.293265e+10        Music        None             1                   4\n4   3.279758e+10        Books        None             1                   5\n5   3.272964e+10          Men        None             1                   6\n6   3.271529e+10        Shoes        None             1                   7\n7   3.268876e+10  Electronics        None             1                   8\n8   3.263979e+10         Home        None             1                   9\n9   3.263888e+10      Jewelry        None             1                  10\n10  7.977467e+08                     None             1                  11\n11  3.325262e+10       Sports        None             1                   1\n12  1.801276e+07                   shirts             0                   2\n13  1.644396e+07                   womens             0                   3\n14  1.626802e+07                 swimwear             0                   4\n15  1.517670e+07                  newborn             0                   5\n16  1.487804e+07               fragrances             0                   6\n17  1.239964e+07                  infants             0                   7\n18  1.228213e+07                  dresses             0                   8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025382,
                    "execution_time": 0.010942,
                    "compile_time": 0.000171,
                    "planning_time": 0.005832
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.06386,
                    "execution_time": 0.011064,
                    "compile_time": 0.002849,
                    "planning_time": 0.041701
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.315059e+10        Women        None             1                   2\n2   3.312029e+10     Children        None             1                   3\n3   3.293265e+10        Music        None             1                   4\n4   3.279758e+10        Books        None             1                   5\n5   3.272964e+10          Men        None             1                   6\n6   3.271529e+10        Shoes        None             1                   7\n7   3.268876e+10  Electronics        None             1                   8\n8   3.263979e+10         Home        None             1                   9\n9   3.263888e+10      Jewelry        None             1                  10\n10  7.977467e+08                     None             1                  11\n11  3.325262e+10       Sports        None             1                   1\n12  1.801276e+07                   shirts             0                   2\n13  1.644396e+07                   womens             0                   3\n14  1.626802e+07                 swimwear             0                   4\n15  1.517670e+07                  newborn             0                   5\n16  1.487804e+07               fragrances             0                   6\n17  1.239964e+07                  infants             0                   7\n18  1.228213e+07                  dresses             0                   8\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end,\n   rank_within_parent \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END , \"RANK_WITHIN_PARENT\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.325262e+10       Sports        None             1                   1\n2   3.315059e+10        Women        None             1                   2\n3   3.312029e+10     Children        None             1                   3\n4   3.293265e+10        Music        None             1                   4\n5   3.279758e+10        Books        None             1                   5\n6   3.272964e+10          Men        None             1                   6\n7   3.271529e+10        Shoes        None             1                   7\n8   3.268876e+10  Electronics        None             1                   8\n9   3.263979e+10         Home        None             1                   9\n10  3.263888e+10      Jewelry        None             1                  10\n11  7.977467e+08                     None             1                  11\n12  4.068719e+08                                      0                   1\n13  1.801276e+07                   shirts             0                   2\n14  1.644396e+07                   womens             0                   3\n15  1.626802e+07                 swimwear             0                   4\n16  1.517670e+07                  newborn             0                   5\n17  1.487804e+07               fragrances             0                   6\n18  1.239964e+07                  infants             0                   7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025858,
                    "execution_time": 0.010543,
                    "compile_time": 0.000146,
                    "planning_time": 0.006337
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.219583,
                    "execution_time": 0.010786,
                    "compile_time": 0.164258,
                    "planning_time": 0.042142
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.325262e+10       Sports        None             1                   1\n2   3.315059e+10        Women        None             1                   2\n3   3.312029e+10     Children        None             1                   3\n4   3.293265e+10        Music        None             1                   4\n5   3.279758e+10        Books        None             1                   5\n6   3.272964e+10          Men        None             1                   6\n7   3.271529e+10        Shoes        None             1                   7\n8   3.268876e+10  Electronics        None             1                   8\n9   3.263979e+10         Home        None             1                   9\n10  3.263888e+10      Jewelry        None             1                  10\n11  7.977467e+08                     None             1                  11\n12  4.068719e+08                                      0                   1\n13  1.801276e+07                   shirts             0                   2\n14  1.644396e+07                   womens             0                   3\n15  1.626802e+07                 swimwear             0                   4\n16  1.517670e+07                  newborn             0                   5\n17  1.487804e+07               fragrances             0                   6\n18  1.239964e+07                  infants             0                   7\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end,\n   rank_within_parent \n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END , \"RANK_WITHIN_PARENT\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.325262e+10       Sports        None             1                   1\n2   3.315059e+10        Women        None             1                   2\n3   3.312029e+10     Children        None             1                   3\n4   3.293265e+10        Music        None             1                   4\n5   3.279758e+10        Books        None             1                   5\n6   3.272964e+10          Men        None             1                   6\n7   3.271529e+10        Shoes        None             1                   7\n8   3.268876e+10  Electronics        None             1                   8\n9   3.263979e+10         Home        None             1                   9\n10  3.263888e+10      Jewelry        None             1                  10\n11  7.977467e+08                     None             1                  11\n12  4.068719e+08                                      0                   1\n13  1.801276e+07                   shirts             0                   2\n14  1.644396e+07                   womens             0                   3\n15  1.626802e+07                 swimwear             0                   4\n16  1.517670e+07                  newborn             0                   5\n17  1.487804e+07               fragrances             0                   6\n18  1.239964e+07                  infants             0                   7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.028012,
                    "execution_time": 0.012026,
                    "compile_time": 0.000154,
                    "planning_time": 0.006422
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.025356,
                    "execution_time": 0.010344,
                    "compile_time": 0.00014,
                    "planning_time": 0.006236
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294638e+11         None        None             2                   1\n1   3.325262e+10       Sports        None             1                   1\n2   3.315059e+10        Women        None             1                   2\n3   3.312029e+10     Children        None             1                   3\n4   3.293265e+10        Music        None             1                   4\n5   3.279758e+10        Books        None             1                   5\n6   3.272964e+10          Men        None             1                   6\n7   3.271529e+10        Shoes        None             1                   7\n8   3.268876e+10  Electronics        None             1                   8\n9   3.263979e+10         Home        None             1                   9\n10  3.263888e+10      Jewelry        None             1                  10\n11  7.977467e+08                     None             1                  11\n12  4.068719e+08                                      0                   1\n13  1.801276e+07                   shirts             0                   2\n14  1.644396e+07                   womens             0                   3\n15  1.626802e+07                 swimwear             0                   4\n16  1.517670e+07                  newborn             0                   5\n17  1.487804e+07               fragrances             0                   6\n18  1.239964e+07                  infants             0                   7\n...*/"
    }
]