[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price) \n from web_sales, customer, customer_address, date_dim, item group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk\ngroup by ca_zip, ca_state /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk group by ca_zip, ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792'))\n group by ca_zip, ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.613484,
                    "execution_time": 9.513177,
                    "compile_time": 0.000532,
                    "planning_time": 0.061714,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.494759,
                    "execution_time": 10.302246,
                    "compile_time": 0.006085,
                    "planning_time": 0.144661,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state        _col_2\n0   85669       UT  8.907852e+09\n1   85460       UT  1.866513e+09\n2   86475       UT  8.771066e+08\n3   85392       AZ  4.914788e+08\n4   80348       ID  9.890374e+08\n5   85460       CO  1.176676e+09\n6   85669       ID  1.544646e+10\n7   85669       CO  2.377641e+10\n8   85460       NM  4.229303e+08\n9   88274       WY  3.314949e+08\n10  80348       NM  1.908493e+08\n11  86475           5.228241e+08\n12  85669       WY  1.015727e+10\n13  85392       WY  7.750031e+08\n14  85392       CO  8.179223e+08\n15  86475       NV  1.822725e+09\n16  83405       CO  1.681305e+09\n17  83405       WY  6.126196e+08\n18  83405       ID  3.044025e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015994,
                    "execution_time": 0.006853,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003258
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052814,
                    "execution_time": 0.007001,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.03794
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state        _col_2\n0   85669       UT  8.907852e+09\n1   85460       UT  1.866513e+09\n2   86475       UT  8.771066e+08\n3   85392       AZ  4.914788e+08\n4   80348       ID  9.890374e+08\n5   85460       CO  1.176676e+09\n6   85669       ID  1.544646e+10\n7   85669       CO  2.377641e+10\n8   85460       NM  4.229303e+08\n9   88274       WY  3.314949e+08\n10  80348       NM  1.908493e+08\n11  86475           5.228241e+08\n12  85669       WY  1.015727e+10\n13  85392       WY  7.750031e+08\n14  85392       CO  8.179223e+08\n15  86475       NV  1.822725e+09\n16  83405       CO  1.681305e+09\n17  83405       WY  6.126196e+08\n18  83405       ID  3.044025e+07\n...*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n/*CURSOR_IDENTIFIER*/\n )\n group by ca_zip, ca_state",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state        _col_2\n0   85669       UT  8.907852e+09\n1   85460       UT  1.866513e+09\n2   86475       UT  8.771066e+08\n3   85392       AZ  4.914788e+08\n4   80348       ID  9.890374e+08\n5   85460       CO  1.176676e+09\n6   85669       ID  1.544646e+10\n7   85669       CO  2.377641e+10\n8   85460       NM  4.229303e+08\n9   88274       WY  3.314949e+08\n10  80348       NM  1.908493e+08\n11  86475           5.228241e+08\n12  85669       WY  1.015727e+10\n13  85392       WY  7.750031e+08\n14  85392       CO  8.179223e+08\n15  86475       NV  1.822725e+09\n16  83405       CO  1.681305e+09\n17  83405       WY  6.126196e+08\n18  83405       ID  3.044025e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015741,
                    "execution_time": 0.00681,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.003162
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050796,
                    "execution_time": 0.006851,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.03804
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state        _col_2\n0   85669       UT  8.907852e+09\n1   85460       UT  1.866513e+09\n2   86475       UT  8.771066e+08\n3   85392       AZ  4.914788e+08\n4   80348       ID  9.890374e+08\n5   85460       CO  1.176676e+09\n6   85669       ID  1.544646e+10\n7   85669       CO  2.377641e+10\n8   85460       NM  4.229303e+08\n9   88274       WY  3.314949e+08\n10  80348       NM  1.908493e+08\n11  86475           5.228241e+08\n12  85669       WY  1.015727e+10\n13  85392       WY  7.750031e+08\n14  85392       CO  8.179223e+08\n15  86475       NV  1.822725e+09\n16  83405       CO  1.681305e+09\n17  83405       WY  6.126196e+08\n18  83405       ID  3.044025e+07\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)))\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.0874,
                    "execution_time": 0.035462,
                    "compile_time": 0.000265,
                    "planning_time": 0.027247,
                    "create_size": 36
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.256666,
                    "execution_time": 0.037594,
                    "compile_time": 0.103518,
                    "planning_time": 0.088376,
                    "create_size": 36
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" FROM 1 FOR 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ NULL as ca_zip, NULL as ca_state, sum(i_current_price) as ws_sales_price\n from item\n where i_item_id in (select i_item_id\n                     from item\n                     where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                     )\n and substring(NULL,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.092898,
                    "execution_time": 0.033911,
                    "compile_time": 0.000357,
                    "planning_time": 0.030482,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.372598,
                    "execution_time": 0.034854,
                    "compile_time": 0.202727,
                    "planning_time": 0.103073,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"WS_SALES_PRICE\" AS \"WS_SALES_PRICE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*  ca_zip ca_state ws_sales_price\n0   None     None           None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017309,
                    "execution_time": 0.007735,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003464
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.239175,
                    "execution_time": 0.007759,
                    "compile_time": 0.185989,
                    "planning_time": 0.038186
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"WS_SALES_PRICE\" AS \"WS_SALES_PRICE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*  ca_zip ca_state ws_sales_price\n0   None     None           None*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\ngroup by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" FROM 1 FOR 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales\n join customer on ws_bill_customer_sk = c_customer_sk\n join customer_address on c_current_addr_sk = ca_address_sk \n join date_dim on ws_sold_date_sk = d_date_sk\n join item on ws_item_sk = i_item_sk \n where ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 22.138265,
                    "execution_time": 22.00847,
                    "compile_time": 0.000636,
                    "planning_time": 0.074583,
                    "create_size": 96
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 44.9805,
                    "execution_time": 21.757099,
                    "compile_time": 23.005171,
                    "planning_time": 0.158464,
                    "create_size": 96
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   55079       MN  205.09\n1   20499       NC  351.66\n2   23394       SC  677.49\n3   23511       SC  176.93\n4   08138       NJ   77.84\n5   32812       AL  255.31\n6   85281       UT  247.41\n7   69237       MO  502.73\n8   89003       CO  214.15\n9   67746       IL  614.76\n10  79431       OK  310.61\n11  64854       MO  656.93\n12  44466       IN  459.64\n13  82276       CO  276.13\n14  58054       ND  371.99\n15  60399       NE  658.08\n16  66653       MO  175.89\n17  21904       WV  328.54\n18  81711       ID  105.93\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015836,
                    "execution_time": 0.006768,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003295
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053058,
                    "execution_time": 0.00718,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038102
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   55079       MN  205.09\n1   20499       NC  351.66\n2   23394       SC  677.49\n3   23511       SC  176.93\n4   08138       NJ   77.84\n5   32812       AL  255.31\n6   85281       UT  247.41\n7   69237       MO  502.73\n8   89003       CO  214.15\n9   67746       IL  614.76\n10  79431       OK  310.61\n11  64854       MO  656.93\n12  44466       IN  459.64\n13  82276       CO  276.13\n14  58054       ND  371.99\n15  60399       NE  658.08\n16  66653       MO  175.89\n17  21904       WV  328.54\n18  81711       ID  105.93\n...*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.377719,
                    "execution_time": 1.257933,
                    "compile_time": 0.000631,
                    "planning_time": 0.076221,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.616176,
                    "execution_time": 1.264834,
                    "compile_time": 0.142194,
                    "planning_time": 0.161452,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   39310       GA  100.01\n1   98721       AK    3.89\n2   18222       NY   60.67\n3   20534       NC   98.58\n4   41075       MI   87.35\n5   88482       CO    3.69\n6   73003       TX    4.46\n7   66787       NE    2.74\n8   20499       WV  123.47\n9   24174       VA  109.60\n10  74593       OK   22.63\n11  55799       SD   74.33\n12  89003       NV  102.72\n13  51757       SD    7.55\n14  12219       PA   67.82\n15  58222       MS    4.96\n16  60499       KS  166.27\n17  79310       TX   42.25\n18  37057       FL   39.89\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01579,
                    "execution_time": 0.006798,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003271
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053143,
                    "execution_time": 0.006826,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.0384
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   39310       GA  100.01\n1   98721       AK    3.89\n2   18222       NY   60.67\n3   20534       NC   98.58\n4   41075       MI   87.35\n5   88482       CO    3.69\n6   73003       TX    4.46\n7   66787       NE    2.74\n8   20499       WV  123.47\n9   24174       VA  109.60\n10  74593       OK   22.63\n11  55799       SD   74.33\n12  89003       NV  102.72\n13  51757       SD    7.55\n14  12219       PA   67.82\n15  58222       MS    4.96\n16  60499       KS  166.27\n17  79310       TX   42.25\n18  37057       FL   39.89\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n order by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" , \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0                   300.96\n1               AL  158.02\n2               AR   39.21\n3               AZ    0.28\n4               CO   62.58\n5               IL  228.70\n6               IN    4.15\n7               KS  152.34\n8               MN  213.03\n9               MO   33.40\n10              MS   12.82\n11              MT   27.61\n12              NE   53.59\n13              NJ    4.63\n14              OH   46.57\n15              OK   23.84\n16              TX   26.80\n17              VA   10.14\n18              WI  143.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01719,
                    "execution_time": 0.0079,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003534
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.140358,
                    "execution_time": 0.008863,
                    "compile_time": 0.085277,
                    "planning_time": 0.038413
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0                   300.96\n1               AL  158.02\n2               AR   39.21\n3               AZ    0.28\n4               CO   62.58\n5               IL  228.70\n6               IN    4.15\n7               KS  152.34\n8               MN  213.03\n9               MO   33.40\n10              MS   12.82\n11              MT   27.61\n12              NE   53.59\n13              NJ    4.63\n14              OH   46.57\n15              OK   23.84\n16              TX   26.80\n17              VA   10.14\n18              WI  143.36\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n order by ca_zip, ca_state\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" , \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0                   300.96\n1               AL  158.02\n2               AR   39.21\n3               AZ    0.28\n4               CO   62.58\n5               IL  228.70\n6               IN    4.15\n7               KS  152.34\n8               MN  213.03\n9               MO   33.40\n10              MS   12.82\n11              MT   27.61\n12              NE   53.59\n13              NJ    4.63\n14              OH   46.57\n15              OK   23.84\n16              TX   26.80\n17              VA   10.14\n18              WI  143.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017368,
                    "execution_time": 0.007817,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.00362
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017595,
                    "execution_time": 0.007984,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003639
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0                   300.96\n1               AL  158.02\n2               AR   39.21\n3               AZ    0.28\n4               CO   62.58\n5               IL  228.70\n6               IN    4.15\n7               KS  152.34\n8               MN  213.03\n9               MO   33.40\n10              MS   12.82\n11              MT   27.61\n12              NE   53.59\n13              NJ    4.63\n14              OH   46.57\n15              OK   23.84\n16              TX   26.80\n17              VA   10.14\n18              WI  143.36\n...*/"
    }
]