[
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere  1=1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.413105,
                    "execution_time": 4.337838,
                    "compile_time": 0.000454,
                    "planning_time": 0.045121,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.865822,
                    "execution_time": 10.710256,
                    "compile_time": 0.0015,
                    "planning_time": 0.120778,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.554348e+13*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015981,
                    "execution_time": 0.006925,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003186
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051928,
                    "execution_time": 0.007401,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038459
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.554348e+13*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and '1998-02-28'  \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093735,
                    "execution_time": 0.039673,
                    "compile_time": 0.000306,
                    "planning_time": 0.028744,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.166504,
                    "execution_time": 0.039,
                    "compile_time": 0.000294,
                    "planning_time": 0.100812,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    excess discount amount\n0             3.554348e+13\n1             3.554348e+13\n2             3.554348e+13\n3             3.554348e+13\n4             3.554348e+13\n5             3.554348e+13\n6             3.554348e+13\n7             3.554348e+13\n8             3.554348e+13\n9             3.554348e+13\n10            3.554348e+13\n11            3.554348e+13\n12            3.554348e+13\n13            3.554348e+13\n14            3.554348e+13\n15            3.554348e+13\n16            3.554348e+13\n17            3.554348e+13\n18            3.554348e+13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016259,
                    "execution_time": 0.007073,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003139
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05287,
                    "execution_time": 0.007142,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.038303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('1998-02-28' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    excess discount amount\n0             3.554348e+13\n1             3.554348e+13\n2             3.554348e+13\n3             3.554348e+13\n4             3.554348e+13\n5             3.554348e+13\n6             3.554348e+13\n7             3.554348e+13\n8             3.554348e+13\n9             3.554348e+13\n10            3.554348e+13\n11            3.554348e+13\n12            3.554348e+13\n13            3.554348e+13\n14            3.554348e+13\n15            3.554348e+13\n16            3.554348e+13\n17            3.554348e+13\n18            3.554348e+13\n...*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            4.427791e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.491011,
                    "execution_time": 0.436647,
                    "compile_time": 0.00019,
                    "planning_time": 0.043135
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.570955,
                    "execution_time": 0.436466,
                    "compile_time": 0.000199,
                    "planning_time": 0.121455
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            4.427791e+10*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             13636373.97*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.086794,
                    "execution_time": 0.032502,
                    "compile_time": 0.000208,
                    "planning_time": 0.042518
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.354866,
                    "execution_time": 0.049241,
                    "compile_time": 0.181075,
                    "planning_time": 0.111002
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0             13636373.97*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > 0 LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             13636373.97*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.092694,
                    "execution_time": 0.038894,
                    "compile_time": 0.000204,
                    "planning_time": 0.041895
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.28606,
                    "execution_time": 0.039079,
                    "compile_time": 0.122314,
                    "planning_time": 0.110338
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0             13636373.97*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n/*CURSOR_IDENTIFIER*/ \n         0\n         )",
        "optimize": [
            "SELECT 0 AS \"0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT 0 AS \"0\" LIMIT 21",
                "preview": "\n/*   0\n0  0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.732214,
                    "execution_time": 0.471969,
                    "compile_time": 0.000326,
                    "planning_time": 0.078413
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.707173,
                    "execution_time": 0.448971,
                    "compile_time": 0.00034,
                    "planning_time": 0.076879
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 0 AS \"0\"",
                "rewrite": "SELECT 0 AS \"0\""
            }
        ],
        "preview": "\n/*   0\n0  0*/"
    },
    {
        "input": "select /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_item_sk = ws_item_sk \nand d_date_sk = ws_sold_date_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales\n         WHERE \n            ws_ext_discount_amt IS NOT NULL\n       ) /* Closing the open subquery */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE NOT \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" IS NULL ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE NOT \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.572581,
                    "execution_time": 0.517097,
                    "compile_time": 0.000308,
                    "planning_time": 0.02894,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.643418,
                    "execution_time": 0.5178,
                    "compile_time": 0.00122,
                    "planning_time": 0.095757,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_ITEM_SK = WS_ITEM_SK AND D_DATE_SK = WS_SOLD_DATE_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES WHERE NOT WS_EXT_DISCOUNT_AMT IS NULL ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.675177e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.611806,
                    "execution_time": 0.547461,
                    "compile_time": 0.000303,
                    "planning_time": 0.048218
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.80719,
                    "execution_time": 0.546933,
                    "compile_time": 0.120942,
                    "planning_time": 0.118468
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.675177e+10*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\nitem.i_manufact_id = 992\nand item.i_item_sk = ws_item_sk \nand date_dim.d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand date_dim.d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n         web_sales\n/*CURSOR_IDENTIFIER*/  )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.404169,
                    "execution_time": 0.349818,
                    "compile_time": 0.000329,
                    "planning_time": 0.02811,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.474688,
                    "execution_time": 0.351837,
                    "compile_time": 0.000381,
                    "planning_time": 0.092993,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE ITEM.I_MANUFACT_ID = 992 AND ITEM.I_ITEM_SK = WS_ITEM_SK AND DATE_DIM.D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND DATE_DIM.D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9508730.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.42504,
                    "execution_time": 0.360089,
                    "compile_time": 0.000385,
                    "planning_time": 0.048604
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.533506,
                    "execution_time": 0.36313,
                    "compile_time": 0.001423,
                    "planning_time": 0.149581
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              9508730.45*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n    ,date_dim\nwhere\nd_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n         where ws_ext_discount_amt > 0\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0 ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.517103,
                    "execution_time": 0.462184,
                    "compile_time": 0.000319,
                    "planning_time": 0.028677,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.588233,
                    "execution_time": 0.462644,
                    "compile_time": 0.001257,
                    "planning_time": 0.095269,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , DATE_DIM WHERE D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES WHERE WS_EXT_DISCOUNT_AMT > 0 ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.657458e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.531042,
                    "execution_time": 0.474488,
                    "compile_time": 0.000258,
                    "planning_time": 0.042401
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.737952,
                    "execution_time": 0.474003,
                    "compile_time": 0.137509,
                    "planning_time": 0.1087
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.657458e+10*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n           WHERE d_date_sk = ws_sold_date_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.257351,
                    "execution_time": 1.190283,
                    "compile_time": 0.000357,
                    "planning_time": 0.037502,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.544964,
                    "execution_time": 1.294468,
                    "compile_time": 0.111386,
                    "planning_time": 0.107549,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9508730.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.269315,
                    "execution_time": 1.197801,
                    "compile_time": 0.000365,
                    "planning_time": 0.052631
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.355287,
                    "execution_time": 1.202638,
                    "compile_time": 0.001572,
                    "planning_time": 0.129936
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              9508730.45*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE d_date_sk = ws_sold_date_sk\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9508730.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.266132,
                    "execution_time": 1.197484,
                    "compile_time": 0.000359,
                    "planning_time": 0.050762
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.273332,
                    "execution_time": 1.20437,
                    "compile_time": 0.000362,
                    "planning_time": 0.051104
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              9508730.45*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\"",
                "rewrite": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n         dateadd(day,90,cast('1998-02-02' as date))\n         )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9520406.64*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.579394,
                    "execution_time": 0.477837,
                    "compile_time": 0.000488,
                    "planning_time": 0.079246
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.66559,
                    "execution_time": 0.477553,
                    "compile_time": 0.002745,
                    "planning_time": 0.149732
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              9520406.64*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9520406.64*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.575058,
                    "execution_time": 0.480953,
                    "compile_time": 0.00048,
                    "planning_time": 0.072338
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.573491,
                    "execution_time": 0.477779,
                    "compile_time": 0.000463,
                    "planning_time": 0.074162
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              9520406.64*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 12.067627,
                    "execution_time": 11.782227,
                    "compile_time": 0.000271,
                    "planning_time": 0.027737,
                    "create_size": 13184
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.288166,
                    "execution_time": 11.927273,
                    "compile_time": 0.00026,
                    "planning_time": 0.092599,
                    "create_size": 13184
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9585245.29*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.166832,
                    "execution_time": 0.071088,
                    "compile_time": 0.000488,
                    "planning_time": 0.073509
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.0897,
                    "execution_time": 0.072325,
                    "compile_time": 3.836214,
                    "planning_time": 0.156973
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              9585245.29*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9585245.29*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.167293,
                    "execution_time": 0.070005,
                    "compile_time": 0.000468,
                    "planning_time": 0.074252
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.167486,
                    "execution_time": 0.07261,
                    "compile_time": 0.00046,
                    "planning_time": 0.073049
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              9585245.29*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ORDER BY SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) ORDER BY SUM ( WS_EXT_DISCOUNT_AMT ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9585245.29*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.165398,
                    "execution_time": 0.071933,
                    "compile_time": 0.00045,
                    "planning_time": 0.072135
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.237509,
                    "execution_time": 0.070336,
                    "compile_time": 0.000568,
                    "planning_time": 0.144607
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              9585245.29*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ORDER BY SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) ORDER BY SUM ( WS_EXT_DISCOUNT_AMT ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              9585245.29*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.163149,
                    "execution_time": 0.069479,
                    "compile_time": 0.000454,
                    "planning_time": 0.072229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.170711,
                    "execution_time": 0.072438,
                    "compile_time": 0.00046,
                    "planning_time": 0.076391
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              9585245.29*/"
    }
]