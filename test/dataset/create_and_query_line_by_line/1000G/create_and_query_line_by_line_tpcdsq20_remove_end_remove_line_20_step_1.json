[
    {
        "input": "select /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over () as percentage_of_total_sales\n/*CURSOR_IDENTIFIER*/\nfrom item\njoin catalog_sales on cs_item_sk = i_item_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER () AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "SELECT /* TPC-DS query20.tpl 0.65 */ i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,SUM(cs_ext_sales_price) AS itemrevenue \n       ,SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER\n           (PARTITION BY i_class) AS revenueratio\n/*CURSOR_IDENTIFIER*/\nFROM catalog_sales cs\nJOIN item i ON cs.cs_item_sk = i.i_item_sk\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price;",
        "optimize": [
            "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"I\".\"I_CLASS\" AS \"I_CLASS\", \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CS\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CS\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CS\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"I\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\", \"I\".\"I_ITEM_DESC\", \"I\".\"I_CATEGORY\", \"I\".\"I_CLASS\", \"I\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  CS_ITEM_SK as i_item_id\n       ,null as i_item_desc \n       ,null as i_category \n       ,null as i_class \n       ,CS_SALES_PRICE as i_current_price\n       ,sum(CS_EXT_SALES_PRICE) as itemrevenue \n       ,sum(CS_EXT_SALES_PRICE)*100/sum(sum(CS_EXT_SALES_PRICE)) over\n           (partition by CS_ITEM_SK) as revenueratio\n from\tcatalog_sales\n group by CS_ITEM_SK, CS_SALES_PRICE\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\", NULL AS \"I_ITEM_DESC\", NULL AS \"I_CATEGORY\", NULL AS \"I_CLASS\", \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\", \"CATALOG_SALES\".\"CS_SALES_PRICE\"",
                "rewrite": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 25.351106,
                    "execution_time": 25.046164,
                    "compile_time": 0.000635,
                    "planning_time": 0.045473,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 25.989867,
                    "execution_time": 25.596587,
                    "compile_time": 0.000673,
                    "planning_time": 0.123963,
                    "create_size": 640
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) and cast('1998-05-20' as date) \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-05-20' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-05-20' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.3946,
                    "execution_time": 0.211595,
                    "compile_time": 0.000658,
                    "planning_time": 0.046775,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.463711,
                    "execution_time": 0.207315,
                    "compile_time": 0.000665,
                    "planning_time": 0.119468,
                    "create_size": 640
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST('1998-05-20' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                 i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAIODBCAAA                                                                                                                        Scottish friends come potential, cheap reforms. Nearly subsequent le  Electronics  cameras             0.20    269803.93        0.1235\n1   AAAAAAAAAOLNAAAA         Special governments used to capture routine members. Human years suit very free books. Only only workers impose; permanent, material crowds would not affect more possible, traditi  Electronics  cameras             7.88    314444.49        0.1439\n2   AAAAAAAAELJFCAAA                                  Probable, essential plans used to say firms. Students lead trains; managerial, old consequences run so. More necessary lives wait urgent times. Average, e  Electronics  cameras             6.57    238789.51        0.1093\n3   AAAAAAAALFGGAAAA                                                                                                        Fairly full colours could not continue directly. Classical samples refer. Musicians   Electronics  cameras             3.01    182002.82        0.0833\n4   AAAAAAAABMOFCAAA                                                                                                                   Seats might draw into a patients. Points might not resume partly yet simp  Electronics  cameras             4.24    174561.88        0.0799\n5   AAAAAAAAPFOFEAAA              Little organs must want sharply extra sorts. Red, expensive samples might not see equally capital cells. Most angry problems find however explicit members. Things believe all  Electronics  cameras            74.34    314079.31        0.1438\n6   AAAAAAAAKCAMBAAA                                                                                                                                   Members could turn. American wounds will not like just me  Electronics  cameras            30.92    200160.58        0.0916\n7   AAAAAAAAECHCCAAA                                Names should modify institutional, red eyes; recent, serious forms phone residential years. Too black figures must travel very; much only policies may not a  Electronics  cameras            79.41    307705.06        0.1408\n8   AAAAAAAACOAGAAAA                                                                                                                                                                          Impressive applica  Electronics  cameras             1.66    236266.44        0.1081\n9   AAAAAAAAFLKKBAAA                                                                                                                                                      Else physical sports should explain qu  Electronics  cameras             4.10    159722.74        0.0731\n10  AAAAAAAANNLDDAAA                                                                         Much private minutes cannot follow sharp main full women. Essential, given days ignore to a results. Hospitals woul  Electronics  cameras             2.23    216662.95        0.0992\n11  AAAAAAAAEOIDAAAA  Of course old courses run unduly. As primary relations reach perhaps. Players collect full, nearby publications. Strong, rare times recover far physical men. Guilty, valid years must not  Electronics  cameras             4.84    227481.75        0.1041\n12  AAAAAAAACDIFCAAA                                                                                                                                                                     Matters may address pub  Electronics  cameras             1.61    184534.64        0.0844\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.359663,
                    "execution_time": 0.298387,
                    "compile_time": 0.000299,
                    "planning_time": 0.042841
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.417876,
                    "execution_time": 0.284526,
                    "compile_time": 0.000309,
                    "planning_time": 0.114442
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                 i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAIODBCAAA                                                                                                                        Scottish friends come potential, cheap reforms. Nearly subsequent le  Electronics  cameras             0.20    269803.93        0.1235\n1   AAAAAAAAAOLNAAAA         Special governments used to capture routine members. Human years suit very free books. Only only workers impose; permanent, material crowds would not affect more possible, traditi  Electronics  cameras             7.88    314444.49        0.1439\n2   AAAAAAAAELJFCAAA                                  Probable, essential plans used to say firms. Students lead trains; managerial, old consequences run so. More necessary lives wait urgent times. Average, e  Electronics  cameras             6.57    238789.51        0.1093\n3   AAAAAAAALFGGAAAA                                                                                                        Fairly full colours could not continue directly. Classical samples refer. Musicians   Electronics  cameras             3.01    182002.82        0.0833\n4   AAAAAAAABMOFCAAA                                                                                                                   Seats might draw into a patients. Points might not resume partly yet simp  Electronics  cameras             4.24    174561.88        0.0799\n5   AAAAAAAAPFOFEAAA              Little organs must want sharply extra sorts. Red, expensive samples might not see equally capital cells. Most angry problems find however explicit members. Things believe all  Electronics  cameras            74.34    314079.31        0.1438\n6   AAAAAAAAKCAMBAAA                                                                                                                                   Members could turn. American wounds will not like just me  Electronics  cameras            30.92    200160.58        0.0916\n7   AAAAAAAAECHCCAAA                                Names should modify institutional, red eyes; recent, serious forms phone residential years. Too black figures must travel very; much only policies may not a  Electronics  cameras            79.41    307705.06        0.1408\n8   AAAAAAAACOAGAAAA                                                                                                                                                                          Impressive applica  Electronics  cameras             1.66    236266.44        0.1081\n9   AAAAAAAAFLKKBAAA                                                                                                                                                      Else physical sports should explain qu  Electronics  cameras             4.10    159722.74        0.0731\n10  AAAAAAAANNLDDAAA                                                                         Much private minutes cannot follow sharp main full women. Essential, given days ignore to a results. Hospitals woul  Electronics  cameras             2.23    216662.95        0.0992\n11  AAAAAAAAEOIDAAAA  Of course old courses run unduly. As primary relations reach perhaps. Players collect full, nearby publications. Strong, rare times recover far physical men. Guilty, valid years must not  Electronics  cameras             4.84    227481.75        0.1041\n12  AAAAAAAACDIFCAAA                                                                                                                                                                     Matters may address pub  Electronics  cameras             1.61    184534.64        0.0844\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACLFCAAAA                                     Original, tall patients might benefit and so on alone statutory centres. Further red legs must say readily important, maximum years. Customers could call very phys     Sports  basketball             2.13    227655.97        0.1037\n1   AAAAAAAAILFPCAAA                                                                                                                                         Still desirable materials address interests. Dead, identical dr     Sports  basketball             8.13    216974.42        0.0989\n2   AAAAAAAAAOPGDAAA                                       Foreign, ideal needs think much. Little subjects carry immediately proposed contents. Bad, precise studies should fight of course somewhere wild views. Instituti     Sports  basketball             2.24    201057.10        0.0916\n3   AAAAAAAAILDNAAAA                                                                                                                                                                                          Letters tear t     Sports  basketball             4.37    219283.14        0.0999\n4   AAAAAAAABBHKAAAA  Studies might fall old workers. Wooden, full images ought to transfer also english men. Certain comments stand mainly from the improvements. More famous boats construct for example political others.     Sports  basketball             3.02    226335.61        0.1031\n5   AAAAAAAACMFDDAAA                                                                                                                           Just old examples should not see great questions. Lives set. Issues include a     Sports  basketball            88.33    264280.91        0.1204\n6   AAAAAAAAGNBHCAAA           Bare, cultural features must stand purely in a tools. Subsequently particular sources ought to like neither native processes. Only attacks take really senior ministers; circumstances might      Sports  basketball            94.57    267829.76        0.1220\n7   AAAAAAAAMOMMCAAA                                                                                                                                                                                                  New, l     Sports  basketball             8.70    249008.81        0.1135\n8   AAAAAAAAMHBIEAAA                                                                                                                                                                           Also female cars must need fa     Sports  basketball            61.70    214894.84        0.0979\n9   AAAAAAAACAOHDAAA                 Thousands may find enough payments. Women worry adequately twice general secrets. So subsequent buildings will comment acutely low, little methods. As sheer leaders would get newly fo     Sports  basketball             7.10    280870.20        0.1280\n10  AAAAAAAADHLLCAAA                                                                                                                                                                       Electronic, musical wings cannot      Sports  basketball             1.64    261745.69        0.1193\n11  AAAAAAAAKAGHDAAA                                                                                                                                                                    Atlantic professionals can look teac     Sports  basketball             1.79    260486.80        0.1187\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.351102,
                    "execution_time": 0.289756,
                    "compile_time": 0.000296,
                    "planning_time": 0.043932
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.355337,
                    "execution_time": 0.29385,
                    "compile_time": 0.000317,
                    "planning_time": 0.043643
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACLFCAAAA                                     Original, tall patients might benefit and so on alone statutory centres. Further red legs must say readily important, maximum years. Customers could call very phys     Sports  basketball             2.13    227655.97        0.1037\n1   AAAAAAAAILFPCAAA                                                                                                                                         Still desirable materials address interests. Dead, identical dr     Sports  basketball             8.13    216974.42        0.0989\n2   AAAAAAAAAOPGDAAA                                       Foreign, ideal needs think much. Little subjects carry immediately proposed contents. Bad, precise studies should fight of course somewhere wild views. Instituti     Sports  basketball             2.24    201057.10        0.0916\n3   AAAAAAAAILDNAAAA                                                                                                                                                                                          Letters tear t     Sports  basketball             4.37    219283.14        0.0999\n4   AAAAAAAABBHKAAAA  Studies might fall old workers. Wooden, full images ought to transfer also english men. Certain comments stand mainly from the improvements. More famous boats construct for example political others.     Sports  basketball             3.02    226335.61        0.1031\n5   AAAAAAAACMFDDAAA                                                                                                                           Just old examples should not see great questions. Lives set. Issues include a     Sports  basketball            88.33    264280.91        0.1204\n6   AAAAAAAAGNBHCAAA           Bare, cultural features must stand purely in a tools. Subsequently particular sources ought to like neither native processes. Only attacks take really senior ministers; circumstances might      Sports  basketball            94.57    267829.76        0.1220\n7   AAAAAAAAMOMMCAAA                                                                                                                                                                                                  New, l     Sports  basketball             8.70    249008.81        0.1135\n8   AAAAAAAAMHBIEAAA                                                                                                                                                                           Also female cars must need fa     Sports  basketball            61.70    214894.84        0.0979\n9   AAAAAAAACAOHDAAA                 Thousands may find enough payments. Women worry adequately twice general secrets. So subsequent buildings will comment acutely low, little methods. As sheer leaders would get newly fo     Sports  basketball             7.10    280870.20        0.1280\n10  AAAAAAAADHLLCAAA                                                                                                                                                                       Electronic, musical wings cannot      Sports  basketball             1.64    261745.69        0.1193\n11  AAAAAAAAKAGHDAAA                                                                                                                                                                    Atlantic professionals can look teac     Sports  basketball             1.79    260486.80        0.1187\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                          i_item_desc i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAJAGBAAA                                                                                                                       Directors will not walk social, red businesses. Workers apply again offers; so     Sports  basketball             2.76    191050.37        0.0870\n1   AAAAAAAALLECDAAA                                                                                                                                                                                        Though high l     Sports  basketball             6.03    212931.80        0.0970\n2   AAAAAAAAILDNAAAA                                                                                                                                                                                       Letters tear t     Sports  basketball             4.37    219283.14        0.0999\n3   AAAAAAAAJAFKBAAA  Special authorities will want so as. Current, other seconds may not go by the individuals; so important transactions leave virtually lawyers. So possible drivers shall not challenge more pure org     Sports  basketball             2.92    209231.85        0.0953\n4   AAAAAAAACLFCAAAA                                  Original, tall patients might benefit and so on alone statutory centres. Further red legs must say readily important, maximum years. Customers could call very phys     Sports  basketball             2.13    227655.97        0.1037\n5   AAAAAAAAILFPCAAA                                                                                                                                      Still desirable materials address interests. Dead, identical dr     Sports  basketball             8.13    216974.42        0.0989\n6   AAAAAAAAAOPGDAAA                                    Foreign, ideal needs think much. Little subjects carry immediately proposed contents. Bad, precise studies should fight of course somewhere wild views. Instituti     Sports  basketball             2.24    201057.10        0.0916\n7   AAAAAAAAILPMDAAA                              Brown, new doors would find later prime proposals. Rooms ought to play new, brilliant players. Other years go so into a parties. Specific, young regions need more afte     Sports  basketball             5.49    204606.60        0.0932\n8   AAAAAAAAHLKADAAA                   Only, complete windows become to a results. High services adopt as yet fine terms. Young claims would mean both prepared products. Sentences use together addresses; eyes cannot t     Sports  basketball             2.92    225666.72        0.1028\n9   AAAAAAAAGNBHCAAA        Bare, cultural features must stand purely in a tools. Subsequently particular sources ought to like neither native processes. Only attacks take really senior ministers; circumstances might      Sports  basketball            94.57    267829.76        0.1220\n10  AAAAAAAACMFDDAAA                                                                                                                        Just old examples should not see great questions. Lives set. Issues include a     Sports  basketball            88.33    264280.91        0.1204\n11  AAAAAAAAKEKEEAAA                                                                                                                                                                                                 Famo     Sports  basketball             0.39    232252.89        0.1058\n12  AAAAAAAAMOMMCAAA                                                                                                                                                                                               New, l     Sports  basketball             8.70    249008.81        0.1135\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.354274,
                    "execution_time": 0.293065,
                    "compile_time": 0.000445,
                    "planning_time": 0.04324
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.348958,
                    "execution_time": 0.289925,
                    "compile_time": 0.000305,
                    "planning_time": 0.04152
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                          i_item_desc i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAJAGBAAA                                                                                                                       Directors will not walk social, red businesses. Workers apply again offers; so     Sports  basketball             2.76    191050.37        0.0870\n1   AAAAAAAALLECDAAA                                                                                                                                                                                        Though high l     Sports  basketball             6.03    212931.80        0.0970\n2   AAAAAAAAILDNAAAA                                                                                                                                                                                       Letters tear t     Sports  basketball             4.37    219283.14        0.0999\n3   AAAAAAAAJAFKBAAA  Special authorities will want so as. Current, other seconds may not go by the individuals; so important transactions leave virtually lawyers. So possible drivers shall not challenge more pure org     Sports  basketball             2.92    209231.85        0.0953\n4   AAAAAAAACLFCAAAA                                  Original, tall patients might benefit and so on alone statutory centres. Further red legs must say readily important, maximum years. Customers could call very phys     Sports  basketball             2.13    227655.97        0.1037\n5   AAAAAAAAILFPCAAA                                                                                                                                      Still desirable materials address interests. Dead, identical dr     Sports  basketball             8.13    216974.42        0.0989\n6   AAAAAAAAAOPGDAAA                                    Foreign, ideal needs think much. Little subjects carry immediately proposed contents. Bad, precise studies should fight of course somewhere wild views. Instituti     Sports  basketball             2.24    201057.10        0.0916\n7   AAAAAAAAILPMDAAA                              Brown, new doors would find later prime proposals. Rooms ought to play new, brilliant players. Other years go so into a parties. Specific, young regions need more afte     Sports  basketball             5.49    204606.60        0.0932\n8   AAAAAAAAHLKADAAA                   Only, complete windows become to a results. High services adopt as yet fine terms. Young claims would mean both prepared products. Sentences use together addresses; eyes cannot t     Sports  basketball             2.92    225666.72        0.1028\n9   AAAAAAAAGNBHCAAA        Bare, cultural features must stand purely in a tools. Subsequently particular sources ought to like neither native processes. Only attacks take really senior ministers; circumstances might      Sports  basketball            94.57    267829.76        0.1220\n10  AAAAAAAACMFDDAAA                                                                                                                        Just old examples should not see great questions. Lives set. Issues include a     Sports  basketball            88.33    264280.91        0.1204\n11  AAAAAAAAKEKEEAAA                                                                                                                                                                                                 Famo     Sports  basketball             0.39    232252.89        0.1058\n12  AAAAAAAAMOMMCAAA                                                                                                                                                                                               New, l     Sports  basketball             8.70    249008.81        0.1135\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                   i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEEBNAAAA                                                                                                                                                                                      Shoes                      NaN    222509.93        1.4929\n1   AAAAAAAAPCDJCAAA                                                                                                                                                                                Electronics                     9.97    263218.49        1.7660\n2   AAAAAAAAAMOJCAAA                                                                                                                                                                                      Shoes                      NaN    220673.82        1.4806\n3   AAAAAAAAGFJODAAA                                     Correct matters should not alert gently agencies. Complete, active results could decide heavy daughters. Tired exchanges overcome now app        Shoes                      NaN    240269.59        1.6121\n4   AAAAAAAAMGJPBAAA                                                                                                                                                                                      Shoes                     0.66    235243.32        1.5783\n5   AAAAAAAAAPAHDAAA                                                                                                                                                                                      Shoes                      NaN    225853.15        1.5153\n6   AAAAAAAADBFLCAAA                                                                                                                                                                                      Shoes                      NaN    211408.99        1.4184\n7   AAAAAAAAAMIBCAAA                                                                                                                                                                                     Sports                      NaN    285525.74        1.9157\n8   AAAAAAAAIPHDEAAA                                                                                                                                                         Big hotels might atta       Sports                     8.70    201338.24        1.3509\n9   AAAAAAAAIHDPCAAA                                                                                                                                                                                     Sports                     6.14    202076.34        1.3558\n10  AAAAAAAAAAMCAAAA                                                                                                                                                                                     Sports                      NaN    253220.15        1.6990\n11  AAAAAAAAGDFIAAAA  Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81    277408.69        1.8613\n12  AAAAAAAAAJEADAAA                                              Days will not say in a eyes. Unlikely, middle researchers would permit well. Familiar youngsters step in the main. Instructions        Sports                    46.33    289734.35        1.9440\n13  AAAAAAAAEOGIAAAA                                                                                                                                                                                Electronics                      NaN    207138.43        1.3898\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.353247,
                    "execution_time": 0.293125,
                    "compile_time": 0.000297,
                    "planning_time": 0.042413
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.363653,
                    "execution_time": 0.305035,
                    "compile_time": 0.000298,
                    "planning_time": 0.041303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                   i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEEBNAAAA                                                                                                                                                                                      Shoes                      NaN    222509.93        1.4929\n1   AAAAAAAAPCDJCAAA                                                                                                                                                                                Electronics                     9.97    263218.49        1.7660\n2   AAAAAAAAAMOJCAAA                                                                                                                                                                                      Shoes                      NaN    220673.82        1.4806\n3   AAAAAAAAGFJODAAA                                     Correct matters should not alert gently agencies. Complete, active results could decide heavy daughters. Tired exchanges overcome now app        Shoes                      NaN    240269.59        1.6121\n4   AAAAAAAAMGJPBAAA                                                                                                                                                                                      Shoes                     0.66    235243.32        1.5783\n5   AAAAAAAAAPAHDAAA                                                                                                                                                                                      Shoes                      NaN    225853.15        1.5153\n6   AAAAAAAADBFLCAAA                                                                                                                                                                                      Shoes                      NaN    211408.99        1.4184\n7   AAAAAAAAAMIBCAAA                                                                                                                                                                                     Sports                      NaN    285525.74        1.9157\n8   AAAAAAAAIPHDEAAA                                                                                                                                                         Big hotels might atta       Sports                     8.70    201338.24        1.3509\n9   AAAAAAAAIHDPCAAA                                                                                                                                                                                     Sports                     6.14    202076.34        1.3558\n10  AAAAAAAAAAMCAAAA                                                                                                                                                                                     Sports                      NaN    253220.15        1.6990\n11  AAAAAAAAGDFIAAAA  Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81    277408.69        1.8613\n12  AAAAAAAAAJEADAAA                                              Days will not say in a eyes. Unlikely, middle researchers would permit well. Familiar youngsters step in the main. Instructions        Sports                    46.33    289734.35        1.9440\n13  AAAAAAAAEOGIAAAA                                                                                                                                                                                Electronics                      NaN    207138.43        1.3898\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                   i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                            Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAPCDJCAAA                                                                                                                                                                                Electronics                     9.97    263218.49        1.7660\n2   AAAAAAAAGDFIAAAA  Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81    277408.69        1.8613\n3   AAAAAAAAAAMCAAAA                                                                                                                                                                                     Sports                      NaN    253220.15        1.6990\n4   AAAAAAAAAJEADAAA                                              Days will not say in a eyes. Unlikely, middle researchers would permit well. Familiar youngsters step in the main. Instructions        Sports                    46.33    289734.35        1.9440\n5   AAAAAAAAAPAHDAAA                                                                                                                                                                                      Shoes                      NaN    225853.15        1.5153\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                Electronics                     1.24    202477.43        1.3585\n7   AAAAAAAAOELEEAAA                                                                                                                                                         Still real detectives       Sports                      NaN    241161.82        1.6181\n8   AAAAAAAAGKFHDAAA                                                      Services say etc by a memories. Only fortunate provisions own however. Wide, mutual facilities must not lay just previou       Sports                      NaN    228486.58        1.5330\n9   AAAAAAAAAMLOBAAA                                                                                                                                                            Real walls ought t  Electronics                     0.79    205535.30        1.3790\n10  AAAAAAAAIBEAAAAA                                                                                                                                                                                      Shoes                    14.70    163981.76        1.1002\n11  AAAAAAAAMLIGEAAA                                                                                                                                                                                     Sports                     3.25    250784.37        1.6826\n12  AAAAAAAAFPGKBAAA                                                                                                                                                                                     Sports                     4.92    306291.08        2.0551\n13  AAAAAAAAIDIADAAA                     So other pains will fly probably. Unique police cause most personal men. Various years used to replace later grey deals. Now evident votes would serve st        Shoes                      NaN    236458.79        1.5865\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.373393,
                    "execution_time": 0.311663,
                    "compile_time": 0.000312,
                    "planning_time": 0.043411
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.365832,
                    "execution_time": 0.306733,
                    "compile_time": 0.000322,
                    "planning_time": 0.041649
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                   i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                            Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAPCDJCAAA                                                                                                                                                                                Electronics                     9.97    263218.49        1.7660\n2   AAAAAAAAGDFIAAAA  Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81    277408.69        1.8613\n3   AAAAAAAAAAMCAAAA                                                                                                                                                                                     Sports                      NaN    253220.15        1.6990\n4   AAAAAAAAAJEADAAA                                              Days will not say in a eyes. Unlikely, middle researchers would permit well. Familiar youngsters step in the main. Instructions        Sports                    46.33    289734.35        1.9440\n5   AAAAAAAAAPAHDAAA                                                                                                                                                                                      Shoes                      NaN    225853.15        1.5153\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                Electronics                     1.24    202477.43        1.3585\n7   AAAAAAAAOELEEAAA                                                                                                                                                         Still real detectives       Sports                      NaN    241161.82        1.6181\n8   AAAAAAAAGKFHDAAA                                                      Services say etc by a memories. Only fortunate provisions own however. Wide, mutual facilities must not lay just previou       Sports                      NaN    228486.58        1.5330\n9   AAAAAAAAAMLOBAAA                                                                                                                                                            Real walls ought t  Electronics                     0.79    205535.30        1.3790\n10  AAAAAAAAIBEAAAAA                                                                                                                                                                                      Shoes                    14.70    163981.76        1.1002\n11  AAAAAAAAMLIGEAAA                                                                                                                                                                                     Sports                     3.25    250784.37        1.6826\n12  AAAAAAAAFPGKBAAA                                                                                                                                                                                     Sports                     4.92    306291.08        2.0551\n13  AAAAAAAAIDIADAAA                     So other pains will fly probably. Unique police cause most personal men. Various years used to replace later grey deals. Now evident votes would serve st        Shoes                      NaN    236458.79        1.5865\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                         i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAPAHDAAA                                                                                                                                                                                            Shoes                      NaN    225853.15        1.5153\n1   AAAAAAAAAMOJCAAA                                                                                                                                                                                            Shoes                      NaN    220673.82        1.4806\n2   AAAAAAAACKIFAAAA                                                                                                                                                                         Living step       Sports                      NaN    269122.90        1.8057\n3   AAAAAAAAIPHDEAAA                                                                                                                                                               Big hotels might atta       Sports                     8.70    201338.24        1.3509\n4   AAAAAAAAJAHLBAAA                                                                             Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n5   AAAAAAAAOJOMDAAA                                                                                 Economic terms cannot exist more tight prominent duties. Magazines work with the volumes. Concerned       Sports                     7.66    162205.37        1.0883\n6   AAAAAAAAPCDJCAAA                                                                                                                                                                                      Electronics                     9.97    263218.49        1.7660\n7   AAAAAAAAGDFIAAAA        Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81    277408.69        1.8613\n8   AAAAAAAAAAMCAAAA                                                                                                                                                                                           Sports                      NaN    253220.15        1.6990\n9   AAAAAAAAAJEADAAA                                                    Days will not say in a eyes. Unlikely, middle researchers would permit well. Familiar youngsters step in the main. Instructions        Sports                    46.33    289734.35        1.9440\n10  AAAAAAAAACEHAAAA                                                                                                                                                                                           Sports                      NaN    219137.77        1.4703\n11  AAAAAAAAOBMEEAAA                                                                                                                                                          Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n12  AAAAAAAANLMPBAAA                                                                                                                                                                                           Sports                     2.07    272737.31        1.8299\n13  AAAAAAAAIHDPCAAA                                                                                                                                                                                           Sports                     6.14    202076.34        1.3558\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.357049,
                    "execution_time": 0.290511,
                    "compile_time": 0.000303,
                    "planning_time": 0.047832
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.362408,
                    "execution_time": 0.303548,
                    "compile_time": 0.000321,
                    "planning_time": 0.041024
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                         i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAPAHDAAA                                                                                                                                                                                            Shoes                      NaN    225853.15        1.5153\n1   AAAAAAAAAMOJCAAA                                                                                                                                                                                            Shoes                      NaN    220673.82        1.4806\n2   AAAAAAAACKIFAAAA                                                                                                                                                                         Living step       Sports                      NaN    269122.90        1.8057\n3   AAAAAAAAIPHDEAAA                                                                                                                                                               Big hotels might atta       Sports                     8.70    201338.24        1.3509\n4   AAAAAAAAJAHLBAAA                                                                             Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n5   AAAAAAAAOJOMDAAA                                                                                 Economic terms cannot exist more tight prominent duties. Magazines work with the volumes. Concerned       Sports                     7.66    162205.37        1.0883\n6   AAAAAAAAPCDJCAAA                                                                                                                                                                                      Electronics                     9.97    263218.49        1.7660\n7   AAAAAAAAGDFIAAAA        Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81    277408.69        1.8613\n8   AAAAAAAAAAMCAAAA                                                                                                                                                                                           Sports                      NaN    253220.15        1.6990\n9   AAAAAAAAAJEADAAA                                                    Days will not say in a eyes. Unlikely, middle researchers would permit well. Familiar youngsters step in the main. Instructions        Sports                    46.33    289734.35        1.9440\n10  AAAAAAAAACEHAAAA                                                                                                                                                                                           Sports                      NaN    219137.77        1.4703\n11  AAAAAAAAOBMEEAAA                                                                                                                                                          Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n12  AAAAAAAANLMPBAAA                                                                                                                                                                                           Sports                     2.07    272737.31        1.8299\n13  AAAAAAAAIHDPCAAA                                                                                                                                                                                           Sports                     6.14    202076.34        1.3558\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANNODAAA                                                                                                                     Profits allow quickly closed movies. Even certain opportunities would carry ver  Electronics     cameras            16.38    196373.06        0.0899\n1   AAAAAAAAELBLCAAA                                     True patients will accept there. Both nervous roles answer consequently eyes. Themes could proceed together great, funny facilities. Identical funds used to sa  Electronics  automotive             2.53    227433.97        0.1082\n2   AAAAAAAAKGKDAAAA                                      Patients could help fascinating forces. Gross, neat parents see big years. Methods could correspond children. Companies ought to know so. Areas involve ahead   Electronics      karoke             4.02    190414.25        0.0861\n3   AAAAAAAAKJMPAAAA                                                                                                                                                         Distinctive things veto. As good as crucial  Electronics     cameras             8.34    198213.73        0.0907\n4   AAAAAAAALCLKDAAA                                                                                                                                                                                       Comparisons s  Electronics  automotive             4.62    263856.29        0.1256\n5   AAAAAAAAEOEGAAAA                         Young factors cannot wish so upper, local records. Other, entire systems may keep magnificent heroes. Clinical friends would not begin positive, real affairs. Altogether m  Electronics      karoke             4.51    271200.86        0.1227\n6   AAAAAAAALDGLAAAA                                                                                                                                     Laws close offences. Original, significant arts fit less. Speci  Electronics     cameras             5.70    186481.85        0.0853\n7   AAAAAAAAHNDODAAA                                                                                            Sharp, original profits should lose perhaps stages. Great terms may confirm little; worlds ought to happ  Electronics  automotive             3.07    253698.25        0.1207\n8   AAAAAAAAECEADAAA                                                                                                                                                        By and large developing features may keep mo  Electronics      karoke             3.80    301250.31        0.1363\n9   AAAAAAAAAJJIDAAA                                                                                                                                                                   Other, natural centuries complete  Electronics     cameras             7.62    290796.48        0.1331\n10  AAAAAAAAEDAKAAAA                                                                                                                                    Separate, common grounds require. Delighted bonds should copy qu  Electronics  automotive             8.77    243984.81        0.1161\n11  AAAAAAAAIFBOAAAA                                                                                                        Movies would include sometimes entire stories; classes join terms. Police can remain too rea  Electronics      karoke             4.68    249701.58        0.1129\n12  AAAAAAAAHMHMCAAA                                                                                                                             Soviet, national wishes operate however on a refugees. Full, open lines  Electronics     cameras             3.18    236700.00        0.1083\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.573911,
                    "execution_time": 0.513885,
                    "compile_time": 0.000365,
                    "planning_time": 0.042212
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.60858,
                    "execution_time": 0.479273,
                    "compile_time": 0.000373,
                    "planning_time": 0.110414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANNODAAA                                                                                                                     Profits allow quickly closed movies. Even certain opportunities would carry ver  Electronics     cameras            16.38    196373.06        0.0899\n1   AAAAAAAAELBLCAAA                                     True patients will accept there. Both nervous roles answer consequently eyes. Themes could proceed together great, funny facilities. Identical funds used to sa  Electronics  automotive             2.53    227433.97        0.1082\n2   AAAAAAAAKGKDAAAA                                      Patients could help fascinating forces. Gross, neat parents see big years. Methods could correspond children. Companies ought to know so. Areas involve ahead   Electronics      karoke             4.02    190414.25        0.0861\n3   AAAAAAAAKJMPAAAA                                                                                                                                                         Distinctive things veto. As good as crucial  Electronics     cameras             8.34    198213.73        0.0907\n4   AAAAAAAALCLKDAAA                                                                                                                                                                                       Comparisons s  Electronics  automotive             4.62    263856.29        0.1256\n5   AAAAAAAAEOEGAAAA                         Young factors cannot wish so upper, local records. Other, entire systems may keep magnificent heroes. Clinical friends would not begin positive, real affairs. Altogether m  Electronics      karoke             4.51    271200.86        0.1227\n6   AAAAAAAALDGLAAAA                                                                                                                                     Laws close offences. Original, significant arts fit less. Speci  Electronics     cameras             5.70    186481.85        0.0853\n7   AAAAAAAAHNDODAAA                                                                                            Sharp, original profits should lose perhaps stages. Great terms may confirm little; worlds ought to happ  Electronics  automotive             3.07    253698.25        0.1207\n8   AAAAAAAAECEADAAA                                                                                                                                                        By and large developing features may keep mo  Electronics      karoke             3.80    301250.31        0.1363\n9   AAAAAAAAAJJIDAAA                                                                                                                                                                   Other, natural centuries complete  Electronics     cameras             7.62    290796.48        0.1331\n10  AAAAAAAAEDAKAAAA                                                                                                                                    Separate, common grounds require. Delighted bonds should copy qu  Electronics  automotive             8.77    243984.81        0.1161\n11  AAAAAAAAIFBOAAAA                                                                                                        Movies would include sometimes entire stories; classes join terms. Police can remain too rea  Electronics      karoke             4.68    249701.58        0.1129\n12  AAAAAAAAHMHMCAAA                                                                                                                             Soviet, national wishes operate however on a refugees. Full, open lines  Electronics     cameras             3.18    236700.00        0.1083\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                    i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKJKLDAAA                                                                                                                                                                                 Electronics                      NaN    202532.58        1.3589\n1   AAAAAAAAAJDHDAAA                                                                                                                                                                                 Electronics                      NaN    214329.87        1.4380\n2   AAAAAAAAPCDJCAAA                                                                                                                                                                                 Electronics                     9.97    263218.49        1.7660\n3   AAAAAAAANAHDCAAA                                                                                                                                       Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n4   AAAAAAAAAGKPBAAA                                                                                                                                                                                 Electronics                      NaN    233447.67        1.5663\n5   AAAAAAAAAHJKAAAA                                                                                                                                                                            Sma  Electronics                      NaN    299929.76        2.0124\n6   AAAAAAAAONDOCAAA                                                                                                                                                                                 Electronics                      NaN    196635.63        1.3193\n7   AAAAAAAAAGHAEAAA                                                                                                                                                                             Jo  Electronics                      NaN    255247.52        1.7126\n8   AAAAAAAAOBMEEAAA                                                                                                                                                     Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n9   AAAAAAAAHGCFCAAA                                                                                                                                                                                 Electronics                     3.56    227022.09        1.5232\n10  AAAAAAAAHPDFBAAA                                                                                                                                                                                 Electronics                     1.24    202477.43        1.3585\n11  AAAAAAAAOFEJAAAA                                                                                                                                                                             Be  Electronics                    49.14    233788.32        1.5686\n12  AAAAAAAAEOGIAAAA                                                                                                                                                                                 Electronics                      NaN    207138.43        1.3898\n13  AAAAAAAAJAHLBAAA                                                                        Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.597431,
                    "execution_time": 0.536559,
                    "compile_time": 0.000476,
                    "planning_time": 0.042575
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.589757,
                    "execution_time": 0.460923,
                    "compile_time": 0.000357,
                    "planning_time": 0.111062
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                    i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKJKLDAAA                                                                                                                                                                                 Electronics                      NaN    202532.58        1.3589\n1   AAAAAAAAAJDHDAAA                                                                                                                                                                                 Electronics                      NaN    214329.87        1.4380\n2   AAAAAAAAPCDJCAAA                                                                                                                                                                                 Electronics                     9.97    263218.49        1.7660\n3   AAAAAAAANAHDCAAA                                                                                                                                       Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n4   AAAAAAAAAGKPBAAA                                                                                                                                                                                 Electronics                      NaN    233447.67        1.5663\n5   AAAAAAAAAHJKAAAA                                                                                                                                                                            Sma  Electronics                      NaN    299929.76        2.0124\n6   AAAAAAAAONDOCAAA                                                                                                                                                                                 Electronics                      NaN    196635.63        1.3193\n7   AAAAAAAAAGHAEAAA                                                                                                                                                                             Jo  Electronics                      NaN    255247.52        1.7126\n8   AAAAAAAAOBMEEAAA                                                                                                                                                     Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n9   AAAAAAAAHGCFCAAA                                                                                                                                                                                 Electronics                     3.56    227022.09        1.5232\n10  AAAAAAAAHPDFBAAA                                                                                                                                                                                 Electronics                     1.24    202477.43        1.3585\n11  AAAAAAAAOFEJAAAA                                                                                                                                                                             Be  Electronics                    49.14    233788.32        1.5686\n12  AAAAAAAAEOGIAAAA                                                                                                                                                                                 Electronics                      NaN    207138.43        1.3898\n13  AAAAAAAAJAHLBAAA                                                                        Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.559497,
                    "execution_time": 0.499209,
                    "compile_time": 0.000354,
                    "planning_time": 0.042647
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.610684,
                    "execution_time": 0.482314,
                    "compile_time": 0.000353,
                    "planning_time": 0.110241
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.566559,
                    "execution_time": 0.506265,
                    "compile_time": 0.000341,
                    "planning_time": 0.042733
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.624808,
                    "execution_time": 0.495931,
                    "compile_time": 0.000351,
                    "planning_time": 0.1111
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.571009,
                    "execution_time": 0.509454,
                    "compile_time": 0.000355,
                    "planning_time": 0.043549
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.782928,
                    "execution_time": 0.5218,
                    "compile_time": 0.135417,
                    "planning_time": 0.107456
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.552206,
                    "execution_time": 0.490673,
                    "compile_time": 0.000364,
                    "planning_time": 0.043366
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.553482,
                    "execution_time": 0.492842,
                    "compile_time": 0.000363,
                    "planning_time": 0.04246
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGHAEAAA                                                                                                                                                                        Jo  Electronics                      NaN    255247.52        1.7126\n1   AAAAAAAAAGKPBAAA                                                                                                                                                                            Electronics                      NaN    233447.67        1.5663\n2   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN    299929.76        2.0124\n3   AAAAAAAAAJDHDAAA                                                                                                                                                                            Electronics                      NaN    214329.87        1.4380\n4   AAAAAAAAAMLOBAAA                                                                                                                                                        Real walls ought t  Electronics                     0.79    205535.30        1.3790\n5   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN    207138.43        1.3898\n6   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN    235856.81        1.5825\n7   AAAAAAAAHGCFCAAA                                                                                                                                                                            Electronics                     3.56    227022.09        1.5232\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24    202477.43        1.3585\n9   AAAAAAAAJAHLBAAA                                                                   Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN    283237.08        1.9004\n10  AAAAAAAAKJKLDAAA                                                                                                                                                                            Electronics                      NaN    202532.58        1.3589\n11  AAAAAAAALPNDEAAA                                                                                                                                                                            Electronics                    57.92    283254.16        1.9005\n12  AAAAAAAANAHDCAAA                                                                                                                                  Even organic circumstances see together   Electronics                     1.44    290435.76        1.9487\n13  AAAAAAAAOBMEEAAA                                                                                                                                                Dominant honours find virt  Electronics                     9.38    239638.74        1.6078\n...*/"
    }
]