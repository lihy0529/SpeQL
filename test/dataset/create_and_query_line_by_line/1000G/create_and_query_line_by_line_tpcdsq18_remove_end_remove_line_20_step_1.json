[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n )  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.783295,
                    "execution_time": 1.534448,
                    "compile_time": 0.000911,
                    "planning_time": 0.078198,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.18695,
                    "execution_time": 8.860833,
                    "compile_time": 9.004743,
                    "planning_time": 0.1641,
                    "create_size": 1792
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.153075,
                    "execution_time": 0.998971,
                    "compile_time": 0.000727,
                    "planning_time": 0.012928,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.234571,
                    "execution_time": 0.994422,
                    "compile_time": 0.007803,
                    "planning_time": 0.055639,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state         ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAKDJLBAAA  United States       OK  Cleveland County  28.0  102.85     0.00   34.96 -1441.16  1936.0   4.0\n1   AAAAAAAAADFDCAAA  United States       OK      Bryan County  23.0   60.64   509.33   50.33  -126.61  1948.0   1.0\n2   AAAAAAAAJIMPCAAA  United States       OK      Bryan County  10.0   89.58     0.00   57.33  -241.10  1948.0   1.0\n3   AAAAAAAAMAOECAAA  United States       KY   McCreary County  84.0  141.74     0.00  128.98  4600.68  1953.0   5.0\n4   AAAAAAAAIIDGBAAA  United States       KY      Floyd County  38.0  173.90     0.00  144.33  2425.16  1984.0   5.0\n5   AAAAAAAAENOMBAAA  United States       SD     Aurora County  43.0  207.77     0.00   87.26  -365.07  1934.0   1.0\n6   AAAAAAAAOIMOBAAA  United States       SD    Sanborn County  69.0  115.57   298.13   19.64 -1874.78  1946.0   6.0\n7   AAAAAAAAMBFBBAAA  United States       SD    Sanborn County  56.0   65.66     0.00   42.02  1080.80  1946.0   6.0\n8   AAAAAAAAHJIDBAAA  United States       SD    Sanborn County   3.0   12.95     0.00    7.51     8.94  1946.0   6.0\n9   AAAAAAAAGKGGBAAA  United States       KY      Allen County  59.0  188.16     0.00  129.83  2790.70  1940.0   5.0\n10  AAAAAAAABHOGDAAA  United States       KY      Allen County  31.0  154.38     0.00   50.94   -54.25  1940.0   5.0\n11  AAAAAAAAOHKBAAAA  United States       NV       Elko County  45.0   23.48     0.00    0.46  -541.35  1957.0   1.0\n12  AAAAAAAAIPLDDAAA  United States       KY  Robertson County  33.0  159.73     0.00  153.34  2619.87  1964.0   1.0\n13  AAAAAAAAFFHACAAA  United States       KY   Gallatin County  76.0   43.77     0.00   28.01  -576.08  1959.0   2.0\n14  AAAAAAAAOEKBAAAA  United States       KY   Gallatin County  98.0  197.88     0.00  130.60  4179.70  1959.0   2.0\n15  AAAAAAAANFPHDAAA  United States       KY      Rowan County  95.0  111.29  1740.81   30.04 -5294.76  1934.0   2.0\n16  AAAAAAAABFBDAAAA  United States       KY      Rowan County   1.0  243.02     0.00  162.82    80.16  1934.0   2.0\n17  AAAAAAAACKHDDAAA  United States       NV    Mineral County  11.0   70.87     0.00   70.16   167.42  1968.0   4.0\n18  AAAAAAAACNIECAAA                      OK     Nowata County  61.0  173.76     0.00   45.17 -2912.75  1949.0   2.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019625,
                    "execution_time": 0.008473,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004553
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057723,
                    "execution_time": 0.008529,
                    "compile_time": 0.001256,
                    "planning_time": 0.039956
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state         ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAKDJLBAAA  United States       OK  Cleveland County  28.0  102.85     0.00   34.96 -1441.16  1936.0   4.0\n1   AAAAAAAAADFDCAAA  United States       OK      Bryan County  23.0   60.64   509.33   50.33  -126.61  1948.0   1.0\n2   AAAAAAAAJIMPCAAA  United States       OK      Bryan County  10.0   89.58     0.00   57.33  -241.10  1948.0   1.0\n3   AAAAAAAAMAOECAAA  United States       KY   McCreary County  84.0  141.74     0.00  128.98  4600.68  1953.0   5.0\n4   AAAAAAAAIIDGBAAA  United States       KY      Floyd County  38.0  173.90     0.00  144.33  2425.16  1984.0   5.0\n5   AAAAAAAAENOMBAAA  United States       SD     Aurora County  43.0  207.77     0.00   87.26  -365.07  1934.0   1.0\n6   AAAAAAAAOIMOBAAA  United States       SD    Sanborn County  69.0  115.57   298.13   19.64 -1874.78  1946.0   6.0\n7   AAAAAAAAMBFBBAAA  United States       SD    Sanborn County  56.0   65.66     0.00   42.02  1080.80  1946.0   6.0\n8   AAAAAAAAHJIDBAAA  United States       SD    Sanborn County   3.0   12.95     0.00    7.51     8.94  1946.0   6.0\n9   AAAAAAAAGKGGBAAA  United States       KY      Allen County  59.0  188.16     0.00  129.83  2790.70  1940.0   5.0\n10  AAAAAAAABHOGDAAA  United States       KY      Allen County  31.0  154.38     0.00   50.94   -54.25  1940.0   5.0\n11  AAAAAAAAOHKBAAAA  United States       NV       Elko County  45.0   23.48     0.00    0.46  -541.35  1957.0   1.0\n12  AAAAAAAAIPLDDAAA  United States       KY  Robertson County  33.0  159.73     0.00  153.34  2619.87  1964.0   1.0\n13  AAAAAAAAFFHACAAA  United States       KY   Gallatin County  76.0   43.77     0.00   28.01  -576.08  1959.0   2.0\n14  AAAAAAAAOEKBAAAA  United States       KY   Gallatin County  98.0  197.88     0.00  130.60  4179.70  1959.0   2.0\n15  AAAAAAAANFPHDAAA  United States       KY      Rowan County  95.0  111.29  1740.81   30.04 -5294.76  1934.0   2.0\n16  AAAAAAAABFBDAAAA  United States       KY      Rowan County   1.0  243.02     0.00  162.82    80.16  1934.0   2.0\n17  AAAAAAAACKHDDAAA  United States       NV    Mineral County  11.0   70.87     0.00   70.16   167.42  1968.0   4.0\n18  AAAAAAAACNIECAAA                      OK     Nowata County  61.0  173.76     0.00   45.17 -2912.75  1949.0   2.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales,\n      customer_demographics cd1,\n      customer_demographics cd2,\n      customer,\n      customer_address,\n      date_dim,\n      item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7\n\tfrom results\n\tgroup by i_item_id \n) as subquery \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"SUBQUERY\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"SUBQUERY\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SUBQUERY\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SUBQUERY\".\"CA_STATE\" AS \"CA_STATE\" , \"SUBQUERY\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SUBQUERY\".\"AGG1\" AS \"AGG1\" , \"SUBQUERY\".\"AGG2\" AS \"AGG2\" , \"SUBQUERY\".\"AGG3\" AS \"AGG3\" , \"SUBQUERY\".\"AGG4\" AS \"AGG4\" , \"SUBQUERY\".\"AGG5\" AS \"AGG5\" , \"SUBQUERY\".\"AGG6\" AS \"AGG6\" , \"SUBQUERY\".\"AGG7\" AS \"AGG7\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.407964,
                    "execution_time": 1.241012,
                    "compile_time": 0.000958,
                    "planning_time": 0.023955,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.419174,
                    "execution_time": 1.218099,
                    "compile_time": 0.004888,
                    "planning_time": 0.067061,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state               ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAANBKNDAAA  United States       CA  San Luis Obispo County  27.0  149.97     0.00  143.97  2286.63  1928.0   5.0\n1   AAAAAAAADDCCDAAA  United States       CA           Tehama County  58.0  167.83  1308.10   35.24 -3515.00  1950.0   0.0\n2   AAAAAAAAMMKGEAAA  United States       KY          Pulaski County  26.0   33.17     0.00    2.98  -432.90  1980.0   5.0\n3   AAAAAAAAKPAGBAAA  United States       KY          Pulaski County  37.0   23.84     0.00   18.59    87.69  1980.0   5.0\n4   AAAAAAAACBBDDAAA  United States       CA            Butte County  52.0   80.41     0.00   69.95   629.20  1924.0   3.0\n5   AAAAAAAACHAPCAAA  United States       NV           Lander County  27.0  119.42     0.00    0.00 -2600.37  1992.0   0.0\n6   AAAAAAAACGONAAAA  United States       KY        Jefferson County   5.0  111.85     0.00   40.26     8.45  1935.0   3.0\n7   AAAAAAAAMCCICAAA  United States       KY        Jefferson County  82.0   96.90     0.00   22.28 -2847.04  1935.0   3.0\n8   AAAAAAAAFBEOBAAA  United States       OK           Garvin County  48.0   35.79     0.00   18.25   196.80  1970.0   0.0\n9   AAAAAAAACBPIDAAA  United States       OK            Grady County   9.0   85.31    44.13   21.32  -597.72  1937.0   2.0\n10  AAAAAAAAAMIBEAAA  United States       KY          Elliott County  37.0   17.61     0.00    1.93  -150.22  1941.0   0.0\n11  AAAAAAAAGBKMDAAA  United States       KY          Elliott County  99.0   50.01     0.00   50.01  1950.30  1941.0   0.0\n12  AAAAAAAAGNMCBAAA  United States       SD        Brookings County  34.0   45.46   726.41   42.73  -704.99  1964.0   4.0\n13  AAAAAAAAKONHAAAA  United States       CA           Orange County   7.0  136.40     0.00  105.02   356.23  1968.0   4.0\n14  AAAAAAAAOKPLCAAA  United States       CA           Orange County  38.0  202.27  1933.81   68.77 -2677.09  1968.0   4.0\n15  AAAAAAAAIDAEBAAA  United States       WI        Lafayette County  54.0   65.28     0.00    6.52  -893.70  1969.0   0.0\n16  AAAAAAAABIHMAAAA  United States       WI        Lafayette County  28.0   24.37     0.00    4.38  -386.68  1969.0   0.0\n17  AAAAAAAAACIDEAAA  United States       CA         Humboldt County  94.0  122.35     0.00   51.38 -3949.88  1980.0   0.0\n18  AAAAAAAACPLHAAAA  United States       CA         Humboldt County  47.0  158.74  2121.60   57.14 -2017.73  1980.0   0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020161,
                    "execution_time": 0.008539,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004754
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056527,
                    "execution_time": 0.008719,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040231
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state               ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAANBKNDAAA  United States       CA  San Luis Obispo County  27.0  149.97     0.00  143.97  2286.63  1928.0   5.0\n1   AAAAAAAADDCCDAAA  United States       CA           Tehama County  58.0  167.83  1308.10   35.24 -3515.00  1950.0   0.0\n2   AAAAAAAAMMKGEAAA  United States       KY          Pulaski County  26.0   33.17     0.00    2.98  -432.90  1980.0   5.0\n3   AAAAAAAAKPAGBAAA  United States       KY          Pulaski County  37.0   23.84     0.00   18.59    87.69  1980.0   5.0\n4   AAAAAAAACBBDDAAA  United States       CA            Butte County  52.0   80.41     0.00   69.95   629.20  1924.0   3.0\n5   AAAAAAAACHAPCAAA  United States       NV           Lander County  27.0  119.42     0.00    0.00 -2600.37  1992.0   0.0\n6   AAAAAAAACGONAAAA  United States       KY        Jefferson County   5.0  111.85     0.00   40.26     8.45  1935.0   3.0\n7   AAAAAAAAMCCICAAA  United States       KY        Jefferson County  82.0   96.90     0.00   22.28 -2847.04  1935.0   3.0\n8   AAAAAAAAFBEOBAAA  United States       OK           Garvin County  48.0   35.79     0.00   18.25   196.80  1970.0   0.0\n9   AAAAAAAACBPIDAAA  United States       OK            Grady County   9.0   85.31    44.13   21.32  -597.72  1937.0   2.0\n10  AAAAAAAAAMIBEAAA  United States       KY          Elliott County  37.0   17.61     0.00    1.93  -150.22  1941.0   0.0\n11  AAAAAAAAGBKMDAAA  United States       KY          Elliott County  99.0   50.01     0.00   50.01  1950.30  1941.0   0.0\n12  AAAAAAAAGNMCBAAA  United States       SD        Brookings County  34.0   45.46   726.41   42.73  -704.99  1964.0   4.0\n13  AAAAAAAAKONHAAAA  United States       CA           Orange County   7.0  136.40     0.00  105.02   356.23  1968.0   4.0\n14  AAAAAAAAOKPLCAAA  United States       CA           Orange County  38.0  202.27  1933.81   68.77 -2677.09  1968.0   4.0\n15  AAAAAAAAIDAEBAAA  United States       WI        Lafayette County  54.0   65.28     0.00    6.52  -893.70  1969.0   0.0\n16  AAAAAAAABIHMAAAA  United States       WI        Lafayette County  28.0   24.37     0.00    4.38  -386.68  1969.0   0.0\n17  AAAAAAAAACIDEAAA  United States       CA         Humboldt County  94.0  122.35     0.00   51.38 -3949.88  1980.0   0.0\n18  AAAAAAAACPLHAAAA  United States       CA         Humboldt County  47.0  158.74  2121.60   57.14 -2017.73  1980.0   0.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n group by i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2    agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAFANKAAAA  United States       WI      Lincoln County  89.0  193.28    0.00  119.83  4733.02  1937.0   4.0\n1   AAAAAAAAMILGAAAA  United States       CA        Butte County  15.0   68.40    0.00   64.98   179.25  1924.0   2.0\n2   AAAAAAAAJNMFEAAA  United States       CA        Butte County  70.0   87.05    0.00   53.10 -1873.90  1924.0   2.0\n3   AAAAAAAAACPODAAA  United States       CA        Butte County  37.0   47.88    0.00   13.40  -170.20  1924.0   2.0\n4   AAAAAAAAMGIFAAAA  United States       CA        Butte County  63.0   24.79    0.00   10.65  -749.07  1924.0   2.0\n5   AAAAAAAACAGADAAA  United States       KY        Green County   8.0   72.13    0.00   17.31  -143.04  1947.0   0.0\n6   AAAAAAAAIJOHCAAA  United States       KY        Green County  88.0  200.64    0.00  122.39  4082.32  1947.0   0.0\n7   AAAAAAAABMKHEAAA  United States       KY   Cumberland County  78.0   39.41    0.00   13.00  -656.76  1966.0   4.0\n8   AAAAAAAACOBIDAAA  United States       WI       Vernon County  20.0  183.54    0.00  113.79   916.20  1986.0   6.0\n9   AAAAAAAABNNBDAAA  United States       CA    Mendocino County  50.0   72.04    0.00   41.06 -1377.50  1940.0   6.0\n10  AAAAAAAAPINAEAAA  United States       SD        Jones County  22.0     NaN     NaN     NaN  1120.24  1949.0   2.0\n11  AAAAAAAAKFCFDAAA  United States       KY    Pendleton County  49.0  105.37    0.00   73.75  1604.75  1934.0   6.0\n12  AAAAAAAALDLADAAA  United States       AL         Clay County  45.0  122.37    0.00   81.98  1512.45  1976.0   4.0\n13  AAAAAAAAIJHKBAAA  United States       AL         Clay County   9.0   86.12    0.00   24.97  -306.18  1976.0   4.0\n14  AAAAAAAAONOPAAAA  United States       WI      Douglas County  96.0  216.21    0.00   25.94 -5112.96  1935.0   5.0\n15  AAAAAAAAEENLDAAA  United States       WI      Douglas County  76.0  176.10  569.81   10.56 -4463.29  1935.0   5.0\n16  AAAAAAAALNNNCAAA  United States       WI      Douglas County  50.0  191.51    0.00  180.01  4648.00  1935.0   5.0\n17  AAAAAAAANNKICAAA  United States       CA  Los Angeles County  82.0   28.73    0.00   26.71   564.98  1947.0   4.0\n18  AAAAAAAAKBMLBAAA  United States       CA  Los Angeles County  96.0   12.69  100.53    7.48   -63.09  1947.0   4.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018948,
                    "execution_time": 0.007822,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004541
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019798,
                    "execution_time": 0.007885,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004844
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2    agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAFANKAAAA  United States       WI      Lincoln County  89.0  193.28    0.00  119.83  4733.02  1937.0   4.0\n1   AAAAAAAAMILGAAAA  United States       CA        Butte County  15.0   68.40    0.00   64.98   179.25  1924.0   2.0\n2   AAAAAAAAJNMFEAAA  United States       CA        Butte County  70.0   87.05    0.00   53.10 -1873.90  1924.0   2.0\n3   AAAAAAAAACPODAAA  United States       CA        Butte County  37.0   47.88    0.00   13.40  -170.20  1924.0   2.0\n4   AAAAAAAAMGIFAAAA  United States       CA        Butte County  63.0   24.79    0.00   10.65  -749.07  1924.0   2.0\n5   AAAAAAAACAGADAAA  United States       KY        Green County   8.0   72.13    0.00   17.31  -143.04  1947.0   0.0\n6   AAAAAAAAIJOHCAAA  United States       KY        Green County  88.0  200.64    0.00  122.39  4082.32  1947.0   0.0\n7   AAAAAAAABMKHEAAA  United States       KY   Cumberland County  78.0   39.41    0.00   13.00  -656.76  1966.0   4.0\n8   AAAAAAAACOBIDAAA  United States       WI       Vernon County  20.0  183.54    0.00  113.79   916.20  1986.0   6.0\n9   AAAAAAAABNNBDAAA  United States       CA    Mendocino County  50.0   72.04    0.00   41.06 -1377.50  1940.0   6.0\n10  AAAAAAAAPINAEAAA  United States       SD        Jones County  22.0     NaN     NaN     NaN  1120.24  1949.0   2.0\n11  AAAAAAAAKFCFDAAA  United States       KY    Pendleton County  49.0  105.37    0.00   73.75  1604.75  1934.0   6.0\n12  AAAAAAAALDLADAAA  United States       AL         Clay County  45.0  122.37    0.00   81.98  1512.45  1976.0   4.0\n13  AAAAAAAAIJHKBAAA  United States       AL         Clay County   9.0   86.12    0.00   24.97  -306.18  1976.0   4.0\n14  AAAAAAAAONOPAAAA  United States       WI      Douglas County  96.0  216.21    0.00   25.94 -5112.96  1935.0   5.0\n15  AAAAAAAAEENLDAAA  United States       WI      Douglas County  76.0  176.10  569.81   10.56 -4463.29  1935.0   5.0\n16  AAAAAAAALNNNCAAA  United States       WI      Douglas County  50.0  191.51    0.00  180.01  4648.00  1935.0   5.0\n17  AAAAAAAANNKICAAA  United States       CA  Los Angeles County  82.0   28.73    0.00   26.71   564.98  1947.0   4.0\n18  AAAAAAAAKBMLBAAA  United States       CA  Los Angeles County  96.0   12.69  100.53    7.48   -63.09  1947.0   4.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n ) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state          ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOAGFDAAA  United States       OK      Beaver County  61.0  189.04     0.00  173.91  5680.32  1941.0   0.0\n1   AAAAAAAAPDJKAAAA  United States       OK      Beaver County  83.0   27.90     0.00   26.78  1087.30  1941.0   0.0\n2   AAAAAAAANEOAAAAA  United States       OK      Beaver County  92.0  201.41  1865.55   38.26 -6402.07  1941.0   0.0\n3   AAAAAAAAAAJBBAAA  United States       KY       Allen County  74.0   27.29     0.00   26.47   526.14  1977.0   4.0\n4   AAAAAAAANNOIBAAA  United States       KY       Allen County  90.0  155.09     0.00   20.16 -5307.30  1977.0   4.0\n5   AAAAAAAAMEMICAAA  United States       OK      Carter County   6.0  136.44     0.00   58.66  -204.96  1978.0   2.0\n6   AAAAAAAACDFEDAAA  United States       OK      Carter County  89.0   55.94     0.00   11.74  -759.17  1978.0   2.0\n7   AAAAAAAAOBHBCAAA  United States       OK      Custer County  61.0   18.04     0.00   12.62  -320.25  1937.0   0.0\n8   AAAAAAAAPIDGCAAA  United States       OK      Custer County   9.0  125.26     0.00   51.35  -116.01  1937.0   0.0\n9   AAAAAAAAAPHABAAA  United States       CA      Colusa County  88.0   24.84   106.93    2.48 -1532.53  1974.0   4.0\n10  AAAAAAAAKEOHAAAA  United States       OK       Adair County  84.0  178.80     0.00   91.18  1100.40  1932.0   3.0\n11  AAAAAAAAELCGCAAA  United States       AL  Lauderdale County  59.0   86.51     0.00   77.85  2757.07  1936.0   2.0\n12  AAAAAAAAGLOHAAAA  United States       KY       Floyd County   5.0   63.28    52.89   55.68    70.41  1970.0   3.0\n13  AAAAAAAAHFKIEAAA  United States       KY       Floyd County  37.0  149.33     0.00   23.89 -2444.59  1970.0   3.0\n14  AAAAAAAAHCOJCAAA  United States       KY       Floyd County  67.0   79.89     0.00   39.14   820.08  1970.0   3.0\n15  AAAAAAAAPIKKDAAA  United States       KY         Lee County  76.0   64.79     0.00    1.94 -1912.92  1926.0   4.0\n16  AAAAAAAAFHJEDAAA  United States       KY         Lee County  57.0   45.27     0.00   22.18  -633.27  1926.0   4.0\n17  AAAAAAAAKKHHEAAA  United States       CA      Tulare County  39.0   75.97     0.00   54.69   961.74  1934.0   6.0\n18  AAAAAAAADDNADAAA  United States       OK     Tillman County  92.0   28.35     0.00   27.78  1331.24  1955.0   3.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019802,
                    "execution_time": 0.008684,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004499
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019228,
                    "execution_time": 0.007785,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state          ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOAGFDAAA  United States       OK      Beaver County  61.0  189.04     0.00  173.91  5680.32  1941.0   0.0\n1   AAAAAAAAPDJKAAAA  United States       OK      Beaver County  83.0   27.90     0.00   26.78  1087.30  1941.0   0.0\n2   AAAAAAAANEOAAAAA  United States       OK      Beaver County  92.0  201.41  1865.55   38.26 -6402.07  1941.0   0.0\n3   AAAAAAAAAAJBBAAA  United States       KY       Allen County  74.0   27.29     0.00   26.47   526.14  1977.0   4.0\n4   AAAAAAAANNOIBAAA  United States       KY       Allen County  90.0  155.09     0.00   20.16 -5307.30  1977.0   4.0\n5   AAAAAAAAMEMICAAA  United States       OK      Carter County   6.0  136.44     0.00   58.66  -204.96  1978.0   2.0\n6   AAAAAAAACDFEDAAA  United States       OK      Carter County  89.0   55.94     0.00   11.74  -759.17  1978.0   2.0\n7   AAAAAAAAOBHBCAAA  United States       OK      Custer County  61.0   18.04     0.00   12.62  -320.25  1937.0   0.0\n8   AAAAAAAAPIDGCAAA  United States       OK      Custer County   9.0  125.26     0.00   51.35  -116.01  1937.0   0.0\n9   AAAAAAAAAPHABAAA  United States       CA      Colusa County  88.0   24.84   106.93    2.48 -1532.53  1974.0   4.0\n10  AAAAAAAAKEOHAAAA  United States       OK       Adair County  84.0  178.80     0.00   91.18  1100.40  1932.0   3.0\n11  AAAAAAAAELCGCAAA  United States       AL  Lauderdale County  59.0   86.51     0.00   77.85  2757.07  1936.0   2.0\n12  AAAAAAAAGLOHAAAA  United States       KY       Floyd County   5.0   63.28    52.89   55.68    70.41  1970.0   3.0\n13  AAAAAAAAHFKIEAAA  United States       KY       Floyd County  37.0  149.33     0.00   23.89 -2444.59  1970.0   3.0\n14  AAAAAAAAHCOJCAAA  United States       KY       Floyd County  67.0   79.89     0.00   39.14   820.08  1970.0   3.0\n15  AAAAAAAAPIKKDAAA  United States       KY         Lee County  76.0   64.79     0.00    1.94 -1912.92  1926.0   4.0\n16  AAAAAAAAFHJEDAAA  United States       KY         Lee County  57.0   45.27     0.00   22.18  -633.27  1926.0   4.0\n17  AAAAAAAAKKHHEAAA  United States       CA      Tulare County  39.0   75.97     0.00   54.69   961.74  1934.0   6.0\n18  AAAAAAAADDNADAAA  United States       OK     Tillman County  92.0   28.35     0.00   27.78  1331.24  1955.0   3.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\t) as combined_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"COMBINED_RESULTS\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"COMBINED_RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"COMBINED_RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"COMBINED_RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"COMBINED_RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"COMBINED_RESULTS\".\"AGG1\" AS \"AGG1\" , \"COMBINED_RESULTS\".\"AGG2\" AS \"AGG2\" , \"COMBINED_RESULTS\".\"AGG3\" AS \"AGG3\" , \"COMBINED_RESULTS\".\"AGG4\" AS \"AGG4\" , \"COMBINED_RESULTS\".\"AGG5\" AS \"AGG5\" , \"COMBINED_RESULTS\".\"AGG6\" AS \"AGG6\" , \"COMBINED_RESULTS\".\"AGG7\" AS \"AGG7\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.387318,
                    "execution_time": 1.213367,
                    "compile_time": 0.001092,
                    "planning_time": 0.030527,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.47043,
                    "execution_time": 1.240599,
                    "compile_time": 0.003781,
                    "planning_time": 0.072852,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state            ca_county   agg1    agg2   agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAJEDPDAAA  United States       SD     McPherson County   14.0   74.85   0.00   29.94  -261.38  1992.0   2.0\n1   AAAAAAAAJMPPBAAA  United States       CA   San Joaquin County   69.0   77.17   0.00   51.70  -592.71  1971.0   5.0\n2   AAAAAAAAKDMKCAAA  United States       AL        Elmore County  100.0   97.01   0.00   32.01 -2506.00  1977.0   6.0\n3   AAAAAAAAIKMAEAAA  United States       AL        Elmore County   86.0   22.55   9.28    3.60  -504.64  1977.0   6.0\n4   AAAAAAAABAFGEAAA  United States       CA      Siskiyou County   82.0   22.07   0.00   11.91   -51.66  1967.0   1.0\n5   AAAAAAAAFKHJDAAA  United States       KY       Bullitt County   98.0   54.91   0.00   37.88  -427.28  1951.0   1.0\n6   AAAAAAAACIKEEAAA  United States       KY       Bullitt County   90.0   56.85   0.00   10.80 -1312.20  1951.0   1.0\n7   AAAAAAAAKNAPCAAA  United States       KY       Bullitt County   20.0  232.65   0.00   27.91 -1438.80  1951.0   1.0\n8   AAAAAAAAACNCDAAA  United States       KY       Bullitt County   69.0   66.48   0.00   18.61  -635.49  1951.0   1.0\n9   AAAAAAAAIDMFAAAA  United States       CA      Imperial County   24.0   26.62  63.21    8.78  -103.05  1977.0   4.0\n10  AAAAAAAAKJACEAAA  United States       KY  Breckinridge County   45.0  223.97   0.00  118.70  1841.85  1964.0   4.0\n11  AAAAAAAAAOFHDAAA  United States       KY  Breckinridge County   95.0   21.79   0.00    5.22  -617.50  1964.0   4.0\n12  AAAAAAAAIMKCDAAA  United States       SD        Potter County   61.0   35.88   0.00   33.72  1101.05  1933.0   4.0\n13  AAAAAAAAAMLCBAAA  United States       SD        Potter County   98.0  226.76   0.00   45.35 -4932.34  1933.0   4.0\n14  AAAAAAAAGAGKAAAA  United States       SD        McCook County   72.0   70.64   0.00   54.39   502.56  1986.0   4.0\n15  AAAAAAAAHDJKCAAA  United States       SD        Aurora County   94.0  120.66   0.00   76.01  3338.88  1969.0   5.0\n16  AAAAAAAAAFNEDAAA  United States       KY          Clay County   45.0   59.89   0.00   27.54   300.15  1985.0   6.0\n17  AAAAAAAALLAGDAAA  United States       KY          Clay County   40.0  154.69   0.00  142.24  2878.47  1965.0   5.0\n18  AAAAAAAAKOJAEAAA  United States       KY          Clay County   51.0   45.75  45.26   44.87   761.32  1965.0   5.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020322,
                    "execution_time": 0.008433,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004717
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055456,
                    "execution_time": 0.008239,
                    "compile_time": 5e-05,
                    "planning_time": 0.040337
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state            ca_county   agg1    agg2   agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAJEDPDAAA  United States       SD     McPherson County   14.0   74.85   0.00   29.94  -261.38  1992.0   2.0\n1   AAAAAAAAJMPPBAAA  United States       CA   San Joaquin County   69.0   77.17   0.00   51.70  -592.71  1971.0   5.0\n2   AAAAAAAAKDMKCAAA  United States       AL        Elmore County  100.0   97.01   0.00   32.01 -2506.00  1977.0   6.0\n3   AAAAAAAAIKMAEAAA  United States       AL        Elmore County   86.0   22.55   9.28    3.60  -504.64  1977.0   6.0\n4   AAAAAAAABAFGEAAA  United States       CA      Siskiyou County   82.0   22.07   0.00   11.91   -51.66  1967.0   1.0\n5   AAAAAAAAFKHJDAAA  United States       KY       Bullitt County   98.0   54.91   0.00   37.88  -427.28  1951.0   1.0\n6   AAAAAAAACIKEEAAA  United States       KY       Bullitt County   90.0   56.85   0.00   10.80 -1312.20  1951.0   1.0\n7   AAAAAAAAKNAPCAAA  United States       KY       Bullitt County   20.0  232.65   0.00   27.91 -1438.80  1951.0   1.0\n8   AAAAAAAAACNCDAAA  United States       KY       Bullitt County   69.0   66.48   0.00   18.61  -635.49  1951.0   1.0\n9   AAAAAAAAIDMFAAAA  United States       CA      Imperial County   24.0   26.62  63.21    8.78  -103.05  1977.0   4.0\n10  AAAAAAAAKJACEAAA  United States       KY  Breckinridge County   45.0  223.97   0.00  118.70  1841.85  1964.0   4.0\n11  AAAAAAAAAOFHDAAA  United States       KY  Breckinridge County   95.0   21.79   0.00    5.22  -617.50  1964.0   4.0\n12  AAAAAAAAIMKCDAAA  United States       SD        Potter County   61.0   35.88   0.00   33.72  1101.05  1933.0   4.0\n13  AAAAAAAAAMLCBAAA  United States       SD        Potter County   98.0  226.76   0.00   45.35 -4932.34  1933.0   4.0\n14  AAAAAAAAGAGKAAAA  United States       SD        McCook County   72.0   70.64   0.00   54.39   502.56  1986.0   4.0\n15  AAAAAAAAHDJKCAAA  United States       SD        Aurora County   94.0  120.66   0.00   76.01  3338.88  1969.0   5.0\n16  AAAAAAAAAFNEDAAA  United States       KY          Clay County   45.0   59.89   0.00   27.54   300.15  1985.0   6.0\n17  AAAAAAAALLAGDAAA  United States       KY          Clay County   40.0  154.69   0.00  142.24  2878.47  1965.0   5.0\n18  AAAAAAAAKOJAEAAA  United States       KY          Clay County   51.0   45.75  45.26   44.87   761.32  1965.0   5.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        NULL::character varying as ca_country,\n        NULL::character varying as ca_state, \n        NULL::character varying as ca_county,\n        NULL::decimal(12,2) as agg1,\n        NULL::decimal(12,2) as agg2,\n        NULL::decimal(12,2) as agg3,\n        NULL::decimal(12,2) as agg4,\n        NULL::decimal(12,2) as agg5,\n        NULL::decimal(12,2) as agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n  from item,\n       customer_demographics cd1\n  where cd1.cd_gender = 'M' and \n        cd1.cd_education_status = 'Primary'\n )\nselect i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\nfrom (\n    select i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n        avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country, ca_state, ca_county\n    union all\n    select i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country, ca_state\n    union all\n    select i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country\n    union all\n    select i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id\n    union all\n    select NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state          ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAADEDDAAAA  United States       KY   Jessamine County  56.0  170.25     0.00  134.49  2513.28  1979.0   2.0\n1   AAAAAAAAHAODEAAA  United States       KY       Allen County  68.0  106.82     0.00   49.13 -2290.24  1977.0   4.0\n2   AAAAAAAADDDLCAAA  United States       OK      Carter County  81.0   87.54     0.00   24.51 -2137.59  1978.0   2.0\n3   AAAAAAAANAHMCAAA  United States       CA      Colusa County   2.0  244.69   122.14  234.90   151.12  1974.0   4.0\n4   AAAAAAAABBDOAAAA  United States       AL  Lauderdale County  94.0    2.46     0.00    0.29  -149.46  1936.0   2.0\n5   AAAAAAAACDFDAAAA  United States       AL  Lauderdale County  65.0   53.31  1095.49   49.57   838.26  1936.0   2.0\n6   AAAAAAAAGIKKBAAA  United States       KY       Floyd County  97.0    8.04    30.38    5.22  -169.09  1970.0   3.0\n7   AAAAAAAAIJDEEAAA  United States       KY       Floyd County  43.0   40.11   338.02   22.46  -424.02  1970.0   3.0\n8   AAAAAAAACAKKAAAA  United States       KY         Lee County  53.0  210.68     0.00  139.04  3518.67  1926.0   4.0\n9   AAAAAAAAPOGKBAAA  United States       KY         Lee County  28.0   33.89    27.32   24.40   186.04  1926.0   4.0\n10  AAAAAAAAIFHEEAAA  United States       CA      Tulare County  67.0  182.68     0.00  153.45  6159.98  1934.0   6.0\n11  AAAAAAAAKAANCAAA  United States       CA        Lake County  41.0  204.02   225.39   61.85 -1426.61  1982.5   3.5\n12  AAAAAAAAOCFCAAAA  United States       CA        Lake County  36.0  147.75     0.00   24.82 -1779.82  1982.5   3.5\n13  AAAAAAAAGHDPAAAA  United States       CA        Lake County  58.0  110.08     0.00   16.51 -1918.64  1981.0   3.0\n14  AAAAAAAAAAHKDAAA  United States       OK     Tillman County  98.0  107.38   871.17   38.65 -2593.03  1955.0   3.0\n15  AAAAAAAAGGHBDAAA  United States       OK     Tillman County  49.0  111.91     0.00   77.21  1196.58  1955.0   3.0\n16  AAAAAAAABLEOBAAA  United States       OK     Tillman County  54.0  167.88     0.00   25.18 -2154.06  1955.0   3.0\n17  AAAAAAAAONAICAAA  United States       OK     Alfalfa County  61.0  174.92     0.00   62.97  -880.23  1980.0   2.0\n18  AAAAAAAAINNPAAAA  United States       KY      Mercer County  13.0   13.51     0.00   10.53     0.65  1952.0   2.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019089,
                    "execution_time": 0.007903,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004629
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020283,
                    "execution_time": 0.008546,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004821
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state          ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAADEDDAAAA  United States       KY   Jessamine County  56.0  170.25     0.00  134.49  2513.28  1979.0   2.0\n1   AAAAAAAAHAODEAAA  United States       KY       Allen County  68.0  106.82     0.00   49.13 -2290.24  1977.0   4.0\n2   AAAAAAAADDDLCAAA  United States       OK      Carter County  81.0   87.54     0.00   24.51 -2137.59  1978.0   2.0\n3   AAAAAAAANAHMCAAA  United States       CA      Colusa County   2.0  244.69   122.14  234.90   151.12  1974.0   4.0\n4   AAAAAAAABBDOAAAA  United States       AL  Lauderdale County  94.0    2.46     0.00    0.29  -149.46  1936.0   2.0\n5   AAAAAAAACDFDAAAA  United States       AL  Lauderdale County  65.0   53.31  1095.49   49.57   838.26  1936.0   2.0\n6   AAAAAAAAGIKKBAAA  United States       KY       Floyd County  97.0    8.04    30.38    5.22  -169.09  1970.0   3.0\n7   AAAAAAAAIJDEEAAA  United States       KY       Floyd County  43.0   40.11   338.02   22.46  -424.02  1970.0   3.0\n8   AAAAAAAACAKKAAAA  United States       KY         Lee County  53.0  210.68     0.00  139.04  3518.67  1926.0   4.0\n9   AAAAAAAAPOGKBAAA  United States       KY         Lee County  28.0   33.89    27.32   24.40   186.04  1926.0   4.0\n10  AAAAAAAAIFHEEAAA  United States       CA      Tulare County  67.0  182.68     0.00  153.45  6159.98  1934.0   6.0\n11  AAAAAAAAKAANCAAA  United States       CA        Lake County  41.0  204.02   225.39   61.85 -1426.61  1982.5   3.5\n12  AAAAAAAAOCFCAAAA  United States       CA        Lake County  36.0  147.75     0.00   24.82 -1779.82  1982.5   3.5\n13  AAAAAAAAGHDPAAAA  United States       CA        Lake County  58.0  110.08     0.00   16.51 -1918.64  1981.0   3.0\n14  AAAAAAAAAAHKDAAA  United States       OK     Tillman County  98.0  107.38   871.17   38.65 -2593.03  1955.0   3.0\n15  AAAAAAAAGGHBDAAA  United States       OK     Tillman County  49.0  111.91     0.00   77.21  1196.58  1955.0   3.0\n16  AAAAAAAABLEOBAAA  United States       OK     Tillman County  54.0  167.88     0.00   25.18 -2154.06  1955.0   3.0\n17  AAAAAAAAONAICAAA  United States       OK     Alfalfa County  61.0  174.92     0.00   62.97  -880.23  1980.0   2.0\n18  AAAAAAAAINNPAAAA  United States       KY      Mercer County  13.0   13.51     0.00   10.53     0.65  1952.0   2.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" , \"CA_STATE\" , \"CA_COUNTY\" , \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAAABEAAA                  AL            34.0   54.35     0.00   21.19    76.50  1940.0   2.0\n1   AAAAAAAAAABJAAAA                  AL            80.0  114.31   658.36   68.58   431.24  1937.0   1.0\n2   AAAAAAAAAABNCAAA                  AL            25.0   78.93     0.00   71.03   433.25  1925.0   0.0\n3   AAAAAAAAAACEEAAA                  AL            78.0  125.47     0.00   52.69 -2831.40  1954.0   6.0\n4   AAAAAAAAAADHBAAA                  AL            79.0   41.06     0.00   24.63   173.01  1971.0   4.0\n5   AAAAAAAAAAELCAAA                  AL            29.0  163.00     0.00   91.28  1005.72  1951.0   0.0\n6   AAAAAAAAAANFCAAA                  AL            91.0   27.35     0.00   12.58   152.88  1971.0   4.0\n7   AAAAAAAAAAPCCAAA                  AL            95.0   40.97     0.00    0.81 -2199.25  1971.0   5.0\n8   AAAAAAAAAAPFCAAA                  AL            75.0   23.75     0.00    9.97  -288.00  1972.0   4.0\n9   AAAAAAAAABBGDAAA                  AL            36.0  111.41     0.00   10.02 -2243.88  1969.0   3.0\n10  AAAAAAAAABCPCAAA                  AL            15.0  154.69     0.00   44.86  -548.40  1940.0   6.0\n11  AAAAAAAAABDDEAAA                  AL            25.0  169.60   142.44   11.87 -1665.44  1955.0   0.0\n12  AAAAAAAAABFAEAAA                  AL            44.0  100.89   185.51   38.33  -787.43  1935.0   6.0\n13  AAAAAAAAABGGBAAA                  AL            51.0   34.16     0.00    2.04  -563.55  1971.0   5.0\n14  AAAAAAAAABHOAAAA                  AL            10.0   49.41     0.00   27.17    58.70  1973.0   0.0\n15  AAAAAAAAABIBBAAA                  AL            90.0  132.61     0.00   15.91 -3920.40  1950.0   4.0\n16  AAAAAAAAABJAAAAA                  AL            33.0  158.76  2036.86  128.59  -494.11  1960.0   3.0\n17  AAAAAAAAABJFEAAA                  AL            18.0   82.14    68.00   37.78  -508.10  1963.0   1.0\n18  AAAAAAAAABKHBAAA                  AL            37.0  138.06     0.00   28.99 -1644.65  1976.0   4.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041481,
                    "execution_time": 0.027291,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.006884
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.238068,
                    "execution_time": 0.027531,
                    "compile_time": 0.162865,
                    "planning_time": 0.040759
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAAABEAAA                  AL            34.0   54.35     0.00   21.19    76.50  1940.0   2.0\n1   AAAAAAAAAABJAAAA                  AL            80.0  114.31   658.36   68.58   431.24  1937.0   1.0\n2   AAAAAAAAAABNCAAA                  AL            25.0   78.93     0.00   71.03   433.25  1925.0   0.0\n3   AAAAAAAAAACEEAAA                  AL            78.0  125.47     0.00   52.69 -2831.40  1954.0   6.0\n4   AAAAAAAAAADHBAAA                  AL            79.0   41.06     0.00   24.63   173.01  1971.0   4.0\n5   AAAAAAAAAAELCAAA                  AL            29.0  163.00     0.00   91.28  1005.72  1951.0   0.0\n6   AAAAAAAAAANFCAAA                  AL            91.0   27.35     0.00   12.58   152.88  1971.0   4.0\n7   AAAAAAAAAAPCCAAA                  AL            95.0   40.97     0.00    0.81 -2199.25  1971.0   5.0\n8   AAAAAAAAAAPFCAAA                  AL            75.0   23.75     0.00    9.97  -288.00  1972.0   4.0\n9   AAAAAAAAABBGDAAA                  AL            36.0  111.41     0.00   10.02 -2243.88  1969.0   3.0\n10  AAAAAAAAABCPCAAA                  AL            15.0  154.69     0.00   44.86  -548.40  1940.0   6.0\n11  AAAAAAAAABDDEAAA                  AL            25.0  169.60   142.44   11.87 -1665.44  1955.0   0.0\n12  AAAAAAAAABFAEAAA                  AL            44.0  100.89   185.51   38.33  -787.43  1935.0   6.0\n13  AAAAAAAAABGGBAAA                  AL            51.0   34.16     0.00    2.04  -563.55  1971.0   5.0\n14  AAAAAAAAABHOAAAA                  AL            10.0   49.41     0.00   27.17    58.70  1973.0   0.0\n15  AAAAAAAAABIBBAAA                  AL            90.0  132.61     0.00   15.91 -3920.40  1950.0   4.0\n16  AAAAAAAAABJAAAAA                  AL            33.0  158.76  2036.86  128.59  -494.11  1960.0   3.0\n17  AAAAAAAAABJFEAAA                  AL            18.0   82.14    68.00   37.78  -508.10  1963.0   1.0\n18  AAAAAAAAABKHBAAA                  AL            37.0  138.06     0.00   28.99 -1644.65  1976.0   4.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" , \"CA_STATE\" , \"CA_COUNTY\" , \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAAABEAAA                  AL            34.0   54.35     0.00   21.19    76.50  1940.0   2.0\n1   AAAAAAAAAABJAAAA                  AL            80.0  114.31   658.36   68.58   431.24  1937.0   1.0\n2   AAAAAAAAAABNCAAA                  AL            25.0   78.93     0.00   71.03   433.25  1925.0   0.0\n3   AAAAAAAAAACEEAAA                  AL            78.0  125.47     0.00   52.69 -2831.40  1954.0   6.0\n4   AAAAAAAAAADHBAAA                  AL            79.0   41.06     0.00   24.63   173.01  1971.0   4.0\n5   AAAAAAAAAAELCAAA                  AL            29.0  163.00     0.00   91.28  1005.72  1951.0   0.0\n6   AAAAAAAAAANFCAAA                  AL            91.0   27.35     0.00   12.58   152.88  1971.0   4.0\n7   AAAAAAAAAAPCCAAA                  AL            95.0   40.97     0.00    0.81 -2199.25  1971.0   5.0\n8   AAAAAAAAAAPFCAAA                  AL            75.0   23.75     0.00    9.97  -288.00  1972.0   4.0\n9   AAAAAAAAABBGDAAA                  AL            36.0  111.41     0.00   10.02 -2243.88  1969.0   3.0\n10  AAAAAAAAABCPCAAA                  AL            15.0  154.69     0.00   44.86  -548.40  1940.0   6.0\n11  AAAAAAAAABDDEAAA                  AL            25.0  169.60   142.44   11.87 -1665.44  1955.0   0.0\n12  AAAAAAAAABFAEAAA                  AL            44.0  100.89   185.51   38.33  -787.43  1935.0   6.0\n13  AAAAAAAAABGGBAAA                  AL            51.0   34.16     0.00    2.04  -563.55  1971.0   5.0\n14  AAAAAAAAABHOAAAA                  AL            10.0   49.41     0.00   27.17    58.70  1973.0   0.0\n15  AAAAAAAAABIBBAAA                  AL            90.0  132.61     0.00   15.91 -3920.40  1950.0   4.0\n16  AAAAAAAAABJAAAAA                  AL            33.0  158.76  2036.86  128.59  -494.11  1960.0   3.0\n17  AAAAAAAAABJFEAAA                  AL            18.0   82.14    68.00   37.78  -508.10  1963.0   1.0\n18  AAAAAAAAABKHBAAA                  AL            37.0  138.06     0.00   28.99 -1644.65  1976.0   4.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039648,
                    "execution_time": 0.027917,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004866
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.039445,
                    "execution_time": 0.027449,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.004976
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAAABEAAA                  AL            34.0   54.35     0.00   21.19    76.50  1940.0   2.0\n1   AAAAAAAAAABJAAAA                  AL            80.0  114.31   658.36   68.58   431.24  1937.0   1.0\n2   AAAAAAAAAABNCAAA                  AL            25.0   78.93     0.00   71.03   433.25  1925.0   0.0\n3   AAAAAAAAAACEEAAA                  AL            78.0  125.47     0.00   52.69 -2831.40  1954.0   6.0\n4   AAAAAAAAAADHBAAA                  AL            79.0   41.06     0.00   24.63   173.01  1971.0   4.0\n5   AAAAAAAAAAELCAAA                  AL            29.0  163.00     0.00   91.28  1005.72  1951.0   0.0\n6   AAAAAAAAAANFCAAA                  AL            91.0   27.35     0.00   12.58   152.88  1971.0   4.0\n7   AAAAAAAAAAPCCAAA                  AL            95.0   40.97     0.00    0.81 -2199.25  1971.0   5.0\n8   AAAAAAAAAAPFCAAA                  AL            75.0   23.75     0.00    9.97  -288.00  1972.0   4.0\n9   AAAAAAAAABBGDAAA                  AL            36.0  111.41     0.00   10.02 -2243.88  1969.0   3.0\n10  AAAAAAAAABCPCAAA                  AL            15.0  154.69     0.00   44.86  -548.40  1940.0   6.0\n11  AAAAAAAAABDDEAAA                  AL            25.0  169.60   142.44   11.87 -1665.44  1955.0   0.0\n12  AAAAAAAAABFAEAAA                  AL            44.0  100.89   185.51   38.33  -787.43  1935.0   6.0\n13  AAAAAAAAABGGBAAA                  AL            51.0   34.16     0.00    2.04  -563.55  1971.0   5.0\n14  AAAAAAAAABHOAAAA                  AL            10.0   49.41     0.00   27.17    58.70  1973.0   0.0\n15  AAAAAAAAABIBBAAA                  AL            90.0  132.61     0.00   15.91 -3920.40  1950.0   4.0\n16  AAAAAAAAABJAAAAA                  AL            33.0  158.76  2036.86  128.59  -494.11  1960.0   3.0\n17  AAAAAAAAABJFEAAA                  AL            18.0   82.14    68.00   37.78  -508.10  1963.0   1.0\n18  AAAAAAAAABKHBAAA                  AL            37.0  138.06     0.00   28.99 -1644.65  1976.0   4.0\n...*/"
    }
]