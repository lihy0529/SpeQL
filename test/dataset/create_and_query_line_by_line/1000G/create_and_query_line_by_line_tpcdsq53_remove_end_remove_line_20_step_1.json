[
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store \ngroup by i_manufact_id /*CURSOR_IDENTIFIER*/ ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n1=1 /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and 1=1 /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 19.377281,
                    "execution_time": 19.300771,
                    "compile_time": 0.000488,
                    "planning_time": 0.049669,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 25.610725,
                    "execution_time": 21.071965,
                    "compile_time": 4.369656,
                    "planning_time": 0.136908,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    i_manufact_id     sum_sales  avg_quarterly_sales\n0              65  1.897356e+08         1.897356e+08\n1              90  1.764835e+08         1.764835e+08\n2             153  1.635005e+08         1.635005e+08\n3             169  1.702987e+08         1.702987e+08\n4             178  1.676346e+08         1.676346e+08\n5             470  1.040054e+08         1.040054e+08\n6             495  1.073480e+08         1.073480e+08\n7             580  9.023887e+07         9.023887e+07\n8             630  7.713309e+07         7.713309e+07\n9             899  2.766914e+07         2.766914e+07\n10            927  2.308799e+07         2.308799e+07\n11            181  1.793047e+08         1.793047e+08\n12            183  1.817981e+08         1.817981e+08\n13            215  1.824456e+08         1.824456e+08\n14            220  1.716712e+08         1.716712e+08\n15            285  1.676672e+08         1.676672e+08\n16            305  1.848561e+08         1.848561e+08\n17            427  1.007539e+08         1.007539e+08\n18            478  9.294928e+07         9.294928e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018385,
                    "execution_time": 0.008018,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004557
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056175,
                    "execution_time": 0.008022,
                    "compile_time": 0.000946,
                    "planning_time": 0.040053
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    i_manufact_id     sum_sales  avg_quarterly_sales\n0              65  1.897356e+08         1.897356e+08\n1              90  1.764835e+08         1.764835e+08\n2             153  1.635005e+08         1.635005e+08\n3             169  1.702987e+08         1.702987e+08\n4             178  1.676346e+08         1.676346e+08\n5             470  1.040054e+08         1.040054e+08\n6             495  1.073480e+08         1.073480e+08\n7             580  9.023887e+07         9.023887e+07\n8             630  7.713309e+07         7.713309e+07\n9             899  2.766914e+07         2.766914e+07\n10            927  2.308799e+07         2.308799e+07\n11            181  1.793047e+08         1.793047e+08\n12            183  1.817981e+08         1.817981e+08\n13            215  1.824456e+08         1.824456e+08\n14            220  1.716712e+08         1.716712e+08\n15            285  1.676672e+08         1.676672e+08\n16            305  1.848561e+08         1.848561e+08\n17            427  1.007539e+08         1.007539e+08\n18            478  9.294928e+07         9.294928e+07\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) \n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.516102,
                    "execution_time": 3.439379,
                    "compile_time": 0.000542,
                    "planning_time": 0.051852,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.775894,
                    "execution_time": 3.616285,
                    "compile_time": 0.002844,
                    "planning_time": 0.127329,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    i_manufact_id    sum_sales  avg_quarterly_sales\n0           260.0  36195190.61          36195190.61\n1           355.0  19212001.77          19212001.77\n2           461.0  21495631.37          21495631.37\n3           621.0  17816422.73          17816422.73\n4           631.0  18662218.59          18662218.59\n5           655.0  17036325.25          17036325.25\n6           871.0   7561553.48           7561553.48\n7           957.0   4921113.85           4921113.85\n8           969.0   4773865.54           4773865.54\n9            56.0  35839002.44          35839002.44\n10          135.0  36109012.40          36109012.40\n11          179.0  37488178.06          37488178.06\n12          243.0  38616269.72          38616269.72\n13          947.0   7595814.26           7595814.26\n14          202.0  35745608.28          35745608.28\n15          652.0  16860983.62          16860983.62\n16          761.0   5722503.49           5722503.49\n17          811.0   6277337.35           6277337.35\n18          922.0   7346423.17           7346423.17\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018106,
                    "execution_time": 0.007895,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.004389
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054819,
                    "execution_time": 0.008105,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039855
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    i_manufact_id    sum_sales  avg_quarterly_sales\n0           260.0  36195190.61          36195190.61\n1           355.0  19212001.77          19212001.77\n2           461.0  21495631.37          21495631.37\n3           621.0  17816422.73          17816422.73\n4           631.0  18662218.59          18662218.59\n5           655.0  17036325.25          17036325.25\n6           871.0   7561553.48           7561553.48\n7           957.0   4921113.85           4921113.85\n8           969.0   4773865.54           4773865.54\n9            56.0  35839002.44          35839002.44\n10          135.0  36109012.40          36109012.40\n11          179.0  37488178.06          37488178.06\n12          243.0  38616269.72          38616269.72\n13          947.0   7595814.26           7595814.26\n14          202.0  35745608.28          35745608.28\n15          652.0  16860983.62          16860983.62\n16          761.0   5722503.49           5722503.49\n17          811.0   6277337.35           6277337.35\n18          922.0   7346423.17           7346423.17\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n(i_category in ('Books','Children','Electronics')) /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.760434,
                    "execution_time": 3.678952,
                    "compile_time": 0.000551,
                    "planning_time": 0.052824,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.871665,
                    "execution_time": 3.709513,
                    "compile_time": 0.00274,
                    "planning_time": 0.131966,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    i_manufact_id    sum_sales  avg_quarterly_sales\n0             633   4094336.69           4094336.69\n1             672   1313706.06           1313706.06\n2             849   2003165.98           2003165.98\n3             933   1583235.83           1583235.83\n4             181  10681864.62          10681864.62\n5             183  10547537.05          10547537.05\n6             215  10679055.05          10679055.05\n7             220  10801521.82          10801521.82\n8             285  10687648.45          10687648.45\n9             305  11238563.90          11238563.90\n10            427   6013568.84           6013568.84\n11            478   5204911.66           5204911.66\n12            496   5183549.52           5183549.52\n13            536   4558622.02           4558622.02\n14            741   1597694.03           1597694.03\n15            808   2138795.61           2138795.61\n16            837   1198428.34           1198428.34\n17             65  10128808.66          10128808.66\n18             90  10392150.83          10392150.83\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017874,
                    "execution_time": 0.00752,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004406
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053731,
                    "execution_time": 0.007711,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.040005
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ('Books', 'Children', 'Electronics') GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    i_manufact_id    sum_sales  avg_quarterly_sales\n0             633   4094336.69           4094336.69\n1             672   1313706.06           1313706.06\n2             849   2003165.98           2003165.98\n3             933   1583235.83           1583235.83\n4             181  10681864.62          10681864.62\n5             183  10547537.05          10547537.05\n6             215  10679055.05          10679055.05\n7             220  10801521.82          10801521.82\n8             285  10687648.45          10687648.45\n9             305  11238563.90          11238563.90\n10            427   6013568.84           6013568.84\n11            478   5204911.66           5204911.66\n12            496   5183549.52           5183549.52\n13            536   4558622.02           4558622.02\n14            741   1597694.03           1597694.03\n15            808   2138795.61           2138795.61\n16            837   1198428.34           1198428.34\n17             65  10128808.66          10128808.66\n18             90  10392150.83          10392150.83\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') ))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.969779,
                    "execution_time": 0.885307,
                    "compile_time": 0.000555,
                    "planning_time": 0.056343,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.071701,
                    "execution_time": 0.905427,
                    "compile_time": 0.002677,
                    "planning_time": 0.133049,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0               1   665636.88            665636.88\n1              61   667735.92            667735.92\n2             148   527600.53            527600.53\n3             434   264825.60            264825.60\n4             504   405394.20            405394.20\n5             522   669330.12            669330.12\n6             590   265464.44            265464.44\n7             752   128396.10            128396.10\n8             946   270856.63            270856.63\n9             260   533364.41            533364.41\n10            355   926685.81            926685.81\n11            461   675386.79            675386.79\n12            621   660287.47            660287.47\n13            631   799214.17            799214.17\n14            655   396891.62            396891.62\n15            871   392231.81            392231.81\n16            957   257709.02            257709.02\n17            969   395742.03            395742.03\n18             56  1324115.11           1324115.11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017746,
                    "execution_time": 0.007309,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004485
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055632,
                    "execution_time": 0.00803,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.03972
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0               1   665636.88            665636.88\n1              61   667735.92            667735.92\n2             148   527600.53            527600.53\n3             434   264825.60            264825.60\n4             504   405394.20            405394.20\n5             522   669330.12            669330.12\n6             590   265464.44            265464.44\n7             752   128396.10            128396.10\n8             946   270856.63            270856.63\n9             260   533364.41            533364.41\n10            355   926685.81            926685.81\n11            461   675386.79            675386.79\n12            621   660287.47            660287.47\n13            631   799214.17            799214.17\n14            655   396891.62            396891.62\n15            871   392231.81            392231.81\n16            957   257709.02            257709.02\n17            969   395742.03            395742.03\n18             56  1324115.11           1324115.11\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) as sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) as avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7')\n)) /*CURSOR_IDENTIFIER*/\ngroup by i_manufact_id\n) as sales_data;",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' ) AND \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' ) AND \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.760602,
                    "execution_time": 0.677865,
                    "compile_time": 0.000555,
                    "planning_time": 0.055512,
                    "create_size": 804
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.933026,
                    "execution_time": 0.686988,
                    "compile_time": 3.083444,
                    "planning_time": 0.134986,
                    "create_size": 804
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             183  138756.50            138756.50\n1             220  135750.17            135750.17\n2               5  133455.79            133455.79\n3              86  134790.86            134790.86\n4             169  133690.42            133690.42\n5             178  133146.89            133146.89\n6               9  137827.19            137827.19\n7             318  135420.14            135420.14\n8              58  132539.37            132539.37\n9             268  131904.61            131904.61\n10            502  132797.76            132797.76\n11            552  126873.98            126873.98\n12            594  130236.57            130236.57\n13            116  133601.60            133601.60\n14            306  127749.52            127749.52\n15            152  133019.53            133019.53\n16            126  131774.13            131774.13\n17            149  130293.17            130293.17\n18            214  138598.03            138598.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017322,
                    "execution_time": 0.007215,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004349
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054539,
                    "execution_time": 0.007841,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.039508
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ('scholaramalgamalg #14', 'scholaramalgamalg #7') AND \"ITEM\".\"I_CATEGORY\" IN ('Books', 'Children', 'Electronics') AND \"ITEM\".\"I_CLASS\" IN ('personal', 'portable', 'reference', 'self-help') GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             183  138756.50            138756.50\n1             220  135750.17            135750.17\n2               5  133455.79            133455.79\n3              86  134790.86            134790.86\n4             169  133690.42            133690.42\n5             178  133146.89            133146.89\n6               9  137827.19            137827.19\n7             318  135420.14            135420.14\n8              58  132539.37            132539.37\n9             268  131904.61            131904.61\n10            502  132797.76            132797.76\n11            552  126873.98            126873.98\n12            594  130236.57            130236.57\n13            116  133601.60            133601.60\n14            306  127749.52            127749.52\n15            152  133019.53            133019.53\n16            126  131774.13            131774.13\n17            149  130293.17            130293.17\n18            214  138598.03            138598.03\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') ))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.216637,
                    "execution_time": 2.129768,
                    "compile_time": 0.000566,
                    "planning_time": 0.058163,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.408402,
                    "execution_time": 2.105263,
                    "compile_time": 0.131902,
                    "planning_time": 0.13886,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0           202.0  3439783.89           3439783.89\n1           652.0  1843505.95           1843505.95\n2           761.0   796359.75            796359.75\n3           811.0   788266.00            788266.00\n4           922.0  1591293.52           1591293.52\n5             NaN  1608764.69           1608764.69\n6           260.0  3443222.12           3443222.12\n7           355.0  2011954.19           2011954.19\n8           461.0  1740793.02           1740793.02\n9           621.0  1472145.45           1472145.45\n10          631.0  2127723.84           2127723.84\n11          655.0  1730409.63           1730409.63\n12          871.0   662496.23            662496.23\n13          957.0   670488.70            670488.70\n14          969.0   402525.88            402525.88\n15           56.0  3837296.75           3837296.75\n16          135.0  5333283.20           5333283.20\n17          179.0  5173390.76           5173390.76\n18          243.0  2925054.86           2925054.86\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017966,
                    "execution_time": 0.007453,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004457
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055323,
                    "execution_time": 0.007694,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.039821
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0           202.0  3439783.89           3439783.89\n1           652.0  1843505.95           1843505.95\n2           761.0   796359.75            796359.75\n3           811.0   788266.00            788266.00\n4           922.0  1591293.52           1591293.52\n5             NaN  1608764.69           1608764.69\n6           260.0  3443222.12           3443222.12\n7           355.0  2011954.19           2011954.19\n8           461.0  1740793.02           1740793.02\n9           621.0  1472145.45           1472145.45\n10          631.0  2127723.84           2127723.84\n11          655.0  1730409.63           1730409.63\n12          871.0   662496.23            662496.23\n13          957.0   670488.70            670488.70\n14          969.0   402525.88            402525.88\n15           56.0  3837296.75           3837296.75\n16          135.0  5333283.20           5333283.20\n17          179.0  5173390.76           5173390.76\n18          243.0  2925054.86           2925054.86\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) as sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) as avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor (i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1'))\n)\ngroup by i_manufact_id\n) as sales_data /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.784313,
                    "execution_time": 0.695724,
                    "compile_time": 0.000572,
                    "planning_time": 0.059915,
                    "create_size": 1032
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.877811,
                    "execution_time": 0.703642,
                    "compile_time": 0.001685,
                    "planning_time": 0.14283,
                    "create_size": 1032
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             183  138756.50            138756.50\n1             220  135750.17            135750.17\n2             169  133690.42            133690.42\n3             178  133146.89            133146.89\n4               5  133455.79            133455.79\n5              86  134790.86            134790.86\n6             396  135830.58            135830.58\n7              58  132539.37            132539.37\n8             268  131904.61            131904.61\n9             961  128247.05            128247.05\n10             83  134290.35            134290.35\n11            813  136548.15            136548.15\n12            502  132797.76            132797.76\n13            863  135146.27            135146.27\n14            279  134054.71            134054.71\n15             81  135817.60            135817.60\n16             87  266415.01            266415.01\n17            484  133052.02            133052.02\n18            116  133601.60            133601.60\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017913,
                    "execution_time": 0.007476,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004593
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055756,
                    "execution_time": 0.008085,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.039921
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             183  138756.50            138756.50\n1             220  135750.17            135750.17\n2             169  133690.42            133690.42\n3             178  133146.89            133146.89\n4               5  133455.79            133455.79\n5              86  134790.86            134790.86\n6             396  135830.58            135830.58\n7              58  132539.37            132539.37\n8             268  131904.61            131904.61\n9             961  128247.05            128247.05\n10             83  134290.35            134290.35\n11            813  136548.15            136548.15\n12            502  132797.76            132797.76\n13            863  135146.27            135146.27\n14            279  134054.71            134054.71\n15             81  135817.60            135817.60\n16             87  266415.01            266415.01\n17            484  133052.02            133052.02\n18            116  133601.60            133601.60\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.802185,
                    "execution_time": 0.717924,
                    "compile_time": 0.000583,
                    "planning_time": 0.056654,
                    "create_size": 1188
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.887152,
                    "execution_time": 0.717222,
                    "compile_time": 0.001707,
                    "planning_time": 0.13778,
                    "create_size": 1188
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61  133195.25            133195.25\n1             752  128396.10            128396.10\n2             135  265285.04            265285.04\n3             167  133409.10            133409.10\n4             462  131799.75            131799.75\n5             508  138127.65            138127.65\n6             355  133189.32            133189.32\n7             631  129941.99            129941.99\n8             871  133817.01            133817.01\n9             315  269128.58            269128.58\n10             22  136488.63            136488.63\n11            454  131984.34            131984.34\n12            432  142300.53            142300.53\n13            198  136507.84            136507.84\n14            416  130533.06            130533.06\n15            442  137438.27            137438.27\n16            560  133163.44            133163.44\n17            612  132017.06            132017.06\n18            931  130567.49            130567.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018356,
                    "execution_time": 0.00808,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.004443
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056479,
                    "execution_time": 0.008285,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.040168
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61  133195.25            133195.25\n1             752  128396.10            128396.10\n2             135  265285.04            265285.04\n3             167  133409.10            133409.10\n4             462  131799.75            131799.75\n5             508  138127.65            138127.65\n6             355  133189.32            133189.32\n7             631  129941.99            129941.99\n8             871  133817.01            133817.01\n9             315  269128.58            269128.58\n10             22  136488.63            136488.63\n11            454  131984.34            131984.34\n12            432  142300.53            142300.53\n13            198  136507.84            136507.84\n14            416  130533.06            130533.06\n15            442  137438.27            137438.27\n16            560  133163.44            133163.44\n17            612  132017.06            132017.06\n18            931  130567.49            130567.49\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.795571,
                    "execution_time": 0.711439,
                    "compile_time": 0.000607,
                    "planning_time": 0.057889,
                    "create_size": 1188
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.991221,
                    "execution_time": 0.763739,
                    "compile_time": 3.057136,
                    "planning_time": 0.136855,
                    "create_size": 1188
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             183   19513.91             34689.12\n1             183   38053.24             34689.12\n2             183   61005.57             34689.12\n3             183   20183.78             34689.12\n4             220   60632.65             33937.54\n5             220   37048.82             33937.54\n6             220   18456.82             33937.54\n7             220   19611.88             33937.54\n8             285   36871.82             33071.38\n9             285   57128.80             33071.38\n10            285   17841.74             33071.38\n11            285   20443.19             33071.38\n12            169   58158.19             33422.60\n13            169   20411.02             33422.60\n14            169   19385.26             33422.60\n15            169   35735.95             33422.60\n16            178   20127.93             33286.72\n17            178   57205.95             33286.72\n18            178   18987.49             33286.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017594,
                    "execution_time": 0.007333,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004381
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055391,
                    "execution_time": 0.007614,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.039951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             183   19513.91             34689.12\n1             183   38053.24             34689.12\n2             183   61005.57             34689.12\n3             183   20183.78             34689.12\n4             220   60632.65             33937.54\n5             220   37048.82             33937.54\n6             220   18456.82             33937.54\n7             220   19611.88             33937.54\n8             285   36871.82             33071.38\n9             285   57128.80             33071.38\n10            285   17841.74             33071.38\n11            285   20443.19             33071.38\n12            169   58158.19             33422.60\n13            169   20411.02             33422.60\n14            169   19385.26             33422.60\n15            169   35735.95             33422.60\n16            178   20127.93             33286.72\n17            178   57205.95             33286.72\n18            178   18987.49             33286.72\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 then 1 else 0 end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090031,
                    "execution_time": 0.060751,
                    "compile_time": 0.000216,
                    "planning_time": 0.005232,
                    "create_size": 1188
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.469854,
                    "execution_time": 0.216879,
                    "compile_time": 0.163473,
                    "planning_time": 0.062268,
                    "create_size": 1188
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61   20030.80             33298.81\n1              61   56044.20             33298.81\n2              61   20588.49             33298.81\n3              61   36531.76             33298.81\n4             752   35388.81             32099.02\n5             752   20457.45             32099.02\n6             752   17874.15             32099.02\n7             752   54675.69             32099.02\n8             135   68372.71             66321.26\n9             135  118652.93             66321.26\n10            135   38317.74             66321.26\n11            135   39941.66             66321.26\n12            315   40074.11             67282.14\n13            315   71768.19             67282.14\n14            315  117935.43             67282.14\n15            315   39350.85             67282.14\n16            355   36938.38             33297.33\n17            355   58375.72             33297.33\n18            355   19671.53             33297.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017346,
                    "execution_time": 0.007338,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.004219
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053292,
                    "execution_time": 0.007498,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039803
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61   20030.80             33298.81\n1              61   56044.20             33298.81\n2              61   20588.49             33298.81\n3              61   36531.76             33298.81\n4             752   35388.81             32099.02\n5             752   20457.45             32099.02\n6             752   17874.15             32099.02\n7             752   54675.69             32099.02\n8             135   68372.71             66321.26\n9             135  118652.93             66321.26\n10            135   38317.74             66321.26\n11            135   39941.66             66321.26\n12            315   40074.11             67282.14\n13            315   71768.19             67282.14\n14            315  117935.43             67282.14\n15            315   39350.85             67282.14\n16            355   36938.38             33297.33\n17            355   58375.72             33297.33\n18            355   19671.53             33297.33\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales > 0.1 end\n/*CURSOR_IDENTIFIER*/ order by sum_sales desc",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0.1 END ORDER BY \"TMP1\".\"SUM_SALES\" DESC NULLS FIRST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0.1 END",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.091778,
                    "execution_time": 0.061635,
                    "compile_time": 0.000227,
                    "planning_time": 0.006257,
                    "create_size": 1188
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.667945,
                    "execution_time": 0.479474,
                    "compile_time": 0.098481,
                    "planning_time": 0.063583,
                    "create_size": 1188
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_11\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" DESC LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             141  179425.90            102364.34\n1             113  175100.21             99507.30\n2             135  118652.93             66321.26\n3              88  117974.29             66335.92\n4             315  117935.43             67282.14\n5             279  117904.32             66844.62\n6             304  116776.09             65569.72\n7              41  116478.05             66713.71\n8              87  116425.49             66603.75\n9             227  116380.98             66964.64\n10            494  116137.38             66171.36\n11            191  115753.62             64405.09\n12            548  115626.32             67941.97\n13            318  114789.12             66996.37\n14            309  114725.72             66187.34\n15            312  114717.91             66155.13\n16            251  114113.84             64358.09\n17            548   75707.82             67941.97\n18            312   72858.84             66155.13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019479,
                    "execution_time": 0.009337,
                    "compile_time": 6.7e-05,
                    "planning_time": 0.004481
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.14147,
                    "execution_time": 0.008726,
                    "compile_time": 0.086136,
                    "planning_time": 0.03978
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0.1 END ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_11\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             141  179425.90            102364.34\n1             113  175100.21             99507.30\n2             135  118652.93             66321.26\n3              88  117974.29             66335.92\n4             315  117935.43             67282.14\n5             279  117904.32             66844.62\n6             304  116776.09             65569.72\n7              41  116478.05             66713.71\n8              87  116425.49             66603.75\n9             227  116380.98             66964.64\n10            494  116137.38             66171.36\n11            191  115753.62             64405.09\n12            548  115626.32             67941.97\n13            318  114789.12             66996.37\n14            309  114725.72             66187.34\n15            312  114717.91             66155.13\n16            251  114113.84             64358.09\n17            548   75707.82             67941.97\n18            312   72858.84             66155.13\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089529,
                    "execution_time": 0.059678,
                    "compile_time": 0.000208,
                    "planning_time": 0.006192,
                    "create_size": 1188
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.458645,
                    "execution_time": 0.367614,
                    "compile_time": 0.001319,
                    "planning_time": 0.062992,
                    "create_size": 1188
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             169   58158.19             33422.60\n1             169   20411.02             33422.60\n2             169   19385.26             33422.60\n3             178   20127.93             33286.72\n4             178   57205.95             33286.72\n5             178   18987.49             33286.72\n6             178   36825.52             33286.72\n7             314   55273.70             32008.14\n8             314   18671.70             32008.14\n9             314   19580.59             32008.14\n10              5   58896.09             33363.94\n11              5   37096.01             33363.94\n12              5   19012.46             33363.94\n13              5   18451.23             33363.94\n14             86   18441.17             33697.71\n15             86   21714.74             33697.71\n16             86   57934.92             33697.71\n17            396   19863.08             33957.64\n18            396   19441.35             33957.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017164,
                    "execution_time": 0.007334,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004225
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055045,
                    "execution_time": 0.0077,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039447
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             169   58158.19             33422.60\n1             169   20411.02             33422.60\n2             169   19385.26             33422.60\n3             178   20127.93             33286.72\n4             178   57205.95             33286.72\n5             178   18987.49             33286.72\n6             178   36825.52             33286.72\n7             314   55273.70             32008.14\n8             314   18671.70             32008.14\n9             314   19580.59             32008.14\n10              5   58896.09             33363.94\n11              5   37096.01             33363.94\n12              5   19012.46             33363.94\n13              5   18451.23             33363.94\n14             86   18441.17             33697.71\n15             86   21714.74             33697.71\n16             86   57934.92             33697.71\n17            396   19863.08             33957.64\n18            396   19441.35             33957.64\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   53279.91             31675.48\n1             598   19576.13             31675.48\n2             598   18960.86             31675.48\n3             598   34885.05             31675.48\n4             773   56256.80             31713.83\n5             773   16847.18             31713.83\n6             773   35108.30             31713.83\n7             773   18643.05             31713.83\n8             552   57338.05             31718.49\n9             552   35057.75             31718.49\n10            552   17488.41             31718.49\n11            552   16989.77             31718.49\n12            242   35272.60             31760.71\n13            242   17847.97             31760.71\n14            242   16473.40             31760.71\n15            242   57448.87             31760.71\n16             63   19578.28             31809.42\n17             63   54801.26             31809.42\n18             63   19028.75             31809.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018458,
                    "execution_time": 0.008574,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.004272
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.195428,
                    "execution_time": 0.009412,
                    "compile_time": 0.140579,
                    "planning_time": 0.039666
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   53279.91             31675.48\n1             598   19576.13             31675.48\n2             598   18960.86             31675.48\n3             598   34885.05             31675.48\n4             773   56256.80             31713.83\n5             773   16847.18             31713.83\n6             773   35108.30             31713.83\n7             773   18643.05             31713.83\n8             552   57338.05             31718.49\n9             552   35057.75             31718.49\n10            552   17488.41             31718.49\n11            552   16989.77             31718.49\n12            242   35272.60             31760.71\n13            242   17847.97             31760.71\n14            242   16473.40             31760.71\n15            242   57448.87             31760.71\n16             63   19578.28             31809.42\n17             63   54801.26             31809.42\n18             63   19028.75             31809.42\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   18960.86             31675.48\n1             598   19576.13             31675.48\n2             598   34885.05             31675.48\n3             598   53279.91             31675.48\n4             773   16847.18             31713.83\n5             773   18643.05             31713.83\n6             773   35108.30             31713.83\n7             773   56256.80             31713.83\n8             552   16989.77             31718.49\n9             552   17488.41             31718.49\n10            552   35057.75             31718.49\n11            552   57338.05             31718.49\n12            242   16473.40             31760.71\n13            242   17847.97             31760.71\n14            242   35272.60             31760.71\n15            242   57448.87             31760.71\n16             63   19028.75             31809.42\n17             63   19578.28             31809.42\n18             63   54801.26             31809.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018702,
                    "execution_time": 0.008505,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.004491
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.164072,
                    "execution_time": 0.008568,
                    "compile_time": 0.110211,
                    "planning_time": 0.039535
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   18960.86             31675.48\n1             598   19576.13             31675.48\n2             598   34885.05             31675.48\n3             598   53279.91             31675.48\n4             773   16847.18             31713.83\n5             773   18643.05             31713.83\n6             773   35108.30             31713.83\n7             773   56256.80             31713.83\n8             552   16989.77             31718.49\n9             552   17488.41             31718.49\n10            552   35057.75             31718.49\n11            552   57338.05             31718.49\n12            242   16473.40             31760.71\n13            242   17847.97             31760.71\n14            242   35272.60             31760.71\n15            242   57448.87             31760.71\n16             63   19028.75             31809.42\n17             63   19578.28             31809.42\n18             63   54801.26             31809.42\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST , \"TMP1\".\"I_MANUFACT_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   18960.86             31675.48\n1             598   19576.13             31675.48\n2             598   34885.05             31675.48\n3             598   53279.91             31675.48\n4             773   16847.18             31713.83\n5             773   18643.05             31713.83\n6             773   35108.30             31713.83\n7             773   56256.80             31713.83\n8             552   16989.77             31718.49\n9             552   17488.41             31718.49\n10            552   35057.75             31718.49\n11            552   57338.05             31718.49\n12            242   16473.40             31760.71\n13            242   17847.97             31760.71\n14            242   35272.60             31760.71\n15            242   57448.87             31760.71\n16             63   19028.75             31809.42\n17             63   19578.28             31809.42\n18             63   54801.26             31809.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019136,
                    "execution_time": 0.008576,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.00494
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.227721,
                    "execution_time": 0.009347,
                    "compile_time": 0.172497,
                    "planning_time": 0.040129
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   18960.86             31675.48\n1             598   19576.13             31675.48\n2             598   34885.05             31675.48\n3             598   53279.91             31675.48\n4             773   16847.18             31713.83\n5             773   18643.05             31713.83\n6             773   35108.30             31713.83\n7             773   56256.80             31713.83\n8             552   16989.77             31718.49\n9             552   17488.41             31718.49\n10            552   35057.75             31718.49\n11            552   57338.05             31718.49\n12            242   16473.40             31760.71\n13            242   17847.97             31760.71\n14            242   35272.60             31760.71\n15            242   57448.87             31760.71\n16             63   19028.75             31809.42\n17             63   19578.28             31809.42\n18             63   54801.26             31809.42\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST , \"TMP1\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   18960.86             31675.48\n1             598   19576.13             31675.48\n2             598   34885.05             31675.48\n3             598   53279.91             31675.48\n4             773   16847.18             31713.83\n5             773   18643.05             31713.83\n6             773   35108.30             31713.83\n7             773   56256.80             31713.83\n8             552   16989.77             31718.49\n9             552   17488.41             31718.49\n10            552   35057.75             31718.49\n11            552   57338.05             31718.49\n12            242   16473.40             31760.71\n13            242   17847.97             31760.71\n14            242   35272.60             31760.71\n15            242   57448.87             31760.71\n16             63   19028.75             31809.42\n17             63   19578.28             31809.42\n18             63   54801.26             31809.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018786,
                    "execution_time": 0.008532,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.00456
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01983,
                    "execution_time": 0.008885,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.004912
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             598   18960.86             31675.48\n1             598   19576.13             31675.48\n2             598   34885.05             31675.48\n3             598   53279.91             31675.48\n4             773   16847.18             31713.83\n5             773   18643.05             31713.83\n6             773   35108.30             31713.83\n7             773   56256.80             31713.83\n8             552   16989.77             31718.49\n9             552   17488.41             31718.49\n10            552   35057.75             31718.49\n11            552   57338.05             31718.49\n12            242   16473.40             31760.71\n13            242   17847.97             31760.71\n14            242   35272.60             31760.71\n15            242   57448.87             31760.71\n16             63   19028.75             31809.42\n17             63   19578.28             31809.42\n18             63   54801.26             31809.42\n...*/"
    }
]