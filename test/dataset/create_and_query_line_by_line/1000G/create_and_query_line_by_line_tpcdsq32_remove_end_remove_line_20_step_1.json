[
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ncs_sold_date_sk = d_date_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 48.280088,
                    "execution_time": 48.207399,
                    "compile_time": 0.000424,
                    "planning_time": 0.042146,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 55.525021,
                    "execution_time": 55.352067,
                    "compile_time": 0.002541,
                    "planning_time": 0.139037,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            4.379052e+14*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016033,
                    "execution_time": 0.007274,
                    "compile_time": 3.9e-05,
                    "planning_time": 0.002969
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051507,
                    "execution_time": 0.007676,
                    "compile_time": 3.9e-05,
                    "planning_time": 0.038083
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   excess discount amount\n0            4.379052e+14*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and '1999-03-22' \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1999-03-22' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1999-03-22' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090697,
                    "execution_time": 0.038828,
                    "compile_time": 0.000295,
                    "planning_time": 0.026609,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155984,
                    "execution_time": 0.040086,
                    "compile_time": 0.001221,
                    "planning_time": 0.089185,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    excess discount amount\n0             4.379052e+14\n1             4.379052e+14\n2             4.379052e+14\n3             4.379052e+14\n4             4.379052e+14\n5             4.379052e+14\n6             4.379052e+14\n7             4.379052e+14\n8             4.379052e+14\n9             4.379052e+14\n10            4.379052e+14\n11            4.379052e+14\n12            4.379052e+14\n13            4.379052e+14\n14            4.379052e+14\n15            4.379052e+14\n16            4.379052e+14\n17            4.379052e+14\n18            4.379052e+14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01653,
                    "execution_time": 0.007597,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.002887
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051739,
                    "execution_time": 0.006997,
                    "compile_time": 3.9e-05,
                    "planning_time": 0.038112
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('1999-03-22' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    excess discount amount\n0             4.379052e+14\n1             4.379052e+14\n2             4.379052e+14\n3             4.379052e+14\n4             4.379052e+14\n5             4.379052e+14\n6             4.379052e+14\n7             4.379052e+14\n8             4.379052e+14\n9             4.379052e+14\n10            4.379052e+14\n11            4.379052e+14\n12            4.379052e+14\n13            4.379052e+14\n14            4.379052e+14\n15            4.379052e+14\n16            4.379052e+14\n17            4.379052e+14\n18            4.379052e+14\n...*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            5.455156e+11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.034183,
                    "execution_time": 0.984301,
                    "compile_time": 0.00021,
                    "planning_time": 0.038479
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.104193,
                    "execution_time": 0.985833,
                    "compile_time": 0.000202,
                    "planning_time": 0.105414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            5.455156e+11*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.707883e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.099001,
                    "execution_time": 0.049674,
                    "compile_time": 0.000198,
                    "planning_time": 0.038286
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.187352,
                    "execution_time": 0.067606,
                    "compile_time": 0.002,
                    "planning_time": 0.105531
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            1.707883e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt IS NOT NULL \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 WHERE NOT \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND NOT CS_EXT_DISCOUNT_AMT IS NULL LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.707883e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.107342,
                    "execution_time": 0.056432,
                    "compile_time": 0.000195,
                    "planning_time": 0.039353
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.331117,
                    "execution_time": 0.057639,
                    "compile_time": 0.154102,
                    "planning_time": 0.106257
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 WHERE NOT \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            1.707883e+08*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \nwhere\ncs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n         where \n            cs_sold_date_sk between (select min(cs_sold_date_sk) from catalog_sales) and \n            dateadd(day,90,cast('1999-02-22' as date))\n        )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT MIN ( \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"_U_1\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" <= \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" WHERE \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES WHERE CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES WHERE CS_SOLD_DATE_SK BETWEEN ( SELECT MIN ( CS_SOLD_DATE_SK ) FROM CATALOG_SALES ) AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) ) LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n         d_date_sk = cs_sold_date_sk\n         )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.671065,
                    "execution_time": 2.610148,
                    "compile_time": 0.000337,
                    "planning_time": 0.033314,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.741236,
                    "execution_time": 2.607791,
                    "compile_time": 0.001381,
                    "planning_time": 0.101913,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.202532e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.628917,
                    "execution_time": 2.563405,
                    "compile_time": 0.00035,
                    "planning_time": 0.048064
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.939065,
                    "execution_time": 2.566527,
                    "compile_time": 0.23353,
                    "planning_time": 0.118428
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            1.202532e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,date_dim\nwhere\nd_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_sold_date_sk = d_date_sk \n/*CURSOR_IDENTIFIER*/ \n           )",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 34.184766,
                    "execution_time": 33.936027,
                    "compile_time": 0.00026,
                    "planning_time": 0.024943,
                    "create_size": 19841
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 37.041222,
                    "execution_time": 36.734106,
                    "compile_time": 0.000279,
                    "planning_time": 0.092762,
                    "create_size": 19841
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.320729,
                    "execution_time": 9.266649,
                    "compile_time": 0.000338,
                    "planning_time": 0.025811,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.84423,
                    "execution_time": 11.718654,
                    "compile_time": 0.001343,
                    "planning_time": 0.09318,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , DATE_DIM WHERE D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            7.293839e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.628149,
                    "execution_time": 2.569596,
                    "compile_time": 0.000282,
                    "planning_time": 0.04319
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.638851,
                    "execution_time": 3.362155,
                    "compile_time": 0.150127,
                    "planning_time": 0.108867
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            7.293839e+10*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n              dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n     )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 45.218516,
                    "execution_time": 44.939013,
                    "compile_time": 0.000256,
                    "planning_time": 0.02542,
                    "create_size": 25601
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 41.466647,
                    "execution_time": 41.103122,
                    "compile_time": 0.003136,
                    "planning_time": 0.091233,
                    "create_size": 25601
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.198132e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.193724,
                    "execution_time": 0.104424,
                    "compile_time": 0.000445,
                    "planning_time": 0.068077
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.022947,
                    "execution_time": 0.137823,
                    "compile_time": 3.721196,
                    "planning_time": 0.140306
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0            1.198132e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.202644e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.20577,
                    "execution_time": 1.116477,
                    "compile_time": 0.000468,
                    "planning_time": 0.067953
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.392115,
                    "execution_time": 4.226927,
                    "compile_time": 0.002691,
                    "planning_time": 0.140638
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0            1.202644e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n/*CURSOR_IDENTIFIER*/\n     )",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.198132e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.196622,
                    "execution_time": 0.106599,
                    "compile_time": 0.000457,
                    "planning_time": 0.068553
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.193721,
                    "execution_time": 0.103314,
                    "compile_time": 0.000454,
                    "planning_time": 0.068859
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0            1.198132e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n      ) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.198132e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.194787,
                    "execution_time": 0.105661,
                    "compile_time": 0.000444,
                    "planning_time": 0.067857
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.193061,
                    "execution_time": 0.104239,
                    "compile_time": 0.000471,
                    "planning_time": 0.067192
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0            1.198132e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n      ) \nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            1.198132e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.194463,
                    "execution_time": 0.104431,
                    "compile_time": 0.000452,
                    "planning_time": 0.068601
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.192946,
                    "execution_time": 0.104115,
                    "compile_time": 0.000459,
                    "planning_time": 0.067575
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0            1.198132e+08*/"
    }
]