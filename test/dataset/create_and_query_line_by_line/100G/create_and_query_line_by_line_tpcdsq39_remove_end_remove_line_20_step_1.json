[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select null as w_warehouse_name, inv_warehouse_sk, inv_item_sk, null as d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from (select inv_warehouse_sk, inv_item_sk, null as d_moy\n             ,stddev_samp(INV_QUANTITY_ON_HAND) stdev, avg(INV_QUANTITY_ON_HAND) mean\n       from inventory\n       group by inv_warehouse_sk, inv_item_sk\n      ) subquery\n)\nselect * from inv\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" ) SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SUBQUERY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SUBQUERY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SUBQUERY\".\"STDEV\" AS \"STDEV\" , \"SUBQUERY\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SUBQUERY\".\"MEAN\" = 0 THEN NULL ELSE \"SUBQUERY\".\"STDEV\" / \"SUBQUERY\".\"MEAN\" END AS \"COV\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.678302,
                    "execution_time": 9.450934,
                    "compile_time": 0.000313,
                    "planning_time": 0.021844,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.541273,
                    "execution_time": 11.136424,
                    "compile_time": 0.171158,
                    "planning_time": 0.022461,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   w_warehouse_name  inv_warehouse_sk  inv_item_sk d_moy       stdev  mean       cov\n0              None                 4        99371  None  273.616318   525  0.521174\n1              None                 4        99381  None  302.666057   448  0.675594\n2              None                 4        99385  None  286.442449   513  0.558367\n3              None                 4        99387  None  284.432651   475  0.598806\n4              None                 4        99397  None  286.838150   505  0.567996\n5              None                 4        99411  None  286.714576   510  0.562185\n6              None                 4        99431  None  321.546216   468  0.687065\n7              None                 4        99439  None  296.688003   510  0.581741\n8              None                 4        99453  None  281.072593   493  0.570127\n9              None                 4        99471  None  274.779864   522  0.526398\n10             None                 4       105707  None  278.233020   488  0.570150\n11             None                 4       105717  None  286.309748   463  0.618380\n12             None                 4       105723  None  315.272700   442  0.713287\n13             None                 4       105725  None  259.986299   465  0.559110\n14             None                 4       105731  None  297.202890   481  0.617885\n15             None                 4       105741  None  291.148908   493  0.590566\n16             None                 4       105771  None  290.166149   472  0.614759\n17             None                 4       105791  None  299.019964   515  0.580621\n18             None                 4       105805  None  291.824518   453  0.644204\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.105365,
                    "execution_time": 0.007692,
                    "compile_time": 0.086707,
                    "planning_time": 0.004295
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.149132,
                    "execution_time": 0.008765,
                    "compile_time": 3.08996,
                    "planning_time": 0.03982
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT NULL AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , NULL AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_1\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_1\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   w_warehouse_name  inv_warehouse_sk  inv_item_sk d_moy       stdev  mean       cov\n0              None                 4        99371  None  273.616318   525  0.521174\n1              None                 4        99381  None  302.666057   448  0.675594\n2              None                 4        99385  None  286.442449   513  0.558367\n3              None                 4        99387  None  284.432651   475  0.598806\n4              None                 4        99397  None  286.838150   505  0.567996\n5              None                 4        99411  None  286.714576   510  0.562185\n6              None                 4        99431  None  321.546216   468  0.687065\n7              None                 4        99439  None  296.688003   510  0.581741\n8              None                 4        99453  None  281.072593   493  0.570127\n9              None                 4        99471  None  274.779864   522  0.526398\n10             None                 4       105707  None  278.233020   488  0.570150\n11             None                 4       105717  None  286.309748   463  0.618380\n12             None                 4       105723  None  315.272700   442  0.713287\n13             None                 4       105725  None  259.986299   465  0.559110\n14             None                 4       105731  None  297.202890   481  0.617885\n15             None                 4       105741  None  291.148908   493  0.590566\n16             None                 4       105771  None  290.166149   472  0.614759\n17             None                 4       105791  None  299.019964   515  0.580621\n18             None                 4       105805  None  291.824518   453  0.644204\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select inv_warehouse_sk, inv_item_sk\n       ,stddev_samp(INV_QUANTITY_ON_HAND) as stdev, avg(INV_QUANTITY_ON_HAND) as mean, case avg(INV_QUANTITY_ON_HAND) when 0 then null else stddev_samp(INV_QUANTITY_ON_HAND)/avg(INV_QUANTITY_ON_HAND) end as cov\n from inventory\n where inv_date_sk IS NOT NULL -- Assuming we filter out rows without a date\n group by inv_warehouse_sk, inv_item_sk)\nselect *\nfrom inv\nwhere case mean when 0 then 0 else stdev/mean end > 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"INV\" AS ( SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" , CASE WHEN AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) = 0 THEN NULL ELSE STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) / AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) END AS \"COV\" FROM \"INVENTORY\" AS \"INVENTORY\" WHERE NOT \"INVENTORY\".\"INV_DATE_SK\" IS NULL GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" ) SELECT \"INV\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INV\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"INV\".\"STDEV\" AS \"STDEV\" , \"INV\".\"MEAN\" AS \"MEAN\" , \"INV\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV\" WHERE CASE WHEN \"INV\".\"MEAN\" = 0 THEN 0 ELSE \"INV\".\"STDEV\" / \"INV\".\"MEAN\" END > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"INVENTORY\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" , CASE WHEN AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) = 0 THEN NULL ELSE STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) / AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) END AS \"COV\" FROM \"INVENTORY\" AS \"INVENTORY\" WHERE NOT \"INVENTORY\".\"INV_DATE_SK\" IS NULL GROUP BY \"INVENTORY\".\"INV_WAREHOUSE_SK\" , \"INVENTORY\".\"INV_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 17.578338,
                    "execution_time": 17.284846,
                    "compile_time": 0.00045,
                    "planning_time": 0.024583,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 22.04095,
                    "execution_time": 17.61047,
                    "compile_time": 4.071172,
                    "planning_time": 0.084742,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" END > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.173953,
                    "execution_time": 0.037041,
                    "compile_time": 0.110042,
                    "planning_time": 0.004793,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.482057,
                    "execution_time": 0.071999,
                    "compile_time": 3.321621,
                    "planning_time": 0.061412,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_3\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_3\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [inv_warehouse_sk, inv_item_sk, stdev, mean, cov]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04826,
                    "execution_time": 0.00757,
                    "compile_time": 0.030244,
                    "planning_time": 0.004586
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.118211,
                    "execution_time": 0.008125,
                    "compile_time": 3.060658,
                    "planning_time": 0.039526
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_2\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_2\".\"MEAN\" END > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"INV_WAREHOUSE_SK\" AS \"INV_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"INV_ITEM_SK\" AS \"INV_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"STDEV\" AS \"STDEV\" , \"SPEQLITE_TEMP_TABLE_3\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_3\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [inv_warehouse_sk, inv_item_sk, stdev, mean, cov]\nIndex: []*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv.w_warehouse_sk,inv.i_item_sk,inv.d_moy,inv.mean, inv.cov from inv \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.629798,
                    "execution_time": 4.329255,
                    "compile_time": 0.000593,
                    "planning_time": 0.042493,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.820221,
                    "execution_time": 4.281875,
                    "compile_time": 11.233448,
                    "planning_time": 0.043376,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.766938,
                    "execution_time": 0.43272,
                    "compile_time": 0.081598,
                    "planning_time": 0.005391,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.266058,
                    "execution_time": 0.649663,
                    "compile_time": 3.300867,
                    "planning_time": 0.062805,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_5\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0               14     171591      1   448  1.029121\n1               14     171595      1   296  1.129032\n2               14     171713      1   407  1.117517\n3               14     178171      1   332  1.198501\n4               14     184557      1   270  1.046268\n5               12     125973      1   318  1.003688\n6               12     132373      1   469  1.032241\n7               12     138595      1   334  1.051766\n8                7      51795      1   445  1.001038\n9                7      51937      1   342  1.091909\n10               7      71111      1   284  1.107454\n11               7      77489      1   279  1.330846\n12               7      77551      1   332  1.183988\n13               7      90223      1   251  1.236252\n14               7      90327      1   407  1.093461\n15               7      90337      1   165  1.392282\n16               7      90343      1   229  1.591977\n17              11      67863      1   336  1.390583\n18              11      74269      1   256  1.074642\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.068046,
                    "execution_time": 0.008191,
                    "compile_time": 0.050137,
                    "planning_time": 0.003559
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.324304,
                    "execution_time": 0.007955,
                    "compile_time": 3.267345,
                    "planning_time": 0.03856
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN NULL ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" = 0 THEN 0 ELSE \"SPEQLITE_TEMP_TABLE_4\".\"STDEV\" / \"SPEQLITE_TEMP_TABLE_4\".\"MEAN\" END > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_5\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0               14     171591      1   448  1.029121\n1               14     171595      1   296  1.129032\n2               14     171713      1   407  1.117517\n3               14     178171      1   332  1.198501\n4               14     184557      1   270  1.046268\n5               12     125973      1   318  1.003688\n6               12     132373      1   469  1.032241\n7               12     138595      1   334  1.051766\n8                7      51795      1   445  1.001038\n9                7      51937      1   342  1.091909\n10               7      71111      1   284  1.107454\n11               7      77489      1   279  1.330846\n12               7      77551      1   332  1.183988\n13               7      90223      1   251  1.236252\n14               7      90327      1   407  1.093461\n15               7      90337      1   165  1.392282\n16               7      90343      1   229  1.591977\n17              11      67863      1   336  1.390583\n18              11      74269      1   256  1.074642\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy\n       ,stdev, mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy\n            ,stddev_samp(INV_QUANTITY_ON_HAND) stdev, avg(INV_QUANTITY_ON_HAND) mean\n      from inventory \n      join warehouse on inv_warehouse_sk = w_warehouse_sk\n      join item on inv_item_sk = i_item_sk\n      join date_dim on inv_date_sk = d_date_sk\n      where d_year = 2001\n      group by w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov\n      ,inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov\nfrom inv inv1, inv inv2\nwhere inv1.w_warehouse_sk = inv2.w_warehouse_sk\n  and inv1.i_item_sk = inv2.i_item_sk\n  and inv1.d_moy < inv2.d_moy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"D_MOY\" < \"INV2\".\"D_MOY\" AND \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"D_MOY\" < \"INV2\".\"D_MOY\" AND \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.086628,
                    "execution_time": 0.607772,
                    "compile_time": 0.000587,
                    "planning_time": 0.006308,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.44276,
                    "execution_time": 0.608174,
                    "compile_time": 7.287848,
                    "planning_time": 0.063625,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1     128421      1   295  1.579252                     1           128421           12         269   1.308309\n1                1     128421      1   295  1.579252                     1           128421            8         158   1.217581\n2                1     134883      1   354  1.018982                     1           134883            3         275   1.101134\n3                1     141245      1   389  1.052042                     1           141245            5         327   1.134839\n4                1     141327      1   354  1.167378                     1           141327            3         314   1.080288\n5                1     141327      1   354  1.167378                     1           141327            7         338   1.099372\n6                1     147715      1   464  1.068604                     1           147715            2         360   1.031152\n7                1     147715      1   464  1.068604                     1           147715            8         439   1.019630\n8                1     154039      1   318  1.443065                     1           154039            6         333   1.023570\n9                1     114911      1   285  1.184336                     1           114911            5         290   1.525106\n10               1     121371      1   376  1.127914                     1           121371            4         248   1.118979\n11               1     179719      1   341  1.251185                     1           179719            3         318   1.060678\n12               1     179719      1   341  1.251185                     1           179719            6         346   1.153852\n13               1     179743      1   309  1.069374                     1           179743           10         312   1.107112\n14               1     179743      1   309  1.069374                     1           179743            6         140   1.714712\n15               1     186045      1   316  1.661770                     1           186045            8         278   1.283310\n16               1     186045      1   316  1.661770                     1           186045            2         369   1.024119\n17               1     192397      1   491  1.036728                     1           192397            9         388   1.000572\n18               2      46073      1   359  1.000190                     2            46073            6         292   1.275379\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.09278,
                    "execution_time": 0.008632,
                    "compile_time": 0.073042,
                    "planning_time": 0.004371
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.171523,
                    "execution_time": 0.008228,
                    "compile_time": 3.11266,
                    "planning_time": 0.039778
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"D_MOY\" < \"INV2\".\"D_MOY\" AND \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_6\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_6\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_6\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1     128421      1   295  1.579252                     1           128421           12         269   1.308309\n1                1     128421      1   295  1.579252                     1           128421            8         158   1.217581\n2                1     134883      1   354  1.018982                     1           134883            3         275   1.101134\n3                1     141245      1   389  1.052042                     1           141245            5         327   1.134839\n4                1     141327      1   354  1.167378                     1           141327            3         314   1.080288\n5                1     141327      1   354  1.167378                     1           141327            7         338   1.099372\n6                1     147715      1   464  1.068604                     1           147715            2         360   1.031152\n7                1     147715      1   464  1.068604                     1           147715            8         439   1.019630\n8                1     154039      1   318  1.443065                     1           154039            6         333   1.023570\n9                1     114911      1   285  1.184336                     1           114911            5         290   1.525106\n10               1     121371      1   376  1.127914                     1           121371            4         248   1.118979\n11               1     179719      1   341  1.251185                     1           179719            3         318   1.060678\n12               1     179719      1   341  1.251185                     1           179719            6         346   1.153852\n13               1     179743      1   309  1.069374                     1           179743           10         312   1.107112\n14               1     179743      1   309  1.069374                     1           179743            6         140   1.714712\n15               1     186045      1   316  1.661770                     1           186045            8         278   1.283310\n16               1     186045      1   316  1.661770                     1           186045            2         369   1.024119\n17               1     192397      1   491  1.036728                     1           192397            9         388   1.000572\n18               2      46073      1   359  1.000190                     2            46073            6         292   1.275379\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" CROSS JOIN \"INV\" AS \"INV2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               12      85039      2   289  1.304876                     1           115527            1         253   1.430376\n1               12      85039      2   289  1.304876                     1           121959            1         393   1.060692\n2               12      85039      2   289  1.304876                     1           128307            1         301   1.502926\n3               12      85039      2   289  1.304876                     1           147467            1         277   1.120619\n4               12      85039      2   289  1.304876                     1           153813            1         187   1.016628\n5               12      85039      2   289  1.304876                     1           153839            1         363   1.025086\n6               12      85039      2   289  1.304876                     2            97051            1         311   1.027006\n7               12      85039      2   289  1.304876                     2            97155            1         159   1.245415\n8               12      85039      2   289  1.304876                     2            97183            1         240   1.035979\n9               12      85039      2   289  1.304876                     2           109921            1         415   1.414214\n10              12      85039      2   289  1.304876                     2           122589            1         324   1.059745\n11              12      85039      2   289  1.304876                     2           122755            1         265   1.132164\n12              12      85039      2   289  1.304876                     3           104253            1         379   1.029058\n13              12      85039      2   289  1.304876                     3           129879            1         334   1.118509\n14              12      85039      2   289  1.304876                     1             6619            1         316   1.289187\n15              12      85039      2   289  1.304876                     1            13031            1         383   1.197638\n16              12      85039      2   289  1.304876                     1            13151            1         448   1.371598\n17              12      85039      2   289  1.304876                     1            38737            1         381   1.302944\n18              12      85039      2   289  1.304876                     2            13797            1         309   1.181817\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.067636,
                    "execution_time": 0.054567,
                    "compile_time": 0.014137,
                    "planning_time": 0.005291
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.194596,
                    "execution_time": 0.065559,
                    "compile_time": 3.133963,
                    "planning_time": 0.04089
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\"",
                "rewrite": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               12      85039      2   289  1.304876                     1           115527            1         253   1.430376\n1               12      85039      2   289  1.304876                     1           121959            1         393   1.060692\n2               12      85039      2   289  1.304876                     1           128307            1         301   1.502926\n3               12      85039      2   289  1.304876                     1           147467            1         277   1.120619\n4               12      85039      2   289  1.304876                     1           153813            1         187   1.016628\n5               12      85039      2   289  1.304876                     1           153839            1         363   1.025086\n6               12      85039      2   289  1.304876                     2            97051            1         311   1.027006\n7               12      85039      2   289  1.304876                     2            97155            1         159   1.245415\n8               12      85039      2   289  1.304876                     2            97183            1         240   1.035979\n9               12      85039      2   289  1.304876                     2           109921            1         415   1.414214\n10              12      85039      2   289  1.304876                     2           122589            1         324   1.059745\n11              12      85039      2   289  1.304876                     2           122755            1         265   1.132164\n12              12      85039      2   289  1.304876                     3           104253            1         379   1.029058\n13              12      85039      2   289  1.304876                     3           129879            1         334   1.118509\n14              12      85039      2   289  1.304876                     1             6619            1         316   1.289187\n15              12      85039      2   289  1.304876                     1            13031            1         383   1.197638\n16              12      85039      2   289  1.304876                     1            13151            1         448   1.371598\n17              12      85039      2   289  1.304876                     1            38737            1         381   1.302944\n18              12      85039      2   289  1.304876                     2            13797            1         309   1.181817\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK_COL_5\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK_COL_6\" , \"INV2\".\"D_MOY\" AS \"D_MOY_COL_7\" , \"INV2\".\"MEAN\" AS \"MEAN_COL_8\" , \"INV2\".\"COV\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.933953,
                    "execution_time": 1.33145,
                    "compile_time": 0.116919,
                    "planning_time": 0.005719,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.256612,
                    "execution_time": 1.408004,
                    "compile_time": 6.299475,
                    "planning_time": 0.061446,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               10     160479      1   360  1.193568                     9           160479            6         342   1.145946\n1               10     160479      1   360  1.193568                     2           160479            8         368   1.089445\n2               10     160479      1   360  1.193568                    10           160479            1         360   1.193568\n3               10      26945      1   317  1.068593                     7            26945            9         331   1.405382\n4               10      26945      1   317  1.068593                     1            26945            5         299   1.672463\n5               10      26945      1   317  1.068593                    12            26945            1         322   1.047800\n6               10      26945      1   317  1.068593                    13            26945            4         312   1.048304\n7               10      26945      1   317  1.068593                     2            26945           10         350   1.015693\n8               10      26945      1   317  1.068593                     9            26945            6         391   1.048330\n9               10      26945      1   317  1.068593                    10            26945            7         385   1.063774\n10              10      26945      1   317  1.068593                    10            26945           10         286   1.517116\n11              10      26945      1   317  1.068593                     8            26945            6         285   1.151727\n12              10      26945      1   317  1.068593                    15            26945           12         274   1.168557\n13              10      26945      1   317  1.068593                     3            26945            2         219   1.287349\n14              10      26945      1   317  1.068593                    10            26945            1         317   1.068593\n15              10      26983      1   165  1.034199                    12            26983            2         258   1.323314\n16              10      26983      1   165  1.034199                     3            26983            6         299   1.259640\n17              10      26983      1   165  1.034199                     1            26983            6         441   1.063195\n18              10      26983      1   165  1.034199                     7            26983           11         266   1.046443\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01873,
                    "execution_time": 0.007893,
                    "compile_time": 5e-05,
                    "planning_time": 0.004355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.091611,
                    "execution_time": 0.00801,
                    "compile_time": 0.035657,
                    "planning_time": 0.039818
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0               10     160479      1   360  1.193568                     9           160479            6         342   1.145946\n1               10     160479      1   360  1.193568                     2           160479            8         368   1.089445\n2               10     160479      1   360  1.193568                    10           160479            1         360   1.193568\n3               10      26945      1   317  1.068593                     7            26945            9         331   1.405382\n4               10      26945      1   317  1.068593                     1            26945            5         299   1.672463\n5               10      26945      1   317  1.068593                    12            26945            1         322   1.047800\n6               10      26945      1   317  1.068593                    13            26945            4         312   1.048304\n7               10      26945      1   317  1.068593                     2            26945           10         350   1.015693\n8               10      26945      1   317  1.068593                     9            26945            6         391   1.048330\n9               10      26945      1   317  1.068593                    10            26945            7         385   1.063774\n10              10      26945      1   317  1.068593                    10            26945           10         286   1.517116\n11              10      26945      1   317  1.068593                     8            26945            6         285   1.151727\n12              10      26945      1   317  1.068593                    15            26945           12         274   1.168557\n13              10      26945      1   317  1.068593                     3            26945            2         219   1.287349\n14              10      26945      1   317  1.068593                    10            26945            1         317   1.068593\n15              10      26983      1   165  1.034199                    12            26983            2         258   1.323314\n16              10      26983      1   165  1.034199                     3            26983            6         299   1.259640\n17              10      26983      1   165  1.034199                     1            26983            6         441   1.063195\n18              10      26983      1   165  1.034199                     7            26983           11         266   1.046443\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n1                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n2                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n3                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n4                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n5                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n6                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n7                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n8                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n9                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n10               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n11               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n12               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n13               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n14               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n15               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n16               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n17               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n18               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.292547,
                    "execution_time": 0.276222,
                    "compile_time": 0.000135,
                    "planning_time": 0.006345
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.777888,
                    "execution_time": 0.386703,
                    "compile_time": 3.324058,
                    "planning_time": 0.041632
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\""
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n1                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n2                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n3                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n4                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n5                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n6                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n7                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n8                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n9                1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n10               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n11               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n12               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n13               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n14               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n15               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n16               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n17               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n18               1     147765      1   277  1.606639                    14           147765           11         439   1.010067\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"INV1\".\"D_MOY\" = 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n1                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n2                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n3                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n4                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n5                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n6                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n7                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n8                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n9                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n10               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n11               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n12               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n13               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n14               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n15               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n16               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n17               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n18               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.128844,
                    "execution_time": 0.083395,
                    "compile_time": 0.02806,
                    "planning_time": 0.007206
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.441651,
                    "execution_time": 0.078321,
                    "compile_time": 3.303341,
                    "planning_time": 0.042853
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"INV1\".\"D_MOY\" = 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n1                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n2                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n3                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n4                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n5                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n6                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n7                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n8                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n9                2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n10               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n11               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n12               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n13               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n14               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n15               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n16               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n17               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n18               2      53967      1   372  1.074142                    15            53967            2         390   1.026402\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n1                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n2                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n3                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n4                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n5                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n6                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n7                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n8                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n9                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n10               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n11               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n12               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n13               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n14               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n15               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n16               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n17               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n18               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.185931,
                    "execution_time": 0.134016,
                    "compile_time": 0.032946,
                    "planning_time": 0.007716
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.654892,
                    "execution_time": 0.13973,
                    "compile_time": 3.455875,
                    "planning_time": 0.043164
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n1                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n2                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n3                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n4                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n5                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n6                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n7                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n8                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n9                3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n10               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n11               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n12               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n13               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n14               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n15               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n16               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n17               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n18               3      82247      1   352  1.229875                     9            82247            9         386   1.026398\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1         29      1   425  1.144126                    14               29           10         376   1.074111\n1                1         29      1   425  1.144126                    14               29           10         376   1.074111\n2                1         29      1   425  1.144126                    14               29           10         376   1.074111\n3                1         29      1   425  1.144126                    14               29           10         376   1.074111\n4                1         29      1   425  1.144126                    14               29           10         376   1.074111\n5                1         29      1   425  1.144126                    14               29           10         376   1.074111\n6                1         29      1   425  1.144126                    14               29           10         376   1.074111\n7                1         29      1   425  1.144126                    14               29           10         376   1.074111\n8                1         29      1   425  1.144126                    14               29           10         376   1.074111\n9                1         29      1   425  1.144126                    14               29           10         376   1.074111\n10               1         29      1   425  1.144126                    14               29           10         376   1.074111\n11               1         29      1   425  1.144126                    14               29           10         376   1.074111\n12               1         29      1   425  1.144126                    14               29           10         376   1.074111\n13               1         29      1   425  1.144126                    14               29           10         376   1.074111\n14               1         29      1   425  1.144126                    14               29           10         376   1.074111\n15               1         29      1   425  1.144126                    14               29           10         376   1.074111\n16               1         29      1   425  1.144126                    14               29           10         376   1.074111\n17               1         29      1   425  1.144126                    14               29           10         376   1.074111\n18               1         29      1   425  1.144126                    14               29           10         376   1.074111\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 17.165573,
                    "execution_time": 17.146732,
                    "compile_time": 0.000165,
                    "planning_time": 0.008451
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 21.199651,
                    "execution_time": 17.146194,
                    "compile_time": 4.703872,
                    "planning_time": 0.044042
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" NULLS LAST"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1         29      1   425  1.144126                    14               29           10         376   1.074111\n1                1         29      1   425  1.144126                    14               29           10         376   1.074111\n2                1         29      1   425  1.144126                    14               29           10         376   1.074111\n3                1         29      1   425  1.144126                    14               29           10         376   1.074111\n4                1         29      1   425  1.144126                    14               29           10         376   1.074111\n5                1         29      1   425  1.144126                    14               29           10         376   1.074111\n6                1         29      1   425  1.144126                    14               29           10         376   1.074111\n7                1         29      1   425  1.144126                    14               29           10         376   1.074111\n8                1         29      1   425  1.144126                    14               29           10         376   1.074111\n9                1         29      1   425  1.144126                    14               29           10         376   1.074111\n10               1         29      1   425  1.144126                    14               29           10         376   1.074111\n11               1         29      1   425  1.144126                    14               29           10         376   1.074111\n12               1         29      1   425  1.144126                    14               29           10         376   1.074111\n13               1         29      1   425  1.144126                    14               29           10         376   1.074111\n14               1         29      1   425  1.144126                    14               29           10         376   1.074111\n15               1         29      1   425  1.144126                    14               29           10         376   1.074111\n16               1         29      1   425  1.144126                    14               29           10         376   1.074111\n17               1         29      1   425  1.144126                    14               29           10         376   1.074111\n18               1         29      1   425  1.144126                    14               29           10         376   1.074111\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1         29      1   425  1.144126                     7               29            1         204    1.08953\n1                1         29      1   425  1.144126                     7               29            1         204    1.08953\n2                1         29      1   425  1.144126                     7               29            1         204    1.08953\n3                1         29      1   425  1.144126                     7               29            1         204    1.08953\n4                1         29      1   425  1.144126                     7               29            1         204    1.08953\n5                1         29      1   425  1.144126                     7               29            1         204    1.08953\n6                1         29      1   425  1.144126                     7               29            1         204    1.08953\n7                1         29      1   425  1.144126                     7               29            1         204    1.08953\n8                1         29      1   425  1.144126                     7               29            1         204    1.08953\n9                1         29      1   425  1.144126                     7               29            1         204    1.08953\n10               1         29      1   425  1.144126                     7               29            1         204    1.08953\n11               1         29      1   425  1.144126                     7               29            1         204    1.08953\n12               1         29      1   425  1.144126                     7               29            1         204    1.08953\n13               1         29      1   425  1.144126                     7               29            1         204    1.08953\n14               1         29      1   425  1.144126                     7               29            1         204    1.08953\n15               1         29      1   425  1.144126                     7               29            1         204    1.08953\n16               1         29      1   425  1.144126                     7               29            1         204    1.08953\n17               1         29      1   425  1.144126                     7               29            1         204    1.08953\n18               1         29      1   425  1.144126                     7               29            1         204    1.08953\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 17.162923,
                    "execution_time": 17.144422,
                    "compile_time": 0.000146,
                    "planning_time": 0.008482
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 21.129888,
                    "execution_time": 17.144772,
                    "compile_time": 4.182607,
                    "planning_time": 0.04452
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" NULLS LAST"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1         29      1   425  1.144126                     7               29            1         204    1.08953\n1                1         29      1   425  1.144126                     7               29            1         204    1.08953\n2                1         29      1   425  1.144126                     7               29            1         204    1.08953\n3                1         29      1   425  1.144126                     7               29            1         204    1.08953\n4                1         29      1   425  1.144126                     7               29            1         204    1.08953\n5                1         29      1   425  1.144126                     7               29            1         204    1.08953\n6                1         29      1   425  1.144126                     7               29            1         204    1.08953\n7                1         29      1   425  1.144126                     7               29            1         204    1.08953\n8                1         29      1   425  1.144126                     7               29            1         204    1.08953\n9                1         29      1   425  1.144126                     7               29            1         204    1.08953\n10               1         29      1   425  1.144126                     7               29            1         204    1.08953\n11               1         29      1   425  1.144126                     7               29            1         204    1.08953\n12               1         29      1   425  1.144126                     7               29            1         204    1.08953\n13               1         29      1   425  1.144126                     7               29            1         204    1.08953\n14               1         29      1   425  1.144126                     7               29            1         204    1.08953\n15               1         29      1   425  1.144126                     7               29            1         204    1.08953\n16               1         29      1   425  1.144126                     7               29            1         204    1.08953\n17               1         29      1   425  1.144126                     7               29            1         204    1.08953\n18               1         29      1   425  1.144126                     7               29            1         204    1.08953\n...*/"
    },
    {
        "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"FOO\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , STDDEV_SAMP ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"STDEV\" , AVG ( \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ) AS \"MEAN\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"WAREHOUSE\".\"W_WAREHOUSE_SK\" , \"ITEM\".\"I_ITEM_SK\" , \"DATE_DIM\".\"D_MOY\" ) , \"INV\" AS ( SELECT \"FOO\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"FOO\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"FOO\".\"D_MOY\" AS \"D_MOY\" , \"FOO\".\"MEAN\" AS \"MEAN\" , CASE WHEN \"FOO\".\"MEAN\" = 0 THEN NULL ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END AS \"COV\" FROM \"FOO\" AS \"FOO\" WHERE CASE WHEN \"FOO\".\"MEAN\" = 0 THEN 0 ELSE \"FOO\".\"STDEV\" / \"FOO\".\"MEAN\" END > 1 ) SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"INV\" AS \"INV1\" JOIN \"INV\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" LIMIT 21",
                "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1         29      1   425  1.144126                     7               29            1         204    1.08953\n1                1         29      1   425  1.144126                     7               29            1         204    1.08953\n2                1         29      1   425  1.144126                     7               29            1         204    1.08953\n3                1         29      1   425  1.144126                     7               29            1         204    1.08953\n4                1         29      1   425  1.144126                     7               29            1         204    1.08953\n5                1         29      1   425  1.144126                     7               29            1         204    1.08953\n6                1         29      1   425  1.144126                     7               29            1         204    1.08953\n7                1         29      1   425  1.144126                     7               29            1         204    1.08953\n8                1         29      1   425  1.144126                     7               29            1         204    1.08953\n9                1         29      1   425  1.144126                     7               29            1         204    1.08953\n10               1         29      1   425  1.144126                     7               29            1         204    1.08953\n11               1         29      1   425  1.144126                     7               29            1         204    1.08953\n12               1         29      1   425  1.144126                     7               29            1         204    1.08953\n13               1         29      1   425  1.144126                     7               29            1         204    1.08953\n14               1         29      1   425  1.144126                     7               29            1         204    1.08953\n15               1         29      1   425  1.144126                     7               29            1         204    1.08953\n16               1         29      1   425  1.144126                     7               29            1         204    1.08953\n17               1         29      1   425  1.144126                     7               29            1         204    1.08953\n18               1         29      1   425  1.144126                     7               29            1         204    1.08953\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 17.162865,
                    "execution_time": 17.143684,
                    "compile_time": 0.000152,
                    "planning_time": 0.008838
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 17.163927,
                    "execution_time": 17.144729,
                    "compile_time": 0.000171,
                    "planning_time": 0.008726
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"INV1\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV1\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV1\".\"D_MOY\" AS \"D_MOY\" , \"INV1\".\"MEAN\" AS \"MEAN\" , \"INV1\".\"COV\" AS \"COV\" , \"INV2\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"INV2\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"INV2\".\"D_MOY\" AS \"D_MOY\" , \"INV2\".\"MEAN\" AS \"MEAN\" , \"INV2\".\"COV\" AS \"COV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"INV1\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"INV1\".\"I_ITEM_SK\" = \"INV2\".\"I_ITEM_SK\" AND \"INV1\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"INV1\".\"D_MOY\" = 1 ORDER BY \"INV1\".\"W_WAREHOUSE_SK\" NULLS LAST , \"INV1\".\"I_ITEM_SK\" NULLS LAST , \"INV1\".\"D_MOY\" NULLS LAST , \"INV1\".\"MEAN\" NULLS LAST , \"INV1\".\"COV\" NULLS LAST , \"INV2\".\"D_MOY\" NULLS LAST , \"INV2\".\"MEAN\" NULLS LAST , \"INV2\".\"COV\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" AS \"W_WAREHOUSE_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" AS \"MEAN\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" AS \"COV\" , \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK_COL_5\" AS \"W_WAREHOUSE_SK_COL_5\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK_COL_6\" AS \"I_ITEM_SK_COL_6\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" AS \"D_MOY_COL_7\" , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" AS \"MEAN_COL_8\" , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" AS \"COV_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"INV2\" ON \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" = \"INV2\".\"W_WAREHOUSE_SK\" AND \"INV2\".\"D_MOY\" = 2 WHERE \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" = 1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"W_WAREHOUSE_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_SK\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY_COL_7\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"MEAN_COL_8\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"COV_COL_9\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk_col_5  i_item_sk_col_6  d_moy_col_7  mean_col_8  cov_col_9\n0                1         29      1   425  1.144126                     7               29            1         204    1.08953\n1                1         29      1   425  1.144126                     7               29            1         204    1.08953\n2                1         29      1   425  1.144126                     7               29            1         204    1.08953\n3                1         29      1   425  1.144126                     7               29            1         204    1.08953\n4                1         29      1   425  1.144126                     7               29            1         204    1.08953\n5                1         29      1   425  1.144126                     7               29            1         204    1.08953\n6                1         29      1   425  1.144126                     7               29            1         204    1.08953\n7                1         29      1   425  1.144126                     7               29            1         204    1.08953\n8                1         29      1   425  1.144126                     7               29            1         204    1.08953\n9                1         29      1   425  1.144126                     7               29            1         204    1.08953\n10               1         29      1   425  1.144126                     7               29            1         204    1.08953\n11               1         29      1   425  1.144126                     7               29            1         204    1.08953\n12               1         29      1   425  1.144126                     7               29            1         204    1.08953\n13               1         29      1   425  1.144126                     7               29            1         204    1.08953\n14               1         29      1   425  1.144126                     7               29            1         204    1.08953\n15               1         29      1   425  1.144126                     7               29            1         204    1.08953\n16               1         29      1   425  1.144126                     7               29            1         204    1.08953\n17               1         29      1   425  1.144126                     7               29            1         204    1.08953\n18               1         29      1   425  1.144126                     7               29            1         204    1.08953\n...*/"
    }
]