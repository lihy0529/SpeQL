[
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id, i_item_desc, i_category, i_class, i_current_price\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n1=1 GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.450732,
                    "execution_time": 4.225047,
                    "compile_time": 0.000707,
                    "planning_time": 0.04499,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.695291,
                    "execution_time": 4.337618,
                    "compile_time": 6.049835,
                    "planning_time": 0.11916,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                    i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADLHBAAAA                                                                                                                                       Illegal, specific buildings must not take. Tests cease s      Music  classical             0.52   5340759.12        0.0406\n1   AAAAAAAAMKEJCAAA            Now big teeth might drive now down a phases. Away new men change journals. Offshore sure jobs would track firmly strongly mental sectors. Final hundreds must continue truly import      Music  classical             9.02   2020130.02        0.0153\n2   AAAAAAAAFJCECAAA                          Rooms must include. Light alternatives end brief, indian days. Executive, private women shall not ask dirty accidents. As informal differences might support in short      Music  classical             3.80   4954285.55        0.0376\n3   AAAAAAAAKPLGBAAA                                                                Glasses may not recognise further old months; different forces might not make also common, institutional eggs. Conditions comme      Music  classical             1.35   2088041.34        0.0158\n4   AAAAAAAAPFGHBAAA                                                                                                            Right, local books win subsequently courts. Modern, different foods find now appare      Music  classical             6.92   4799792.94        0.0365\n5   AAAAAAAAAPPEBAAA      Clothes carry more lively matters. Reasonable, fun colleges last able, experienced cities. Good states could account otherwise cultural conferences. Late usual techniques might not star      Music  classical             2.00   2826267.67        0.0215\n6   AAAAAAAAMFENBAAA                                                                                                                   Just everyday women would not mark at least. Quiet councillors may give here      Music  classical             4.50   2939461.61        0.0223\n7   AAAAAAAAHMMJAAAA                                                                                                                                         Commercial policies should maintain in a occupations.       Music  classical             3.44   5035268.42        0.0383\n8   AAAAAAAAKJKJAAAA                                                                                                                                          Fine, good requirements would not work. Very certain       Music  classical             1.71   2986787.86        0.0227\n9   AAAAAAAAOKBIBAAA                                                   Great, sophisticated women know late much atlantic consumers. Walls would answer there. Subsequently large opportunities may not teach succe      Music  classical             6.48   2030161.35        0.0154\n10  AAAAAAAAINMGCAAA                                                                Letters might shout at a friends. Able problems get almost on a thousands. Also economic countries must complain never general       Music  classical            30.25   2769663.92        0.0210\n11  AAAAAAAAKABOAAAA                           Full revenues prove different adults. Degrees would pay on a members. Then islamic parties should not make for the edges. Surroundings cannot practice still for a v      Music  classical             6.87   1992949.36        0.0151\n12  AAAAAAAANJNHBAAA                                                                                                                                                  Home concerned schools turn never poor champi      Music  classical             4.14   4948590.36        0.0376\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019044,
                    "execution_time": 0.007369,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005185
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05738,
                    "execution_time": 0.007507,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.041031
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                    i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADLHBAAAA                                                                                                                                       Illegal, specific buildings must not take. Tests cease s      Music  classical             0.52   5340759.12        0.0406\n1   AAAAAAAAMKEJCAAA            Now big teeth might drive now down a phases. Away new men change journals. Offshore sure jobs would track firmly strongly mental sectors. Final hundreds must continue truly import      Music  classical             9.02   2020130.02        0.0153\n2   AAAAAAAAFJCECAAA                          Rooms must include. Light alternatives end brief, indian days. Executive, private women shall not ask dirty accidents. As informal differences might support in short      Music  classical             3.80   4954285.55        0.0376\n3   AAAAAAAAKPLGBAAA                                                                Glasses may not recognise further old months; different forces might not make also common, institutional eggs. Conditions comme      Music  classical             1.35   2088041.34        0.0158\n4   AAAAAAAAPFGHBAAA                                                                                                            Right, local books win subsequently courts. Modern, different foods find now appare      Music  classical             6.92   4799792.94        0.0365\n5   AAAAAAAAAPPEBAAA      Clothes carry more lively matters. Reasonable, fun colleges last able, experienced cities. Good states could account otherwise cultural conferences. Late usual techniques might not star      Music  classical             2.00   2826267.67        0.0215\n6   AAAAAAAAMFENBAAA                                                                                                                   Just everyday women would not mark at least. Quiet councillors may give here      Music  classical             4.50   2939461.61        0.0223\n7   AAAAAAAAHMMJAAAA                                                                                                                                         Commercial policies should maintain in a occupations.       Music  classical             3.44   5035268.42        0.0383\n8   AAAAAAAAKJKJAAAA                                                                                                                                          Fine, good requirements would not work. Very certain       Music  classical             1.71   2986787.86        0.0227\n9   AAAAAAAAOKBIBAAA                                                   Great, sophisticated women know late much atlantic consumers. Walls would answer there. Subsequently large opportunities may not teach succe      Music  classical             6.48   2030161.35        0.0154\n10  AAAAAAAAINMGCAAA                                                                Letters might shout at a friends. Able problems get almost on a thousands. Also economic countries must complain never general       Music  classical            30.25   2769663.92        0.0210\n11  AAAAAAAAKABOAAAA                           Full revenues prove different adults. Degrees would pay on a members. Then islamic parties should not make for the edges. Surroundings cannot practice still for a v      Music  classical             6.87   1992949.36        0.0151\n12  AAAAAAAANJNHBAAA                                                                                                                                                  Home concerned schools turn never poor champi      Music  classical             4.14   4948590.36        0.0376\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) and cast('2001-12-31' as date) \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-12-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-12-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.946522,
                    "execution_time": 0.802367,
                    "compile_time": 0.000674,
                    "planning_time": 0.044736,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.789283,
                    "execution_time": 0.779016,
                    "compile_time": 5.779017,
                    "planning_time": 0.12543,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOPPGAAAA                                                                                                                                                                      So foreign grounds stop pro        Men  shirts             8.03    973940.74        0.0427\n1   AAAAAAAABPHCAAAA                French, neighbouring words speak evenly big divisions. Completely urban employers may return efforts. Almost rich buildings keep. Rows wear. Royal, new meetings must lift still         Men  shirts             8.31    780213.95        0.0342\n2   AAAAAAAANLNDAAAA                                                             Perhaps guilty users go more private systems. Simply national months will eat in a colours. Clinical patients keep only in a feeling        Men  shirts             9.21    881692.15        0.0386\n3   AAAAAAAACEMLAAAA                                                                                                                           Hard supposed attitudes build. Readily straight reports should need ge        Men  shirts             1.42    872599.01        0.0382\n4   AAAAAAAAIJADAAAA                                                                                                                                                                                               In        Men  shirts             8.64    856249.04        0.0375\n5   AAAAAAAAMJGNBAAA                       Once hard policies must not reach citizens. Long values let in a observations. Communications used to provide at least in the societies. Years feel. Ultimately large oppo        Men  shirts             5.30    914982.36        0.0401\n6   AAAAAAAAIHFPCAAA                                                                                                                                                 Daily, difficult elements will not know now deci        Men  shirts             4.48    932979.47        0.0409\n7   AAAAAAAAIFNFBAAA                                                                           Available relationships confuse so in the years. Other, final employers ought to offer aggressively. Warm, old transac        Men  shirts             2.69    745544.50        0.0327\n8   AAAAAAAAPICAAAAA                                                                                                                                                                                  Children would         Men  shirts             2.05    860220.51        0.0377\n9   AAAAAAAAAKFBDAAA                                                                           High, appropriate dimensions go never reasons. Fields follow also. Close daughters should see now. Likely horses could        Men  shirts             6.57    891522.72        0.0391\n10  AAAAAAAADAEMAAAA                                                                                                                                                   Fixed heads play please. Almost true authoriti        Men  shirts             5.61    829593.75        0.0364\n11  AAAAAAAAIPMNCAAA                                        Teachers find all good years. Problems consider other, weak banks. Organisations could link in a members. Other hands close muscles. Too political things        Men  shirts             5.92    865359.09        0.0379\n12  AAAAAAAALJPPCAAA                                                                                               Japanese, imaginative concentrations see most mixed, adverse members. Earnings can control now eco        Men  shirts             1.23    958851.99        0.0420\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019883,
                    "execution_time": 0.007938,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005351
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057416,
                    "execution_time": 0.007648,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040813
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2001-12-31' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOPPGAAAA                                                                                                                                                                      So foreign grounds stop pro        Men  shirts             8.03    973940.74        0.0427\n1   AAAAAAAABPHCAAAA                French, neighbouring words speak evenly big divisions. Completely urban employers may return efforts. Almost rich buildings keep. Rows wear. Royal, new meetings must lift still         Men  shirts             8.31    780213.95        0.0342\n2   AAAAAAAANLNDAAAA                                                             Perhaps guilty users go more private systems. Simply national months will eat in a colours. Clinical patients keep only in a feeling        Men  shirts             9.21    881692.15        0.0386\n3   AAAAAAAACEMLAAAA                                                                                                                           Hard supposed attitudes build. Readily straight reports should need ge        Men  shirts             1.42    872599.01        0.0382\n4   AAAAAAAAIJADAAAA                                                                                                                                                                                               In        Men  shirts             8.64    856249.04        0.0375\n5   AAAAAAAAMJGNBAAA                       Once hard policies must not reach citizens. Long values let in a observations. Communications used to provide at least in the societies. Years feel. Ultimately large oppo        Men  shirts             5.30    914982.36        0.0401\n6   AAAAAAAAIHFPCAAA                                                                                                                                                 Daily, difficult elements will not know now deci        Men  shirts             4.48    932979.47        0.0409\n7   AAAAAAAAIFNFBAAA                                                                           Available relationships confuse so in the years. Other, final employers ought to offer aggressively. Warm, old transac        Men  shirts             2.69    745544.50        0.0327\n8   AAAAAAAAPICAAAAA                                                                                                                                                                                  Children would         Men  shirts             2.05    860220.51        0.0377\n9   AAAAAAAAAKFBDAAA                                                                           High, appropriate dimensions go never reasons. Fields follow also. Close daughters should see now. Likely horses could        Men  shirts             6.57    891522.72        0.0391\n10  AAAAAAAADAEMAAAA                                                                                                                                                   Fixed heads play please. Almost true authoriti        Men  shirts             5.61    829593.75        0.0364\n11  AAAAAAAAIPMNCAAA                                        Teachers find all good years. Problems consider other, weak banks. Organisations could link in a members. Other hands close muscles. Too political things        Men  shirts             5.92    865359.09        0.0379\n12  AAAAAAAALJPPCAAA                                                                                               Japanese, imaginative concentrations see most mixed, adverse members. Earnings can control now eco        Men  shirts             1.23    958851.99        0.0420\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPHCHAAAA                                                                                                                                                                 Men                      NaN     48736.40        2.2155\n1   AAAAAAAAFLPIBAAA  Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n2   AAAAAAAANBDPCAAA                                                                                                                                                                 Men                      NaN     57570.69        2.6172\n3   AAAAAAAADJBFBAAA                                                         Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n4   AAAAAAAAHOEPAAAA                    Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                 Men                      NaN     68700.27        3.1231\n6   AAAAAAAAIDAGCAAA                                                                                                                                                               Music                    43.87     41500.11        1.8866\n7   AAAAAAAALCNNBAAA                                                                                                                                                                 Men                    23.97     63640.27        2.8931\n8   AAAAAAAADGOLAAAA                                                                                                                                          Over new wars g      Music                      NaN     28542.33        1.2975\n9   AAAAAAAAAPLHCAAA                            Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n10  AAAAAAAAEJDJAAAA                                  More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n11  AAAAAAAABLDBDAAA                                                                       Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n12  AAAAAAAAOAEABAAA                                                                                                                                                               Shoes                    60.87     64756.64        2.9438\n13  AAAAAAAADBFLCAAA                                                                                                                                                               Shoes                      NaN     52899.29        2.4048\n14  AAAAAAAAIOFBDAAA                                                     However scottish differences imagine existing, negative fears. Environmental, great trends call henc      Music                    98.49     63266.56        2.8761\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.202197,
                    "execution_time": 0.143063,
                    "compile_time": 0.000306,
                    "planning_time": 0.04156
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.262695,
                    "execution_time": 0.137571,
                    "compile_time": 0.000295,
                    "planning_time": 0.106968
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPHCHAAAA                                                                                                                                                                 Men                      NaN     48736.40        2.2155\n1   AAAAAAAAFLPIBAAA  Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n2   AAAAAAAANBDPCAAA                                                                                                                                                                 Men                      NaN     57570.69        2.6172\n3   AAAAAAAADJBFBAAA                                                         Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n4   AAAAAAAAHOEPAAAA                    Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                 Men                      NaN     68700.27        3.1231\n6   AAAAAAAAIDAGCAAA                                                                                                                                                               Music                    43.87     41500.11        1.8866\n7   AAAAAAAALCNNBAAA                                                                                                                                                                 Men                    23.97     63640.27        2.8931\n8   AAAAAAAADGOLAAAA                                                                                                                                          Over new wars g      Music                      NaN     28542.33        1.2975\n9   AAAAAAAAAPLHCAAA                            Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n10  AAAAAAAAEJDJAAAA                                  More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n11  AAAAAAAABLDBDAAA                                                                       Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n12  AAAAAAAAOAEABAAA                                                                                                                                                               Shoes                    60.87     64756.64        2.9438\n13  AAAAAAAADBFLCAAA                                                                                                                                                               Shoes                      NaN     52899.29        2.4048\n14  AAAAAAAAIOFBDAAA                                                     However scottish differences imagine existing, negative fears. Environmental, great trends call henc      Music                    98.49     63266.56        2.8761\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADJBFBAAA                                                         Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n1   AAAAAAAAHOEPAAAA                    Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n2   AAAAAAAAAPLHCAAA                            Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n3   AAAAAAAAKKIFBAAA                                                                                                                                                                 Men                      NaN     68700.27        3.1231\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                 Men                      NaN     48736.40        2.2155\n5   AAAAAAAAIDAGCAAA                                                                                                                                                               Music                    43.87     41500.11        1.8866\n6   AAAAAAAAFLPIBAAA  Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n7   AAAAAAAANBDPCAAA                                                                                                                                                                 Men                      NaN     57570.69        2.6172\n8   AAAAAAAAMIDLAAAA                                                                                                                                                                 Men                     2.56     43123.47        1.9604\n9   AAAAAAAALCNNBAAA                                                                                                                                                                 Men                    23.97     63640.27        2.8931\n10  AAAAAAAABLDBDAAA                                                                       Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n11  AAAAAAAAGLOFCAAA                                                                                                            Members shall love observations. Grey, willin      Music                      NaN     28599.99        1.3001\n12  AAAAAAAAEOEIBAAA                                                                                                                                           Total, very fo        Men                    12.72     35910.84        1.6325\n13  AAAAAAAAEJDJAAAA                                  More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n14  AAAAAAAAOGDMAAAA                                                                                                                                                               Music                     9.32     27364.60        1.2440\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.195588,
                    "execution_time": 0.136139,
                    "compile_time": 0.000395,
                    "planning_time": 0.041495
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.192243,
                    "execution_time": 0.13398,
                    "compile_time": 0.000304,
                    "planning_time": 0.040796
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADJBFBAAA                                                         Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n1   AAAAAAAAHOEPAAAA                    Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n2   AAAAAAAAAPLHCAAA                            Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n3   AAAAAAAAKKIFBAAA                                                                                                                                                                 Men                      NaN     68700.27        3.1231\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                 Men                      NaN     48736.40        2.2155\n5   AAAAAAAAIDAGCAAA                                                                                                                                                               Music                    43.87     41500.11        1.8866\n6   AAAAAAAAFLPIBAAA  Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n7   AAAAAAAANBDPCAAA                                                                                                                                                                 Men                      NaN     57570.69        2.6172\n8   AAAAAAAAMIDLAAAA                                                                                                                                                                 Men                     2.56     43123.47        1.9604\n9   AAAAAAAALCNNBAAA                                                                                                                                                                 Men                    23.97     63640.27        2.8931\n10  AAAAAAAABLDBDAAA                                                                       Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n11  AAAAAAAAGLOFCAAA                                                                                                            Members shall love observations. Grey, willin      Music                      NaN     28599.99        1.3001\n12  AAAAAAAAEOEIBAAA                                                                                                                                           Total, very fo        Men                    12.72     35910.84        1.6325\n13  AAAAAAAAEJDJAAAA                                  More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n14  AAAAAAAAOGDMAAAA                                                                                                                                                               Music                     9.32     27364.60        1.2440\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n1   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n2   AAAAAAAAKGCBAAAA                                                                                         Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44     48640.87        2.2112\n3   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n4   AAAAAAAANBDPCAAA                                                                                                                                                                                                           Men                      NaN     57570.69        2.6172\n5   AAAAAAAAIDAGCAAA                                                                                                                                                                                                         Music                    43.87     41500.11        1.8866\n6   AAAAAAAALCNNBAAA                                                                                                                                                                                                           Men                    23.97     63640.27        2.8931\n7   AAAAAAAAAPLHCAAA                                                                      Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n8   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n9   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN     35343.70        1.6067\n10  AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu      Shoes                      NaN     61715.42        2.8056\n11  AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN     28542.33        1.2975\n12  AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     48736.40        2.2155\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.201813,
                    "execution_time": 0.142655,
                    "compile_time": 0.000333,
                    "planning_time": 0.041081
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.193751,
                    "execution_time": 0.128684,
                    "compile_time": 0.000304,
                    "planning_time": 0.047611
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n1   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n2   AAAAAAAAKGCBAAAA                                                                                         Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44     48640.87        2.2112\n3   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n4   AAAAAAAANBDPCAAA                                                                                                                                                                                                           Men                      NaN     57570.69        2.6172\n5   AAAAAAAAIDAGCAAA                                                                                                                                                                                                         Music                    43.87     41500.11        1.8866\n6   AAAAAAAALCNNBAAA                                                                                                                                                                                                           Men                    23.97     63640.27        2.8931\n7   AAAAAAAAAPLHCAAA                                                                      Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n8   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n9   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN     35343.70        1.6067\n10  AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu      Shoes                      NaN     61715.42        2.8056\n11  AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN     28542.33        1.2975\n12  AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     48736.40        2.2155\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                       i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFLPIBAAA           Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n1   AAAAAAAANBDPCAAA                                                                                                                                                                          Men                      NaN     57570.69        2.6172\n2   AAAAAAAADJBFBAAA                                                                  Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n3   AAAAAAAAHOEPAAAA                             Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n4   AAAAAAAAAPLHCAAA                                     Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                          Men                      NaN     68700.27        3.1231\n6   AAAAAAAAEJDJAAAA                                           More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n7   AAAAAAAALCNNBAAA                                                                                                                                                                          Men                    23.97     63640.27        2.8931\n8   AAAAAAAADBFLCAAA                                                                                                                                                                        Shoes                      NaN     52899.29        2.4048\n9   AAAAAAAABLDBDAAA                                                                                Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n10  AAAAAAAANOHAAAAA                                                                 Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN     35343.70        1.6067\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                          Men                     2.56     43123.47        1.9604\n12  AAAAAAAAGPDBDAAA                                                                                                                                                                          Men                      NaN     16376.96        0.7445\n13  AAAAAAAAEOEIBAAA                                                                                                                                                    Total, very fo        Men                    12.72     35910.84        1.6325\n14  AAAAAAAAIOFBDAAA                                                              However scottish differences imagine existing, negative fears. Environmental, great trends call henc      Music                    98.49     63266.56        2.8761\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.18098,
                    "execution_time": 0.119528,
                    "compile_time": 0.000308,
                    "planning_time": 0.043881
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.205443,
                    "execution_time": 0.147224,
                    "compile_time": 0.000305,
                    "planning_time": 0.040602
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                       i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFLPIBAAA           Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n1   AAAAAAAANBDPCAAA                                                                                                                                                                          Men                      NaN     57570.69        2.6172\n2   AAAAAAAADJBFBAAA                                                                  Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n3   AAAAAAAAHOEPAAAA                             Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n4   AAAAAAAAAPLHCAAA                                     Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                          Men                      NaN     68700.27        3.1231\n6   AAAAAAAAEJDJAAAA                                           More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n7   AAAAAAAALCNNBAAA                                                                                                                                                                          Men                    23.97     63640.27        2.8931\n8   AAAAAAAADBFLCAAA                                                                                                                                                                        Shoes                      NaN     52899.29        2.4048\n9   AAAAAAAABLDBDAAA                                                                                Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n10  AAAAAAAANOHAAAAA                                                                 Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN     35343.70        1.6067\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                          Men                     2.56     43123.47        1.9604\n12  AAAAAAAAGPDBDAAA                                                                                                                                                                          Men                      NaN     16376.96        0.7445\n13  AAAAAAAAEOEIBAAA                                                                                                                                                    Total, very fo        Men                    12.72     35910.84        1.6325\n14  AAAAAAAAIOFBDAAA                                                              However scottish differences imagine existing, negative fears. Environmental, great trends call henc      Music                    98.49     63266.56        2.8761\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class \n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                       i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAPLHCAAA                                     Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n1   AAAAAAAAFLPIBAAA           Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n2   AAAAAAAANBDPCAAA                                                                                                                                                                          Men                      NaN     57570.69        2.6172\n3   AAAAAAAAPHCHAAAA                                                                                                                                                                          Men                      NaN     48736.40        2.2155\n4   AAAAAAAAKKIFBAAA                                                                                                                                                                          Men                      NaN     68700.27        3.1231\n5   AAAAAAAADBFLCAAA                                                                                                                                                                        Shoes                      NaN     52899.29        2.4048\n6   AAAAAAAAEJDJAAAA                                           More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n7   AAAAAAAADJBFBAAA                                                                  Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n8   AAAAAAAAHOEPAAAA                             Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n9   AAAAAAAAIOFBDAAA                                                              However scottish differences imagine existing, negative fears. Environmental, great trends call henc      Music                    98.49     63266.56        2.8761\n10  AAAAAAAALCNNBAAA                                                                                                                                                                          Men                    23.97     63640.27        2.8931\n11  AAAAAAAAGAKDAAAA  Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     39001.70        1.7730\n12  AAAAAAAABLDBDAAA                                                                                Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n13  AAAAAAAAALEEBAAA                                                                                                                  Later left spirits must not upgrade certainly as      Music                     4.87     87682.67        3.9861\n14  AAAAAAAAMIDLAAAA                                                                                                                                                                          Men                     2.56     43123.47        1.9604\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.19247,
                    "execution_time": 0.13292,
                    "compile_time": 0.000316,
                    "planning_time": 0.041223
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.196687,
                    "execution_time": 0.138381,
                    "compile_time": 0.000314,
                    "planning_time": 0.040828
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                       i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAPLHCAAA                                     Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n1   AAAAAAAAFLPIBAAA           Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n2   AAAAAAAANBDPCAAA                                                                                                                                                                          Men                      NaN     57570.69        2.6172\n3   AAAAAAAAPHCHAAAA                                                                                                                                                                          Men                      NaN     48736.40        2.2155\n4   AAAAAAAAKKIFBAAA                                                                                                                                                                          Men                      NaN     68700.27        3.1231\n5   AAAAAAAADBFLCAAA                                                                                                                                                                        Shoes                      NaN     52899.29        2.4048\n6   AAAAAAAAEJDJAAAA                                           More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n7   AAAAAAAADJBFBAAA                                                                  Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n8   AAAAAAAAHOEPAAAA                             Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n9   AAAAAAAAIOFBDAAA                                                              However scottish differences imagine existing, negative fears. Environmental, great trends call henc      Music                    98.49     63266.56        2.8761\n10  AAAAAAAALCNNBAAA                                                                                                                                                                          Men                    23.97     63640.27        2.8931\n11  AAAAAAAAGAKDAAAA  Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     39001.70        1.7730\n12  AAAAAAAABLDBDAAA                                                                                Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n13  AAAAAAAAALEEBAAA                                                                                                                  Later left spirits must not upgrade certainly as      Music                     4.87     87682.67        3.9861\n14  AAAAAAAAMIDLAAAA                                                                                                                                                                          Men                     2.56     43123.47        1.9604\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKKIFBAAA                                                                                                                                                                   Men                      NaN     68700.27        3.1231\n1   AAAAAAAAPHCHAAAA                                                                                                                                                                   Men                      NaN     48736.40        2.2155\n2   AAAAAAAALCNNBAAA                                                                                                                                                                   Men                    23.97     63640.27        2.8931\n3   AAAAAAAADGOLAAAA                                                                                                                                            Over new wars g      Music                      NaN     28542.33        1.2975\n4   AAAAAAAADBFLCAAA                                                                                                                                                                 Shoes                      NaN     52899.29        2.4048\n5   AAAAAAAAFLPIBAAA    Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n6   AAAAAAAANBDPCAAA                                                                                                                                                                   Men                      NaN     57570.69        2.6172\n7   AAAAAAAADJBFBAAA                                                           Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n8   AAAAAAAAHOEPAAAA                      Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n9   AAAAAAAAAPLHCAAA                              Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n10  AAAAAAAAEJDJAAAA                                    More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n11  AAAAAAAABLDBDAAA                                                                         Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n12  AAAAAAAAIDAGCAAA                                                                                                                                                                 Music                    43.87     41500.11        1.8866\n13  AAAAAAAAMFHACAAA                                                                                                                                                                   Men                     3.18     33225.70        1.5104\n14  AAAAAAAAOGDMAAAA                                                                                                                                                                 Music                     9.32     27364.60        1.2440\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.173218,
                    "execution_time": 0.114154,
                    "compile_time": 0.000309,
                    "planning_time": 0.041512
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.194694,
                    "execution_time": 0.136161,
                    "compile_time": 0.000311,
                    "planning_time": 0.040959
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKKIFBAAA                                                                                                                                                                   Men                      NaN     68700.27        3.1231\n1   AAAAAAAAPHCHAAAA                                                                                                                                                                   Men                      NaN     48736.40        2.2155\n2   AAAAAAAALCNNBAAA                                                                                                                                                                   Men                    23.97     63640.27        2.8931\n3   AAAAAAAADGOLAAAA                                                                                                                                            Over new wars g      Music                      NaN     28542.33        1.2975\n4   AAAAAAAADBFLCAAA                                                                                                                                                                 Shoes                      NaN     52899.29        2.4048\n5   AAAAAAAAFLPIBAAA    Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n6   AAAAAAAANBDPCAAA                                                                                                                                                                   Men                      NaN     57570.69        2.6172\n7   AAAAAAAADJBFBAAA                                                           Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n8   AAAAAAAAHOEPAAAA                      Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n9   AAAAAAAAAPLHCAAA                              Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n10  AAAAAAAAEJDJAAAA                                    More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n11  AAAAAAAABLDBDAAA                                                                         Statutory, british centuries meet too deep, reasonable crops. Now capable years pl      Music                     4.65     82768.93        3.7627\n12  AAAAAAAAIDAGCAAA                                                                                                                                                                 Music                    43.87     41500.11        1.8866\n13  AAAAAAAAMFHACAAA                                                                                                                                                                   Men                     3.18     33225.70        1.5104\n14  AAAAAAAAOGDMAAAA                                                                                                                                                                 Music                     9.32     27364.60        1.2440\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     48736.40        2.2155\n1   AAAAAAAAAPLHCAAA                                                                      Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n2   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n3   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n4   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n5   AAAAAAAANBDPCAAA                                                                                                                                                                                                           Men                      NaN     57570.69        2.6172\n6   AAAAAAAAIDAGCAAA                                                                                                                                                                                                         Music                    43.87     41500.11        1.8866\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                           Men                      NaN     68700.27        3.1231\n8   AAAAAAAAKGCBAAAA                                                                                         Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44     48640.87        2.2112\n9   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu      Shoes                      NaN     61715.42        2.8056\n10  AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     27364.60        1.2440\n11  AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n12  AAAAAAAAMFHACAAA                                                                                                                                                                                                           Men                     3.18     33225.70        1.5104\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.184964,
                    "execution_time": 0.12635,
                    "compile_time": 0.000303,
                    "planning_time": 0.040977
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.182512,
                    "execution_time": 0.12303,
                    "compile_time": 0.000307,
                    "planning_time": 0.041934
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     48736.40        2.2155\n1   AAAAAAAAAPLHCAAA                                                                      Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30     59116.41        2.6874\n2   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     46841.54        2.1294\n3   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     45567.31        2.0715\n4   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56     49532.41        2.2517\n5   AAAAAAAANBDPCAAA                                                                                                                                                                                                           Men                      NaN     57570.69        2.6172\n6   AAAAAAAAIDAGCAAA                                                                                                                                                                                                         Music                    43.87     41500.11        1.8866\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                           Men                      NaN     68700.27        3.1231\n8   AAAAAAAAKGCBAAAA                                                                                         Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44     48640.87        2.2112\n9   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu      Shoes                      NaN     61715.42        2.8056\n10  AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     27364.60        1.2440\n11  AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     58048.88        2.6389\n12  AAAAAAAAMFHACAAA                                                                                                                                                                                                           Men                     3.18     33225.70        1.5104\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n    i_item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc i_category         i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAAABAAA           Outside waste minutes make for a men. Grand, suitable citizens raise merely within the officials. Minutes may not represent in part with a officials. Old, social resources may not catch r        Men          shirts             7.87     32565.71        0.0255\n1   AAAAAAAAAAADBAAA                         Always video-taped parties talk recently junior students. Special, principal cases hurt. Exciting results mean then following circumstances. Payments can fail much with a sy      Shoes        athletic             3.23     66852.27        0.0532\n2   AAAAAAAAAAAEBAAA                                                                                                                                                Industrial, free movies add more; contributions explai        Men          shirts             5.93     59387.72        0.0466\n3   AAAAAAAAAAAGBAAA                             Oddly social creditors could become twice supposed original writers. Members play there. For instance electoral firms will not understand too literary, underlying prices        Men           pants             4.88     31954.71        0.0264\n4   AAAAAAAAAAALAAAA                                                                                                                                                 Now major examples show. Products would not lobby the      Shoes          womens             1.66     67192.77        0.0524\n5   AAAAAAAAAAAMCAAA                                                                                             Guilty aspects talk only, only devices. Effective, nice quantities may not cut usually just new committee      Shoes            kids             0.30     56860.97        0.0454\n6   AAAAAAAAAAAPBAAA                                                                                                                                                    Massive regulations lead meanwhile possible citize      Music       classical             2.86     50139.08        0.0391\n7   AAAAAAAAAABBAAAA                                                                                                                                                                                       Recent discussi      Music         country             5.37     50859.35        0.0400\n8   AAAAAAAAAABBCAAA                                                                                                          Even old spirits might give. Dark, powerful conditions used to emerge rich, alone cities. Th        Men          shirts             1.75     60081.06        0.0472\n9   AAAAAAAAAABCCAAA  Women carry soviet players. Monthly, new lists could scream particularly practices. Political police eliminate legal, key enterprises. Good, new losses might not allow outside a articles. New, sha        Men  sports-apparel             4.98     63274.99        0.0515\n10  AAAAAAAAAABDAAAA                                                                                                    Extended, central centuries ought to predict thus early controls; so financial years shall not see        Men  sports-apparel             1.36     62347.68        0.0507\n11  AAAAAAAAAABEAAAA                                                                                                          New meetings discuss also occasional, corporate approaches. Specialist, mixed groups ought t      Music       classical             8.23     42775.91        0.0334\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.2149,
                    "execution_time": 0.153917,
                    "compile_time": 0.015048,
                    "planning_time": 0.042883
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.020232,
                    "execution_time": 0.137863,
                    "compile_time": 4.854056,
                    "planning_time": 0.108838
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc i_category         i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAAABAAA           Outside waste minutes make for a men. Grand, suitable citizens raise merely within the officials. Minutes may not represent in part with a officials. Old, social resources may not catch r        Men          shirts             7.87     32565.71        0.0255\n1   AAAAAAAAAAADBAAA                         Always video-taped parties talk recently junior students. Special, principal cases hurt. Exciting results mean then following circumstances. Payments can fail much with a sy      Shoes        athletic             3.23     66852.27        0.0532\n2   AAAAAAAAAAAEBAAA                                                                                                                                                Industrial, free movies add more; contributions explai        Men          shirts             5.93     59387.72        0.0466\n3   AAAAAAAAAAAGBAAA                             Oddly social creditors could become twice supposed original writers. Members play there. For instance electoral firms will not understand too literary, underlying prices        Men           pants             4.88     31954.71        0.0264\n4   AAAAAAAAAAALAAAA                                                                                                                                                 Now major examples show. Products would not lobby the      Shoes          womens             1.66     67192.77        0.0524\n5   AAAAAAAAAAAMCAAA                                                                                             Guilty aspects talk only, only devices. Effective, nice quantities may not cut usually just new committee      Shoes            kids             0.30     56860.97        0.0454\n6   AAAAAAAAAAAPBAAA                                                                                                                                                    Massive regulations lead meanwhile possible citize      Music       classical             2.86     50139.08        0.0391\n7   AAAAAAAAAABBAAAA                                                                                                                                                                                       Recent discussi      Music         country             5.37     50859.35        0.0400\n8   AAAAAAAAAABBCAAA                                                                                                          Even old spirits might give. Dark, powerful conditions used to emerge rich, alone cities. Th        Men          shirts             1.75     60081.06        0.0472\n9   AAAAAAAAAABCCAAA  Women carry soviet players. Monthly, new lists could scream particularly practices. Political police eliminate legal, key enterprises. Good, new losses might not allow outside a articles. New, sha        Men  sports-apparel             4.98     63274.99        0.0515\n10  AAAAAAAAAABDAAAA                                                                                                    Extended, central centuries ought to predict thus early controls; so financial years shall not see        Men  sports-apparel             1.36     62347.68        0.0507\n11  AAAAAAAAAABEAAAA                                                                                                          New meetings discuss also occasional, corporate approaches. Specialist, mixed groups ought t      Music       classical             8.23     42775.91        0.0334\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                    i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKEGCBAAA                                                                                                                                                                                  As fond talks        Men  accessories             3.13     67463.00        0.0526\n1   AAAAAAAAOABDCAAA                                                                                                                                Months should stimulate now genuine muscles. Expensive, main ho        Men        pants             1.00     45461.24        0.0376\n2   AAAAAAAANEKEAAAA           For instance social police get more public bacteria. Funds look there high, clean stations. At least profound stairs win even. Civil days may invest tentatively standards. Old, gre        Men  accessories             2.48     44926.65        0.0350\n3   AAAAAAAAEGPHCAAA                                                                                                                                              Separate, minimum things could think with the wee        Men        pants             3.59     35709.16        0.0296\n4   AAAAAAAAPKAPAAAA                                                                                                                                      Direct years know on the mountains. Injuries predict furt        Men  accessories             7.71     39280.37        0.0306\n5   AAAAAAAAPOPDCAAA                                Soviet rates can suggest new, strong instructions; ill partners appeal expensive results. Just possible homes used to intervene cautiously mental royal grounds        Men        pants             7.95     63182.77        0.0523\n6   AAAAAAAAFILNAAAA                                                                                           Excellent, american governments get over considerable needs. Powerful, new rivals deal comfortably r        Men  accessories             6.21     44169.55        0.0345\n7   AAAAAAAAGAKICAAA       Resources spend under from a factors. Mainly social regulations will not meet in order eyes. Different, present years ask in full; young, acute opponents exercise as else intense names        Men        pants             8.98     30061.65        0.0249\n8   AAAAAAAAPHAADAAA                                                                                      Plants might speak newly children; usually intellectual things would investigate indeed criteria. Gradual        Men  accessories             4.75     59926.79        0.0468\n9   AAAAAAAANKFADAAA                                                   Open, initial men shall abandon generally public men. In between electronic shoulders satisfy modest, possible policies. Silly groups may en        Men        pants             2.82     45405.75        0.0376\n10  AAAAAAAALAGHBAAA                                                                                                                                                          More sudden pensions would move up to        Men  accessories             9.99     36134.38        0.0282\n11  AAAAAAAADKHDCAAA             Pages take religious, national hours. Scottish passengers distinguish necessary, simple measurements. Less significant jobs cannot deal continued times. Special, new chips constr        Men        pants             0.89     58043.91        0.0481\n12  AAAAAAAAFBLFAAAA                                                                                                                                    Stories may create about a clothes. Trousers cannot get ent        Men  accessories             1.81     89252.39        0.0697\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.212451,
                    "execution_time": 0.150633,
                    "compile_time": 0.015007,
                    "planning_time": 0.042291
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.879158,
                    "execution_time": 0.142028,
                    "compile_time": 4.714797,
                    "planning_time": 0.10673
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                    i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKEGCBAAA                                                                                                                                                                                  As fond talks        Men  accessories             3.13     67463.00        0.0526\n1   AAAAAAAAOABDCAAA                                                                                                                                Months should stimulate now genuine muscles. Expensive, main ho        Men        pants             1.00     45461.24        0.0376\n2   AAAAAAAANEKEAAAA           For instance social police get more public bacteria. Funds look there high, clean stations. At least profound stairs win even. Civil days may invest tentatively standards. Old, gre        Men  accessories             2.48     44926.65        0.0350\n3   AAAAAAAAEGPHCAAA                                                                                                                                              Separate, minimum things could think with the wee        Men        pants             3.59     35709.16        0.0296\n4   AAAAAAAAPKAPAAAA                                                                                                                                      Direct years know on the mountains. Injuries predict furt        Men  accessories             7.71     39280.37        0.0306\n5   AAAAAAAAPOPDCAAA                                Soviet rates can suggest new, strong instructions; ill partners appeal expensive results. Just possible homes used to intervene cautiously mental royal grounds        Men        pants             7.95     63182.77        0.0523\n6   AAAAAAAAFILNAAAA                                                                                           Excellent, american governments get over considerable needs. Powerful, new rivals deal comfortably r        Men  accessories             6.21     44169.55        0.0345\n7   AAAAAAAAGAKICAAA       Resources spend under from a factors. Mainly social regulations will not meet in order eyes. Different, present years ask in full; young, acute opponents exercise as else intense names        Men        pants             8.98     30061.65        0.0249\n8   AAAAAAAAPHAADAAA                                                                                      Plants might speak newly children; usually intellectual things would investigate indeed criteria. Gradual        Men  accessories             4.75     59926.79        0.0468\n9   AAAAAAAANKFADAAA                                                   Open, initial men shall abandon generally public men. In between electronic shoulders satisfy modest, possible policies. Silly groups may en        Men        pants             2.82     45405.75        0.0376\n10  AAAAAAAALAGHBAAA                                                                                                                                                          More sudden pensions would move up to        Men  accessories             9.99     36134.38        0.0282\n11  AAAAAAAADKHDCAAA             Pages take religious, national hours. Scottish passengers distinguish necessary, simple measurements. Less significant jobs cannot deal continued times. Special, new chips constr        Men        pants             0.89     58043.91        0.0481\n12  AAAAAAAAFBLFAAAA                                                                                                                                    Stories may create about a clothes. Trousers cannot get ent        Men  accessories             1.81     89252.39        0.0697\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                     i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                        Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n1   AAAAAAAALCNNBAAA                                                                                                                                                                                                        Men                         23.97     63640.27        2.8931\n2   AAAAAAAAPHCHAAAA                                                                                                                                                                                                        Men                           NaN     48736.40        2.2155\n3   AAAAAAAAGIGEBAAA                                                                                                                                                                                     At least sm        Men                           NaN     40986.43        1.8632\n4   AAAAAAAAPBHACAAA                                                     National values like thereby electrical families; civil arms ought to feel combined, natural industries. Terrible activities will give prov        Men                          0.52     57710.45        2.6235\n5   AAAAAAAAEOEIBAAA                                                                                                                                                                                  Total, very fo        Men                         12.72     35910.84        1.6325\n6   AAAAAAAAMFHACAAA                                                                                                                                                                                                        Men                          3.18     33225.70        1.5104\n7   AAAAAAAAKOHOBAAA                                                                                                                                                                                                        Men                           NaN     28745.73        1.3068\n8   AAAAAAAAEBPOBAAA                                                                                 Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n9   AAAAAAAAAMLDAAAA                                                                                                                                                                                                        Men                           NaN     70400.58        3.2004\n10  AAAAAAAANBDPCAAA                                                                                                                                                                                                        Men                           NaN     57570.69        2.6172\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                        Men                          2.56     43123.47        1.9604\n12  AAAAAAAAABLKAAAA                                       Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.192885,
                    "execution_time": 0.133055,
                    "compile_time": 0.012876,
                    "planning_time": 0.042257
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.618439,
                    "execution_time": 0.148157,
                    "compile_time": 4.451315,
                    "planning_time": 0.105417
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                     i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                        Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n1   AAAAAAAALCNNBAAA                                                                                                                                                                                                        Men                         23.97     63640.27        2.8931\n2   AAAAAAAAPHCHAAAA                                                                                                                                                                                                        Men                           NaN     48736.40        2.2155\n3   AAAAAAAAGIGEBAAA                                                                                                                                                                                     At least sm        Men                           NaN     40986.43        1.8632\n4   AAAAAAAAPBHACAAA                                                     National values like thereby electrical families; civil arms ought to feel combined, natural industries. Terrible activities will give prov        Men                          0.52     57710.45        2.6235\n5   AAAAAAAAEOEIBAAA                                                                                                                                                                                  Total, very fo        Men                         12.72     35910.84        1.6325\n6   AAAAAAAAMFHACAAA                                                                                                                                                                                                        Men                          3.18     33225.70        1.5104\n7   AAAAAAAAKOHOBAAA                                                                                                                                                                                                        Men                           NaN     28745.73        1.3068\n8   AAAAAAAAEBPOBAAA                                                                                 Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n9   AAAAAAAAAMLDAAAA                                                                                                                                                                                                        Men                           NaN     70400.58        3.2004\n10  AAAAAAAANBDPCAAA                                                                                                                                                                                                        Men                           NaN     57570.69        2.6172\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                        Men                          2.56     43123.47        1.9604\n12  AAAAAAAAABLKAAAA                                       Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.194747,
                    "execution_time": 0.133413,
                    "compile_time": 0.015595,
                    "planning_time": 0.042805
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.774258,
                    "execution_time": 0.130495,
                    "compile_time": 4.613966,
                    "planning_time": 0.105401
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.221416,
                    "execution_time": 0.16178,
                    "compile_time": 0.014225,
                    "planning_time": 0.042077
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.802614,
                    "execution_time": 0.133487,
                    "compile_time": 4.637623,
                    "planning_time": 0.107882
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.464871,
                    "execution_time": 0.390078,
                    "compile_time": 0.02988,
                    "planning_time": 0.043194
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.545649,
                    "execution_time": 0.420749,
                    "compile_time": 6.375118,
                    "planning_time": 0.111584
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.454251,
                    "execution_time": 0.392824,
                    "compile_time": 0.000362,
                    "planning_time": 0.042966
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.45394,
                    "execution_time": 0.394966,
                    "compile_time": 0.000356,
                    "planning_time": 0.04106
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                               Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43     57248.78        2.6025\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                Men                           NaN     70400.58        3.2004\n2   AAAAAAAAEBPOBAAA                                                                                         Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                           NaN     49555.74        2.2528\n3   AAAAAAAAEGEFAAAA                                                Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     40062.68        1.8212\n4   AAAAAAAAEOEIBAAA                                                                                                                                                                                          Total, very fo        Men                         12.72     35910.84        1.6325\n5   AAAAAAAAGIGEBAAA                                                                                                                                                                                             At least sm        Men                           NaN     40986.43        1.8632\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                                                Men                           NaN     16376.96        0.7445\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                Men                           NaN     68700.27        3.1231\n8   AAAAAAAAKOHOBAAA                                                                                                                                                                                                                Men                           NaN     28745.73        1.3068\n9   AAAAAAAALCNNBAAA                                                                                                                                                                                                                Men                         23.97     63640.27        2.8931\n10  AAAAAAAAMFHACAAA                                                                                                                                                                                                                Men                          3.18     33225.70        1.5104\n11  AAAAAAAAMIDLAAAA                                                                                                                                                                                                                Men                          2.56     43123.47        1.9604\n...*/"
    }
]