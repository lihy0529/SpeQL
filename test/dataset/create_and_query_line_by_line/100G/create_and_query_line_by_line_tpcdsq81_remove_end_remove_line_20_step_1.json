[
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n group by cr_returning_customer_sk, ca_state)\nselect * from customer_total_return /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\"",
                "rewrite": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "with /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk\n join customer_address on cr_returning_customer_sk = ca_address_sk\n where d_year = 1999\n group by cr_returning_customer_sk, ca_state\n )\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.857401,
                    "execution_time": 0.481566,
                    "compile_time": 0.033777,
                    "planning_time": 0.041229,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.209306,
                    "execution_time": 0.475769,
                    "compile_time": 3.298038,
                    "planning_time": 0.111787,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            945210        NC           2135.14\n1            286377        NY            610.83\n2            347828        GA           4970.54\n3            998162        WY           5910.61\n4            756270        VA            936.21\n5            597672        MT           3621.49\n6            370287        CO            115.12\n7             58084        ME           7259.11\n8            682669        WA           3141.24\n9            668658        TX           2158.02\n10            66580        CO            986.63\n11           528836        NE           2188.68\n12           208357        NY           4872.17\n13           703835        KY           3991.86\n14           608287        TN            749.72\n15           517726        VA           1061.08\n16           395641        IA            370.22\n17            97784        MT            530.14\n18           860063        TX           4205.87\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017566,
                    "execution_time": 0.008186,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003413
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055226,
                    "execution_time": 0.008054,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038675
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            945210        NC           2135.14\n1            286377        NY            610.83\n2            347828        GA           4970.54\n3            998162        WY           5910.61\n4            756270        VA            936.21\n5            597672        MT           3621.49\n6            370287        CO            115.12\n7             58084        ME           7259.11\n8            682669        WA           3141.24\n9            668658        TX           2158.02\n10            66580        CO            986.63\n11           528836        NE           2188.68\n12           208357        NY           4872.17\n13           703835        KY           3991.86\n14           608287        TN            749.72\n15           517726        VA           1061.08\n16           395641        IA            370.22\n17            97784        MT            530.14\n18           860063        TX           4205.87\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk \n join customer_address on cr_returning_addr_sk = ca_address_sk \n where d_year =1999\n group by cr_returning_customer_sk, ca_state\n)\n/*CURSOR_IDENTIFIER*/\nselect * from customer_total_return;",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.062959,
                    "execution_time": 0.688467,
                    "compile_time": 0.030519,
                    "planning_time": 0.040001,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.054889,
                    "execution_time": 1.366608,
                    "compile_time": 3.27157,
                    "planning_time": 0.110709,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           1271423        OH              6.66\n1            667003        MI           2682.40\n2            397414        NY            940.70\n3            859866        KS             14.40\n4            517940        PA            647.39\n5           1647345        WV           7463.64\n6            894026        MN            879.68\n7            384265        TX             17.09\n8           1772408        TX            288.66\n9            110403        PA           1062.37\n10          1631183        PA             77.91\n11           791597        MN            476.72\n12           275594        TX             54.42\n13          1191208        MO             90.05\n14           759852        KY           2039.47\n15          1195382        ND            724.42\n16          1646281        NC            489.66\n17          1115829        NV            163.70\n18          1045818        MA              0.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017677,
                    "execution_time": 0.008236,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003503
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054988,
                    "execution_time": 0.007757,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038799
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           1271423        OH              6.66\n1            667003        MI           2682.40\n2            397414        NY            940.70\n3            859866        KS             14.40\n4            517940        PA            647.39\n5           1647345        WV           7463.64\n6            894026        MN            879.68\n7            384265        TX             17.09\n8           1772408        TX            288.66\n9            110403        PA           1062.37\n10          1631183        PA             77.91\n11           791597        MN            476.72\n12           275594        TX             54.42\n13          1191208        MO             90.05\n14           759852        KY           2039.47\n15          1195382        ND            724.42\n16          1646281        NC            489.66\n17          1115829        NV            163.70\n18          1045818        MA              0.00\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year = 1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk, ca_state\n)\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           1271423        OH              6.66\n1            667003        MI           2682.40\n2            397414        NY            940.70\n3            859866        KS             14.40\n4            517940        PA            647.39\n5           1647345        WV           7463.64\n6            894026        MN            879.68\n7            384265        TX             17.09\n8           1772408        TX            288.66\n9            110403        PA           1062.37\n10          1631183        PA             77.91\n11           791597        MN            476.72\n12           275594        TX             54.42\n13          1191208        MO             90.05\n14           759852        KY           2039.47\n15          1195382        ND            724.42\n16          1646281        NC            489.66\n17          1115829        NV            163.70\n18          1045818        MA              0.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016834,
                    "execution_time": 0.007311,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003438
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016935,
                    "execution_time": 0.00752,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003329
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           1271423        OH              6.66\n1            667003        MI           2682.40\n2            397414        NY            940.70\n3            859866        KS             14.40\n4            517940        PA            647.39\n5           1647345        WV           7463.64\n6            894026        MN            879.68\n7            384265        TX             17.09\n8           1772408        TX            288.66\n9            110403        PA           1062.37\n10          1631183        PA             77.91\n11           791597        MN            476.72\n12           275594        TX             54.42\n13          1191208        MO             90.05\n14           759852        KY           2039.47\n15          1195382        ND            724.42\n16          1646281        NC            489.66\n17          1115829        NV            163.70\n18          1045818        MA              0.00\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           1245837        OK           2074.11\n1           1288147        SD             81.60\n2           1303790                      267.74\n3           1875135        TX             68.43\n4           1622934        OH            263.08\n5            708927        IL            425.33\n6            885474        MO             88.99\n7           1823512        WI             24.60\n8            546038        GA             52.12\n9            278421        NE             10.20\n10           927340        MO           1716.48\n11           398108        NC           1251.41\n12          1773130        OH            214.51\n13           591330        IA             16.01\n14           457820        PA            621.22\n15          1660601        TN           1794.31\n16          1870500        MT           3872.56\n17          1781500        ND           4391.52\n18          1885702        TX            931.99\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016966,
                    "execution_time": 0.007593,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003424
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01694,
                    "execution_time": 0.007401,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003519
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0           1245837        OK           2074.11\n1           1288147        SD             81.60\n2           1303790                      267.74\n3           1875135        TX             68.43\n4           1622934        OH            263.08\n5            708927        IL            425.33\n6            885474        MO             88.99\n7           1823512        WI             24.60\n8            546038        GA             52.12\n9            278421        NE             10.20\n10           927340        MO           1716.48\n11           398108        NC           1251.41\n12          1773130        OH            214.51\n13           591330        IA             16.01\n14           457820        PA            621.22\n15          1660601        TN           1794.31\n16          1870500        MT           3872.56\n17          1781500        ND           4391.52\n18          1885702        TX            931.99\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.40181,
                    "execution_time": 0.226717,
                    "compile_time": 0.000276,
                    "planning_time": 0.003034,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.480189,
                    "execution_time": 0.234589,
                    "compile_time": 0.000264,
                    "planning_time": 0.058499,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number     ca_city        ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            441.53\n1   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             34.91\n2   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             81.76\n3   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             58.35\n4   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            312.01\n5   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            375.58\n6   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           1070.59\n7   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            616.95\n8   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           2727.10\n9   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             79.92\n10  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             26.85\n11  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            624.70\n12  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo              3.87\n13  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             15.81\n14  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           9255.58\n15  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           1604.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.306423,
                    "execution_time": 0.259742,
                    "compile_time": 0.03178,
                    "planning_time": 0.036971
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.746642,
                    "execution_time": 0.253834,
                    "compile_time": 3.591714,
                    "planning_time": 0.092544
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number     ca_city        ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            441.53\n1   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             34.91\n2   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             81.76\n3   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             58.35\n4   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            312.01\n5   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            375.58\n6   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           1070.59\n7   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            616.95\n8   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           2727.10\n9   AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             79.92\n10  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             26.85\n11  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo            624.70\n12  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo              3.87\n13  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo             15.81\n14  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           9255.58\n15  AAAAAAAADHAJNBAA          Ms.        Holly     Johnson              376  10th Chestnut            Dr.         Suite Q  Union Hill  Cherokee County       IA  57746  United States           -6.0            condo           1604.68\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_3\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.069281,
                    "execution_time": 0.039247,
                    "compile_time": 0.000319,
                    "planning_time": 0.003709,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.127782,
                    "execution_time": 0.039118,
                    "compile_time": 0.000336,
                    "planning_time": 0.060119,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.066857,
                    "execution_time": 0.03829,
                    "compile_time": 0.000291,
                    "planning_time": 0.003509,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.135161,
                    "execution_time": 0.038344,
                    "compile_time": 0.000286,
                    "planning_time": 0.059817,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.487114,
                    "execution_time": 0.239601,
                    "compile_time": 0.000262,
                    "planning_time": 0.003212,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.001636,
                    "execution_time": 0.291397,
                    "compile_time": 0.190127,
                    "planning_time": 0.264871,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.077142,
                    "execution_time": 0.047845,
                    "compile_time": 0.000286,
                    "planning_time": 0.003706,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.133269,
                    "execution_time": 0.04673,
                    "compile_time": 0.00026,
                    "planning_time": 0.05925,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number ca_city ca_county ca_state ca_zip ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           1894.83\n1   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3990.08\n2   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2589.25\n3   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3726.39\n4   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           6319.87\n5   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           4651.52\n6   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           1817.26\n7   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           1925.60\n8   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2292.21\n9   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3507.60\n10  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2139.67\n11  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2517.90\n12  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3267.13\n13  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3534.23\n14  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           6739.20\n15  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3793.07\n16  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2163.28\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.696646,
                    "execution_time": 0.64032,
                    "compile_time": 0.043137,
                    "planning_time": 0.040829
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.236439,
                    "execution_time": 2.138251,
                    "compile_time": 5.022109,
                    "planning_time": 0.101284
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number ca_city ca_county ca_state ca_zip ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           1894.83\n1   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3990.08\n2   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2589.25\n3   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3726.39\n4   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           6319.87\n5   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           4651.52\n6   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           1817.26\n7   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           1925.60\n8   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2292.21\n9   AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3507.60\n10  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2139.67\n11  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2517.90\n12  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3267.13\n13  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3534.23\n14  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           6739.20\n15  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           3793.07\n16  AAAAAAAACJAJNBAA          Mr.         Eric       Allen                                            Ave                                                                        -6.0        apartment           2163.28\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number     ca_city    ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           3476.92\n1   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2254.78\n2   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           9175.24\n3   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           5749.32\n4   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2850.43\n5   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           1981.41\n6   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2521.73\n7   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2429.29\n8   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           4900.97\n9   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2907.12\n10  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2751.72\n11  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           1894.02\n12  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           1956.21\n13  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2587.24\n14  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           5874.02\n15  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2668.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.745931,
                    "execution_time": 0.652392,
                    "compile_time": 0.03323,
                    "planning_time": 0.04538
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.013676,
                    "execution_time": 0.598108,
                    "compile_time": 3.296566,
                    "planning_time": 0.098603
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number     ca_city    ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           3476.92\n1   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2254.78\n2   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           9175.24\n3   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           5749.32\n4   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2850.43\n5   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           1981.41\n6   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2521.73\n7   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2429.29\n8   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           4900.97\n9   AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2907.12\n10  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2751.72\n11  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           1894.02\n12  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           1956.21\n13  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2587.24\n14  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           5874.02\n15  AAAAAAAAGLEOGBAA          Mr.        Roger      Torres              235           1st             Dr.       Suite 190  Greenfield  Lake County       TN  35038  United States           -6.0    single family           2668.49\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.074089,
                    "execution_time": 0.046403,
                    "compile_time": 0.000252,
                    "planning_time": 0.003806,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.131998,
                    "execution_time": 0.04647,
                    "compile_time": 0.000276,
                    "planning_time": 0.059726,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.523142,
                    "execution_time": 0.180213,
                    "compile_time": 0.162392,
                    "planning_time": 0.036751,
                    "create_size": 608
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.221315,
                    "execution_time": 0.249361,
                    "compile_time": 9.71444,
                    "planning_time": 0.101597,
                    "create_size": 608
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number    ca_street_name ca_street_type ca_suite_number        ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAOPGCCBAA         Miss        Naomi      Wenger              767      College 11th           Blvd         Suite K     Unionville    Sullivan County       TN  31711  United States           -6.0        apartment           3482.72\n1   AAAAAAAALKEDABAA         Mrs.        Lydia      Mathis              732             Park            Blvd       Suite 170       Florence       Wayne County       TN  33394  United States           -6.0            condo           2098.74\n2   AAAAAAAAIGCEEBAA          Mr.       Thomas   Hernandez              301            Adams              Ln       Suite 130        Lebanon     Madison County       TN  32898  United States           -6.0        apartment           7545.06\n3   AAAAAAAAHLBAKBAA                   Michael                          391                                                                                          TN         United States           -6.0                            2595.53\n4   AAAAAAAAJEHEKAAA          Dr.       Robert       Lopez              925       8th Dogwood         Avenue       Suite 280       Woodlawn      Putnam County       TN  34098  United States           -6.0        apartment           6358.29\n5   AAAAAAAAEFOKIAAA          Mr.        David        Lake              960             11th             Dr.       Suite 240       Waterloo       Macon County       TN  31675  United States           -6.0    single family           6019.64\n6   AAAAAAAAFHNOHAAA          Mr.        Elmer    Turnbull              520            South            Blvd         Suite B          Royal      Gibson County       TN  35819  United States           -5.0    single family           6458.36\n7   AAAAAAAADAJCNBAA          Sir        Jacob    Williams               18        Spring 3rd             Wy         Suite B       Lakeview     Hancock County       TN  38579  United States           -5.0            condo           5363.68\n8   AAAAAAAAKNHELAAA          Sir       Edward       Payne              126  Spruce Hillcrest           Pkwy       Suite 140    Maple Grove     Hawkins County       TN  38252  United States           -5.0            condo           2337.83\n9   AAAAAAAAJLNEJBAA          Ms.        Nancy       Bland              898      Spring South             Ln         Suite K    Springfield       Giles County       TN  39303  United States           -5.0    single family           3337.81\n10  AAAAAAAAMJGFDBAA          Dr.       Tawnya      Norton               81             10th             Dr.         Suite J    Buena Vista      Tipton County       TN  35752  United States           -6.0            condo           9482.44\n11  AAAAAAAACBHDFAAA         Mrs.                                       694         1st Adams             RD       Suite 240       Woodland     Houston County       TN  34854  United States           -5.0            condo           6554.61\n12  AAAAAAAAPGIKNBAA          Sir        Henry        Park              630            Eigth           Drive        Suite 30        Perkins    Franklin County       TN  31852  United States           -5.0    single family           5516.49\n13  AAAAAAAANDLMHAAA          Sir  Christopher       Green              230           Wilson          Circle         Suite V      Macedonia     Carroll County       TN  31087  United States           -5.0        apartment           2480.96\n14  AAAAAAAAKBKIOAAA          Dr.       Edward      Harris              648              3rd             Ave       Suite 480     Pine Grove      Wilson County       TN  34593  United States           -5.0    single family           1892.58\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.049724,
                    "execution_time": 0.007883,
                    "compile_time": 0.028954,
                    "planning_time": 0.005673
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.10552,
                    "execution_time": 0.008346,
                    "compile_time": 3.044447,
                    "planning_time": 0.042017
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number    ca_street_name ca_street_type ca_suite_number        ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAOPGCCBAA         Miss        Naomi      Wenger              767      College 11th           Blvd         Suite K     Unionville    Sullivan County       TN  31711  United States           -6.0        apartment           3482.72\n1   AAAAAAAALKEDABAA         Mrs.        Lydia      Mathis              732             Park            Blvd       Suite 170       Florence       Wayne County       TN  33394  United States           -6.0            condo           2098.74\n2   AAAAAAAAIGCEEBAA          Mr.       Thomas   Hernandez              301            Adams              Ln       Suite 130        Lebanon     Madison County       TN  32898  United States           -6.0        apartment           7545.06\n3   AAAAAAAAHLBAKBAA                   Michael                          391                                                                                          TN         United States           -6.0                            2595.53\n4   AAAAAAAAJEHEKAAA          Dr.       Robert       Lopez              925       8th Dogwood         Avenue       Suite 280       Woodlawn      Putnam County       TN  34098  United States           -6.0        apartment           6358.29\n5   AAAAAAAAEFOKIAAA          Mr.        David        Lake              960             11th             Dr.       Suite 240       Waterloo       Macon County       TN  31675  United States           -6.0    single family           6019.64\n6   AAAAAAAAFHNOHAAA          Mr.        Elmer    Turnbull              520            South            Blvd         Suite B          Royal      Gibson County       TN  35819  United States           -5.0    single family           6458.36\n7   AAAAAAAADAJCNBAA          Sir        Jacob    Williams               18        Spring 3rd             Wy         Suite B       Lakeview     Hancock County       TN  38579  United States           -5.0            condo           5363.68\n8   AAAAAAAAKNHELAAA          Sir       Edward       Payne              126  Spruce Hillcrest           Pkwy       Suite 140    Maple Grove     Hawkins County       TN  38252  United States           -5.0            condo           2337.83\n9   AAAAAAAAJLNEJBAA          Ms.        Nancy       Bland              898      Spring South             Ln         Suite K    Springfield       Giles County       TN  39303  United States           -5.0    single family           3337.81\n10  AAAAAAAAMJGFDBAA          Dr.       Tawnya      Norton               81             10th             Dr.         Suite J    Buena Vista      Tipton County       TN  35752  United States           -6.0            condo           9482.44\n11  AAAAAAAACBHDFAAA         Mrs.                                       694         1st Adams             RD       Suite 240       Woodland     Houston County       TN  34854  United States           -5.0            condo           6554.61\n12  AAAAAAAAPGIKNBAA          Sir        Henry        Park              630            Eigth           Drive        Suite 30        Perkins    Franklin County       TN  31852  United States           -5.0    single family           5516.49\n13  AAAAAAAANDLMHAAA          Sir  Christopher       Green              230           Wilson          Circle         Suite V      Macedonia     Carroll County       TN  31087  United States           -5.0        apartment           2480.96\n14  AAAAAAAAKBKIOAAA          Dr.       Edward      Harris              648              3rd             Ave       Suite 480     Pine Grove      Wilson County       TN  34593  United States           -5.0    single family           1892.58\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039537,
                    "execution_time": 0.011609,
                    "compile_time": 0.014252,
                    "planning_time": 0.006309
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.325875,
                    "execution_time": 0.011183,
                    "compile_time": 5.268022,
                    "planning_time": 0.042586
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0429,
                    "execution_time": 0.010862,
                    "compile_time": 0.016797,
                    "planning_time": 0.007308
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.729924,
                    "execution_time": 0.012095,
                    "compile_time": 4.673698,
                    "planning_time": 0.043078
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" , \"CA_LOCATION_TYPE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.058616,
                    "execution_time": 0.011527,
                    "compile_time": 0.032095,
                    "planning_time": 0.007172
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.335431,
                    "execution_time": 0.011072,
                    "compile_time": 3.277097,
                    "planning_time": 0.045421
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" , \"CA_LOCATION_TYPE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026645,
                    "execution_time": 0.011427,
                    "compile_time": 0.000109,
                    "planning_time": 0.007419
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.026144,
                    "execution_time": 0.0109,
                    "compile_time": 0.000108,
                    "planning_time": 0.007327
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_9\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_9\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number       ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAAAHAAA          Dr.        Linda       Silva               30  Sycamore Maple      Boulevard       Suite 380      Franklin  Lauderdale County       TN  39101  United States           -6.0            condo           2370.06\n1   AAAAAAAAAAAAMAAA          Dr.       Daniel       Mckay              606    Second North           Road       Suite 280       Newport   Robertson County       TN  31521  United States           -6.0    single family           2618.17\n2   AAAAAAAAAABAOAAA         Mrs.         Ruth       Smith              449           Park          Street         Suite I     Hillcrest       Smith County       TN  33003  United States           -6.0        apartment           2167.51\n3   AAAAAAAAAABFBBAA          Mr.         Tony     Pearson              284   Fourth Church            Ct.         Suite M     Plainview     Decatur County       TN  33683  United States           -5.0    single family           2314.81\n4   AAAAAAAAAABIKBAA          Sir                                       862           Pine            Blvd         Suite W      Fairview   Henderson County       TN  35709  United States           -5.0            condo           1704.38\n5   AAAAAAAAAACIHAAA          Dr.     Reginald  Washington              315        Johnson             Ave       Suite 140    Springdale      Sevier County       TN  38883  United States           -6.0        apartment           4258.93\n6   AAAAAAAAAACLCAAA          Sir        Moses    Bautista                                                       Suite 250        Marion     Lincoln County       TN  30399  United States           -6.0                            2852.48\n7   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           2672.80\n8   AAAAAAAAAACMDAAA          Dr.        Shane       Wells              830        Lake Oak            Ave         Suite L     Jamestown    Fentress County       TN  36867  United States           -5.0    single family           4229.19\n9   AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           2107.94\n10  AAAAAAAAAACNNBAA          Dr.      Charles      Barnes              975     Ridge Cedar             Ln         Suite M     Deerfield      Coffee County       TN  39840  United States           -5.0    single family           5428.34\n11  AAAAAAAAAACOBBAA         Mrs.        Karen     Pollack              389     Poplar 11th            Dr.       Suite 380      Lakeview        Rhea County       TN  38579  United States           -6.0            condo           6388.45\n12  AAAAAAAAAACOJAAA          Ms.     Marjorie    Williams              967   Third Dogwood            Dr.         Suite E   Mount Olive    Franklin County       TN  38059  United States           -5.0        apartment           2650.92\n13  AAAAAAAAAADCHAAA         Mrs.      Earlene        Moss              459          Fifth            Cir.         Suite B       Maywood      Wilson County       TN  35681  United States           -5.0            condo          11682.74\n14  AAAAAAAAAADFFBAA          Sir        David      Porter              530         Ash 7th             RD        Suite 20       Oakdale      Blount County       TN  39584  United States           -5.0    single family           2495.24\n...*/"
    }
]